(function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=i.toString,l=i.hasOwnProperty,c=r.forEach,h=r.map,p=r.reduce,d=r.reduceRight,v=r.filter,m=r.every,g=r.some,y=r.indexOf,b=r.lastIndexOf,w=Array.isArray,E=Object.keys,S=s.bind,x=function(e){if(e instanceof x)return e;if(!(this instanceof x))return new x(e);this._wrapped=e};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=x),exports._=x):e._=x,x.VERSION="1.6.0";var T=x.each=x.forEach=function(e,t,r){if(e==null)return e;if(c&&e.forEach===c)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;i<s;i++)if(t.call(r,e[i],i,e)===n)return}else{var o=x.keys(e);for(var i=0,s=o.length;i<s;i++)if(t.call(r,e[o[i]],o[i],e)===n)return}return e};x.map=x.collect=function(e,t,n){var r=[];return e==null?r:h&&e.map===h?e.map(t,n):(T(e,function(e,i,s){r.push(t.call(n,e,i,s))}),r)};var N="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(p&&e.reduce===p)return r&&(t=x.bind(t,r)),i?e.reduce(t,n):e.reduce(t);T(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)});if(!i)throw new TypeError(N);return n},x.reduceRight=x.foldr=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(d&&e.reduceRight===d)return r&&(t=x.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=x.keys(e);s=o.length}T(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)});if(!i)throw new TypeError(N);return n},x.find=x.detect=function(e,t,n){var r;return C(e,function(e,i,s){if(t.call(n,e,i,s))return r=e,!0}),r},x.filter=x.select=function(e,t,n){var r=[];return e==null?r:v&&e.filter===v?e.filter(t,n):(T(e,function(e,i,s){t.call(n,e,i,s)&&r.push(e)}),r)},x.reject=function(e,t,n){return x.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},x.every=x.all=function(e,t,r){t||(t=x.identity);var i=!0;return e==null?i:m&&e.every===m?e.every(t,r):(T(e,function(e,s,o){if(!(i=i&&t.call(r,e,s,o)))return n}),!!i)};var C=x.some=x.any=function(e,t,r){t||(t=x.identity);var i=!1;return e==null?i:g&&e.some===g?e.some(t,r):(T(e,function(e,s,o){if(i||(i=t.call(r,e,s,o)))return n}),!!i)};x.contains=x.include=function(e,t){return e==null?!1:y&&e.indexOf===y?e.indexOf(t)!=-1:C(e,function(e){return e===t})},x.invoke=function(e,t){var n=u.call(arguments,2),r=x.isFunction(t);return x.map(e,function(e){return(r?t:e[t]).apply(e,n)})},x.pluck=function(e,t){return x.map(e,x.property(t))},x.where=function(e,t){return x.filter(e,x.matches(t))},x.findWhere=function(e,t){return x.find(e,x.matches(t))},x.max=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);var r=-Infinity,i=-Infinity;return T(e,function(e,s,o){var u=t?t.call(n,e,s,o):e;u>i&&(r=e,i=u)}),r},x.min=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);var r=Infinity,i=Infinity;return T(e,function(e,s,o){var u=t?t.call(n,e,s,o):e;u<i&&(r=e,i=u)}),r},x.shuffle=function(e){var t,n=0,r=[];return T(e,function(e){t=x.random(n++),r[n-1]=r[t],r[t]=e}),r},x.sample=function(e,t,n){return t==null||n?(e.length!==+e.length&&(e=x.values(e)),e[x.random(e.length-1)]):x.shuffle(e).slice(0,Math.max(0,t))};var k=function(e){return e==null?x.identity:x.isFunction(e)?e:x.property(e)};x.sortBy=function(e,t,n){return t=k(t),x.pluck(x.map(e,function(e,r,i){return{value:e,index:r,criteria:t.call(n,e,r,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(n<r||r===void 0)return-1}return e.index-t.index}),"value")};var L=function(e){return function(t,n,r){var i={};return n=k(n),T(t,function(s,o){var u=n.call(r,s,o,t);e(i,u,s)}),i}};x.groupBy=L(function(e,t,n){x.has(e,t)?e[t].push(n):e[t]=[n]}),x.indexBy=L(function(e,t,n){e[t]=n}),x.countBy=L(function(e,t){x.has(e,t)?e[t]++:e[t]=1}),x.sortedIndex=function(e,t,n,r){n=k(n);var i=n.call(r,t),s=0,o=e.length;while(s<o){var u=s+o>>>1;n.call(r,e[u])<i?s=u+1:o=u}return s},x.toArray=function(e){return e?x.isArray(e)?u.call(e):e.length===+e.length?x.map(e,x.identity):x.values(e):[]},x.size=function(e){return e==null?0:e.length===+e.length?e.length:x.keys(e).length},x.first=x.head=x.take=function(e,t,n){return e==null?void 0:t==null||n?e[0]:t<0?[]:u.call(e,0,t)},x.initial=function(e,t,n){return u.call(e,0,e.length-(t==null||n?1:t))},x.last=function(e,t,n){return e==null?void 0:t==null||n?e[e.length-1]:u.call(e,Math.max(e.length-t,0))},x.rest=x.tail=x.drop=function(e,t,n){return u.call(e,t==null||n?1:t)},x.compact=function(e){return x.filter(e,x.identity)};var A=function(e,t,n){return t&&x.every(e,x.isArray)?a.apply(n,e):(T(e,function(e){x.isArray(e)||x.isArguments(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n)};x.flatten=function(e,t){return A(e,t,[])},x.without=function(e){return x.difference(e,u.call(arguments,1))},x.partition=function(e,t){var n=[],r=[];return T(e,function(e){(t(e)?n:r).push(e)}),[n,r]},x.uniq=x.unique=function(e,t,n,r){x.isFunction(t)&&(r=n,n=t,t=!1);var i=n?x.map(e,n,r):e,s=[],o=[];return T(i,function(n,r){if(t?!r||o[o.length-1]!==n:!x.contains(o,n))o.push(n),s.push(e[r])}),s},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(e){var t=u.call(arguments,1);return x.filter(x.uniq(e),function(e){return x.every(t,function(t){return x.contains(t,e)})})},x.difference=function(e){var t=a.apply(r,u.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})},x.zip=function(){var e=x.max(x.pluck(arguments,"length").concat(0)),t=new Array(e);for(var n=0;n<e;n++)t[n]=x.pluck(arguments,""+n);return t},x.object=function(e,t){if(e==null)return{};var n={};for(var r=0,i=e.length;r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},x.indexOf=function(e,t,n){if(e==null)return-1;var r=0,i=e.length;if(n){if(typeof n!="number")return r=x.sortedIndex(e,t),e[r]===t?r:-1;r=n<0?Math.max(0,i+n):n}if(y&&e.indexOf===y)return e.indexOf(t,n);for(;r<i;r++)if(e[r]===t)return r;return-1},x.lastIndexOf=function(e,t,n){if(e==null)return-1;var r=n!=null;if(b&&e.lastIndexOf===b)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);var i=r?n:e.length;while(i--)if(e[i]===t)return i;return-1},x.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);while(i<r)s[i++]=e,e+=n;return s};var O=function(){};x.bind=function(e,t){var n,r;if(S&&e.bind===S)return S.apply(e,u.call(arguments,1));if(!x.isFunction(e))throw new TypeError;return n=u.call(arguments,2),r=function(){if(this instanceof r){O.prototype=e.prototype;var i=new O;O.prototype=null;var s=e.apply(i,n.concat(u.call(arguments)));return Object(s)===s?s:i}return e.apply(t,n.concat(u.call(arguments)))}},x.partial=function(e){var t=u.call(arguments,1);return function(){var n=0,r=t.slice();for(var i=0,s=r.length;i<s;i++)r[i]===x&&(r[i]=arguments[n++]);while(n<arguments.length)r.push(arguments[n++]);return e.apply(this,r)}},x.bindAll=function(e){var t=u.call(arguments,1);if(t.length===0)throw new Error("bindAll must be passed function names");return T(t,function(t){e[t]=x.bind(e[t],e)}),e},x.memoize=function(e,t){var n={};return t||(t=x.identity),function(){var r=t.apply(this,arguments);return x.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},x.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},x.defer=function(e){return x.delay.apply(x,[e,1].concat(u.call(arguments,1)))},x.throttle=function(e,t,n){var r,i,s,o=null,u=0;n||(n={});var a=function(){u=n.leading===!1?0:x.now(),o=null,s=e.apply(r,i),r=i=null};return function(){var f=x.now();!u&&n.leading===!1&&(u=f);var l=t-(f-u);return r=this,i=arguments,l<=0?(clearTimeout(o),o=null,u=f,s=e.apply(r,i),r=i=null):!o&&n.trailing!==!1&&(o=setTimeout(a,l)),s}},x.debounce=function(e,t,n){var r,i,s,o,u,a=function(){var f=x.now()-o;f<t?r=setTimeout(a,t-f):(r=null,n||(u=e.apply(s,i),s=i=null))};return function(){s=this,i=arguments,o=x.now();var f=n&&!r;return r||(r=setTimeout(a,t)),f&&(u=e.apply(s,i),s=i=null),u}},x.once=function(e){var t=!1,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}},x.wrap=function(e,t){return x.partial(t,e)},x.compose=function(){var e=arguments;return function(){var t=arguments;for(var n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},x.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},x.keys=function(e){if(!x.isObject(e))return[];if(E)return E(e);var t=[];for(var n in e)x.has(e,n)&&t.push(n);return t},x.values=function(e){var t=x.keys(e),n=t.length,r=new Array(n);for(var i=0;i<n;i++)r[i]=e[t[i]];return r},x.pairs=function(e){var t=x.keys(e),n=t.length,r=new Array(n);for(var i=0;i<n;i++)r[i]=[t[i],e[t[i]]];return r},x.invert=function(e){var t={},n=x.keys(e);for(var r=0,i=n.length;r<i;r++)t[e[n[r]]]=n[r];return t},x.functions=x.methods=function(e){var t=[];for(var n in e)x.isFunction(e[n])&&t.push(n);return t.sort()},x.extend=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},x.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return T(n,function(n){n in e&&(t[n]=e[n])}),t},x.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)x.contains(n,i)||(t[i]=e[i]);return t},x.defaults=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]===void 0&&(e[n]=t[n])}),e},x.clone=function(e){return x.isObject(e)?x.isArray(e)?e.slice():x.extend({},e):e},x.tap=function(e,t){return t(e),e};var M=function(e,t,n,r){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;e instanceof x&&(e=e._wrapped),t instanceof x&&(t=t._wrapped);var i=f.call(e);if(i!=f.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return!1;var s=n.length;while(s--)if(n[s]==e)return r[s]==t;var o=e.constructor,u=t.constructor;if(o!==u&&!(x.isFunction(o)&&o instanceof o&&x.isFunction(u)&&u instanceof u)&&"constructor"in e&&"constructor"in t)return!1;n.push(e),r.push(t);var a=0,l=!0;if(i=="[object Array]"){a=e.length,l=a==t.length;if(l)while(a--)if(!(l=M(e[a],t[a],n,r)))break}else{for(var c in e)if(x.has(e,c)){a++;if(!(l=x.has(t,c)&&M(e[c],t[c],n,r)))break}if(l){for(c in t)if(x.has(t,c)&&!(a--))break;l=!a}}return n.pop(),r.pop(),l};x.isEqual=function(e,t){return M(e,t,[],[])},x.isEmpty=function(e){if(e==null)return!0;if(x.isArray(e)||x.isString(e))return e.length===0;for(var t in e)if(x.has(e,t))return!1;return!0},x.isElement=function(e){return!!e&&e.nodeType===1},x.isArray=w||function(e){return f.call(e)=="[object Array]"},x.isObject=function(e){return e===Object(e)},T(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return f.call(t)=="[object "+e+"]"}}),x.isArguments(arguments)||(x.isArguments=function(e){return!!e&&!!x.has(e,"callee")}),typeof /./!="function"&&(x.isFunction=function(e){return typeof e=="function"}),x.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},x.isNaN=function(e){return x.isNumber(e)&&e!=+e},x.isBoolean=function(e){return e===!0||e===!1||f.call(e)=="[object Boolean]"},x.isNull=function(e){return e===null},x.isUndefined=function(e){return e===void 0},x.has=function(e,t){return l.call(e,t)},x.noConflict=function(){return e._=t,this},x.identity=function(e){return e},x.constant=function(e){return function(){return e}},x.property=function(e){return function(t){return t[e]}},x.matches=function(e){return function(t){if(t===e)return!0;for(var n in e)if(e[n]!==t[n])return!1;return!0}},x.times=function(e,t,n){var r=Array(Math.max(0,e));for(var i=0;i<e;i++)r[i]=t.call(n,i);return r},x.random=function(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},x.now=Date.now||function(){return(new Date).getTime()};var _={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};_.unescape=x.invert(_.escape);var D={escape:new RegExp("["+x.keys(_.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(_.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(e){x[e]=function(t){return t==null?"":(""+t).replace(D[e],function(t){return _[e][t]})}}),x.result=function(e,t){if(e==null)return void 0;var n=e[t];return x.isFunction(n)?n.call(e):n},x.mixin=function(e){T(x.functions(e),function(t){var n=x[t]=e[t];x.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),F.call(this,n.apply(x,e))}})};var P=0;x.uniqueId=function(e){var t=++P+"";return e?e+t:t},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(e,t,n){var r;n=x.defaults({},n,x.templateSettings);var i=new RegExp([(n.escape||H).source,(n.interpolate||H).source,(n.evaluate||H).source].join("|")+"|$","g"),s=0,o="__p+='";e.replace(i,function(t,n,r,i,u){return o+=e.slice(s,u).replace(j,function(e){return"\\"+B[e]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(o+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(o+="';\n"+i+"\n__p+='"),s=u+t.length,t}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{r=new Function(n.variable||"obj","_",o)}catch(u){throw u.source=o,u}if(t)return r(t,x);var a=function(e){return r.call(this,e,x)};return a.source="function("+(n.variable||"obj")+"){\n"+o+"}",a},x.chain=function(e){return x(e).chain()};var F=function(e){return this._chain?x(e).chain():e};x.mixin(x),T(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];x.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),(e=="shift"||e=="splice")&&n.length===0&&delete n[0],F.call(this,n)}}),T(["concat","join","slice"],function(e){var t=r[e];x.prototype[e]=function(){return F.call(this,t.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),typeof define=="function"&&define.amd&&define("underscore",[],function(){return x})}).call(this),function(e,t){function _(e){var t=M[e]={};return v.each(e.split(y),function(e,n){t[n]=!0}),t}function H(e,n,r){if(r===t&&e.nodeType===1){var i="data-"+n.replace(P,"-$1").toLowerCase();r=e.getAttribute(i);if(typeof r=="string"){try{r=r==="true"?!0:r==="false"?!1:r==="null"?null:+r+""===r?+r:D.test(r)?v.parseJSON(r):r}catch(s){}v.data(e,n,r)}else r=t}return r}function B(e){var t;for(t in e){if(t==="data"&&v.isEmptyObject(e[t]))continue;if(t!=="toJSON")return!1}return!0}function et(){return!1}function tt(){return!0}function ut(e){return!e||!e.parentNode||e.parentNode.nodeType===11}function at(e,t){do e=e[t];while(e&&e.nodeType!==1);return e}function ft(e,t,n){t=t||0;if(v.isFunction(t))return v.grep(e,function(e,r){var i=!!t.call(e,r,e);return i===n});if(t.nodeType)return v.grep(e,function(e,r){return e===t===n});if(typeof t=="string"){var r=v.grep(e,function(e){return e.nodeType===1});if(it.test(t))return v.filter(t,r,!n);t=v.filter(t,r)}return v.grep(e,function(e,r){return v.inArray(e,t)>=0===n})}function lt(e){var t=ct.split("|"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}function Lt(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function At(e,t){if(t.nodeType!==1||!v.hasData(e))return;var n,r,i,s=v._data(e),o=v._data(t,s),u=s.events;if(u){delete o.handle,o.events={};for(n in u)for(r=0,i=u[n].length;r<i;r++)v.event.add(t,n,u[n][r])}o.data&&(o.data=v.extend({},o.data))}function Ot(e,t){var n;if(t.nodeType!==1)return;t.clearAttributes&&t.clearAttributes(),t.mergeAttributes&&t.mergeAttributes(e),n=t.nodeName.toLowerCase(),n==="object"?(t.parentNode&&(t.outerHTML=e.outerHTML),v.support.html5Clone&&e.innerHTML&&!v.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):n==="input"&&Et.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):n==="option"?t.selected=e.defaultSelected:n==="input"||n==="textarea"?t.defaultValue=e.defaultValue:n==="script"&&t.text!==e.text&&(t.text=e.text),t.removeAttribute(v.expando)}function Mt(e){return typeof e.getElementsByTagName!="undefined"?e.getElementsByTagName("*"):typeof e.querySelectorAll!="undefined"?e.querySelectorAll("*"):[]}function _t(e){Et.test(e.type)&&(e.defaultChecked=e.checked)}function Qt(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=Jt.length;while(i--){t=Jt[i]+n;if(t in e)return t}return r}function Gt(e,t){return e=t||e,v.css(e,"display")==="none"||!v.contains(e.ownerDocument,e)}function Yt(e,t){var n,r,i=[],s=0,o=e.length;for(;s<o;s++){n=e[s];if(!n.style)continue;i[s]=v._data(n,"olddisplay"),t?(!i[s]&&n.style.display==="none"&&(n.style.display=""),n.style.display===""&&Gt(n)&&(i[s]=v._data(n,"olddisplay",nn(n.nodeName)))):(r=Dt(n,"display"),!i[s]&&r!=="none"&&v._data(n,"olddisplay",r))}for(s=0;s<o;s++){n=e[s];if(!n.style)continue;if(!t||n.style.display==="none"||n.style.display==="")n.style.display=t?i[s]||"":"none"}return e}function Zt(e,t,n){var r=Rt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function en(e,t,n,r){var i=n===(r?"border":"content")?4:t==="width"?1:0,s=0;for(;i<4;i+=2)n==="margin"&&(s+=v.css(e,n+$t[i],!0)),r?(n==="content"&&(s-=parseFloat(Dt(e,"padding"+$t[i]))||0),n!=="margin"&&(s-=parseFloat(Dt(e,"border"+$t[i]+"Width"))||0)):(s+=parseFloat(Dt(e,"padding"+$t[i]))||0,n!=="padding"&&(s+=parseFloat(Dt(e,"border"+$t[i]+"Width"))||0));return s}function tn(e,t,n){var r=t==="width"?e.offsetWidth:e.offsetHeight,i=!0,s=v.support.boxSizing&&v.css(e,"boxSizing")==="border-box";if(r<=0||r==null){r=Dt(e,t);if(r<0||r==null)r=e.style[t];if(Ut.test(r))return r;i=s&&(v.support.boxSizingReliable||r===e.style[t]),r=parseFloat(r)||0}return r+en(e,t,n||(s?"border":"content"),i)+"px"}function nn(e){if(Wt[e])return Wt[e];var t=v("<"+e+">").appendTo(i.body),n=t.css("display");t.remove();if(n==="none"||n===""){Pt=i.body.appendChild(Pt||v.extend(i.createElement("iframe"),{frameBorder:0,width:0,height:0}));if(!Ht||!Pt.createElement)Ht=(Pt.contentWindow||Pt.contentDocument).document,Ht.write("<!doctype html><html><body>"),Ht.close();t=Ht.body.appendChild(Ht.createElement(e)),n=Dt(t,"display"),i.body.removeChild(Pt)}return Wt[e]=n,n}function fn(e,t,n,r){var i;if(v.isArray(t))v.each(t,function(t,i){n||sn.test(e)?r(e,i):fn(e+"["+(typeof i=="object"?t:"")+"]",i,n,r)});else if(!n&&v.type(t)==="object")for(i in t)fn(e+"["+i+"]",t[i],n,r);else r(e,t)}function Cn(e){return function(t,n){typeof t!="string"&&(n=t,t="*");var r,i,s,o=t.toLowerCase().split(y),u=0,a=o.length;if(v.isFunction(n))for(;u<a;u++)r=o[u],s=/^\+/.test(r),s&&(r=r.substr(1)||"*"),i=e[r]=e[r]||[],i[s?"unshift":"push"](n)}}function kn(e,n,r,i,s,o){s=s||n.dataTypes[0],o=o||{},o[s]=!0;var u,a=e[s],f=0,l=a?a.length:0,c=e===Sn;for(;f<l&&(c||!u);f++)u=a[f](n,r,i),typeof u=="string"&&(!c||o[u]?u=t:(n.dataTypes.unshift(u),u=kn(e,n,r,i,u,o)));return(c||!u)&&!o["*"]&&(u=kn(e,n,r,i,"*",o)),u}function Ln(e,n){var r,i,s=v.ajaxSettings.flatOptions||{};for(r in n)n[r]!==t&&((s[r]?e:i||(i={}))[r]=n[r]);i&&v.extend(!0,e,i)}function An(e,n,r){var i,s,o,u,a=e.contents,f=e.dataTypes,l=e.responseFields;for(s in l)s in r&&(n[l[s]]=r[s]);while(f[0]==="*")f.shift(),i===t&&(i=e.mimeType||n.getResponseHeader("content-type"));if(i)for(s in a)if(a[s]&&a[s].test(i)){f.unshift(s);break}if(f[0]in r)o=f[0];else{for(s in r){if(!f[0]||e.converters[s+" "+f[0]]){o=s;break}u||(u=s)}o=o||u}if(o)return o!==f[0]&&f.unshift(o),r[o]}function On(e,t){var n,r,i,s,o=e.dataTypes.slice(),u=o[0],a={},f=0;e.dataFilter&&(t=e.dataFilter(t,e.dataType));if(o[1])for(n in e.converters)a[n.toLowerCase()]=e.converters[n];for(;i=o[++f];)if(i!=="*"){if(u!=="*"&&u!==i){n=a[u+" "+i]||a["* "+i];if(!n)for(r in a){s=r.split(" ");if(s[1]===i){n=a[u+" "+s[0]]||a["* "+s[0]];if(n){n===!0?n=a[r]:a[r]!==!0&&(i=s[0],o.splice(f--,0,i));break}}}if(n!==!0)if(n&&e["throws"])t=n(t);else try{t=n(t)}catch(l){return{state:"parsererror",error:n?l:"No conversion from "+u+" to "+i}}}u=i}return{state:"success",data:t}}function Fn(){try{return new e.XMLHttpRequest}catch(t){}}function In(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function $n(){return setTimeout(function(){qn=t},0),qn=v.now()}function Jn(e,t){v.each(t,function(t,n){var r=(Vn[t]||[]).concat(Vn["*"]),i=0,s=r.length;for(;i<s;i++)if(r[i].call(e,t,n))return})}function Kn(e,t,n){var r,i=0,s=0,o=Xn.length,u=v.Deferred().always(function(){delete a.elem}),a=function(){var t=qn||$n(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,i=1-r,s=0,o=f.tweens.length;for(;s<o;s++)f.tweens[s].run(i);return u.notifyWith(e,[f,i,n]),i<1&&o?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:v.extend({},t),opts:v.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:qn||$n(),duration:n.duration,tweens:[],createTween:function(t,n,r){var i=v.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(i),i},stop:function(t){var n=0,r=t?f.tweens.length:0;for(;n<r;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;Qn(l,f.opts.specialEasing);for(;i<o;i++){r=Xn[i].call(f,e,l,f.opts);if(r)return r}return Jn(f,l),v.isFunction(f.opts.start)&&f.opts.start.call(e,f),v.fx.timer(v.extend(a,{anim:f,queue:f.opts.queue,elem:e})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function Qn(e,t){var n,r,i,s,o;for(n in e){r=v.camelCase(n),i=t[r],s=e[n],v.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=v.cssHooks[r];if(o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}}function Gn(e,t,n){var r,i,s,o,u,a,f,l,c,h=this,p=e.style,d={},m=[],g=e.nodeType&&Gt(e);n.queue||(l=v._queueHooks(e,"fx"),l.unqueued==null&&(l.unqueued=0,c=l.empty.fire,l.empty.fire=function(){l.unqueued||c()}),l.unqueued++,h.always(function(){h.always(function(){l.unqueued--,v.queue(e,"fx").length||l.empty.fire()})})),e.nodeType===1&&("height"in t||"width"in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],v.css(e,"display")==="inline"&&v.css(e,"float")==="none"&&(!v.support.inlineBlockNeedsLayout||nn(e.nodeName)==="inline"?p.display="inline-block":p.zoom=1)),n.overflow&&(p.overflow="hidden",v.support.shrinkWrapBlocks||h.done(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(r in t){s=t[r];if(Un.exec(s)){delete t[r],a=a||s==="toggle";if(s===(g?"hide":"show"))continue;m.push(r)}}o=m.length;if(o){u=v._data(e,"fxshow")||v._data(e,"fxshow",{}),"hidden"in u&&(g=u.hidden),a&&(u.hidden=!g),g?v(e).show():h.done(function(){v(e).hide()}),h.done(function(){var t;v.removeData(e,"fxshow",!0);for(t in d)v.style(e,t,d[t])});for(r=0;r<o;r++)i=m[r],f=h.createTween(i,g?u[i]:0),d[i]=u[i]||v.style(e,i),i in u||(u[i]=f.start,g&&(f.end=f.start,f.start=i==="width"||i==="height"?1:0))}}function Yn(e,t,n,r,i){return new Yn.prototype.init(e,t,n,r,i)}function Zn(e,t){var n,r={height:e},i=0;t=t?1:0;for(;i<4;i+=2-t)n=$t[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function tr(e){return v.isWindow(e)?e:e.nodeType===9?e.defaultView||e.parentWindow:!1}var n,r,i=e.document,s=e.location,o=e.navigator,u=e.jQuery,a=e.$,f=Array.prototype.push,l=Array.prototype.slice,c=Array.prototype.indexOf,h=Object.prototype.toString,p=Object.prototype.hasOwnProperty,d=String.prototype.trim,v=function(e,t){return new v.fn.init(e,t,n)},m=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,g=/\S/,y=/\s+/,b=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,w=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,E=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,S=/^[\],:{}\s]*$/,x=/(?:^|:|,)(?:\s*\[)+/g,T=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,N=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,C=/^-ms-/,k=/-([\da-z])/gi,L=function(e,t){return(t+"").toUpperCase()},A=function(){i.addEventListener?(i.removeEventListener("DOMContentLoaded",A,!1),v.ready()):i.readyState==="complete"&&(i.detachEvent("onreadystatechange",A),v.ready())},O={};v.fn=v.prototype={constructor:v,init:function(e,n,r){var s,o,u,a;if(!e)return this;if(e.nodeType)return this.context=this[0]=e,this.length=1,this;if(typeof e=="string"){e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3?s=[null,e,null]:s=w.exec(e);if(s&&(s[1]||!n)){if(s[1])return n=n instanceof v?n[0]:n,a=n&&n.nodeType?n.ownerDocument||n:i,e=v.parseHTML(s[1],a,!0),E.test(s[1])&&v.isPlainObject(n)&&this.attr.call(e,n,!0),v.merge(this,e);o=i.getElementById(s[2]);if(o&&o.parentNode){if(o.id!==s[2])return r.find(e);this.length=1,this[0]=o}return this.context=i,this.selector=e,this}return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e)}return v.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),v.makeArray(e,this))},selector:"",jquery:"1.8.3",length:0,size:function(){return this.length},toArray:function(){return l.call(this)},get:function(e){return e==null?this.toArray():e<0?this[this.length+e]:this[e]},pushStack:function(e,t,n){var r=v.merge(this.constructor(),e);return r.prevObject=this,r.context=this.context,t==="find"?r.selector=this.selector+(this.selector?" ":"")+n:t&&(r.selector=this.selector+"."+t+"("+n+")"),r},each:function(e,t){return v.each(this,e,t)},ready:function(e){return v.ready.promise().done(e),this},eq:function(e){return e=+e,e===-1?this.slice(e):this.slice(e,e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(l.apply(this,arguments),"slice",l.call(arguments).join(","))},map:function(e){return this.pushStack(v.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:f,sort:[].sort,splice:[].splice},v.fn.init.prototype=v.fn,v.extend=v.fn.extend=function(){var e,n,r,i,s,o,u=arguments[0]||{},a=1,f=arguments.length,l=!1;typeof u=="boolean"&&(l=u,u=arguments[1]||{},a=2),typeof u!="object"&&!v.isFunction(u)&&(u={}),f===a&&(u=this,--a);for(;a<f;a++)if((e=arguments[a])!=null)for(n in e){r=u[n],i=e[n];if(u===i)continue;l&&i&&(v.isPlainObject(i)||(s=v.isArray(i)))?(s?(s=!1,o=r&&v.isArray(r)?r:[]):o=r&&v.isPlainObject(r)?r:{},u[n]=v.extend(l,o,i)):i!==t&&(u[n]=i)}return u},v.extend({noConflict:function(t){return e.$===v&&(e.$=a),t&&e.jQuery===v&&(e.jQuery=u),v},isReady:!1,readyWait:1,holdReady:function(e){e?v.readyWait++:v.ready(!0)},ready:function(e){if(e===!0?--v.readyWait:v.isReady)return;if(!i.body)return setTimeout(v.ready,1);v.isReady=!0;if(e!==!0&&--v.readyWait>0)return;r.resolveWith(i,[v]),v.fn.trigger&&v(i).trigger("ready").off("ready")},isFunction:function(e){return v.type(e)==="function"},isArray:Array.isArray||function(e){return v.type(e)==="array"},isWindow:function(e){return e!=null&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return e==null?String(e):O[h.call(e)]||"object"},isPlainObject:function(e){if(!e||v.type(e)!=="object"||e.nodeType||v.isWindow(e))return!1;try{if(e.constructor&&!p.call(e,"constructor")&&!p.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}var r;for(r in e);return r===t||p.call(e,r)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,n){var r;return!e||typeof e!="string"?null:(typeof t=="boolean"&&(n=t,t=0),t=t||i,(r=E.exec(e))?[t.createElement(r[1])]:(r=v.buildFragment([e],t,n?null:[]),v.merge([],(r.cacheable?v.clone(r.fragment):r.fragment).childNodes)))},parseJSON:function(t){if(!t||typeof t!="string")return null;t=v.trim(t);if(e.JSON&&e.JSON.parse)return e.JSON.parse(t);if(S.test(t.replace(T,"@").replace(N,"]").replace(x,"")))return(new Function("return "+t))();v.error("Invalid JSON: "+t)},parseXML:function(n){var r,i;if(!n||typeof n!="string")return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(s){r=t}return(!r||!r.documentElement||r.getElementsByTagName("parsererror").length)&&v.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&g.test(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(C,"ms-").replace(k,L)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,n,r){var i,s=0,o=e.length,u=o===t||v.isFunction(e);if(r){if(u){for(i in e)if(n.apply(e[i],r)===!1)break}else for(;s<o;)if(n.apply(e[s++],r)===!1)break}else if(u){for(i in e)if(n.call(e[i],i,e[i])===!1)break}else for(;s<o;)if(n.call(e[s],s,e[s++])===!1)break;return e},trim:d&&!d.call("﻿ ")?function(e){return e==null?"":d.call(e)}:function(e){return e==null?"":(e+"").replace(b,"")},makeArray:function(e,t){var n,r=t||[];return e!=null&&(n=v.type(e),e.length==null||n==="string"||n==="function"||n==="regexp"||v.isWindow(e)?f.call(r,e):v.merge(r,e)),r},inArray:function(e,t,n){var r;if(t){if(c)return c.call(t,e,n);r=t.length,n=n?n<0?Math.max(0,r+n):n:0;for(;n<r;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=n.length,i=e.length,s=0;if(typeof r=="number")for(;s<r;s++)e[i++]=n[s];else while(n[s]!==t)e[i++]=n[s++];return e.length=i,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length;n=!!n;for(;s<o;s++)r=!!t(e[s],s),n!==r&&i.push(e[s]);return i},map:function(e,n,r){var i,s,o=[],u=0,a=e.length,f=e instanceof v||a!==t&&typeof a=="number"&&(a>0&&e[0]&&e[a-1]||a===0||v.isArray(e));if(f)for(;u<a;u++)i=n(e[u],u,r),i!=null&&(o[o.length]=i);else for(s in e)i=n(e[s],s,r),i!=null&&(o[o.length]=i);return o.concat.apply([],o)},guid:1,proxy:function(e,n){var r,i,s;return typeof n=="string"&&(r=e[n],n=e,e=r),v.isFunction(e)?(i=l.call(arguments,2),s=function(){return e.apply(n,i.concat(l.call(arguments)))},s.guid=e.guid=e.guid||v.guid++,s):t},access:function(e,n,r,i,s,o,u){var a,f=r==null,l=0,c=e.length;if(r&&typeof r=="object"){for(l in r)v.access(e,n,l,r[l],1,o,i);s=1}else if(i!==t){a=u===t&&v.isFunction(i),f&&(a?(a=n,n=function(e,t,n){return a.call(v(e),n)}):(n.call(e,i),n=null));if(n)for(;l<c;l++)n(e[l],r,a?i.call(e[l],l,n(e[l],r)):i,u);s=1}return s?e:f?n.call(e):c?n(e[0],r):o},now:function(){return(new Date).getTime()}}),v.ready.promise=function(t){if(!r){r=v.Deferred();if(i.readyState==="complete")setTimeout(v.ready,1);else if(i.addEventListener)i.addEventListener("DOMContentLoaded",A,!1),e.addEventListener("load",v.ready,!1);else{i.attachEvent("onreadystatechange",A),e.attachEvent("onload",v.ready);var n=!1;try{n=e.frameElement==null&&i.documentElement}catch(s){}n&&n.doScroll&&function o(){if(!v.isReady){try{n.doScroll("left")}catch(e){return setTimeout(o,50)}v.ready()}}()}}return r.promise(t)},v.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(e,t){O["[object "+t+"]"]=t.toLowerCase()}),n=v(i);var M={};v.Callbacks=function(e){e=typeof e=="string"?M[e]||_(e):v.extend({},e);var n,r,i,s,o,u,a=[],f=!e.once&&[],l=function(t){n=e.memory&&t,r=!0,u=s||0,s=0,o=a.length,i=!0;for(;a&&u<o;u++)if(a[u].apply(t[0],t[1])===!1&&e.stopOnFalse){n=!1;break}i=!1,a&&(f?f.length&&l(f.shift()):n?a=[]:c.disable())},c={add:function(){if(a){var t=a.length;(function r(t){v.each(t,function(t,n){var i=v.type(n);i==="function"?(!e.unique||!c.has(n))&&a.push(n):n&&n.length&&i!=="string"&&r(n)})})(arguments),i?o=a.length:n&&(s=t,l(n))}return this},remove:function(){return a&&v.each(arguments,function(e,t){var n;while((n=v.inArray(t,a,n))>-1)a.splice(n,1),i&&(n<=o&&o--,n<=u&&u--)}),this},has:function(e){return v.inArray(e,a)>-1},empty:function(){return a=[],this},disable:function(){return a=f=n=t,this},disabled:function(){return!a},lock:function(){return f=t,n||c.disable(),this},locked:function(){return!f},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],a&&(!r||f)&&(i?f.push(t):l(t)),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!r}};return c},v.extend({Deferred:function(e){var t=[["resolve","done",v.Callbacks("once memory"),"resolved"],["reject","fail",v.Callbacks("once memory"),"rejected"],["notify","progress",v.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return v.Deferred(function(n){v.each(t,function(t,r){var s=r[0],o=e[t];i[r[1]](v.isFunction(o)?function(){var e=o.apply(this,arguments);e&&v.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[s+"With"](this===i?n:this,[e])}:n[s])}),e=null}).promise()},promise:function(e){return e!=null?v.extend(e,r):r}},i={};return r.pipe=r.then,v.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[e^1][2].disable,t[2][2].lock),i[s[0]]=o.fire,i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=l.call(arguments),r=n.length,i=r!==1||e&&v.isFunction(e.promise)?r:0,s=i===1?e:v.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?l.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,a,f;if(r>1){u=new Array(r),a=new Array(r),f=new Array(r);for(;t<r;t++)n[t]&&v.isFunction(n[t].promise)?n[t].promise().done(o(t,f,n)).fail(s.reject).progress(o(t,a,u)):--i}return i||s.resolveWith(f,n),s.promise()}}),v.support=function(){var t,n,r,s,o,u,a,f,l,c,h,p=i.createElement("div");p.setAttribute("className","t"),p.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=p.getElementsByTagName("*"),r=p.getElementsByTagName("a")[0];if(!n||!r||!n.length)return{};s=i.createElement("select"),o=s.appendChild(i.createElement("option")),u=p.getElementsByTagName("input")[0],r.style.cssText="top:1px;float:left;opacity:.5",t={leadingWhitespace:p.firstChild.nodeType===3,tbody:!p.getElementsByTagName("tbody").length,htmlSerialize:!!p.getElementsByTagName("link").length,style:/top/.test(r.getAttribute("style")),hrefNormalized:r.getAttribute("href")==="/a",opacity:/^0.5/.test(r.style.opacity),cssFloat:!!r.style.cssFloat,checkOn:u.value==="on",optSelected:o.selected,getSetAttribute:p.className!=="t",enctype:!!i.createElement("form").enctype,html5Clone:i.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",boxModel:i.compatMode==="CSS1Compat",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},u.checked=!0,t.noCloneChecked=u.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!o.disabled;try{delete p.test}catch(d){t.deleteExpando=!1}!p.addEventListener&&p.attachEvent&&p.fireEvent&&(p.attachEvent("onclick",h=function(){t.noCloneEvent=!1}),p.cloneNode(!0).fireEvent("onclick"),p.detachEvent("onclick",h)),u=i.createElement("input"),u.value="t",u.setAttribute("type","radio"),t.radioValue=u.value==="t",u.setAttribute("checked","checked"),u.setAttribute("name","t"),p.appendChild(u),a=i.createDocumentFragment(),a.appendChild(p.lastChild),t.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked,t.appendChecked=u.checked,a.removeChild(u),a.appendChild(p);if(p.attachEvent)for(l in{submit:!0,change:!0,focusin:!0})f="on"+l,c=f in p,c||(p.setAttribute(f,"return;"),c=typeof p[f]=="function"),t[l+"Bubbles"]=c;return v(function(){var n,r,s,o,u="padding:0;margin:0;border:0;display:block;overflow:hidden;",a=i.getElementsByTagName("body")[0];if(!a)return;n=i.createElement("div"),n.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",a.insertBefore(n,a.firstChild),r=i.createElement("div"),n.appendChild(r),r.innerHTML="<table><tr><td></td><td>t</td></tr></table>",s=r.getElementsByTagName("td"),s[0].style.cssText="padding:0;margin:0;border:0;display:none",c=s[0].offsetHeight===0,s[0].style.display="",s[1].style.display="none",t.reliableHiddenOffsets=c&&s[0].offsetHeight===0,r.innerHTML="",r.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",t.boxSizing=r.offsetWidth===4,t.doesNotIncludeMarginInBodyOffset=a.offsetTop!==1,e.getComputedStyle&&(t.pixelPosition=(e.getComputedStyle(r,null)||{}).top!=="1%",t.boxSizingReliable=(e.getComputedStyle(r,null)||{width:"4px"}).width==="4px",o=i.createElement("div"),o.style.cssText=r.style.cssText=u,o.style.marginRight=o.style.width="0",r.style.width="1px",r.appendChild(o),t.reliableMarginRight=!parseFloat((e.getComputedStyle(o,null)||{}).marginRight)),typeof r.style.zoom!="undefined"&&(r.innerHTML="",r.style.cssText=u+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=r.offsetWidth===3,r.style.display="block",r.style.overflow="visible",r.innerHTML="<div></div>",r.firstChild.style.width="5px",t.shrinkWrapBlocks=r.offsetWidth!==3,n.style.zoom=1),a.removeChild(n),n=r=s=o=null}),a.removeChild(p),n=r=s=o=u=a=p=null,t}();var D=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,P=/([A-Z])/g;v.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(v.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?v.cache[e[v.expando]]:e[v.expando],!!e&&!B(e)},data:function(e,n,r,i){if(!v.acceptData(e))return;var s,o,u=v.expando,a=typeof n=="string",f=e.nodeType,l=f?v.cache:e,c=f?e[u]:e[u]&&u;if((!c||!l[c]||!i&&!l[c].data)&&a&&r===t)return;c||(f?e[u]=c=v.deletedIds.pop()||v.guid++:c=u),l[c]||(l[c]={},f||(l[c].toJSON=v.noop));if(typeof n=="object"||typeof n=="function")i?l[c]=v.extend(l[c],n):l[c].data=v.extend(l[c].data,n);return s=l[c],i||(s.data||(s.data={}),s=s.data),r!==t&&(s[v.camelCase(n)]=r),a?(o=s[n],o==null&&(o=s[v.camelCase(n)])):o=s,o},removeData:function(e,t,n){if(!v.acceptData(e))return;var r,i,s,o=e.nodeType,u=o?v.cache:e,a=o?e[v.expando]:v.expando;if(!u[a])return;if(t){r=n?u[a]:u[a].data;if(r){v.isArray(t)||(t in r?t=[t]:(t=v.camelCase(t),t in r?t=[t]:t=t.split(" ")));for(i=0,s=t.length;i<s;i++)delete r[t[i]];if(!(n?B:v.isEmptyObject)(r))return}}if(!n){delete u[a].data;if(!B(u[a]))return}o?v.cleanData([e],!0):v.support.deleteExpando||u!=u.window?delete u[a]:u[a]=null},_data:function(e,t,n){return v.data(e,t,n,!0)},acceptData:function(e){var t=e.nodeName&&v.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),v.fn.extend({data:function(e,n){var r,i,s,o,u,a=this[0],f=0,l=null;if(e===t){if(this.length){l=v.data(a);if(a.nodeType===1&&!v._data(a,"parsedAttrs")){s=a.attributes;for(u=s.length;f<u;f++)o=s[f].name,o.indexOf("data-")||(o=v.camelCase(o.substring(5)),H(a,o,l[o]));v._data(a,"parsedAttrs",!0)}}return l}return typeof e=="object"?this.each(function(){v.data(this,e)}):(r=e.split(".",2),r[1]=r[1]?"."+r[1]:"",i=r[1]+"!",v.access(this,function(n){if(n===t)return l=this.triggerHandler("getData"+i,[r[0]]),l===t&&a&&(l=v.data(a,e),l=H(a,e,l)),l===t&&r[1]?this.data(r[0]):l;r[1]=n,this.each(function(){var t=v(this);t.triggerHandler("setData"+i,r),v.data(this,e,n),t.triggerHandler("changeData"+i,r)})},null,n,arguments.length>1,null,!1))},removeData:function(e){return this.each(function(){v.removeData(this,e)})}}),v.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=v._data(e,t),n&&(!r||v.isArray(n)?r=v._data(e,t,v.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=v.queue(e,t),r=n.length,i=n.shift(),s=v._queueHooks(e,t),o=function(){v.dequeue(e,t)};i==="inprogress"&&(i=n.shift(),r--),i&&(t==="fx"&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return v._data(e,n)||v._data(e,n,{empty:v.Callbacks("once memory").add(function(){v.removeData(e,t+"queue",!0),v.removeData(e,n,!0)})})}}),v.fn.extend({queue:function(e,n){var r=2;return typeof e!="string"&&(n=e,e="fx",r--),arguments.length<r?v.queue(this[0],e):n===t?this:this.each(function(){var t=v.queue(this,e,n);v._queueHooks(this,e),e==="fx"&&t[0]!=="inprogress"&&v.dequeue(this,e)})},dequeue:function(e){return this.each(function(){v.dequeue(this,e)})},delay:function(e,t){return e=v.fx?v.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,s=v.Deferred(),o=this,u=this.length,a=function(){--i||s.resolveWith(o,[o])};typeof e!="string"&&(n=e,e=t),e=e||"fx";while(u--)r=v._data(o[u],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(a));return a(),s.promise(n)}});var j,F,I,q=/[\t\r\n]/g,R=/\r/g,U=/^(?:button|input)$/i,z=/^(?:button|input|object|select|textarea)$/i,W=/^a(?:rea|)$/i,X=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,V=v.support.getSetAttribute;v.fn.extend({attr:function(e,t){return v.access(this,v.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){v.removeAttr(this,e)})},prop:function(e,t){return v.access(this,v.prop,e,t,arguments.length>1)},removeProp:function(e){return e=v.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,s,o,u;if(v.isFunction(e))return this.each(function(t){v(this).addClass(e.call(this,t,this.className))});if(e&&typeof e=="string"){t=e.split(y);for(n=0,r=this.length;n<r;n++){i=this[n];if(i.nodeType===1)if(!i.className&&t.length===1)i.className=e;else{s=" "+i.className+" ";for(o=0,u=t.length;o<u;o++)s.indexOf(" "+t[o]+" ")<0&&(s+=t[o]+" ");i.className=v.trim(s)}}}return this},removeClass:function(e){var n,r,i,s,o,u,a;if(v.isFunction(e))return this.each(function(t){v(this).removeClass(e.call(this,t,this.className))});if(e&&typeof e=="string"||e===t){n=(e||"").split(y);for(u=0,a=this.length;u<a;u++){i=this[u];if(i.nodeType===1&&i.className){r=(" "+i.className+" ").replace(q," ");for(s=0,o=n.length;s<o;s++)while(r.indexOf(" "+n[s]+" ")>=0)r=r.replace(" "+n[s]+" "," ");i.className=e?v.trim(r):""}}}return this},toggleClass:function(e,t){var n=typeof e,r=typeof t=="boolean";return v.isFunction(e)?this.each(function(n){v(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if(n==="string"){var i,s=0,o=v(this),u=t,a=e.split(y);while(i=a[s++])u=r?u:!o.hasClass(i),o[u?"addClass":"removeClass"](i)}else if(n==="undefined"||n==="boolean")this.className&&v._data(this,"__className__",this.className),this.className=this.className||e===!1?"":v._data(this,"__className__")||""})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;n<r;n++)if(this[n].nodeType===1&&(" "+this[n].className+" ").replace(q," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,r,i,s=this[0];if(!arguments.length){if(s)return n=v.valHooks[s.type]||v.valHooks[s.nodeName.toLowerCase()],n&&"get"in n&&(r=n.get(s,"value"))!==t?r:(r=s.value,typeof r=="string"?r.replace(R,""):r==null?"":r);return}return i=v.isFunction(e),this.each(function(r){var s,o=v(this);if(this.nodeType!==1)return;i?s=e.call(this,r,o.val()):s=e,s==null?s="":typeof s=="number"?s+="":v.isArray(s)&&(s=v.map(s,function(e){return e==null?"":e+""})),n=v.valHooks[this.type]||v.valHooks[this.nodeName.toLowerCase()];if(!n||!("set"in n)||n.set(this,s,"value")===t)this.value=s})}}),v.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,s=e.type==="select-one"||i<0,o=s?null:[],u=s?i+1:r.length,a=i<0?u:s?i:0;for(;a<u;a++){n=r[a];if((n.selected||a===i)&&(v.support.optDisabled?!n.disabled:n.getAttribute("disabled")===null)&&(!n.parentNode.disabled||!v.nodeName(n.parentNode,"optgroup"))){t=v(n).val();if(s)return t;o.push(t)}}return o},set:function(e,t){var n=v.makeArray(t);return v(e).find("option").each(function(){this.selected=v.inArray(v(this).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},attrFn:{},attr:function(e,n,r,i){var s,o,u,a=e.nodeType;if(!e||a===3||a===8||a===2)return;if(i&&v.isFunction(v.fn[n]))return v(e)[n](r);if(typeof e.getAttribute=="undefined")return v.prop(e,n,r);u=a!==1||!v.isXMLDoc(e),u&&(n=n.toLowerCase(),o=v.attrHooks[n]||(X.test(n)?F:j));if(r!==t){if(r===null){v.removeAttr(e,n);return}return o&&"set"in o&&u&&(s=o.set(e,r,n))!==t?s:(e.setAttribute(n,r+""),r)}return o&&"get"in o&&u&&(s=o.get(e,n))!==null?s:(s=e.getAttribute(n),s===null?t:s)},removeAttr:function(e,t){var n,r,i,s,o=0;if(t&&e.nodeType===1){r=t.split(y);for(;o<r.length;o++)i=r[o],i&&(n=v.propFix[i]||i,s=X.test(i),s||v.attr(e,i,""),e.removeAttribute(V?i:n),s&&n in e&&(e[n]=!1))}},attrHooks:{type:{set:function(e,t){if(U.test(e.nodeName)&&e.parentNode)v.error("type property can't be changed");else if(!v.support.radioValue&&t==="radio"&&v.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}},value:{get:function(e,t){return j&&v.nodeName(e,"button")?j.get(e,t):t in e?e.value:null},set:function(e,t,n){if(j&&v.nodeName(e,"button"))return j.set(e,t,n);e.value=t}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,n,r){var i,s,o,u=e.nodeType;if(!e||u===3||u===8||u===2)return;return o=u!==1||!v.isXMLDoc(e),o&&(n=v.propFix[n]||n,s=v.propHooks[n]),r!==t?s&&"set"in s&&(i=s.set(e,r,n))!==t?i:e[n]=r:s&&"get"in s&&(i=s.get(e,n))!==null?i:e[n]},propHooks:{tabIndex:{get:function(e){var n=e.getAttributeNode("tabindex");return n&&n.specified?parseInt(n.value,10):z.test(e.nodeName)||W.test(e.nodeName)&&e.href?0:t}}}}),F={get:function(e,n){var r,i=v.prop(e,n);return i===!0||typeof i!="boolean"&&(r=e.getAttributeNode(n))&&r.nodeValue!==!1?n.toLowerCase():t},set:function(e,t,n){var r;return t===!1?v.removeAttr(e,n):(r=v.propFix[n]||n,r in e&&(e[r]=!0),e.setAttribute(n,n.toLowerCase())),n}},V||(I={name:!0,id:!0,coords:!0},j=v.valHooks.button={get:function(e,n){var r;return r=e.getAttributeNode(n),r&&(I[n]?r.value!=="":r.specified)?r.value:t},set:function(e,t,n){var r=e.getAttributeNode(n);return r||(r=i.createAttribute(n),e.setAttributeNode(r)),r.value=t+""}},v.each(["width","height"],function(e,t){v.attrHooks[t]=v.extend(v.attrHooks[t],{set:function(e,n){if(n==="")return e.setAttribute(t,"auto"),n}})}),v.attrHooks.contenteditable={get:j.get,set:function(e,t,n){t===""&&(t="false"),j.set(e,t,n)}}),v.support.hrefNormalized||v.each(["href","src","width","height"],function(e,n){v.attrHooks[n]=v.extend(v.attrHooks[n],{get:function(e){var r=e.getAttribute(n,2);return r===null?t:r}})}),v.support.style||(v.attrHooks.style={get:function(e){return e.style.cssText.toLowerCase()||t},set:function(e,t){return e.style.cssText=t+""}}),v.support.optSelected||(v.propHooks.selected=v.extend(v.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),v.support.enctype||(v.propFix.enctype="encoding"),v.support.checkOn||v.each(["radio","checkbox"],function(){v.valHooks[this]={get:function(e){return e.getAttribute("value")===null?"on":e.value}}}),v.each(["radio","checkbox"],function(){v.valHooks[this]=v.extend(v.valHooks[this],{set:function(e,t){if(v.isArray(t))return e.checked=v.inArray(v(e).val(),t)>=0}})});var $=/^(?:textarea|input|select)$/i,J=/^([^\.]*|)(?:\.(.+)|)$/,K=/(?:^|\s)hover(\.\S+|)\b/,Q=/^key/,G=/^(?:mouse|contextmenu)|click/,Y=/^(?:focusinfocus|focusoutblur)$/,Z=function(e){return v.event.special.hover?e:e.replace(K,"mouseenter$1 mouseleave$1")};v.event={add:function(e,n,r,i,s){var o,u,a,f,l,c,h,p,d,m,g;if(e.nodeType===3||e.nodeType===8||!n||!r||!(o=v._data(e)))return;r.handler&&(d=r,r=d.handler,s=d.selector),r.guid||(r.guid=v.guid++),a=o.events,a||(o.events=a={}),u=o.handle,u||(o.handle=u=function(e){return typeof v=="undefined"||!!e&&v.event.triggered===e.type?t:v.event.dispatch.apply(u.elem,arguments)},u.elem=e),n=v.trim(Z(n)).split(" ");for(f=0;f<n.length;f++){l=J.exec(n[f])||[],c=l[1],h=(l[2]||"").split(".").sort(),g=v.event.special[c]||{},c=(s?g.delegateType:g.bindType)||c,g=v.event.special[c]||{},p=v.extend({type:c,origType:l[1],data:i,handler:r,guid:r.guid,selector:s,needsContext:s&&v.expr.match.needsContext.test(s),namespace:h.join(".")},d),m=a[c];if(!m){m=a[c]=[],m.delegateCount=0;if(!g.setup||g.setup.call(e,i,h,u)===!1)e.addEventListener?e.addEventListener(c,u,!1):e.attachEvent&&e.attachEvent("on"+c,u)}g.add&&(g.add.call(e,p),p.handler.guid||(p.handler.guid=r.guid)),s?m.splice(m.delegateCount++,0,p):m.push(p),v.event.global[c]=!0}e=null},global:{},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,m,g=v.hasData(e)&&v._data(e);if(!g||!(h=g.events))return;t=v.trim(Z(t||"")).split(" ");for(s=0;s<t.length;s++){o=J.exec(t[s])||[],u=a=o[1],f=o[2];if(!u){for(u in h)v.event.remove(e,u+t[s],n,r,!0);continue}p=v.event.special[u]||{},u=(r?p.delegateType:p.bindType)||u,d=h[u]||[],l=d.length,f=f?new RegExp("(^|\\.)"+f.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null;for(c=0;c<d.length;c++)m=d[c],(i||a===m.origType)&&(!n||n.guid===m.guid)&&(!f||f.test(m.namespace))&&(!r||r===m.selector||r==="**"&&m.selector)&&(d.splice(c--,1),m.selector&&d.delegateCount--,p.remove&&p.remove.call(e,m));d.length===0&&l!==d.length&&((!p.teardown||p.teardown.call(e,f,g.handle)===!1)&&v.removeEvent(e,u,g.handle),delete h[u])}v.isEmptyObject(h)&&(delete g.handle,v.removeData(e,"events",!0))},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(n,r,s,o){if(!s||s.nodeType!==3&&s.nodeType!==8){var u,a,f,l,c,h,p,d,m,g,y=n.type||n,b=[];if(Y.test(y+v.event.triggered))return;y.indexOf("!")>=0&&(y=y.slice(0,-1),a=!0),y.indexOf(".")>=0&&(b=y.split("."),y=b.shift(),b.sort());if((!s||v.event.customEvent[y])&&!v.event.global[y])return;n=typeof n=="object"?n[v.expando]?n:new v.Event(y,n):new v.Event(y),n.type=y,n.isTrigger=!0,n.exclusive=a,n.namespace=b.join("."),n.namespace_re=n.namespace?new RegExp("(^|\\.)"+b.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,h=y.indexOf(":")<0?"on"+y:"";if(!s){u=v.cache;for(f in u)u[f].events&&u[f].events[y]&&v.event.trigger(n,r,u[f].handle.elem,!0);return}n.result=t,n.target||(n.target=s),r=r!=null?v.makeArray(r):[],r.unshift(n),p=v.event.special[y]||{};if(p.trigger&&p.trigger.apply(s,r)===!1)return;m=[[s,p.bindType||y]];if(!o&&!p.noBubble&&!v.isWindow(s)){g=p.delegateType||y,l=Y.test(g+y)?s:s.parentNode;for(c=s;l;l=l.parentNode)m.push([l,g]),c=l;c===(s.ownerDocument||i)&&m.push([c.defaultView||c.parentWindow||e,g])}for(f=0;f<m.length&&!n.isPropagationStopped();f++)l=m[f][0],n.type=m[f][1],d=(v._data(l,"events")||{})[n.type]&&v._data(l,"handle"),d&&d.apply(l,r),d=h&&l[h],d&&v.acceptData(l)&&d.apply&&d.apply(l,r)===!1&&n.preventDefault();return n.type=y,!o&&!n.isDefaultPrevented()&&(!p._default||p._default.apply(s.ownerDocument,r)===!1)&&(y!=="click"||!v.nodeName(s,"a"))&&v.acceptData(s)&&h&&s[y]&&(y!=="focus"&&y!=="blur"||n.target.offsetWidth!==0)&&!v.isWindow(s)&&(c=s[h],c&&(s[h]=null),v.event.triggered=y,s[y](),v.event.triggered=t,c&&(s[h]=c)),n.result}return},dispatch:function(n){n=v.event.fix(n||e.event);var r,i,s,o,u,a,f,c,h,p,d=(v._data(this,"events")||{})[n.type]||[],m=d.delegateCount,g=l.call(arguments),y=!n.exclusive&&!n.namespace,b=v.event.special[n.type]||{},w=[];g[0]=n,n.delegateTarget=this;if(b.preDispatch&&b.preDispatch.call(this,n)===!1)return;if(m&&(!n.button||n.type!=="click"))for(s=n.target;s!=this;s=s.parentNode||this)if(s.disabled!==!0||n.type!=="click"){u={},f=[];for(r=0;r<m;r++)c=d[r],h=c.selector,u[h]===t&&(u[h]=c.needsContext?v(h,this).index(s)>=0:v.find(h,this,null,[s]).length),u[h]&&f.push(c);f.length&&w.push({elem:s,matches:f})}d.length>m&&w.push({elem:this,matches:d.slice(m)});for(r=0;r<w.length&&!n.isPropagationStopped();r++){a=w[r],n.currentTarget=a.elem;for(i=0;i<a.matches.length&&!n.isImmediatePropagationStopped();i++){c=a.matches[i];if(y||!n.namespace&&!c.namespace||n.namespace_re&&n.namespace_re.test(c.namespace))n.data=c.data,n.handleObj=c,o=((v.event.special[c.origType]||{}).handle||c.handler).apply(a.elem,g),o!==t&&(n.result=o,o===!1&&(n.preventDefault(),n.stopPropagation()))}}return b.postDispatch&&b.postDispatch.call(this,n),n.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return e.which==null&&(e.which=t.charCode!=null?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,s,o,u=n.button,a=n.fromElement;return e.pageX==null&&n.clientX!=null&&(r=e.target.ownerDocument||i,s=r.documentElement,o=r.body,e.pageX=n.clientX+(s&&s.scrollLeft||o&&o.scrollLeft||0)-(s&&s.clientLeft||o&&o.clientLeft||0),e.pageY=n.clientY+(s&&s.scrollTop||o&&o.scrollTop||0)-(s&&s.clientTop||o&&o.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?n.toElement:a),!e.which&&u!==t&&(e.which=u&1?1:u&2?3:u&4?2:0),e}},fix:function(e){if(e[v.expando])return e;var t,n,r=e,s=v.event.fixHooks[e.type]||{},o=s.props?this.props.concat(s.props):this.props;e=v.Event(r);for(t=o.length;t;)n=o[--t],e[n]=r[n];return e.target||(e.target=r.srcElement||i),e.target.nodeType===3&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,s.filter?s.filter(e,r):e},special:{load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(e,t,n){v.isWindow(this)&&(this.onbeforeunload=n)},teardown:function(e,t){this.onbeforeunload===t&&(this.onbeforeunload=null)}}},simulate:function(e,t,n,r){var i=v.extend(new v.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?v.event.trigger(i,null,t):v.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},v.event.handle=v.event.dispatch,v.removeEvent=i.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]=="undefined"&&(e[r]=null),e.detachEvent(r,n))},v.Event=function(e,t){if(!(this instanceof v.Event))return new v.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?tt:et):this.type=e,t&&v.extend(this,t),this.timeStamp=e&&e.timeStamp||v.now(),this[v.expando]=!0},v.Event.prototype={preventDefault:function(){this.isDefaultPrevented=tt;var e=this.originalEvent;if(!e)return;e.preventDefault?e.preventDefault():e.returnValue=!1},stopPropagation:function(){this.isPropagationStopped=tt;var e=this.originalEvent;if(!e)return;e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=tt,this.stopPropagation()},isDefaultPrevented:et,isPropagationStopped:et,isImmediatePropagationStopped:et},v.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){v.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj,o=s.selector;if(!i||i!==r&&!v.contains(r,i))e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t;return n}}}),v.support.submitBubbles||(v.event.special.submit={setup:function(){if(v.nodeName(this,"form"))return!1;v.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=v.nodeName(n,"input")||v.nodeName(n,"button")?n.form:t;r&&!v._data(r,"_submit_attached")&&(v.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),v._data(r,"_submit_attached",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&v.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){if(v.nodeName(this,"form"))return!1;v.event.remove(this,"._submit")}}),v.support.changeBubbles||(v.event.special.change={setup:function(){if($.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")v.event.add(this,"propertychange._change",function(e){e.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),v.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),v.event.simulate("change",this,e,!0)});return!1}v.event.add(this,"beforeactivate._change",function(e){var t=e.target;$.test(t.nodeName)&&!v._data(t,"_change_attached")&&(v.event.add(t,"change._change",function(e){this.parentNode&&!e.isSimulated&&!e.isTrigger&&v.event.simulate("change",this.parentNode,e,!0)}),v._data(t,"_change_attached",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||t.type!=="radio"&&t.type!=="checkbox")return e.handleObj.handler.apply(this,arguments)},teardown:function(){return v.event.remove(this,"._change"),!$.test(this.nodeName)}}),v.support.focusinBubbles||v.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){v.event.simulate(t,e.target,v.event.fix(e),!0)};v.event.special[t]={setup:function(){n++===0&&i.addEventListener(e,r,!0)},teardown:function(){--n===0&&i.removeEventListener(e,r,!0)}}}),v.fn.extend({on:function(e,n,r,i,s){var o,u;if(typeof e=="object"){typeof n!="string"&&(r=r||n,n=t);for(u in e)this.on(u,n,r,e[u],s);return this}r==null&&i==null?(i=n,r=n=t):i==null&&(typeof n=="string"?(i=r,r=t):(i=r,r=n,n=t));if(i===!1)i=et;else if(!i)return this;return s===1&&(o=i,i=function(e){return v().off(e),o.apply(this,arguments)},i.guid=o.guid||(o.guid=v.guid++)),this.each(function(){v.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,s;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,v(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if(typeof e=="object"){for(s in e)this.off(s,n,e[s]);return this}if(n===!1||typeof n=="function")r=n,n=t;return r===!1&&(r=et),this.each(function(){v.event.remove(this,e,r,n)})},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},live:function(e,t,n){return v(this.context).on(e,this.selector,t,n),this},die:function(e,t){return v(this.context).off(e,this.selector||"**",t),this},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return arguments.length===1?this.off(e,"**"):this.off(t,e||"**",n)},trigger:function(e,t){return this.each(function(){v.event.trigger(e,t,this)})},triggerHandler:function(e,t){if(this[0])return v.event.trigger(e,t,this[0],!0)},toggle:function(e){var t=arguments,n=e.guid||v.guid++,r=0,i=function(n){var i=(v._data(this,"lastToggle"+e.guid)||0)%r;return v._data(this,"lastToggle"+e.guid,i+1),n.preventDefault(),t[i].apply(this,arguments)||!1};i.guid=n;while(r<t.length)t[r++].guid=n;return this.click(i)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),v.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){v.fn[t]=function(e,n){return n==null&&(n=e,e=null),arguments.length>0?this.on(t,null,e,n):this.trigger(t)},Q.test(t)&&(v.event.fixHooks[t]=v.event.keyHooks),G.test(t)&&(v.event.fixHooks[t]=v.event.mouseHooks)}),function(e,t){function nt(e,t,n,r){n=n||[],t=t||g;var i,s,a,f,l=t.nodeType;if(!e||typeof e!="string")return n;if(l!==1&&l!==9)return[];a=o(t);if(!a&&!r)if(i=R.exec(e))if(f=i[1]){if(l===9){s=t.getElementById(f);if(!s||!s.parentNode)return n;if(s.id===f)return n.push(s),n}else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(f))&&u(t,s)&&s.id===f)return n.push(s),n}else{if(i[2])return S.apply(n,x.call(t.getElementsByTagName(e),0)),n;if((f=i[3])&&Z&&t.getElementsByClassName)return S.apply(n,x.call(t.getElementsByClassName(f),0)),n}return vt(e.replace(j,"$1"),t,n,r,a)}function rt(e){return function(t){var n=t.nodeName.toLowerCase();return n==="input"&&t.type===e}}function it(e){return function(t){var n=t.nodeName.toLowerCase();return(n==="input"||n==="button")&&t.type===e}}function st(e){return N(function(t){return t=+t,N(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function ot(e,t,n){if(e===t)return n;var r=e.nextSibling;while(r){if(r===t)return-1;r=r.nextSibling}return 1}function ut(e,t){var n,r,s,o,u,a,f,l=L[d][e+" "];if(l)return t?0:l.slice(0);u=e,a=[],f=i.preFilter;while(u){if(!n||(r=F.exec(u)))r&&(u=u.slice(r[0].length)||u),a.push(s=[]);n=!1;if(r=I.exec(u))s.push(n=new m(r.shift())),u=u.slice(n.length),n.type=r[0].replace(j," ");for(o in i.filter)(r=J[o].exec(u))&&(!f[o]||(r=f[o](r)))&&(s.push(n=new m(r.shift())),u=u.slice(n.length),n.type=o,n.matches=r);if(!n)break}return t?u.length:u?nt.error(e):L(e,a).slice(0)}function at(e,t,r){var i=t.dir,s=r&&t.dir==="parentNode",o=w++;return t.first?function(t,n,r){while(t=t[i])if(s||t.nodeType===1)return e(t,n,r)}:function(t,r,u){if(!u){var a,f=b+" "+o+" ",l=f+n;while(t=t[i])if(s||t.nodeType===1){if((a=t[d])===l)return t.sizset;if(typeof a=="string"&&a.indexOf(f)===0){if(t.sizset)return t}else{t[d]=l;if(e(t,r,u))return t.sizset=!0,t;t.sizset=!1}}}else while(t=t[i])if(s||t.nodeType===1)if(e(t,r,u))return t}}function ft(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function lt(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=t!=null;for(;u<a;u++)if(s=e[u])if(!n||n(s,r,i))o.push(s),f&&t.push(u);return o}function ct(e,t,n,r,i,s){return r&&!r[d]&&(r=ct(r)),i&&!i[d]&&(i=ct(i,s)),N(function(s,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=s||dt(t||"*",u.nodeType?[u]:u,[]),m=e&&(s||!t)?lt(v,h,e,u,a):v,g=n?i||(s?e:d||r)?[]:o:m;n&&n(m,g,u,a);if(r){f=lt(g,p),r(f,[],u,a),l=f.length;while(l--)if(c=f[l])g[p[l]]=!(m[p[l]]=c)}if(s){if(i||e){if(i){f=[],l=g.length;while(l--)(c=g[l])&&f.push(m[l]=c);i(null,g=[],f,a)}l=g.length;while(l--)(c=g[l])&&(f=i?T.call(s,c):h[l])>-1&&(s[f]=!(o[f]=c))}}else g=lt(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):S.apply(o,g)})}function ht(e){var t,n,r,s=e.length,o=i.relative[e[0].type],u=o||i.relative[" "],a=o?1:0,f=at(function(e){return e===t},u,!0),l=at(function(e){return T.call(t,e)>-1},u,!0),h=[function(e,n,r){return!o&&(r||n!==c)||((t=n).nodeType?f(e,n,r):l(e,n,r))}];for(;a<s;a++)if(n=i.relative[e[a].type])h=[at(ft(h),n)];else{n=i.filter[e[a].type].apply(null,e[a].matches);if(n[d]){r=++a;for(;r<s;r++)if(i.relative[e[r].type])break;return ct(a>1&&ft(h),a>1&&e.slice(0,a-1).join("").replace(j,"$1"),n,a<r&&ht(e.slice(a,r)),r<s&&ht(e=e.slice(r)),r<s&&e.join(""))}h.push(n)}return ft(h)}function pt(e,t){var r=t.length>0,s=e.length>0,o=function(u,a,f,l,h){var p,d,v,m=[],y=0,w="0",x=u&&[],T=h!=null,N=c,C=u||s&&i.find.TAG("*",h&&a.parentNode||a),k=b+=N==null?1:Math.E;T&&(c=a!==g&&a,n=o.el);for(;(p=C[w])!=null;w++){if(s&&p){for(d=0;v=e[d];d++)if(v(p,a,f)){l.push(p);break}T&&(b=k,n=++o.el)}r&&((p=!v&&p)&&y--,u&&x.push(p))}y+=w;if(r&&w!==y){for(d=0;v=t[d];d++)v(x,m,a,f);if(u){if(y>0)while(w--)!x[w]&&!m[w]&&(m[w]=E.call(l));m=lt(m)}S.apply(l,m),T&&!u&&m.length>0&&y+t.length>1&&nt.uniqueSort(l)}return T&&(b=k,c=N),x};return o.el=0,r?N(o):o}function dt(e,t,n){var r=0,i=t.length;for(;r<i;r++)nt(e,t[r],n);return n}function vt(e,t,n,r,s){var o,u,f,l,c,h=ut(e),p=h.length;if(!r&&h.length===1){u=h[0]=h[0].slice(0);if(u.length>2&&(f=u[0]).type==="ID"&&t.nodeType===9&&!s&&i.relative[u[1].type]){t=i.find.ID(f.matches[0].replace($,""),t,s)[0];if(!t)return n;e=e.slice(u.shift().length)}for(o=J.POS.test(e)?-1:u.length-1;o>=0;o--){f=u[o];if(i.relative[l=f.type])break;if(c=i.find[l])if(r=c(f.matches[0].replace($,""),z.test(u[0].type)&&t.parentNode||t,s)){u.splice(o,1),e=r.length&&u.join("");if(!e)return S.apply(n,x.call(r,0)),n;break}}}return a(e,h)(r,t,s,n,z.test(e)),n}function mt(){}var n,r,i,s,o,u,a,f,l,c,h=!0,p="undefined",d=("sizcache"+Math.random()).replace(".",""),m=String,g=e.document,y=g.documentElement,b=0,w=0,E=[].pop,S=[].push,x=[].slice,T=[].indexOf||function(e){var t=0,n=this.length;for(;t<n;t++)if(this[t]===e)return t;return-1},N=function(e,t){return e[d]=t==null||t,e},C=function(){var e={},t=[];return N(function(n,r){return t.push(n)>i.cacheLength&&delete e[t.shift()],e[n+" "]=r},e)},k=C(),L=C(),A=C(),O="[\\x20\\t\\r\\n\\f]",M="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",_=M.replace("w","w#"),D="([*^$|!~]?=)",P="\\["+O+"*("+M+")"+O+"*(?:"+D+O+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+_+")|)|)"+O+"*\\]",H=":("+M+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+P+")|[^:]|\\\\.)*|.*))\\)|)",B=":(even|odd|eq|gt|lt|nth|first|last)(?:\\("+O+"*((?:-\\d)?\\d*)"+O+"*\\)|)(?=[^-]|$)",j=new RegExp("^"+O+"+|((?:^|[^\\\\])(?:\\\\.)*)"+O+"+$","g"),F=new RegExp("^"+O+"*,"+O+"*"),I=new RegExp("^"+O+"*([\\x20\\t\\r\\n\\f>+~])"+O+"*"),q=new RegExp(H),R=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,U=/^:not/,z=/[\x20\t\r\n\f]*[+~]/,W=/:not\($/,X=/h\d/i,V=/input|select|textarea|button/i,$=/\\(?!\\)/g,J={ID:new RegExp("^#("+M+")"),CLASS:new RegExp("^\\.("+M+")"),NAME:new RegExp("^\\[name=['\"]?("+M+")['\"]?\\]"),TAG:new RegExp("^("+M.replace("w","w*")+")"),ATTR:new RegExp("^"+P),PSEUDO:new RegExp("^"+H),POS:new RegExp(B,"i"),CHILD:new RegExp("^:(only|nth|first|last)-child(?:\\("+O+"*(even|odd|(([+-]|)(\\d*)n|)"+O+"*(?:([+-]|)"+O+"*(\\d+)|))"+O+"*\\)|)","i"),needsContext:new RegExp("^"+O+"*[>+~]|"+B,"i")},K=function(e){var t=g.createElement("div");try{return e(t)}catch(n){return!1}finally{t=null}},Q=K(function(e){return e.appendChild(g.createComment("")),!e.getElementsByTagName("*").length}),G=K(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==p&&e.firstChild.getAttribute("href")==="#"}),Y=K(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return t!=="boolean"&&t!=="string"}),Z=K(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",!e.getElementsByClassName||!e.getElementsByClassName("e").length?!1:(e.lastChild.className="e",e.getElementsByClassName("e").length===2)}),et=K(function(e){e.id=d+0,e.innerHTML="<a name='"+d+"'></a><div name='"+d+"'></div>",y.insertBefore(e,y.firstChild);var t=g.getElementsByName&&g.getElementsByName(d).length===2+g.getElementsByName(d+0).length;return r=!g.getElementById(d),y.removeChild(e),t});try{x.call(y.childNodes,0)[0].nodeType}catch(tt){x=function(e){var t,n=[];for(;t=this[e];e++)n.push(t);return n}}nt.matches=function(e,t){return nt(e,null,null,t)},nt.matchesSelector=function(e,t){return nt(t,null,null,[e]).length>0},s=nt.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(i===1||i===9||i===11){if(typeof e.textContent=="string")return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=s(e)}else if(i===3||i===4)return e.nodeValue}else for(;t=e[r];r++)n+=s(t);return n},o=nt.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?t.nodeName!=="HTML":!1},u=nt.contains=y.contains?function(e,t){var n=e.nodeType===9?e.documentElement:e,r=t&&t.parentNode;return e===r||!!(r&&r.nodeType===1&&n.contains&&n.contains(r))}:y.compareDocumentPosition?function(e,t){return t&&!!(e.compareDocumentPosition(t)&16)}:function(e,t){while(t=t.parentNode)if(t===e)return!0;return!1},nt.attr=function(e,t){var n,r=o(e);return r||(t=t.toLowerCase()),(n=i.attrHandle[t])?n(e):r||Y?e.getAttribute(t):(n=e.getAttributeNode(t),n?typeof e[t]=="boolean"?e[t]?t:null:n.specified?n.value:null:null)},i=nt.selectors={cacheLength:50,createPseudo:N,match:J,attrHandle:G?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},find:{ID:r?function(e,t,n){if(typeof t.getElementById!==p&&!n){var r=t.getElementById(e);return r&&r.parentNode?[r]:[]}}:function(e,n,r){if(typeof n.getElementById!==p&&!r){var i=n.getElementById(e);return i?i.id===e||typeof i.getAttributeNode!==p&&i.getAttributeNode("id").value===e?[i]:t:[]}},TAG:Q?function(e,t){if(typeof t.getElementsByTagName!==p)return t.getElementsByTagName(e)}:function(e,t){var n=t.getElementsByTagName(e);if(e==="*"){var r,i=[],s=0;for(;r=n[s];s++)r.nodeType===1&&i.push(r);return i}return n},NAME:et&&function(e,t){if(typeof t.getElementsByName!==p)return t.getElementsByName(name)},CLASS:Z&&function(e,t,n){if(typeof t.getElementsByClassName!==p&&!n)return t.getElementsByClassName(e)}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace($,""),e[3]=(e[4]||e[5]||"").replace($,""),e[2]==="~="&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),e[1]==="nth"?(e[2]||nt.error(e[0]),e[3]=+(e[3]?e[4]+(e[5]||1):2*(e[2]==="even"||e[2]==="odd")),e[4]=+(e[6]+e[7]||e[2]==="odd")):e[2]&&nt.error(e[0]),e},PSEUDO:function(e){var t,n;if(J.CHILD.test(e[0]))return null;if(e[3])e[2]=e[3];else if(t=e[4])q.test(t)&&(n=ut(t,!0))&&(n=t.indexOf(")",t.length-n)-t.length)&&(t=t.slice(0,n),e[0]=e[0].slice(0,n)),e[2]=t;return e.slice(0,3)}},filter:{ID:r?function(e){return e=e.replace($,""),function(t){return t.getAttribute("id")===e}}:function(e){return e=e.replace($,""),function(t){var n=typeof t.getAttributeNode!==p&&t.getAttributeNode("id");return n&&n.value===e}},TAG:function(e){return e==="*"?function(){return!0}:(e=e.replace($,"").toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=k[d][e+" "];return t||(t=new RegExp("(^|"+O+")"+e+"("+O+"|$)"))&&k(e,function(e){return t.test(e.className||typeof e.getAttribute!==p&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r,i){var s=nt.attr(r,e);return s==null?t==="!=":t?(s+="",t==="="?s===n:t==="!="?s!==n:t==="^="?n&&s.indexOf(n)===0:t==="*="?n&&s.indexOf(n)>-1:t==="$="?n&&s.substr(s.length-n.length)===n:t==="~="?(" "+s+" ").indexOf(n)>-1:t==="|="?s===n||s.substr(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r){return e==="nth"?function(e){var t,i,s=e.parentNode;if(n===1&&r===0)return!0;if(s){i=0;for(t=s.firstChild;t;t=t.nextSibling)if(t.nodeType===1){i++;if(e===t)break}}return i-=r,i===n||i%n===0&&i/n>=0}:function(t){var n=t;switch(e){case"only":case"first":while(n=n.previousSibling)if(n.nodeType===1)return!1;if(e==="first")return!0;n=t;case"last":while(n=n.nextSibling)if(n.nodeType===1)return!1;return!0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||nt.error("unsupported pseudo: "+e);return r[d]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?N(function(e,n){var i,s=r(e,t),o=s.length;while(o--)i=T.call(e,s[o]),e[i]=!(n[i]=s[o])}):function(e){return r(e,0,n)}):r}},pseudos:{not:N(function(e){var t=[],n=[],r=a(e.replace(j,"$1"));return r[d]?N(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)if(s=o[u])e[u]=!(t[u]=s)}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:N(function(e){return function(t){return nt(e,t).length>0}}),contains:N(function(e){return function(t){return(t.textContent||t.innerText||s(t)).indexOf(e)>-1}}),enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&!!e.checked||t==="option"&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},parent:function(e){return!i.pseudos.empty(e)},empty:function(e){var t;e=e.firstChild;while(e){if(e.nodeName>"@"||(t=e.nodeType)===3||t===4)return!1;e=e.nextSibling}return!0},header:function(e){return X.test(e.nodeName)},text:function(e){var t,n;return e.nodeName.toLowerCase()==="input"&&(t=e.type)==="text"&&((n=e.getAttribute("type"))==null||n.toLowerCase()===t)},radio:rt("radio"),checkbox:rt("checkbox"),file:rt("file"),password:rt("password"),image:rt("image"),submit:it("submit"),reset:it("reset"),button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type==="button"||t==="button"},input:function(e){return V.test(e.nodeName)},focus:function(e){var t=e.ownerDocument;return e===t.activeElement&&(!t.hasFocus||t.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},active:function(e){return e===e.ownerDocument.activeElement},first:st(function(){return[0]}),last:st(function(e,t){return[t-1]}),eq:st(function(e,t,n){return[n<0?n+t:n]}),even:st(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:st(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:st(function(e,t,n){for(var r=n<0?n+t:n;--r>=0;)e.push(r);return e}),gt:st(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}},f=y.compareDocumentPosition?function(e,t){return e===t?(l=!0,0):(!e.compareDocumentPosition||!t.compareDocumentPosition?e.compareDocumentPosition:e.compareDocumentPosition(t)&4)?-1:1}:function(e,t){if(e===t)return l=!0,0;if(e.sourceIndex&&t.sourceIndex)return e.sourceIndex-t.sourceIndex;var n,r,i=[],s=[],o=e.parentNode,u=t.parentNode,a=o;if(o===u)return ot(e,t);if(!o)return-1;if(!u)return 1;while(a)i.unshift(a),a=a.parentNode;a=u;while(a)s.unshift(a),a=a.parentNode;n=i.length,r=s.length;for(var f=0;f<n&&f<r;f++)if(i[f]!==s[f])return ot(i[f],s[f]);return f===n?ot(e,s[f],-1):ot(i[f],t,1)},[0,0].sort(f),h=!l,nt.uniqueSort=function(e){var t,n=[],r=1,i=0;l=h,e.sort(f);if(l){for(;t=e[r];r++)t===e[r-1]&&(i=n.push(r));while(i--)e.splice(n[i],1)}return e},nt.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},a=nt.compile=function(e,t){var n,r=[],i=[],s=A[d][e+" "];if(!s){t||(t=ut(e)),n=t.length;while(n--)s=ht(t[n]),s[d]?r.push(s):i.push(s);s=A(e,pt(i,r))}return s},g.querySelectorAll&&function(){var e,t=vt,n=/'|\\/g,r=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,i=[":focus"],s=[":active"],u=y.matchesSelector||y.mozMatchesSelector||y.webkitMatchesSelector||y.oMatchesSelector||y.msMatchesSelector;K(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||i.push("\\["+O+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||i.push(":checked")}),K(function(e){e.innerHTML="<p test=''></p>",e.querySelectorAll("[test^='']").length&&i.push("[*^$]="+O+"*(?:\"\"|'')"),e.innerHTML="<input type='hidden'/>",e.querySelectorAll(":enabled").length||i.push(":enabled",":disabled")}),i=new RegExp(i.join("|")),vt=function(e,r,s,o,u){if(!o&&!u&&!i.test(e)){var a,f,l=!0,c=d,h=r,p=r.nodeType===9&&e;if(r.nodeType===1&&r.nodeName.toLowerCase()!=="object"){a=ut(e),(l=r.getAttribute("id"))?c=l.replace(n,"\\$&"):r.setAttribute("id",c),c="[id='"+c+"'] ",f=a.length;while(f--)a[f]=c+a[f].join("");h=z.test(e)&&r.parentNode||r,p=a.join(",")}if(p)try{return S.apply(s,x.call(h.querySelectorAll(p),0)),s}catch(v){}finally{l||r.removeAttribute("id")}}return t(e,r,s,o,u)},u&&(K(function(t){e=u.call(t,"div");try{u.call(t,"[test!='']:sizzle"),s.push("!=",H)}catch(n){}}),s=new RegExp(s.join("|")),nt.matchesSelector=function(t,n){n=n.replace(r,"='$1']");if(!o(t)&&!s.test(n)&&!i.test(n))try{var a=u.call(t,n);if(a||e||t.document&&t.document.nodeType!==11)return a}catch(f){}return nt(n,null,null,[t]).length>0})}(),i.pseudos.nth=i.pseudos.eq,i.filters=mt.prototype=i.pseudos,i.setFilters=new mt,nt.attr=v.attr,v.find=nt,v.expr=nt.selectors,v.expr[":"]=v.expr.pseudos,v.unique=nt.uniqueSort,v.text=nt.getText,v.isXMLDoc=nt.isXML,v.contains=nt.contains}(e);var nt=/Until$/,rt=/^(?:parents|prev(?:Until|All))/,it=/^.[^:#\[\.,]*$/,st=v.expr.match.needsContext,ot={children:!0,contents:!0,next:!0,prev:!0};v.fn.extend({find:function(e){var t,n,r,i,s,o,u=this;if(typeof e!="string")return v(e).filter(function(){for(t=0,n=u.length;t<n;t++)if(v.contains(u[t],this))return!0});o=this.pushStack("","find",e);for(t=0,n=this.length;t<n;t++){r=o.length,v.find(e,this[t],o);if(t>0)for(i=r;i<o.length;i++)for(s=0;s<r;s++)if(o[s]===o[i]){o.splice(i--,1);break}}return o},has:function(e){var t,n=v(e,this),r=n.length;return this.filter(function(){for(t=0;t<r;t++)if(v.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(ft(this,e,!1),"not",e)},filter:function(e){return this.pushStack(ft(this,e,!0),"filter",e)},is:function(e){return!!e&&(typeof e=="string"?st.test(e)?v(e,this.context).index(this[0])>=0:v.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){var n,r=0,i=this.length,s=[],o=st.test(e)||typeof e!="string"?v(e,t||this.context):0;for(;r<i;r++){n=this[r];while(n&&n.ownerDocument&&n!==t&&n.nodeType!==11){if(o?o.index(n)>-1:v.find.matchesSelector(n,e)){s.push(n);break}n=n.parentNode}}return s=s.length>1?v.unique(s):s,this.pushStack(s,"closest",e)},index:function(e){return e?typeof e=="string"?v.inArray(this[0],v(e)):v.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(e,t){var n=typeof e=="string"?v(e,t):v.makeArray(e&&e.nodeType?[e]:e),r=v.merge(this.get(),n);return this.pushStack(ut(n[0])||ut(r[0])?r:v.unique(r))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}}),v.fn.andSelf=v.fn.addBack,v.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return v.dir(e,"parentNode")},parentsUntil:function(e,t,n){return v.dir(e,"parentNode",n)},next:function(e){return at(e,"nextSibling")},prev:function(e){return at(e,"previousSibling")},nextAll:function(e){return v.dir(e,"nextSibling")},prevAll:function(e){return v.dir(e,"previousSibling")},nextUntil:function(e,t,n){return v.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return v.dir(e,"previousSibling",n)},siblings:function(e){return v.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return v.sibling(e.firstChild)},contents:function(e){return v.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:v.merge([],e.childNodes)}},function(e,t){v.fn[e]=function(n,r){var i=v.map(this,t,n);return nt.test(e)||(r=n),r&&typeof r=="string"&&(i=v.filter(r,i)),i=this.length>1&&!ot[e]?v.unique(i):i,this.length>1&&rt.test(e)&&(i=i.reverse()),this.pushStack(i,e,l.call(arguments).join(","))}}),v.extend({filter:function(e,t,n){return n&&(e=":not("+e+")"),t.length===1?v.find.matchesSelector(t[0],e)?[t[0]]:[]:v.find.matches(e,t)},dir:function(e,n,r){var i=[],s=e[n];while(s&&s.nodeType!==9&&(r===t||s.nodeType!==1||!v(s).is(r)))s.nodeType===1&&i.push(s),s=s[n];return i},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)e.nodeType===1&&e!==t&&n.push(e);return n}});var ct="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",ht=/ jQuery\d+="(?:null|\d+)"/g,pt=/^\s+/,dt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,vt=/<([\w:]+)/,mt=/<tbody/i,gt=/<|&#?\w+;/,yt=/<(?:script|style|link)/i,bt=/<(?:script|object|embed|option|style)/i,wt=new RegExp("<(?:"+ct+")[\\s/>]","i"),Et=/^(?:checkbox|radio)$/,St=/checked\s*(?:[^=]|=\s*.checked.)/i,xt=/\/(java|ecma)script/i,Tt=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,Nt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},Ct=lt(i),kt=Ct.appendChild(i.createElement("div"));Nt.optgroup=Nt.option,Nt.tbody=Nt.tfoot=Nt.colgroup=Nt.caption=Nt.thead,Nt.th=Nt.td,v.support.htmlSerialize||(Nt._default=[1,"X<div>","</div>"]),v.fn.extend({text:function(e){return v.access(this,function(e){return e===t?v.text(this):this.empty().append((this[0]&&this[0].ownerDocument||i).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(v.isFunction(e))return this.each(function(t){v(this).wrapAll(e.call(this,t))});if(this[0]){var t=v(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&e.firstChild.nodeType===1)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return v.isFunction(e)?this.each(function(t){v(this).wrapInner(e.call(this,t))}):this.each(function(){var t=v(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=v.isFunction(e);return this.each(function(n){v(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){v.nodeName(this,"body")||v(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(this.nodeType===1||this.nodeType===11)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(this.nodeType===1||this.nodeType===11)&&this.insertBefore(e,this.firstChild)})},before:function(){if(!ut(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this)});if(arguments.length){var e=v.clean(arguments);return this.pushStack(v.merge(e,this),"before",this.selector)}},after:function(){if(!ut(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this.nextSibling)});if(arguments.length){var e=v.clean(arguments);return this.pushStack(v.merge(this,e),"after",this.selector)}},remove:function(e,t){var n,r=0;for(;(n=this[r])!=null;r++)if(!e||v.filter(e,[n]).length)!t&&n.nodeType===1&&(v.cleanData(n.getElementsByTagName("*")),v.cleanData([n])),n.parentNode&&n.parentNode.removeChild(n);return this},empty:function(){var e,t=0;for(;(e=this[t])!=null;t++){e.nodeType===1&&v.cleanData(e.getElementsByTagName("*"));while(e.firstChild)e.removeChild(e.firstChild)}return this},clone:function(e,t){return e=e==null?!1:e,t=t==null?e:t,this.map(function(){return v.clone(this,e,t)})},html:function(e){return v.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return n.nodeType===1?n.innerHTML.replace(ht,""):t;if(typeof e=="string"&&!yt.test(e)&&(v.support.htmlSerialize||!wt.test(e))&&(v.support.leadingWhitespace||!pt.test(e))&&!Nt[(vt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(dt,"<$1></$2>");try{for(;r<i;r++)n=this[r]||{},n.nodeType===1&&(v.cleanData(n.getElementsByTagName("*")),n.innerHTML=e);n=0}catch(s){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){return ut(this[0])?this.length?this.pushStack(v(v.isFunction(e)?e():e),"replaceWith",e):this:v.isFunction(e)?this.each(function(t){var n=v(this),r=n.html();n.replaceWith(e.call(this,t,r))}):(typeof e!="string"&&(e=v(e).detach()),this.each(function(){var t=this.nextSibling,n=this.parentNode;v(this).remove(),t?v(t).before(e):v(n).append(e)}))},detach:function(e){return this.remove(e,!0)},domManip:function(e,n,r){e=[].concat.apply([],e);var i,s,o,u,a=0,f=e[0],l=[],c=this.length;if(!v.support.checkClone&&c>1&&typeof f=="string"&&St.test(f))return this.each(function(){v(this).domManip(e,n,r)});if(v.isFunction(f))return this.each(function(i){var s=v(this);e[0]=f.call(this,i,n?s.html():t),s.domManip(e,n,r)});if(this[0]){i=v.buildFragment(e,this,l),o=i.fragment,s=o.firstChild,o.childNodes.length===1&&(o=s);if(s){n=n&&v.nodeName(s,"tr");for(u=i.cacheable||c-1;a<c;a++)r.call(n&&v.nodeName(this[a],"table")?Lt(this[a],"tbody"):this[a],a===u?o:v.clone(o,!0,!0))}o=s=null,l.length&&v.each(l,function(e,t){t.src?v.ajax?v.ajax({url:t.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):v.error("no ajax"):v.globalEval((t.text||t.textContent||t.innerHTML||"").replace(Tt,"")),t.parentNode&&t.parentNode.removeChild(t)})}return this}}),v.buildFragment=function(e,n,r){var s,o,u,a=e[0];return n=n||i,n=!n.nodeType&&n[0]||n,n=n.ownerDocument||n,e.length===1&&typeof a=="string"&&a.length<512&&n===i&&a.charAt(0)==="<"&&!bt.test(a)&&(v.support.checkClone||!St.test(a))&&(v.support.html5Clone||!wt.test(a))&&(o=!0,s=v.fragments[a],u=s!==t),s||(s=n.createDocumentFragment(),v.clean(e,n,s,r),o&&(v.fragments[a]=u&&s)),{fragment:s,cacheable:o}},v.fragments={},v.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){v.fn[e]=function(n){var r,i=0,s=[],o=v(n),u=o.length,a=this.length===1&&this[0].parentNode;if((a==null||a&&a.nodeType===11&&a.childNodes.length===1)&&u===1)return o[t](this[0]),this;for(;i<u;i++)r=(i>0?this.clone(!0):this).get(),v(o[i])[t](r),s=s.concat(r);return this.pushStack(s,e,o.selector)}}),v.extend({clone:function(e,t,n){var r,i,s,o;v.support.html5Clone||v.isXMLDoc(e)||!wt.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(kt.innerHTML=e.outerHTML,kt.removeChild(o=kt.firstChild));if((!v.support.noCloneEvent||!v.support.noCloneChecked)&&(e.nodeType===1||e.nodeType===11)&&!v.isXMLDoc(e)){Ot(e,o),r=Mt(e),i=Mt(o);for(s=0;r[s];++s)i[s]&&Ot(r[s],i[s])}if(t){At(e,o);if(n){r=Mt(e),i=Mt(o);for(s=0;r[s];++s)At(r[s],i[s])}}return r=i=null,o},clean:function(e,t,n,r){var s,o,u,a,f,l,c,h,p,d,m,g,y=t===i&&Ct,b=[];if(!t||typeof t.createDocumentFragment=="undefined")t=i;for(s=0;(u=e[s])!=null;s++){typeof u=="number"&&(u+="");if(!u)continue;if(typeof u=="string")if(!gt.test(u))u=t.createTextNode(u);else{y=y||lt(t),c=t.createElement("div"),y.appendChild(c),u=u.replace(dt,"<$1></$2>"),a=(vt.exec(u)||["",""])[1].toLowerCase(),f=Nt[a]||Nt._default,l=f[0],c.innerHTML=f[1]+u+f[2];while(l--)c=c.lastChild;if(!v.support.tbody){h=mt.test(u),p=a==="table"&&!h?c.firstChild&&c.firstChild.childNodes:f[1]==="<table>"&&!h?c.childNodes:[];for(o=p.length-1;o>=0;--o)v.nodeName(p[o],"tbody")&&!p[o].childNodes.length&&p[o].parentNode.removeChild(p[o])}!v.support.leadingWhitespace&&pt.test(u)&&c.insertBefore(t.createTextNode(pt.exec(u)[0]),c.firstChild),u=c.childNodes,c.parentNode.removeChild(c)}u.nodeType?b.push(u):v.merge(b,u)}c&&(u=c=y=null);if(!v.support.appendChecked)for(s=0;(u=b[s])!=null;s++)v.nodeName(u,"input")?_t(u):typeof u.getElementsByTagName!="undefined"&&v.grep(u.getElementsByTagName("input"),_t);if(n){m=function(e){if(!e.type||xt.test(e.type))return r?r.push(e.parentNode?e.parentNode.removeChild(e):e):n.appendChild(e)};for(s=0;(u=b[s])!=null;s++)if(!v.nodeName(u,"script")||!m(u))n.appendChild(u),typeof u.getElementsByTagName!="undefined"&&(g=v.grep(v.merge([],u.getElementsByTagName("script")),m),b.splice.apply(b,[s+1,0].concat(g)),s+=g.length)}return b},cleanData:function(e,t){var n,r,i,s,o=0,u=v.expando,a=v.cache,f=v.support.deleteExpando,l=v.event.special;for(;(i=e[o])!=null;o++)if(t||v.acceptData(i)){r=i[u],n=r&&a[r];if(n){if(n.events)for(s in n.events)l[s]?v.event.remove(i,s):v.removeEvent(i,s,n.handle);a[r]&&(delete a[r],f?delete i[u]:i.removeAttribute?i.removeAttribute(u):i[u]=null,v.deletedIds.push(r))}}}}),function(){var e,t;v.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},e=v.uaMatch(o.userAgent),t={},e.browser&&(t[e.browser]=!0,t.version=e.version),t.chrome?t.webkit=!0:t.webkit&&(t.safari=!0),v.browser=t,v.sub=function(){function e(t,n){return new e.fn.init(t,n)}v.extend(!0,e,this),e.superclass=this,e.fn=e.prototype=this(),e.fn.constructor=e,e.sub=this.sub,e.fn.init=function(r,i){return i&&i instanceof v&&!(i instanceof e)&&(i=e(i)),v.fn.init.call(this,r,i,t)},e.fn.init.prototype=e.fn;var t=e(i);return e}}();var Dt,Pt,Ht,Bt=/alpha\([^)]*\)/i,jt=/opacity=([^)]*)/,Ft=/^(top|right|bottom|left)$/,It=/^(none|table(?!-c[ea]).+)/,qt=/^margin/,Rt=new RegExp("^("+m+")(.*)$","i"),Ut=new RegExp("^("+m+")(?!px)[a-z%]+$","i"),zt=new RegExp("^([-+])=("+m+")","i"),Wt={BODY:"block"},Xt={position:"absolute",visibility:"hidden",display:"block"},Vt={letterSpacing:0,fontWeight:400},$t=["Top","Right","Bottom","Left"],Jt=["Webkit","O","Moz","ms"],Kt=v.fn.toggle;v.fn.extend({css:function(e,n){return v.access(this,function(e,n,r){return r!==t?v.style(e,n,r):v.css(e,n)},e,n,arguments.length>1)},show:function(){return Yt(this,!0)},hide:function(){return Yt(this)},toggle:function(e,t){var n=typeof e=="boolean";return v.isFunction(e)&&v.isFunction(t)?Kt.apply(this,arguments):this.each(function(){(n?e:Gt(this))?v(this).show():v(this).hide()})}}),v.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Dt(e,"opacity");return n===""?"1":n}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":v.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(!e||e.nodeType===3||e.nodeType===8||!e.style)return;var s,o,u,a=v.camelCase(n),f=e.style;n=v.cssProps[a]||(v.cssProps[a]=Qt(f,a)),u=v.cssHooks[n]||v.cssHooks[a];if(r===t)return u&&"get"in u&&(s=u.get(e,!1,i))!==t?s:f[n];o=typeof r,o==="string"&&(s=zt.exec(r))&&(r=(s[1]+1)*s[2]+parseFloat(v.css(e,n)),o="number");if(r==null||o==="number"&&isNaN(r))return;o==="number"&&!v.cssNumber[a]&&(r+="px");if(!u||!("set"in u)||(r=u.set(e,r,i))!==t)try{f[n]=r}catch(l){}},css:function(e,n,r,i){var s,o,u,a=v.camelCase(n);return n=v.cssProps[a]||(v.cssProps[a]=Qt(e.style,a)),u=v.cssHooks[n]||v.cssHooks[a],u&&"get"in u&&(s=u.get(e,!0,i)),s===t&&(s=Dt(e,n)),s==="normal"&&n in Vt&&(s=Vt[n]),r||i!==t?(o=parseFloat(s),r||v.isNumeric(o)?o||0:s):s},swap:function(e,t,n){var r,i,s={};for(i in t)s[i]=e.style[i],e.style[i]=t[i];r=n.call(e);for(i in t)e.style[i]=s[i];return r}}),e.getComputedStyle?Dt=function(t,n){var r,i,s,o,u=e.getComputedStyle(t,null),a=t.style;return u&&(r=u.getPropertyValue(n)||u[n],r===""&&!v.contains(t.ownerDocument,t)&&(r=v.style(t,n)),Ut.test(r)&&qt.test(n)&&(i=a.width,s=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=r,r=u.width,a.width=i,a.minWidth=s,a.maxWidth=o)),r}:i.documentElement.currentStyle&&(Dt=function(e,t){var n,r,i=e.currentStyle&&e.currentStyle[t],s=e.style;return i==null&&s&&s[t]&&(i=s[t]),Ut.test(i)&&!Ft.test(t)&&(n=s.left,r=e.runtimeStyle&&e.runtimeStyle.left,r&&(e.runtimeStyle.left=e.currentStyle.left),s.left=t==="fontSize"?"1em":i,i=s.pixelLeft+"px",s.left=n,r&&(e.runtimeStyle.left=r)),i===""?"auto":i}),v.each(["height","width"],function(e,t){v.cssHooks[t]={get:function(e,n,r){if(n)return e.offsetWidth===0&&It.test(Dt(e,"display"))?v.swap(e,Xt,function(){return tn(e,t,r)}):tn(e,t,r)},set:function(e,n,r){return Zt(e,n,r?en(e,t,r,v.support.boxSizing&&v.css(e,"boxSizing")==="border-box"):0)}}}),v.support.opacity||(v.cssHooks.opacity={get:function(e,t){return jt.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=v.isNumeric(t)?"alpha(opacity="+t*100+")":"",s=r&&r.filter||n.filter||"";n.zoom=1;if(t>=1&&v.trim(s.replace(Bt,""))===""&&n.removeAttribute){n.removeAttribute("filter");if(r&&!r.filter)return}n.filter=Bt.test(s)?s.replace(Bt,i):s+" "+i}}),v(function(){v.support.reliableMarginRight||(v.cssHooks.marginRight={get:function(e,t){return v.swap(e,{display:"inline-block"},function(){if(t)return Dt(e,"marginRight")})}}),!v.support.pixelPosition&&v.fn.position&&v.each(["top","left"],function(e,t){v.cssHooks[t]={get:function(e,n){if(n){var r=Dt(e,t);return Ut.test(r)?v(e).position()[t]+"px":r}}}})}),v.expr&&v.expr.filters&&(v.expr.filters.hidden=function(e){return e.offsetWidth===0&&e.offsetHeight===0||!v.support.reliableHiddenOffsets&&(e.style&&e.style.display||Dt(e,"display"))==="none"},v.expr.filters.visible=function(e){return!v.expr.filters.hidden(e)}),v.each({margin:"",padding:"",border:"Width"},function(e,t){v.cssHooks[e+t]={expand:function(n){var r,i=typeof n=="string"?n.split(" "):[n],s={};for(r=0;r<4;r++)s[e+$t[r]+t]=i[r]||i[r-2]||i[0];return s}},qt.test(e)||(v.cssHooks[e+t].set=Zt)});var rn=/%20/g,sn=/\[\]$/,on=/\r?\n/g,un=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,an=/^(?:select|textarea)/i;v.fn.extend({serialize:function(){return v.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?v.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||an.test(this.nodeName)||un.test(this.type))}).map(function(e,t){var n=v(this).val();return n==null?null:v.isArray(n)?v.map(n,function(e,n){return{name:t.name,value:e.replace(on,"\r\n")}}):{name:t.name,value:n.replace(on,"\r\n")}}).get()}}),v.param=function(e,n){var r,i=[],s=function(e,t){t=v.isFunction(t)?t():t==null?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};n===t&&(n=v.ajaxSettings&&v.ajaxSettings.traditional);if(v.isArray(e)||e.jquery&&!v.isPlainObject(e))v.each(e,function(){s(this.name,this.value)});else for(r in e)fn(r,e[r],n,s);return i.join("&").replace(rn,"+")};var ln,cn,hn=/#.*$/,pn=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,dn=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,vn=/^(?:GET|HEAD)$/,mn=/^\/\//,gn=/\?/,yn=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,bn=/([?&])_=[^&]*/,wn=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,En=v.fn.load,Sn={},xn={},Tn=["*/"]+["*"];try{cn=s.href}catch(Nn){cn=i.createElement("a"),cn.href="",cn=cn.href}ln=wn.exec(cn.toLowerCase())||[],v.fn.load=function(e,n,r){if(typeof e!="string"&&En)return En.apply(this,arguments);if(!this.length)return this;var i,s,o,u=this,a=e.indexOf(" ");return a>=0&&(i=e.slice(a,e.length),e=e.slice(0,a)),v.isFunction(n)?(r=n,n=t):n&&typeof n=="object"&&(s="POST"),v.ajax({url:e,type:s,dataType:"html",data:n,complete:function(e,t){r&&u.each(r,o||[e.responseText,t,e])}}).done(function(e){o=arguments,u.html(i?v("<div>").append(e.replace(yn,"")).find(i):e)}),this},v.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,t){v.fn[t]=function(e){return this.on(t,e)}}),v.each(["get","post"],function(e,n){v[n]=function(e,r,i,s){return v.isFunction(r)&&(s=s||i,i=r,r=t),v.ajax({type:n,url:e,data:r,success:i,dataType:s})}}),v.extend({getScript:function(e,n){return v.get(e,t,n,"script")},getJSON:function(e,t,n){return v.get(e,t,n,"json")},ajaxSetup:function(e,t){return t?Ln(e,v.ajaxSettings):(t=e,e=v.ajaxSettings),Ln(e,t),e},ajaxSettings:{url:cn,isLocal:dn.test(ln[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":Tn},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":v.parseJSON,"text xml":v.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:Cn(Sn),ajaxTransport:Cn(xn),ajax:function(e,n){function T(e,n,s,a){var l,y,b,w,S,T=n;if(E===2)return;E=2,u&&clearTimeout(u),o=t,i=a||"",x.readyState=e>0?4:0,s&&(w=An(c,x,s));if(e>=200&&e<300||e===304)c.ifModified&&(S=x.getResponseHeader("Last-Modified"),S&&(v.lastModified[r]=S),S=x.getResponseHeader("Etag"),S&&(v.etag[r]=S)),e===304?(T="notmodified",l=!0):(l=On(c,w),T=l.state,y=l.data,b=l.error,l=!b);else{b=T;if(!T||e)T="error",e<0&&(e=0)}x.status=e,x.statusText=(n||T)+"",l?d.resolveWith(h,[y,T,x]):d.rejectWith(h,[x,T,b]),x.statusCode(g),g=t,f&&p.trigger("ajax"+(l?"Success":"Error"),[x,c,l?y:b]),m.fireWith(h,[x,T]),f&&(p.trigger("ajaxComplete",[x,c]),--v.active||v.event.trigger("ajaxStop"))}typeof e=="object"&&(n=e,e=t),n=n||{};var r,i,s,o,u,a,f,l,c=v.ajaxSetup({},n),h=c.context||c,p=h!==c&&(h.nodeType||h instanceof v)?v(h):v.event,d=v.Deferred(),m=v.Callbacks("once memory"),g=c.statusCode||{},b={},w={},E=0,S="canceled",x={readyState:0,setRequestHeader:function(e,t){if(!E){var n=e.toLowerCase();e=w[n]=w[n]||e,b[e]=t}return this},getAllResponseHeaders:function(){return E===2?i:null},getResponseHeader:function(e){var n;if(E===2){if(!s){s={};while(n=pn.exec(i))s[n[1].toLowerCase()]=n[2]}n=s[e.toLowerCase()]}return n===t?null:n},overrideMimeType:function(e){return E||(c.mimeType=e),this},abort:function(e){return e=e||S,o&&o.abort(e),T(0,e),this}};d.promise(x),x.success=x.done,x.error=x.fail,x.complete=m.add,x.statusCode=function(e){if(e){var t;if(E<2)for(t in e)g[t]=[g[t],e[t]];else t=e[x.status],x.always(t)}return this},c.url=((e||c.url)+"").replace(hn,"").replace(mn,ln[1]+"//"),c.dataTypes=v.trim(c.dataType||"*").toLowerCase().split(y),c.crossDomain==null&&(a=wn.exec(c.url.toLowerCase()),c.crossDomain=!(!a||a[1]===ln[1]&&a[2]===ln[2]&&(a[3]||(a[1]==="http:"?80:443))==(ln[3]||(ln[1]==="http:"?80:443)))),c.data&&c.processData&&typeof c.data!="string"&&(c.data=v.param(c.data,c.traditional)),kn(Sn,c,n,x);if(E===2)return x;f=c.global,c.type=c.type.toUpperCase(),c.hasContent=!vn.test(c.type),f&&v.active++===0&&v.event.trigger("ajaxStart");if(!c.hasContent){c.data&&(c.url+=(gn.test(c.url)?"&":"?")+c.data,delete c.data),r=c.url;if(c.cache===!1){var N=v.now(),C=c.url.replace(bn,"$1_="+N);c.url=C+(C===c.url?(gn.test(c.url)?"&":"?")+"_="+N:"")}}(c.data&&c.hasContent&&c.contentType!==!1||n.contentType)&&x.setRequestHeader("Content-Type",c.contentType),c.ifModified&&(r=r||c.url,v.lastModified[r]&&x.setRequestHeader("If-Modified-Since",v.lastModified[r]),v.etag[r]&&x.setRequestHeader("If-None-Match",v.etag[r])),x.setRequestHeader("Accept",c.dataTypes[0]&&c.accepts[c.dataTypes[0]]?c.accepts[c.dataTypes[0]]+(c.dataTypes[0]!=="*"?", "+Tn+"; q=0.01":""):c.accepts["*"]);for(l in c.headers)x.setRequestHeader(l,c.headers[l]);if(!c.beforeSend||c.beforeSend.call(h,x,c)!==!1&&E!==2){S="abort";for(l in{success:1,error:1,complete:1})x[l](c[l]);o=kn(xn,c,n,x);if(!o)T(-1,"No Transport");else{x.readyState=1,f&&p.trigger("ajaxSend",[x,c]),c.async&&c.timeout>0&&(u=setTimeout(function(){x.abort("timeout")},c.timeout));try{E=1,o.send(b,T)}catch(k){if(!(E<2))throw k;T(-1,k)}}return x}return x.abort()},active:0,lastModified:{},etag:{}});var Mn=[],_n=/\?/,Dn=/(=)\?(?=&|$)|\?\?/,Pn=v.now();v.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Mn.pop()||v.expando+"_"+Pn++;return this[e]=!0,e}}),v.ajaxPrefilter("json jsonp",function(n,r,i){var s,o,u,a=n.data,f=n.url,l=n.jsonp!==!1,c=l&&Dn.test(f),h=l&&!c&&typeof a=="string"&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Dn.test(a);if(n.dataTypes[0]==="jsonp"||c||h)return s=n.jsonpCallback=v.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,o=e[s],c?n.url=f.replace(Dn,"$1"+s):h?n.data=a.replace(Dn,"$1"+s):l&&(n.url+=(_n.test(f)?"&":"?")+n.jsonp+"="+s),n.converters["script json"]=function(){return u||v.error(s+" was not called"),u[0]},n.dataTypes[0]="json",e[s]=function(){u=arguments},i.always(function(){e[s]=o,n[s]&&(n.jsonpCallback=r.jsonpCallback,Mn.push(s)),u&&v.isFunction(o)&&o(u[0]),u=o=t}),"script"}),v.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(e){return v.globalEval(e),e}}}),v.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),v.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=i.head||i.getElementsByTagName("head")[0]||i.documentElement;return{send:function(s,o){n=i.createElement("script"),n.async="async",e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,i){if(i||!n.readyState||/loaded|complete/.test(n.readyState))n.onload=n.onreadystatechange=null,r&&n.parentNode&&r.removeChild(n),n=t,i||o(200,"success")},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(0,1)}}}});var Hn,Bn=e.ActiveXObject?function(){for(var e in Hn)Hn[e](0,1)}:!1,jn=0;v.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&Fn()||In()}:Fn,function(e){v.extend(v.support,{ajax:!!e,cors:!!e&&"withCredentials"in e})}(v.ajaxSettings.xhr()),v.support.ajax&&v.ajaxTransport(function(n){if(!n.crossDomain||v.support.cors){var r;return{send:function(i,s){var o,u,a=n.xhr();n.username?a.open(n.type,n.url,n.async,n.username,n.password):a.open(n.type,n.url,n.async);if(n.xhrFields)for(u in n.xhrFields)a[u]=n.xhrFields[u];n.mimeType&&a.overrideMimeType&&a.overrideMimeType(n.mimeType),!n.crossDomain&&!i["X-Requested-With"]&&(i["X-Requested-With"]="XMLHttpRequest");try{for(u in i)a.setRequestHeader(u,i[u])}catch(f){}a.send(n.hasContent&&n.data||null),r=function(e,i){var u,f,l,c,h;try{if(r&&(i||a.readyState===4)){r=t,o&&(a.onreadystatechange=v.noop,Bn&&delete Hn[o]);if(i)a.readyState!==4&&a.abort();else{u=a.status,l=a.getAllResponseHeaders(),c={},h=a.responseXML,h&&h.documentElement&&(c.xml=h);try{c.text=a.responseText}catch(p){}try{f=a.statusText}catch(p){f=""}!u&&n.isLocal&&!n.crossDomain?u=c.text?200:404:u===1223&&(u=204)}}}catch(d){i||s(-1,d)}c&&s(u,f,c,l)},n.async?a.readyState===4?setTimeout(r,0):(o=++jn,Bn&&(Hn||(Hn={},v(e).unload(Bn)),Hn[o]=r),a.onreadystatechange=r):r()},abort:function(){r&&r(0,1)}}}});var qn,Rn,Un=/^(?:toggle|show|hide)$/,zn=new RegExp("^(?:([-+])=|)("+m+")([a-z%]*)$","i"),Wn=/queueHooks$/,Xn=[Gn],Vn={"*":[function(e,t){var n,r,i=this.createTween(e,t),s=zn.exec(t),o=i.cur(),u=+o||0,a=1,f=20;if(s){n=+s[2],r=s[3]||(v.cssNumber[e]?"":"px");if(r!=="px"&&u){u=v.css(i.elem,e,!0)||n||1;do a=a||".5",u/=a,v.style(i.elem,e,u+r);while(a!==(a=i.cur()/o)&&a!==1&&--f)}i.unit=r,i.start=u,i.end=s[1]?u+(s[1]+1)*n:n}return i}]};v.Animation=v.extend(Kn,{tweener:function(e,t){v.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;r<i;r++)n=e[r],Vn[n]=Vn[n]||[],Vn[n].unshift(t)},prefilter:function(e,t){t?Xn.unshift(e):Xn.push(e)}}),v.Tween=Yn,Yn.prototype={constructor:Yn,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(v.cssNumber[n]?"":"px")},cur:function(){var e=Yn.propHooks[this.prop];return e&&e.get?e.get(this):Yn.propHooks._default.get(this)},run:function(e){var t,n=Yn.propHooks[this.prop];return this.options.duration?this.pos=t=v.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Yn.propHooks._default.set(this),this}},Yn.prototype.init.prototype=Yn.prototype,Yn.propHooks={_default:{get:function(e){var t;return e.elem[e.prop]==null||!!e.elem.style&&e.elem.style[e.prop]!=null?(t=v.css(e.elem,e.prop,!1,""),!t||t==="auto"?0:t):e.elem[e.prop]},set:function(e){v.fx.step[e.prop]?v.fx.step[e.prop](e):e.elem.style&&(e.elem.style[v.cssProps[e.prop]]!=null||v.cssHooks[e.prop])?v.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Yn.propHooks.scrollTop=Yn.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},v.each(["toggle","show","hide"],function(e,t){var n=v.fn[t];v.fn[t]=function(r,i,s){return r==null||typeof r=="boolean"||!e&&v.isFunction(r)&&v.isFunction(i)?n.apply(this,arguments):this.animate(Zn(t,!0),r,i,s)}}),v.fn.extend({fadeTo:function(e,t,n,r){return this.filter(Gt).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=v.isEmptyObject(e),s=v.speed(t,n,r),o=function(){var t=Kn(this,v.extend({},e),s);i&&t.stop(!0)};return i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return typeof e!="string"&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=e!=null&&e+"queueHooks",s=v.timers,o=v._data(this);if(n)o[n]&&o[n].stop&&i(o[n]);else for(n in o)o[n]&&o[n].stop&&Wn.test(n)&&i(o[n]);for(n=s.length;n--;)s[n].elem===this&&(e==null||s[n].queue===e)&&(s[n].anim.stop(r),t=!1,s.splice(n,1));(t||!r)&&v.dequeue(this,e)})}}),v.each({slideDown:Zn("show"),slideUp:Zn("hide"),slideToggle:Zn("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){v.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),v.speed=function(e,t,n){var r=e&&typeof e=="object"?v.extend({},e):{complete:n||!n&&t||v.isFunction(e)&&e,duration:e,easing:n&&t||t&&!v.isFunction(t)&&t};r.duration=v.fx.off?0:typeof r.duration=="number"?r.duration:r.duration in v.fx.speeds?v.fx.speeds[r.duration]:v.fx.speeds._default;if(r.queue==null||r.queue===!0)r.queue="fx";return r.old=r.complete,r.complete=function(){v.isFunction(r.old)&&r.old.call(this),r.queue&&v.dequeue(this,r.queue)},r},v.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},v.timers=[],v.fx=Yn.prototype.init,v.fx.tick=function(){var e,n=v.timers,r=0;qn=v.now();for(;r<n.length;r++)e=n[r],!e()&&n[r]===e&&n.splice(r--,1);n.length||v.fx.stop(),qn=t},v.fx.timer=function(e){e()&&v.timers.push(e)&&!Rn&&(Rn=setInterval(v.fx.tick,v.fx.interval))},v.fx.interval=13,v.fx.stop=function(){clearInterval(Rn),Rn=null},v.fx.speeds={slow:600,fast:200,_default:400},v.fx.step={},v.expr&&v.expr.filters&&(v.expr.filters.animated=function(e){return v.grep(v.timers,function(t){return e===t.elem}).length});var er=/^(?:body|html)$/i;v.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){v.offset.setOffset(this,e,t)});var n,r,i,s,o,u,a,f={top:0,left:0},l=this[0],c=l&&l.ownerDocument;if(!c)return;return(r=c.body)===l?v.offset.bodyOffset(l):(n=c.documentElement,v.contains(n,l)?(typeof l.getBoundingClientRect!="undefined"&&(f=l.getBoundingClientRect()),i=tr(c),s=n.clientTop||r.clientTop||0,o=n.clientLeft||r.clientLeft||0,u=i.pageYOffset||n.scrollTop,a=i.pageXOffset||n.scrollLeft,{top:f.top+u-s,left:f.left+a-o}):f)},v.offset={bodyOffset:function(e){var t=e.offsetTop,n=e.offsetLeft;return v.support.doesNotIncludeMarginInBodyOffset&&(t+=parseFloat(v.css(e,"marginTop"))||0,n+=parseFloat(v.css(e,"marginLeft"))||0),{top:t,left:n}},setOffset:function(e,t,n){var r=v.css(e,"position");r==="static"&&(e.style.position="relative");var i=v(e),s=i.offset(),o=v.css(e,"top"),u=v.css(e,"left"),a=(r==="absolute"||r==="fixed")&&v.inArray("auto",[o,u])>-1,f={},l={},c,h;a?(l=i.position(),c=l.top,h=l.left):(c=parseFloat(o)||0,h=parseFloat(u)||0),v.isFunction(t)&&(t=t.call(e,n,s)),t.top!=null&&(f.top=t.top-s.top+c),t.left!=null&&(f.left=t.left-s.left+h),"using"in t?t.using.call(e,f):i.css(f)}},v.fn.extend({position:function(){if(!this[0])return;var e=this[0],t=this.offsetParent(),n=this.offset(),r=er.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat(v.css(e,"marginTop"))||0,n.left-=parseFloat(v.css(e,"marginLeft"))||0,r.top+=parseFloat(v.css(t[0],"borderTopWidth"))||0,r.left+=parseFloat(v.css(t[0],"borderLeftWidth"))||0,{top:n.top-r.top,left:n.left-r.left}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||i.body;while(e&&!er.test(e.nodeName)&&v.css(e,"position")==="static")e=e.offsetParent;return e||i.body})}}),v.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);v.fn[e]=function(i){return v.access(this,function(e,i,s){var o=tr(e);if(s===t)return o?n in o?o[n]:o.document.documentElement[i]:e[i];o?o.scrollTo(r?v(o).scrollLeft():s,r?s:v(o).scrollTop()):e[i]=s},e,i,arguments.length,null)}}),v.each({Height:"height",Width:"width"},function(e,n){v.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){v.fn[i]=function(i,s){var o=arguments.length&&(r||typeof i!="boolean"),u=r||(i===!0||s===!0?"margin":"border");return v.access(this,function(n,r,i){var s;return v.isWindow(n)?n.document.documentElement["client"+e]:n.nodeType===9?(s=n.documentElement,Math.max(n.body["scroll"+e],s["scroll"+e],n.body["offset"+e],s["offset"+e],s["client"+e])):i===t?v.css(n,r,i,u):v.style(n,r,i,u)},n,o?i:t,o,null)}})}),e.jQuery=e.$=v,typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return v})}(window),function(e,t){if(typeof define=="function"&&define.amd)define("backbone",["underscore","jquery","exports"],function(n,r,i){e.Backbone=t(e,i,n,r)});else if(typeof exports!="undefined"){var n=require("underscore");t(e,exports,n)}else e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(this,function(e,t,n,r){var i=e.Backbone,s=[],o=s.push,u=s.slice,a=s.splice;t.VERSION="1.1.2",t.$=r,t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var f=t.Events={on:function(e,t,n){if(!c(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var r=this._events[e]||(this._events[e]=[]);return r.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,r){if(!c(this,"once",e,[t,r])||!t)return this;var i=this,s=n.once(function(){i.off(e,s),t.apply(this,arguments)});return s._callback=t,this.on(e,s,r)},off:function(e,t,r){var i,s,o,u,a,f,l,h;if(!this._events||!c(this,"off",e,[t,r]))return this;if(!e&&!t&&!r)return this._events=void 0,this;u=e?[e]:n.keys(this._events);for(a=0,f=u.length;a<f;a++){e=u[a];if(o=this._events[e]){this._events[e]=i=[];if(t||r)for(l=0,h=o.length;l<h;l++)s=o[l],(t&&t!==s.callback&&t!==s.callback._callback||r&&r!==s.context)&&i.push(s);i.length||delete this._events[e]}}return this},trigger:function(e){if(!this._events)return this;var t=u.call(arguments,1);if(!c(this,"trigger",e,t))return this;var n=this._events[e],r=this._events.all;return n&&h(n,t),r&&h(r,arguments),this},stopListening:function(e,t,r){var i=this._listeningTo;if(!i)return this;var s=!t&&!r;!r&&typeof t=="object"&&(r=this),e&&((i={})[e._listenId]=e);for(var o in i)e=i[o],e.off(t,r,this),(s||n.isEmpty(e._events))&&delete this._listeningTo[o];return this}},l=/\s+/,c=function(e,t,n,r){if(!n)return!0;if(typeof n=="object"){for(var i in n)e[t].apply(e,[i,n[i]].concat(r));return!1}if(l.test(n)){var s=n.split(l);for(var o=0,u=s.length;o<u;o++)e[t].apply(e,[s[o]].concat(r));return!1}return!0},h=function(e,t){var n,r=-1,i=e.length,s=t[0],o=t[1],u=t[2];switch(t.length){case 0:while(++r<i)(n=e[r]).callback.call(n.ctx);return;case 1:while(++r<i)(n=e[r]).callback.call(n.ctx,s);return;case 2:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o);return;case 3:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o,u);return;default:while(++r<i)(n=e[r]).callback.apply(n.ctx,t);return}},p={listenTo:"on",listenToOnce:"once"};n.each(p,function(e,t){f[t]=function(t,r,i){var s=this._listeningTo||(this._listeningTo={}),o=t._listenId||(t._listenId=n.uniqueId("l"));return s[o]=t,!i&&typeof r=="object"&&(i=this),t[e](r,i,this),this}}),f.bind=f.on,f.unbind=f.off,n.extend(t,f);var d=t.Model=function(e,t){var r=e||{};t||(t={}),this.cid=n.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(r=this.parse(r,t)||{}),r=n.defaults({},r,n.result(this,"defaults")),this.set(r,t),this.changed={},this.initialize.apply(this,arguments)};n.extend(d.prototype,f,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return this.get(e)!=null},set:function(e,t,r){var i,s,o,u,a,f,l,c;if(e==null)return this;typeof e=="object"?(s=e,r=t):(s={})[e]=t,r||(r={});if(!this._validate(s,r))return!1;o=r.unset,a=r.silent,u=[],f=this._changing,this._changing=!0,f||(this._previousAttributes=n.clone(this.attributes),this.changed={}),c=this.attributes,l=this._previousAttributes,this.idAttribute in s&&(this.id=s[this.idAttribute]);for(i in s)t=s[i],n.isEqual(c[i],t)||u.push(i),n.isEqual(l[i],t)?delete this.changed[i]:this.changed[i]=t,o?delete c[i]:c[i]=t;if(!a){u.length&&(this._pending=r);for(var h=0,p=u.length;h<p;h++)this.trigger("change:"+u[h],this,c[u[h]],r)}if(f)return this;if(!a)while(this._pending)r=this._pending,this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var r in this.attributes)t[r]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return e==null?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?n.clone(this.changed):!1;var t,r=!1,i=this._changing?this._previousAttributes:this.attributes;for(var s in e){if(n.isEqual(i[s],t=e[s]))continue;(r||(r={}))[s]=t}return r},previous:function(e){return e==null||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=e?n.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=this,r=e.success;return e.success=function(n){if(!t.set(t.parse(n,e),e))return!1;r&&r(t,n,e),t.trigger("sync",t,n,e)},I(this,e),this.sync("read",this,e)},save:function(e,t,r){var i,s,o,u=this.attributes;e==null||typeof e=="object"?(i=e,r=t):(i={})[e]=t,r=n.extend({validate:!0},r);if(i&&!r.wait){if(!this.set(i,r))return!1}else if(!this._validate(i,r))return!1;i&&r.wait&&(this.attributes=n.extend({},u,i)),r.parse===void 0&&(r.parse=!0);var a=this,f=r.success;return r.success=function(e){a.attributes=u;var t=a.parse(e,r);r.wait&&(t=n.extend(i||{},t));if(n.isObject(t)&&!a.set(t,r))return!1;f&&f(a,e,r),a.trigger("sync",a,e,r)},I(this,r),s=this.isNew()?"create":r.patch?"patch":"update",s==="patch"&&(r.attrs=i),o=this.sync(s,this,r),i&&r.wait&&(this.attributes=u),o},destroy:function(e){e=e?n.clone(e):{};var t=this,r=e.success,i=function(){t.trigger("destroy",t,t.collection,e)};e.success=function(n){(e.wait||t.isNew())&&i(),r&&r(t,n,e),t.isNew()||t.trigger("sync",t,n,e)};if(this.isNew())return e.success(),!1;I(this,e);var s=this.sync("delete",this,e);return e.wait||i(),s},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||F();return this.isNew()?e:e.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},n.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var r=this.validationError=this.validate(e,t)||null;return r?(this.trigger("invalid",this,r,n.extend(t,{validationError:r})),!1):!0}});var v=["keys","values","pairs","invert","pick","omit"];n.each(v,function(e){d.prototype[e]=function(){var t=u.call(arguments);return t.unshift(this.attributes),n[e].apply(n,t)}});var m=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator!==void 0&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},g={add:!0,remove:!0,merge:!0},y={add:!0,remove:!1};n.extend(m.prototype,f,{model:d,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.extend({merge:!1},t,y))},remove:function(e,t){var r=!n.isArray(e);e=r?[e]:n.clone(e),t||(t={});var i,s,o,u;for(i=0,s=e.length;i<s;i++){u=e[i]=this.get(e[i]);if(!u)continue;delete this._byId[u.id],delete this._byId[u.cid],o=this.indexOf(u),this.models.splice(o,1),this.length--,t.silent||(t.index=o,u.trigger("remove",u,this,t)),this._removeReference(u,t)}return r?e[0]:e},set:function(e,t){t=n.defaults({},t,g),t.parse&&(e=this.parse(e,t));var r=!n.isArray(e);e=r?e?[e]:[]:n.clone(e);var i,s,o,u,a,f,l,c=t.at,h=this.model,p=this.comparator&&c==null&&t.sort!==!1,v=n.isString(this.comparator)?this.comparator:null,m=[],y=[],b={},w=t.add,E=t.merge,S=t.remove,x=!p&&w&&S?[]:!1;for(i=0,s=e.length;i<s;i++){a=e[i]||{},a instanceof d?o=u=a:o=a[h.prototype.idAttribute||"id"];if(f=this.get(o))S&&(b[f.cid]=!0),E&&(a=a===u?u.attributes:a,t.parse&&(a=f.parse(a,t)),f.set(a,t),p&&!l&&f.hasChanged(v)&&(l=!0)),e[i]=f;else if(w){u=e[i]=this._prepareModel(a,t);if(!u)continue;m.push(u),this._addReference(u,t)}u=f||u,x&&(u.isNew()||!b[u.id])&&x.push(u),b[u.id]=!0}if(S){for(i=0,s=this.length;i<s;++i)b[(u=this.models[i]).cid]||y.push(u);y.length&&this.remove(y,t)}if(m.length||x&&x.length){p&&(l=!0),this.length+=m.length;if(c!=null)for(i=0,s=m.length;i<s;i++)this.models.splice(c+i,0,m[i]);else{x&&(this.models.length=0);var T=x||m;for(i=0,s=T.length;i<s;i++)this.models.push(T[i])}}l&&this.sort({silent:!0});if(!t.silent){for(i=0,s=m.length;i<s;i++)(u=m[i]).trigger("add",u,this,t);(l||x&&x.length)&&this.trigger("sort",this,t)}return r?e[0]:e},reset:function(e,t){t||(t={});for(var r=0,i=this.models.length;r<i;r++)this._removeReference(this.models[r],t);return t.previousModels=this.models,this._reset(),e=this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,n.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,n.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return u.apply(this.models,arguments)},get:function(e){return e==null?void 0:this._byId[e]||this._byId[e.id]||this._byId[e.cid]},at:function(e){return this.models[e]},where:function(e,t){return n.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),n.isString(this.comparator)||this.comparator.length===1?this.models=this.sortBy(this.comparator,this):this.models.sort(n.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return n.invoke(this.models,"get",e)},fetch:function(e){e=e?n.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=e.success,r=this;return e.success=function(n){var i=e.reset?"reset":"set";r[i](n,e),t&&t(r,n,e),r.trigger("sync",r,n,e)},I(this,e),this.sync("read",this,e)},create:function(e,t){t=t?n.clone(t):{};if(!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var r=this,i=t.success;return t.success=function(e,n){t.wait&&r.add(e,t),i&&i(e,n,t)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof d)return e;t=t?n.clone(t):{},t.collection=this;var r=new this.model(e,t);return r.validationError?(this.trigger("invalid",this,r.validationError,t),!1):r},_addReference:function(e,t){this._byId[e.cid]=e,e.id!=null&&(this._byId[e.id]=e),e.collection||(e.collection=this),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e==="add"||e==="remove")&&n!==this)return;e==="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],t.id!=null&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments)}});var b=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];n.each(b,function(e){m.prototype[e]=function(){var t=u.call(arguments);return t.unshift(this.models),n[e].apply(n,t)}});var w=["groupBy","countBy","sortBy","indexBy"];n.each(w,function(e){m.prototype[e]=function(t,r){var i=n.isFunction(t)?t:function(e){return e.get(t)};return n[e](this.models,i,r)}});var E=t.View=function(e){this.cid=n.uniqueId("view"),e||(e={}),n.extend(this,n.pick(e,x)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},S=/^(\S+)\s*(.*)$/,x=["model","collection","el","id","attributes","className","tagName","events"];n.extend(E.prototype,f,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,n){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=n.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var r=e[t];n.isFunction(r)||(r=this[e[t]]);if(!r)continue;var i=t.match(S),s=i[1],o=i[2];r=n.bind(r,this),s+=".delegateEvents"+this.cid,o===""?this.$el.on(s,r):this.$el.on(s,o,r)}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(!this.el){var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e["class"]=n.result(this,"className"));var r=t.$("<"+n.result(this,"tagName")+">").attr(e);this.setElement(r,!1)}else this.setElement(n.result(this,"el"),!1)}}),t.sync=function(e,r,i){var s=N[e];n.defaults(i||(i={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var o={type:s,dataType:"json"};i.url||(o.url=n.result(r,"url")||F()),i.data==null&&r&&(e==="create"||e==="update"||e==="patch")&&(o.contentType="application/json",o.data=JSON.stringify(i.attrs||r.toJSON(i))),i.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{});if(i.emulateHTTP&&(s==="PUT"||s==="DELETE"||s==="PATCH")){o.type="POST",i.emulateJSON&&(o.data._method=s);var u=i.beforeSend;i.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",s);if(u)return u.apply(this,arguments)}}o.type!=="GET"&&!i.emulateJSON&&(o.processData=!1),o.type==="PATCH"&&T&&(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var a=i.xhr=t.ajax(n.extend(o,i));return r.trigger("request",r,a,i),a};var T=typeof window!="undefined"&&!!window.ActiveXObject&&(!window.XMLHttpRequest||!(new XMLHttpRequest).dispatchEvent),N={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var C=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},k=/\((.*?)\)/g,L=/(\(\?)?:\w+/g,A=/\*\w+/g,O=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(C.prototype,f,{initialize:function(){},route:function(e,r,i){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(r)&&(i=r,r=""),i||(i=this[r]);var s=this;return t.history.route(e,function(n){var o=s._extractParameters(e,n);s.execute(i,o),s.trigger.apply(s,["route:"+r].concat(o)),s.trigger("route",r,o),t.history.trigger("route",s,r,o)}),this},execute:function(e,t){e&&e.apply(this,t)},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(!this.routes)return;this.routes=n.result(this,"routes");var e,t=n.keys(this.routes);while((e=t.pop())!=null)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(O,"\\$&").replace(k,"(?:$1)?").replace(L,function(e,t){return t?e:"([^/?]+)"}).replace(A,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var r=e.exec(t).slice(1);return n.map(r,function(e,t){return t===r.length-1?e||null:e?decodeURIComponent(e):null})}});var M=t.History=function(){this.handlers=[],n.bindAll(this,"checkUrl"),typeof window!="undefined"&&(this.location=window.location,this.history=window.history)},_=/^[#\/]|\s+$/g,D=/^\/+|\/+$/g,P=/msie [\w.]+/,H=/\/$/,B=/#.*$/;M.started=!1,n.extend(M.prototype,f,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||!this._wantsHashChange||t){e=decodeURI(this.location.pathname+this.location.search);var n=this.root.replace(H,"");e.indexOf(n)||(e=e.slice(n.length))}else e=this.getHash();return e.replace(_,"")},start:function(e){if(M.started)throw new Error("Backbone.history has already been started");M.started=!0,this.options=n.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var r=this.getFragment(),i=document.documentMode,s=P.exec(navigator.userAgent.toLowerCase())&&(!i||i<=7);this.root=("/"+this.root+"/").replace(D,"/");if(s&&this._wantsHashChange){var o=t.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=o.hide().appendTo("body")[0].contentWindow,this.navigate(r)}this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!s?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=r;var u=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&u.hash&&(this.fragment=this.getHash().replace(_,""),this.history.replaceState({},document.title,this.root+this.fragment))}if(!this.options.silent)return this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),M.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return e=this.fragment=this.getFragment(e),n.any(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0})},navigate:function(e,t){if(!M.started)return!1;if(!t||t===!0)t={trigger:!!t};var n=this.root+(e=this.getFragment(e||""));e=e.replace(B,"");if(this.fragment===e)return;this.fragment=e,e===""&&n!=="/"&&(n=n.slice(0,-1));if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}if(t.trigger)return this.loadUrl(e)},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),t.history=new M;var j=function(e,t){var r=this,i;e&&n.has(e,"constructor")?i=e.constructor:i=function(){return r.apply(this,arguments)},n.extend(i,r,t);var s=function(){this.constructor=i};return s.prototype=r.prototype,i.prototype=new s,e&&n.extend(i.prototype,e),i.__super__=r.prototype,i};d.extend=m.extend=C.extend=E.extend=M.extend=j;var F=function(){throw new Error('A "url" property or function must be specified')},I=function(e,t){var n=t.error;t.error=function(r){n&&n(e,r,t),e.trigger("error",e,r,t)}};return t});var Handlebars=function(){var e=function(){"use strict";function t(e){this.string=e}var e;return t.prototype.toString=function(){return""+this.string},e=t,e}(),t=function(e){"use strict";function o(e){return r[e]||"&amp;"}function u(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}function c(e){return e instanceof n?e.toString():!e&&e!==0?"":(e=""+e,s.test(e)?e.replace(i,o):e)}function h(e){return!e&&e!==0?!0:l(e)&&e.length===0?!0:!1}var t={},n=e,r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},i=/[&<>"'`]/g,s=/[&<>"'`]/;t.extend=u;var a=Object.prototype.toString;t.toString=a;var f=function(e){return typeof e=="function"};f(/x/)&&(f=function(e){return typeof e=="function"&&a.call(e)==="[object Function]"});var f;t.isFunction=f;var l=Array.isArray||function(e){return e&&typeof e=="object"?a.call(e)==="[object Array]":!1};return t.isArray=l,t.escapeExpression=c,t.isEmpty=h,t}(e),n=function(){"use strict";function n(e,n){var r;n&&n.firstLine&&(r=n.firstLine,e+=" - "+r+":"+n.firstColumn);var i=Error.prototype.constructor.call(this,e);for(var s=0;s<t.length;s++)this[t[s]]=i[t[s]];r&&(this.lineNumber=r,this.column=n.firstColumn)}var e,t=["description","fileName","lineNumber","message","name","number","stack"];return n.prototype=new Error,e=n,e}(),r=function(e,t){"use strict";function h(e,t){this.helpers=e||{},this.partials=t||{},p(this)}function p(e){e.registerHelper("helperMissing",function(e){if(arguments.length===2)return undefined;throw new i("Missing helper: '"+e+"'")}),e.registerHelper("blockHelperMissing",function(t,n){var r=n.inverse||function(){},i=n.fn;return f(t)&&(t=t.call(this)),t===!0?i(this):t===!1||t==null?r(this):a(t)?t.length>0?e.helpers.each(t,n):r(this):i(t)}),e.registerHelper("each",function(e,t){var n=t.fn,r=t.inverse,i=0,s="",o;f(e)&&(e=e.call(this)),t.data&&(o=m(t.data));if(e&&typeof e=="object")if(a(e))for(var u=e.length;i<u;i++)o&&(o.index=i,o.first=i===0,o.last=i===e.length-1),s+=n(e[i],{data:o});else for(var l in e)e.hasOwnProperty(l)&&(o&&(o.key=l,o.index=i,o.first=i===0),s+=n(e[l],{data:o}),i++);return i===0&&(s=r(this)),s}),e.registerHelper("if",function(e,t){return f(e)&&(e=e.call(this)),!t.hash.includeZero&&!e||r.isEmpty(e)?t.inverse(this):t.fn(this)}),e.registerHelper("unless",function(t,n){return e.helpers["if"].call(this,t,{fn:n.inverse,inverse:n.fn,hash:n.hash})}),e.registerHelper("with",function(e,t){f(e)&&(e=e.call(this));if(!r.isEmpty(e))return t.fn(e)}),e.registerHelper("log",function(t,n){var r=n.data&&n.data.level!=null?parseInt(n.data.level,10):1;e.log(r,t)})}function v(e,t){d.log(e,t)}var n={},r=e,i=t,s="1.3.0";n.VERSION=s;var o=4;n.COMPILER_REVISION=o;var u={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"};n.REVISION_CHANGES=u;var a=r.isArray,f=r.isFunction,l=r.toString,c="[object Object]";n.HandlebarsEnvironment=h,h.prototype={constructor:h,logger:d,log:v,registerHelper:function(e,t,n){if(l.call(e)===c){if(n||t)throw new i("Arg not supported with multiple helpers");r.extend(this.helpers,e)}else n&&(t.not=n),this.helpers[e]=t},registerPartial:function(e,t){l.call(e)===c?r.extend(this.partials,e):this.partials[e]=t}};var d={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(e,t){if(d.level<=e){var n=d.methodMap[e];typeof console!="undefined"&&console[n]&&console[n].call(console,t)}}};n.logger=d,n.log=v;var m=function(e){var t={};return r.extend(t,e),t};return n.createFrame=m,n}(t,n),i=function(e,t,n){"use strict";function a(e){var t=e&&e[0]||1,n=o;if(t!==n){if(t<n){var r=u[n],i=u[t];throw new s("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+r+") or downgrade your runtime to an older version ("+i+").")}throw new s("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")}}function f(e,t){if(!t)throw new s("No environment passed to template");var n=function(e,n,r,i,o,u){var a=t.VM.invokePartial.apply(this,arguments);if(a!=null)return a;if(t.compile){var f={helpers:i,partials:o,data:u};return o[n]=t.compile(e,{data:u!==undefined},t),o[n](r,f)}throw new s("The partial "+n+" could not be compiled when running in runtime-only mode")},r={escapeExpression:i.escapeExpression,invokePartial:n,programs:[],program:function(e,t,n){var r=this.programs[e];return n?r=c(e,t,n):r||(r=this.programs[e]=c(e,t)),r},merge:function(e,t){var n=e||t;return e&&t&&e!==t&&(n={},i.extend(n,t),i.extend(n,e)),n},programWithDepth:t.VM.programWithDepth,noop:t.VM.noop,compilerInfo:null};return function(n,i){i=i||{};var s=i.partial?i:t,o,u;i.partial||(o=i.helpers,u=i.partials);var a=e.call(r,s,n,o,u,i.data);return i.partial||t.VM.checkRevision(r.compilerInfo),a}}function l(e,t,n){var r=Array.prototype.slice.call(arguments,3),i=function(e,i){return i=i||{},t.apply(this,[e,i.data||n].concat(r))};return i.program=e,i.depth=r.length,i}function c(e,t,n){var r=function(e,r){return r=r||{},t(e,r.data||n)};return r.program=e,r.depth=0,r}function h(e,t,n,r,i,o){var u={partial:!0,helpers:r,partials:i,data:o};if(e===undefined)throw new s("The partial "+t+" could not be found");if(e instanceof Function)return e(n,u)}function p(){return""}var r={},i=e,s=t,o=n.COMPILER_REVISION,u=n.REVISION_CHANGES;return r.checkRevision=a,r.template=f,r.programWithDepth=l,r.program=c,r.invokePartial=h,r.noop=p,r}(t,n,r),s=function(e,t,n,r,i){"use strict";var s,o=e,u=t,a=n,f=r,l=i,c=function(){var e=new o.HandlebarsEnvironment;return f.extend(e,o),e.SafeString=u,e.Exception=a,e.Utils=f,e.VM=l,e.template=function(t){return l.template(t,e)},e},h=c();return h.create=c,s=h,s}(r,e,n,t,i),o=function(e){"use strict";function r(e){e=e||{},this.firstLine=e.first_line,this.firstColumn=e.first_column,this.lastColumn=e.last_column,this.lastLine=e.last_line}var t,n=e,i={ProgramNode:function(e,t,n,s){var o,u;arguments.length===3?(s=n,n=null):arguments.length===2&&(s=t,t=null),r.call(this,s),this.type="program",this.statements=e,this.strip={},n?(u=n[0],u?(o={first_line:u.firstLine,last_line:u.lastLine,last_column:u.lastColumn,first_column:u.firstColumn},this.inverse=new i.ProgramNode(n,t,o)):this.inverse=new i.ProgramNode(n,t),this.strip.right=t.left):t&&(this.strip.left=t.right)},MustacheNode:function(e,t,n,s,o){r.call(this,o),this.type="mustache",this.strip=s;if(n!=null&&n.charAt){var u=n.charAt(3)||n.charAt(2);this.escaped=u!=="{"&&u!=="&"}else this.escaped=!!n;e instanceof i.SexprNode?this.sexpr=e:this.sexpr=new i.SexprNode(e,t),this.sexpr.isRoot=!0,this.id=this.sexpr.id,this.params=this.sexpr.params,this.hash=this.sexpr.hash,this.eligibleHelper=this.sexpr.eligibleHelper,this.isHelper=this.sexpr.isHelper},SexprNode:function(e,t,n){r.call(this,n),this.type="sexpr",this.hash=t;var i=this.id=e[0],s=this.params=e.slice(1),o=this.eligibleHelper=i.isSimple;this.isHelper=o&&(s.length||t)},PartialNode:function(e,t,n,i){r.call(this,i),this.type="partial",this.partialName=e,this.context=t,this.strip=n},BlockNode:function(e,t,i,s,o){r.call(this,o);if(e.sexpr.id.original!==s.path.original)throw new n(e.sexpr.id.original+" doesn't match "+s.path.original,this);this.type="block",this.mustache=e,this.program=t,this.inverse=i,this.strip={left:e.strip.left,right:s.strip.right},(t||i).strip.left=e.strip.right,(i||t).strip.right=s.strip.left,i&&!t&&(this.isInverse=!0)},ContentNode:function(e,t){r.call(this,t),this.type="content",this.string=e},HashNode:function(e,t){r.call(this,t),this.type="hash",this.pairs=e},IdNode:function(e,t){r.call(this,t),this.type="ID";var i="",s=[],o=0;for(var u=0,a=e.length;u<a;u++){var f=e[u].part;i+=(e[u].separator||"")+f;if(f===".."||f==="."||f==="this"){if(s.length>0)throw new n("Invalid path: "+i,this);f===".."?o++:this.isScoped=!0}else s.push(f)}this.original=i,this.parts=s,this.string=s.join("."),this.depth=o,this.isSimple=e.length===1&&!this.isScoped&&o===0,this.stringModeValue=this.string},PartialNameNode:function(e,t){r.call(this,t),this.type="PARTIAL_NAME",this.name=e.original},DataNode:function(e,t){r.call(this,t),this.type="DATA",this.id=e},StringNode:function(e,t){r.call(this,t),this.type="STRING",this.original=this.string=this.stringModeValue=e},IntegerNode:function(e,t){r.call(this,t),this.type="INTEGER",this.original=this.integer=e,this.stringModeValue=Number(e)},BooleanNode:function(e,t){r.call(this,t),this.type="BOOLEAN",this.bool=e,this.stringModeValue=e==="true"},CommentNode:function(e,t){r.call(this,t),this.type="comment",this.comment=e}};return t=i,t}(n),u=function(){"use strict";var e,t=function(){function t(e,t){return{left:e.charAt(2)==="~",right:t.charAt(0)==="~"||t.charAt(1)==="~"}}function r(){this.yy={}}var e={trace:function(){},yy:{},symbols_:{error:2,root:3,statements:4,EOF:5,program:6,simpleInverse:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,sexpr:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,CLOSE_UNESCAPED:24,OPEN_PARTIAL:25,partialName:26,partial_option0:27,sexpr_repetition0:28,sexpr_option0:29,dataName:30,param:31,STRING:32,INTEGER:33,BOOLEAN:34,OPEN_SEXPR:35,CLOSE_SEXPR:36,hash:37,hash_repetition_plus0:38,hashSegment:39,ID:40,EQUALS:41,DATA:42,pathSegments:43,SEP:44,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"CLOSE_UNESCAPED",25:"OPEN_PARTIAL",32:"STRING",33:"INTEGER",34:"BOOLEAN",35:"OPEN_SEXPR",36:"CLOSE_SEXPR",40:"ID",41:"EQUALS",42:"DATA",44:"SEP"},productions_:[0,[3,2],[3,1],[6,2],[6,3],[6,2],[6,1],[6,1],[6,0],[4,1],[4,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,4],[7,2],[17,3],[17,1],[31,1],[31,1],[31,1],[31,1],[31,1],[31,3],[37,1],[39,3],[26,1],[26,1],[26,1],[30,2],[21,1],[43,3],[43,1],[27,0],[27,1],[28,0],[28,2],[29,0],[29,1],[38,1],[38,2]],performAction:function(n,r,i,s,o,u,a){var f=u.length-1;switch(o){case 1:return new s.ProgramNode(u[f-1],this._$);case 2:return new s.ProgramNode([],this._$);case 3:this.$=new s.ProgramNode([],u[f-1],u[f],this._$);break;case 4:this.$=new s.ProgramNode(u[f-2],u[f-1],u[f],this._$);break;case 5:this.$=new s.ProgramNode(u[f-1],u[f],[],this._$);break;case 6:this.$=new s.ProgramNode(u[f],this._$);break;case 7:this.$=new s.ProgramNode([],this._$);break;case 8:this.$=new s.ProgramNode([],this._$);break;case 9:this.$=[u[f]];break;case 10:u[f-1].push(u[f]),this.$=u[f-1];break;case 11:this.$=new s.BlockNode(u[f-2],u[f-1].inverse,u[f-1],u[f],this._$);break;case 12:this.$=new s.BlockNode(u[f-2],u[f-1],u[f-1].inverse,u[f],this._$);break;case 13:this.$=u[f];break;case 14:this.$=u[f];break;case 15:this.$=new s.ContentNode(u[f],this._$);break;case 16:this.$=new s.CommentNode(u[f],this._$);break;case 17:this.$=new s.MustacheNode(u[f-1],null,u[f-2],t(u[f-2],u[f]),this._$);break;case 18:this.$=new s.MustacheNode(u[f-1],null,u[f-2],t(u[f-2],u[f]),this._$);break;case 19:this.$={path:u[f-1],strip:t(u[f-2],u[f])};break;case 20:this.$=new s.MustacheNode(u[f-1],null,u[f-2],t(u[f-2],u[f]),this._$);break;case 21:this.$=new s.MustacheNode(u[f-1],null,u[f-2],t(u[f-2],u[f]),this._$);break;case 22:this.$=new s.PartialNode(u[f-2],u[f-1],t(u[f-3],u[f]),this._$);break;case 23:this.$=t(u[f-1],u[f]);break;case 24:this.$=new s.SexprNode([u[f-2]].concat(u[f-1]),u[f],this._$);break;case 25:this.$=new s.SexprNode([u[f]],null,this._$);break;case 26:this.$=u[f];break;case 27:this.$=new s.StringNode(u[f],this._$);break;case 28:this.$=new s.IntegerNode(u[f],this._$);break;case 29:this.$=new s.BooleanNode(u[f],this._$);break;case 30:this.$=u[f];break;case 31:u[f-1].isHelper=!0,this.$=u[f-1];break;case 32:this.$=new s.HashNode(u[f],this._$);break;case 33:this.$=[u[f-2],u[f]];break;case 34:this.$=new s.PartialNameNode(u[f],this._$);break;case 35:this.$=new s.PartialNameNode(new s.StringNode(u[f],this._$),this._$);break;case 36:this.$=new s.PartialNameNode(new s.IntegerNode(u[f],this._$));break;case 37:this.$=new s.DataNode(u[f],this._$);break;case 38:this.$=new s.IdNode(u[f],this._$);break;case 39:u[f-2].push({part:u[f],separator:u[f-1]}),this.$=u[f-2];break;case 40:this.$=[{part:u[f]}];break;case 43:this.$=[];break;case 44:u[f-1].push(u[f]);break;case 47:this.$=[u[f]];break;case 48:u[f-1].push(u[f])}},table:[{3:1,4:2,5:[1,3],8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],25:[1,15]},{1:[3]},{5:[1,16],8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],25:[1,15]},{1:[2,2]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],25:[2,9]},{4:20,6:18,7:19,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,8],22:[1,13],23:[1,14],25:[1,15]},{4:20,6:22,7:19,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,8],22:[1,13],23:[1,14],25:[1,15]},{5:[2,13],14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],25:[2,13]},{5:[2,14],14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],25:[2,14]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],25:[2,15]},{5:[2,16],14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],25:[2,16]},{17:23,21:24,30:25,40:[1,28],42:[1,27],43:26},{17:29,21:24,30:25,40:[1,28],42:[1,27],43:26},{17:30,21:24,30:25,40:[1,28],42:[1,27],43:26},{17:31,21:24,30:25,40:[1,28],42:[1,27],43:26},{21:33,26:32,32:[1,34],33:[1,35],40:[1,28],43:26},{1:[2,1]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],25:[2,10]},{10:36,20:[1,37]},{4:38,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,7],22:[1,13],23:[1,14],25:[1,15]},{7:39,8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,6],22:[1,13],23:[1,14],25:[1,15]},{17:23,18:[1,40],21:24,30:25,40:[1,28],42:[1,27],43:26},{10:41,20:[1,37]},{18:[1,42]},{18:[2,43],24:[2,43],28:43,32:[2,43],33:[2,43],34:[2,43],35:[2,43],36:[2,43],40:[2,43],42:[2,43]},{18:[2,25],24:[2,25],36:[2,25]},{18:[2,38],24:[2,38],32:[2,38],33:[2,38],34:[2,38],35:[2,38],36:[2,38],40:[2,38],42:[2,38],44:[1,44]},{21:45,40:[1,28],43:26},{18:[2,40],24:[2,40],32:[2,40],33:[2,40],34:[2,40],35:[2,40],36:[2,40],40:[2,40],42:[2,40],44:[2,40]},{18:[1,46]},{18:[1,47]},{24:[1,48]},{18:[2,41],21:50,27:49,40:[1,28],43:26},{18:[2,34],40:[2,34]},{18:[2,35],40:[2,35]},{18:[2,36],40:[2,36]},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],25:[2,11]},{21:51,40:[1,28],43:26},{8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,3],22:[1,13],23:[1,14],25:[1,15]},{4:52,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,5],22:[1,13],23:[1,14],25:[1,15]},{14:[2,23],15:[2,23],16:[2,23],19:[2,23],20:[2,23],22:[2,23],23:[2,23],25:[2,23]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],25:[2,12]},{14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],25:[2,18]},{18:[2,45],21:56,24:[2,45],29:53,30:60,31:54,32:[1,57],33:[1,58],34:[1,59],35:[1,61],36:[2,45],37:55,38:62,39:63,40:[1,64],42:[1,27],43:26},{40:[1,65]},{18:[2,37],24:[2,37],32:[2,37],33:[2,37],34:[2,37],35:[2,37],36:[2,37],40:[2,37],42:[2,37]},{14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],25:[2,17]},{5:[2,20],14:[2,20],15:[2,20],16:[2,20],19:[2,20],20:[2,20],22:[2,20],23:[2,20],25:[2,20]},{5:[2,21],14:[2,21],15:[2,21],16:[2,21],19:[2,21],20:[2,21],22:[2,21],23:[2,21],25:[2,21]},{18:[1,66]},{18:[2,42]},{18:[1,67]},{8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],25:[1,15]},{18:[2,24],24:[2,24],36:[2,24]},{18:[2,44],24:[2,44],32:[2,44],33:[2,44],34:[2,44],35:[2,44],36:[2,44],40:[2,44],42:[2,44]},{18:[2,46],24:[2,46],36:[2,46]},{18:[2,26],24:[2,26],32:[2,26],33:[2,26],34:[2,26],35:[2,26],36:[2,26],40:[2,26],42:[2,26]},{18:[2,27],24:[2,27],32:[2,27],33:[2,27],34:[2,27],35:[2,27],36:[2,27],40:[2,27],42:[2,27]},{18:[2,28],24:[2,28],32:[2,28],33:[2,28],34:[2,28],35:[2,28],36:[2,28],40:[2,28],42:[2,28]},{18:[2,29],24:[2,29],32:[2,29],33:[2,29],34:[2,29],35:[2,29],36:[2,29],40:[2,29],42:[2,29]},{18:[2,30],24:[2,30],32:[2,30],33:[2,30],34:[2,30],35:[2,30],36:[2,30],40:[2,30],42:[2,30]},{17:68,21:24,30:25,40:[1,28],42:[1,27],43:26},{18:[2,32],24:[2,32],36:[2,32],39:69,40:[1,70]},{18:[2,47],24:[2,47],36:[2,47],40:[2,47]},{18:[2,40],24:[2,40],32:[2,40],33:[2,40],34:[2,40],35:[2,40],36:[2,40],40:[2,40],41:[1,71],42:[2,40],44:[2,40]},{18:[2,39],24:[2,39],32:[2,39],33:[2,39],34:[2,39],35:[2,39],36:[2,39],40:[2,39],42:[2,39],44:[2,39]},{5:[2,22],14:[2,22],15:[2,22],16:[2,22],19:[2,22],20:[2,22],22:[2,22],23:[2,22],25:[2,22]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],25:[2,19]},{36:[1,72]},{18:[2,48],24:[2,48],36:[2,48],40:[2,48]},{41:[1,71]},{21:56,30:60,31:73,32:[1,57],33:[1,58],34:[1,59],35:[1,61],40:[1,28],42:[1,27],43:26},{18:[2,31],24:[2,31],32:[2,31],33:[2,31],34:[2,31],35:[2,31],36:[2,31],40:[2,31],42:[2,31]},{18:[2,33],24:[2,33],36:[2,33],40:[2,33]}],defaultActions:{3:[2,2],16:[2,1],50:[2,42]},parseError:function(t,n){throw new Error(t)},parse:function(t){function v(e){r.length=r.length-2*e,i.length=i.length-e,s.length=s.length-e}function m(){var e;return e=n.lexer.lex()||1,typeof e!="number"&&(e=n.symbols_[e]||e),e}var n=this,r=[0],i=[null],s=[],o=this.table,u="",a=0,f=0,l=0,c=2,h=1;this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,typeof this.lexer.yylloc=="undefined"&&(this.lexer.yylloc={});var p=this.lexer.yylloc;s.push(p);var d=this.lexer.options&&this.lexer.options.ranges;typeof this.yy.parseError=="function"&&(this.parseError=this.yy.parseError);var g,y,b,w,E,S,x={},T,N,C,k;for(;;){b=r[r.length-1];if(this.defaultActions[b])w=this.defaultActions[b];else{if(g===null||typeof g=="undefined")g=m();w=o[b]&&o[b][g]}if(typeof w=="undefined"||!w.length||!w[0]){var L="";if(!l){k=[];for(T in o[b])this.terminals_[T]&&T>2&&k.push("'"+this.terminals_[T]+"'");this.lexer.showPosition?L="Parse error on line "+(a+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+k.join(", ")+", got '"+(this.terminals_[g]||g)+"'":L="Parse error on line "+(a+1)+": Unexpected "+(g==1?"end of input":"'"+(this.terminals_[g]||g)+"'"),this.parseError(L,{text:this.lexer.match,token:this.terminals_[g]||g,line:this.lexer.yylineno,loc:p,expected:k})}}if(w[0]instanceof Array&&w.length>1)throw new Error("Parse Error: multiple actions possible at state: "+b+", token: "+g);switch(w[0]){case 1:r.push(g),i.push(this.lexer.yytext),s.push(this.lexer.yylloc),r.push(w[1]),g=null,y?(g=y,y=null):(f=this.lexer.yyleng,u=this.lexer.yytext,a=this.lexer.yylineno,p=this.lexer.yylloc,l>0&&l--);break;case 2:N=this.productions_[w[1]][1],x.$=i[i.length-N],x._$={first_line:s[s.length-(N||1)].first_line,last_line:s[s.length-1].last_line,first_column:s[s.length-(N||1)].first_column,last_column:s[s.length-1].last_column},d&&(x._$.range=[s[s.length-(N||1)].range[0],s[s.length-1].range[1]]),S=this.performAction.call(x,u,f,a,this.yy,w[1],i,s);if(typeof S!="undefined")return S;N&&(r=r.slice(0,-1*N*2),i=i.slice(0,-1*N),s=s.slice(0,-1*N)),r.push(this.productions_[w[1]][0]),i.push(x.$),s.push(x._$),C=o[r[r.length-2]][r[r.length-1]],r.push(C);break;case 3:return!0}}return!0}},n=function(){var e={EOF:1,parseError:function(t,n){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,n)},setInput:function(e){return this._input=e,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);return t?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-t]),this},more:function(){return this._more=!0,this},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=(new Array(e.length+1)).join("-");return e+this.upcomingInput()+"\n"+t+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,n,r,i,s;this._more||(this.yytext="",this.match="");var o=this._currentRules();for(var u=0;u<o.length;u++){n=this._input.match(this.rules[o[u]]);if(n&&(!t||n[0].length>t[0].length)){t=n,r=u;if(!this.options.flex)break}}if(t){s=t[0].match(/(?:\r\n?|\n).*/g),s&&(this.yylineno+=s.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:s?s[s.length-1].length-s[s.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],e=this.performAction.call(this,this.yy,this,o[r],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1);if(e)return e;return}return this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return typeof t!="undefined"?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(t){this.begin(t)}};return e.options={},e.performAction=function(t,n,r,i){function s(e,t){return n.yytext=n.yytext.substr(e,n.yyleng-t)}var o=i;switch(r){case 0:n.yytext.slice(-2)==="\\\\"?(s(0,1),this.begin("mu")):n.yytext.slice(-1)==="\\"?(s(0,1),this.begin("emu")):this.begin("mu");if(n.yytext)return 14;break;case 1:return 14;case 2:return this.popState(),14;case 3:return s(0,4),this.popState(),15;case 4:return 35;case 5:return 36;case 6:return 25;case 7:return 16;case 8:return 20;case 9:return 19;case 10:return 19;case 11:return 23;case 12:return 22;case 13:this.popState(),this.begin("com");break;case 14:return s(3,5),this.popState(),15;case 15:return 22;case 16:return 41;case 17:return 40;case 18:return 40;case 19:return 44;case 20:break;case 21:return this.popState(),24;case 22:return this.popState(),18;case 23:return n.yytext=s(1,2).replace(/\\"/g,'"'),32;case 24:return n.yytext=s(1,2).replace(/\\'/g,"'"),32;case 25:return 42;case 26:return 34;case 27:return 34;case 28:return 33;case 29:return 40;case 30:return n.yytext=s(1,2),40;case 31:return"INVALID";case 32:return 5}},e.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:[\s\S]*?--\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{!--)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{(~)?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:-?[0-9]+(?=([~}\s)])))/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],e.conditions={mu:{rules:[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[3],inclusive:!1},INITIAL:{rules:[0,1,32],inclusive:!0}},e}();return e.lexer=n,r.prototype=e,e.Parser=r,new r}();return e=t,e}(),a=function(e,t){"use strict";function s(e){return e.constructor===i.ProgramNode?e:(r.yy=i,r.parse(e))}var n={},r=e,i=t;return n.parser=r,n.parse=s,n}(u,o),f=function(e){"use strict";function r(){}function i(e,t,r){if(e==null||typeof e!="string"&&e.constructor!==r.AST.ProgramNode)throw new n("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+e);t=t||{},"data"in t||(t.data=!0);var i=r.parse(e),s=(new r.Compiler).compile(i,t);return(new r.JavaScriptCompiler).compile(s,t)}function s(e,t,r){function s(){var n=r.parse(e),i=(new r.Compiler).compile(n,t),s=(new r.JavaScriptCompiler).compile(i,t,undefined,!0);return r.template(s)}if(e==null||typeof e!="string"&&e.constructor!==r.AST.ProgramNode)throw new n("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+e);t=t||{},"data"in t||(t.data=!0);var i;return function(e,t){return i||(i=s()),i.call(this,e,t)}}var t={},n=e;return t.Compiler=r,r.prototype={compiler:r,disassemble:function(){var e=this.opcodes,t,n=[],r,i;for(var s=0,o=e.length;s<o;s++){t=e[s];if(t.opcode==="DECLARE")n.push("DECLARE "+t.name+"="+t.value);else{r=[];for(var u=0;u<t.args.length;u++)i=t.args[u],typeof i=="string"&&(i='"'+i.replace("\n","\\n")+'"'),r.push(i);n.push(t.opcode+" "+r.join(" "))}}return n.join("\n")},equals:function(e){var t=this.opcodes.length;if(e.opcodes.length!==t)return!1;for(var n=0;n<t;n++){var r=this.opcodes[n],i=e.opcodes[n];if(r.opcode!==i.opcode||r.args.length!==i.args.length)return!1;for(var s=0;s<r.args.length;s++)if(r.args[s]!==i.args[s])return!1}t=this.children.length;if(e.children.length!==t)return!1;for(n=0;n<t;n++)if(!this.children[n].equals(e.children[n]))return!1;return!0},guid:0,compile:function(e,t){this.opcodes=[],this.children=[],this.depths={list:[]},this.options=t;var n=this.options.knownHelpers;this.options.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0};if(n)for(var r in n)this.options.knownHelpers[r]=n[r];return this.accept(e)},accept:function(e){var t=e.strip||{},n;return t.left&&this.opcode("strip"),n=this[e.type](e),t.right&&this.opcode("strip"),n},program:function(e){var t=e.statements;for(var n=0,r=t.length;n<r;n++)this.accept(t[n]);return this.isSimple=r===1,this.depths.list=this.depths.list.sort(function(e,t){return e-t}),this},compileProgram:function(e){var t=(new this.compiler).compile(e,this.options),n=this.guid++,r;this.usePartial=this.usePartial||t.usePartial,this.children[n]=t;for(var i=0,s=t.depths.list.length;i<s;i++){r=t.depths.list[i];if(r<2)continue;this.addDepth(r-1)}return n},block:function(e){var t=e.mustache,n=e.program,r=e.inverse;n&&(n=this.compileProgram(n)),r&&(r=this.compileProgram(r));var i=t.sexpr,s=this.classifySexpr(i);s==="helper"?this.helperSexpr(i,n,r):s==="simple"?(this.simpleSexpr(i),this.opcode("pushProgram",n),this.opcode("pushProgram",r),this.opcode("emptyHash"),this.opcode("blockValue")):(this.ambiguousSexpr(i,n,r),this.opcode("pushProgram",n),this.opcode("pushProgram",r),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},hash:function(e){var t=e.pairs,n,r;this.opcode("pushHash");for(var i=0,s=t.length;i<s;i++)n=t[i],r=n[1],this.options.stringParams?(r.depth&&this.addDepth(r.depth),this.opcode("getContext",r.depth||0),this.opcode("pushStringParam",r.stringModeValue,r.type),r.type==="sexpr"&&this.sexpr(r)):this.accept(r),this.opcode("assignToHash",n[0]);this.opcode("popHash")},partial:function(e){var t=e.partialName;this.usePartial=!0,e.context?this.ID(e.context):this.opcode("push","depth0"),this.opcode("invokePartial",t.name),this.opcode("append")},content:function(e){this.opcode("appendContent",e.string)},mustache:function(e){this.sexpr(e.sexpr),e.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},ambiguousSexpr:function(e,t,n){var r=e.id,i=r.parts[0],s=t!=null||n!=null;this.opcode("getContext",r.depth),this.opcode("pushProgram",t),this.opcode("pushProgram",n),this.opcode("invokeAmbiguous",i,s)},simpleSexpr:function(e){var t=e.id;t.type==="DATA"?this.DATA(t):t.parts.length?this.ID(t):(this.addDepth(t.depth),this.opcode("getContext",t.depth),this.opcode("pushContext")),this.opcode("resolvePossibleLambda")},helperSexpr:function(e,t,r){var i=this.setupFullMustacheParams(e,t,r),s=e.id.parts[0];if(this.options.knownHelpers[s])this.opcode("invokeKnownHelper",i.length,s);else{if(this.options.knownHelpersOnly)throw new n("You specified knownHelpersOnly, but used the unknown helper "+s,e);this.opcode("invokeHelper",i.length,s,e.isRoot)}},sexpr:function(e){var t=this.classifySexpr(e);t==="simple"?this.simpleSexpr(e):t==="helper"?this.helperSexpr(e):this.ambiguousSexpr(e)},ID:function(e){this.addDepth(e.depth),this.opcode("getContext",e.depth);var t=e.parts[0];t?this.opcode("lookupOnContext",e.parts[0]):this.opcode("pushContext");for(var n=1,r=e.parts.length;n<r;n++)this.opcode("lookup",e.parts[n])},DATA:function(e){this.options.data=!0;if(e.id.isScoped||e.id.depth)throw new n("Scoped data references are not supported: "+e.original,e);this.opcode("lookupData");var t=e.id.parts;for(var r=0,i=t.length;r<i;r++)this.opcode("lookup",t[r])},STRING:function(e){this.opcode("pushString",e.string)},INTEGER:function(e){this.opcode("pushLiteral",e.integer)},BOOLEAN:function(e){this.opcode("pushLiteral",e.bool)},comment:function(){},opcode:function(e){this.opcodes.push({opcode:e,args:[].slice.call(arguments,1)})},declare:function(e,t){this.opcodes.push({opcode:"DECLARE",name:e,value:t})},addDepth:function(e){if(e===0)return;this.depths[e]||(this.depths[e]=!0,this.depths.list.push(e))},classifySexpr:function(e){var t=e.isHelper,n=e.eligibleHelper,r=this.options;if(n&&!t){var i=e.id.parts[0];r.knownHelpers[i]?t=!0:r.knownHelpersOnly&&(n=!1)}return t?"helper":n?"ambiguous":"simple"},pushParams:function(e){var t=e.length,n;while(t--)n=e[t],this.options.stringParams?(n.depth&&this.addDepth(n.depth),this.opcode("getContext",n.depth||0),this.opcode("pushStringParam",n.stringModeValue,n.type),n.type==="sexpr"&&this.sexpr(n)):this[n.type](n)},setupFullMustacheParams:function(e,t,n){var r=e.params;return this.pushParams(r),this.opcode("pushProgram",t),this.opcode("pushProgram",n),e.hash?this.hash(e.hash):this.opcode("emptyHash"),r}},t.precompile=i,t.compile=s,t}(n),l=function(e,t){"use strict";function u(e){this.value=e}function a(){}var n,r=e.COMPILER_REVISION,i=e.REVISION_CHANGES,s=e.log,o=t;a.prototype={nameLookup:function(e,t){var n,r;return e.indexOf("depth")===0&&(n=!0),/^[0-9]+$/.test(t)?r=e+"["+t+"]":a.isValidJavaScriptVariableName(t)?r=e+"."+t:r=e+"['"+t+"']",n?"("+e+" && "+r+")":r},compilerInfo:function(){var e=r,t=i[e];return"this.compilerInfo = ["+e+",'"+t+"'];\n"},appendToBuffer:function(e){return this.environment.isSimple?"return "+e+";":{appendToBuffer:!0,content:e,toString:function(){return"buffer += "+e+";"}}},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(e,t,n,r){this.environment=e,this.options=t||{},s("debug",this.environment.disassemble()+"\n\n"),this.name=this.environment.name,this.isChild=!!n,this.context=n||{programs:[],environments:[],aliases:{}},this.preamble(),this.stackSlot=0,this.stackVars=[],this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.compileChildren(e,t);var i=e.opcodes,u;this.i=0;for(var a=i.length;this.i<a;this.i++)u=i[this.i],u.opcode==="DECLARE"?this[u.name]=u.value:this[u.opcode].apply(this,u.args),u.opcode!==this.stripNext&&(this.stripNext=!1);this.pushSource("");if(this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new o("Compile completed with content left on stack");return this.createFunctionContext(r)},preamble:function(){var e=[];if(!this.isChild){var t=this.namespace,n="helpers = this.merge(helpers, "+t+".helpers);";this.environment.usePartial&&(n=n+" partials = this.merge(partials, "+t+".partials);"),this.options.data&&(n+=" data = data || {};"),e.push(n)}else e.push("");this.environment.isSimple?e.push(""):e.push(", buffer = "+this.initializeBuffer()),this.lastContext=0,this.source=e},createFunctionContext:function(e){var t=this.stackVars.concat(this.registers.list);t.length>0&&(this.source[1]=this.source[1]+", "+t.join(", "));if(!this.isChild)for(var n in this.context.aliases)this.context.aliases.hasOwnProperty(n)&&(this.source[1]=this.source[1]+", "+n+"="+this.context.aliases[n]);this.source[1]&&(this.source[1]="var "+this.source[1].substring(2)+";"),this.isChild||(this.source[1]+="\n"+this.context.programs.join("\n")+"\n"),this.environment.isSimple||this.pushSource("return buffer;");var r=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"];for(var i=0,o=this.environment.depths.list.length;i<o;i++)r.push("depth"+this.environment.depths.list[i]);var u=this.mergeSource();this.isChild||(u=this.compilerInfo()+u);if(e)return r.push(u),Function.apply(this,r);var a="function "+(this.name||"")+"("+r.join(",")+") {\n  "+u+"}";return s("debug",a+"\n\n"),a},mergeSource:function(){var e="",t;for(var n=0,r=this.source.length;n<r;n++){var i=this.source[n];i.appendToBuffer?t?t=t+"\n    + "+i.content:t=i.content:(t&&(e+="buffer += "+t+";\n  ",t=undefined),e+=i+"\n  ")}return e},blockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var e=["depth0"];this.setupParams(0,e),this.replaceStack(function(t){return e.splice(1,0,t),"blockHelperMissing.call("+e.join(", ")+")"})},ambiguousBlockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var e=["depth0"];this.setupParams(0,e);var t=this.topStack();e.splice(1,0,t),this.pushSource("if (!"+this.lastHelper+") { "+t+" = blockHelperMissing.call("+e.join(", ")+"); }")},appendContent:function(e){this.pendingContent&&(e=this.pendingContent+e),this.stripNext&&(e=e.replace(/^\s+/,"")),this.pendingContent=e},strip:function(){this.pendingContent&&(this.pendingContent=this.pendingContent.replace(/\s+$/,"")),this.stripNext="strip"},append:function(){this.flushInline();var e=this.popStack();this.pushSource("if("+e+" || "+e+" === 0) { "+this.appendToBuffer(e)+" }"),this.environment.isSimple&&this.pushSource("else { "+this.appendToBuffer("''")+" }")},appendEscaped:function(){this.context.aliases.escapeExpression="this.escapeExpression",this.pushSource(this.appendToBuffer("escapeExpression("+this.popStack()+")"))},getContext:function(e){this.lastContext!==e&&(this.lastContext=e)},lookupOnContext:function(e){this.push(this.nameLookup("depth"+this.lastContext,e,"context"))},pushContext:function(){this.pushStackLiteral("depth"+this.lastContext)},resolvePossibleLambda:function(){this.context.aliases.functionType='"function"',this.replaceStack(function(e){return"typeof "+e+" === functionType ? "+e+".apply(depth0) : "+e})},lookup:function(e){this.replaceStack(function(t){return t+" == null || "+t+" === false ? "+t+" : "+this.nameLookup(t,e,"context")})},lookupData:function(){this.pushStackLiteral("data")},pushStringParam:function(e,t){this.pushStackLiteral("depth"+this.lastContext),this.pushString(t),t!=="sexpr"&&(typeof e=="string"?this.pushString(e):this.pushStackLiteral(e))},emptyHash:function(){this.pushStackLiteral("{}"),this.options.stringParams&&(this.push("{}"),this.push("{}"))},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:[],types:[],contexts:[]}},popHash:function(){var e=this.hash;this.hash=this.hashes.pop(),this.options.stringParams&&(this.push("{"+e.contexts.join(",")+"}"),this.push("{"+e.types.join(",")+"}")),this.push("{\n    "+e.values.join(",\n    ")+"\n  }")},pushString:function(e){this.pushStackLiteral(this.quotedString(e))},push:function(e){return this.inlineStack.push(e),e},pushLiteral:function(e){this.pushStackLiteral(e)},pushProgram:function(e){e!=null?this.pushStackLiteral(this.programExpression(e)):this.pushStackLiteral(null)},invokeHelper:function(e,t,n){this.context.aliases.helperMissing="helpers.helperMissing",this.useRegister("helper");var r=this.lastHelper=this.setupHelper(e,t,!0),i=this.nameLookup("depth"+this.lastContext,t,"context"),s="helper = "+r.name+" || "+i;r.paramsInit&&(s+=","+r.paramsInit),this.push("("+s+",helper "+"? helper.call("+r.callParams+") "+": helperMissing.call("+r.helperMissingParams+"))"),n||this.flushInline()},invokeKnownHelper:function(e,t){var n=this.setupHelper(e,t);this.push(n.name+".call("+n.callParams+")")},invokeAmbiguous:function(e,t){this.context.aliases.functionType='"function"',this.useRegister("helper"),this.emptyHash();var n=this.setupHelper(0,e,t),r=this.lastHelper=this.nameLookup("helpers",e,"helper"),i=this.nameLookup("depth"+this.lastContext,e,"context"),s=this.nextStack();n.paramsInit&&this.pushSource(n.paramsInit),this.pushSource("if (helper = "+r+") { "+s+" = helper.call("+n.callParams+"); }"),this.pushSource("else { helper = "+i+"; "+s+" = typeof helper === functionType ? helper.call("+n.callParams+") : helper; }")},invokePartial:function(e){var t=[this.nameLookup("partials",e,"partial"),"'"+e+"'",this.popStack(),"helpers","partials"];this.options.data&&t.push("data"),this.context.aliases.self="this",this.push("self.invokePartial("+t.join(", ")+")")},assignToHash:function(e){var t=this.popStack(),n,r;this.options.stringParams&&(r=this.popStack(),n=this.popStack());var i=this.hash;n&&i.contexts.push("'"+e+"': "+n),r&&i.types.push("'"+e+"': "+r),i.values.push("'"+e+"': ("+t+")")},compiler:a,compileChildren:function(e,t){var n=e.children,r,i;for(var s=0,o=n.length;s<o;s++){r=n[s],i=new this.compiler;var u=this.matchExistingProgram(r);u==null?(this.context.programs.push(""),u=this.context.programs.length,r.index=u,r.name="program"+u,this.context.programs[u]=i.compile(r,t,this.context),this.context.environments[u]=r):(r.index=u,r.name="program"+u)}},matchExistingProgram:function(e){for(var t=0,n=this.context.environments.length;t<n;t++){var r=this.context.environments[t];if(r&&r.equals(e))return t}},programExpression:function(e){this.context.aliases.self="this";if(e==null)return"self.noop";var t=this.environment.children[e],n=t.depths.list,r,i=[t.index,t.name,"data"];for(var s=0,o=n.length;s<o;s++)r=n[s],r===1?i.push("depth0"):i.push("depth"+(r-1));return(n.length===0?"self.program(":"self.programWithDepth(")+i.join(", ")+")"},register:function(e,t){this.useRegister(e),this.pushSource(e+" = "+t+";")},useRegister:function(e){this.registers[e]||(this.registers[e]=!0,this.registers.list.push(e))},pushStackLiteral:function(e){return this.push(new u(e))},pushSource:function(e){this.pendingContent&&(this.source.push(this.appendToBuffer(this.quotedString(this.pendingContent))),this.pendingContent=undefined),e&&this.source.push(e)},pushStack:function(e){this.flushInline();var t=this.incrStack();return e&&this.pushSource(t+" = "+e+";"),this.compileStack.push(t),t},replaceStack:function(e){var t="",n=this.isInline(),r,i,s;if(n){var o=this.popStack(!0);if(o instanceof u)r=o.value,s=!0;else{i=!this.stackSlot;var a=i?this.incrStack():this.topStackName();t="("+this.push(a)+" = "+o+"),",r=this.topStack()}}else r=this.topStack();var f=e.call(this,r);return n?(s||this.popStack(),i&&this.stackSlot--,this.push("("+t+f+")")):(/^stack/.test(r)||(r=this.nextStack()),this.pushSource(r+" = ("+t+f+");")),r},nextStack:function(){return this.pushStack()},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var e=this.inlineStack;if(e.length){this.inlineStack=[];for(var t=0,n=e.length;t<n;t++){var r=e[t];r instanceof u?this.compileStack.push(r):this.pushStack(r)}}},isInline:function(){return this.inlineStack.length},popStack:function(e){var t=this.isInline(),n=(t?this.inlineStack:this.compileStack).pop();if(!e&&n instanceof u)return n.value;if(!t){if(!this.stackSlot)throw new o("Invalid stack pop");this.stackSlot--}return n},topStack:function(e){var t=this.isInline()?this.inlineStack:this.compileStack,n=t[t.length-1];return!e&&n instanceof u?n.value:n},quotedString:function(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},setupHelper:function(e,t,n){var r=[],i=this.setupParams(e,r,n),s=this.nameLookup("helpers",t,"helper");return{params:r,paramsInit:i,name:s,callParams:["depth0"].concat(r).join(", "),helperMissingParams:n&&["depth0",this.quotedString(t)].concat(r).join(", ")}},setupOptions:function(e,t){var n=[],r=[],i=[],s,o,u;n.push("hash:"+this.popStack()),this.options.stringParams&&(n.push("hashTypes:"+this.popStack()),n.push("hashContexts:"+this.popStack())),o=this.popStack(),u=this.popStack();if(u||o)u||(this.context.aliases.self="this",u="self.noop"),o||(this.context.aliases.self="this",o="self.noop"),n.push("inverse:"+o),n.push("fn:"+u);for(var a=0;a<e;a++)s=this.popStack(),t.push(s),this.options.stringParams&&(i.push(this.popStack()),r.push(this.popStack()));return this.options.stringParams&&(n.push("contexts:["+r.join(",")+"]"),n.push("types:["+i.join(",")+"]")),this.options.data&&n.push("data:data"),n},setupParams:function(e,t,n){var r="{"+this.setupOptions(e,t).join(",")+"}";return n?(this.useRegister("options"),t.push("options"),"options="+r):(t.push(r),"")}};var f="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "),l=a.RESERVED_WORDS={};for(var c=0,h=f.length;c<h;c++)l[f[c]]=!0;return a.isValidJavaScriptVariableName=function(e){return!a.RESERVED_WORDS[e]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(e)?!0:!1},n=a,n}(r,n),c=function(e,t,n,r,i){"use strict";var s,o=e,u=t,a=n.parser,f=n.parse,l=r.Compiler,c=r.compile,h=r.precompile,p=i,d=o.create,v=function(){var e=d();return e.compile=function(t,n){return c(t,n,e)},e.precompile=function(t,n){return h(t,n,e)},e.AST=u,e.Compiler=l,e.JavaScriptCompiler=p,e.Parser=a,e.parse=f,e};return o=v(),o.create=v,s=o,s}(s,o,a,f,l);return c}();define("handlebars",function(e){return function(){var t,n;return t||e.Handlebars}}(this)),function(e,t){typeof exports=="object"?module.exports=t():typeof define=="function"&&define.amd?define("spin",t):e.Spinner=t()}(this,function(){"use strict";function r(e,t){var n=document.createElement(e||"div"),r;for(r in t)n[r]=t[r];return n}function i(e){for(var t=1,n=arguments.length;t<n;t++)e.appendChild(arguments[t]);return e}function o(e,r,i,o){var u=["opacity",r,~~(e*100),i,o].join("-"),a=.01+i/o*100,f=Math.max(1-(1-e)/r*(100-a),e),l=n.substring(0,n.indexOf("Animation")).toLowerCase(),c=l&&"-"+l+"-"||"";return t[u]||(s.insertRule("@"+c+"keyframes "+u+"{"+"0%{opacity:"+f+"}"+a+"%{opacity:"+e+"}"+(a+.01)+"%{opacity:1}"+(a+r)%100+"%{opacity:"+e+"}"+"100%{opacity:"+f+"}"+"}",s.cssRules.length),t[u]=1),u}function u(t,n){var r=t.style,i,s;n=n.charAt(0).toUpperCase()+n.slice(1);for(s=0;s<e.length;s++){i=e[s]+n;if(r[i]!==undefined)return i}if(r[n]!==undefined)return n}function a(e,t){for(var n in t)e.style[u(e,n)||n]=t[n];return e}function f(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]===undefined&&(e[r]=n[r])}return e}function l(e){var t={x:e.offsetLeft,y:e.offsetTop};while(e=e.offsetParent)t.x+=e.offsetLeft,t.y+=e.offsetTop;return t}function c(e,t){return typeof e=="string"?e:e[t%e.length]}function p(e){this.opts=f(e||{},p.defaults,h)}function d(){function e(e,t){return r("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',t)}s.addRule(".spin-vml","behavior:url(#default#VML)"),p.prototype.lines=function(t,n){function o(){return a(e("group",{coordsize:s+" "+s,coordorigin:-r+" "+ -r}),{width:s,height:s})}function h(t,s,u){i(f,i(a(o(),{rotation:360/n.lines*t+"deg",left:~~s}),i(a(e("roundrect",{arcsize:n.corners}),{width:r,height:n.width,left:n.radius,top:-n.width>>1,filter:u}),e("fill",{color:c(n.color,t),opacity:n.opacity}),e("stroke",{opacity:0}))))}var r=n.length+n.width,s=2*r,u=-(n.width+n.length)*2+"px",f=a(o(),{position:"absolute",top:u,left:u}),l;if(n.shadow)for(l=1;l<=n.lines;l++)h(l,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(l=1;l<=n.lines;l++)h(l);return i(t,f)},p.prototype.opacity=function(e,t,n,r){var i=e.firstChild;r=r.shadow&&r.lines||0,i&&t+r<i.childNodes.length&&(i=i.childNodes[t+r],i=i&&i.firstChild,i=i&&i.firstChild,i&&(i.opacity=n))}}var e=["webkit","Moz","ms","O"],t={},n,s=function(){var e=r("style",{type:"text/css"});return i(document.getElementsByTagName("head")[0],e),e.sheet||e.styleSheet}(),h={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",position:"absolute"};p.defaults={},f(p.prototype,{spin:function(e){this.stop();var t=this,i=t.opts,s=t.el=a(r(0,{className:i.className}),{position:i.position,width:0,zIndex:i.zIndex}),o=i.radius+i.length+i.width;e&&(e.insertBefore(s,e.firstChild||null),a(s,{left:i.left,top:i.top})),s.setAttribute("role","progressbar"),t.lines(s,t.opts);if(!n){var u=0,f=(i.lines-1)*(1-i.direction)/2,l,c=i.fps,h=c/i.speed,p=(1-i.opacity)/(h*i.trail/100),d=h/i.lines;(function v(){u++;for(var e=0;e<i.lines;e++)l=Math.max(1-(u+(i.lines-e)*d)%h*p,i.opacity),t.opacity(s,e*i.direction+f,l,i);t.timeout=t.el&&setTimeout(v,~~(1e3/c))})()}return t},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=undefined),this},lines:function(e,t){function l(e,n){return a(r(),{position:"absolute",width:t.length+t.width+"px",height:t.width+"px",background:e,boxShadow:n,transformOrigin:"left",transform:"rotate("+~~(360/t.lines*s+t.rotate)+"deg) translate("+t.radius+"px"+",0)",borderRadius:(t.corners*t.width>>1)+"px"})}var s=0,u=(t.lines-1)*(1-t.direction)/2,f;for(;s<t.lines;s++)f=a(r(),{position:"absolute",top:1+~(t.width/2)+"px",transform:t.hwaccel?"translate3d(0,0,0)":"",opacity:t.opacity,animation:n&&o(t.opacity,t.trail,u+s*t.direction,t.lines)+" "+1/t.speed+"s linear infinite"}),t.shadow&&i(f,a(l("#000","0 0 4px #000"),{top:"2px"})),i(e,i(f,l(c(t.color,s),"0 0 1px rgba(0,0,0,.1)")));return e},opacity:function(e,t,n){t<e.childNodes.length&&(e.childNodes[t].style.opacity=n)}});var v=a(r("group"),{behavior:"url(#default#VML)"});return!u(v,"transform")&&v.adj?d():n=u(v,"animation"),p}),"use strict",define("views/spin",["backbone","spin"],function(e,t){var n=e.View.extend({el:"#spinView",options:{lines:11,length:10,width:2,radius:10,corners:1,rotate:0,direction:1,color:"#fff",speed:1.3,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"0",left:"0"},initialize:function(){this.spinner=new t(this.options),e.Events.on("spinner:start",this.start,this),e.Events.on("spinner:stop",this.stop,this)},start:function(){this.spinner.spin(this.el)},stop:function(){this.spinner.stop()}});return n}),function(){var root=this,__prev={jQuery:root.jQuery,$:root.$,L:root.L,Mustache:root.Mustache,Backbone:root.Backbone,_:root._};(function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=i.toString,l=i.hasOwnProperty,c=r.forEach,h=r.map,p=r.reduce,d=r.reduceRight,v=r.filter,m=r.every,g=r.some,y=r.indexOf,b=r.lastIndexOf,w=Array.isArray,E=Object.keys,S=s.bind,x=function(e){return e instanceof x?e:this instanceof x?(this._wrapped=e,void 0):new x(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):e._=x,x.VERSION="1.4.4";var T=x.each=x.forEach=function(e,t,r){if(null!=e)if(c&&e.forEach===c)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;s>i;i++)if(t.call(r,e[i],i,e)===n)return}else for(var o in e)if(x.has(e,o)&&t.call(r,e[o],o,e)===n)return};x.map=x.collect=function(e,t,n){var r=[];return null==e?r:h&&e.map===h?e.map(t,n):(T(e,function(e,i,s){r[r.length]=t.call(n,e,i,s)}),r)};var N="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return r&&(t=x.bind(t,r)),i?e.reduce(t,n):e.reduce(t);if(T(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)}),!i)throw new TypeError(N);return n},x.reduceRight=x.foldr=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),d&&e.reduceRight===d)return r&&(t=x.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=x.keys(e);s=o.length}if(T(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)}),!i)throw new TypeError(N);return n},x.find=x.detect=function(e,t,n){var r;return C(e,function(e,i,s){return t.call(n,e,i,s)?(r=e,!0):void 0}),r},x.filter=x.select=function(e,t,n){var r=[];return null==e?r:v&&e.filter===v?e.filter(t,n):(T(e,function(e,i,s){t.call(n,e,i,s)&&(r[r.length]=e)}),r)},x.reject=function(e,t,n){return x.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},x.every=x.all=function(e,t,r){t||(t=x.identity);var i=!0;return null==e?i:m&&e.every===m?e.every(t,r):(T(e,function(e,s,o){return(i=i&&t.call(r,e,s,o))?void 0:n}),!!i)};var C=x.some=x.any=function(e,t,r){t||(t=x.identity);var i=!1;return null==e?i:g&&e.some===g?e.some(t,r):(T(e,function(e,s,o){return i||(i=t.call(r,e,s,o))?n:void 0}),!!i)};x.contains=x.include=function(e,t){return null==e?!1:y&&e.indexOf===y?e.indexOf(t)!=-1:C(e,function(e){return e===t})},x.invoke=function(e,t){var n=u.call(arguments,2),r=x.isFunction(t);return x.map(e,function(e){return(r?t:e[t]).apply(e,n)})},x.pluck=function(e,t){return x.map(e,function(e){return e[t]})},x.where=function(e,t,n){return x.isEmpty(t)?n?null:[]:x[n?"find":"filter"](e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},x.findWhere=function(e,t){return x.where(e,t,!0)},x.max=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&65535>e.length)return Math.max.apply(Math,e);if(!t&&x.isEmpty(e))return-1/0;var r={computed:-1/0,value:-1/0};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>=r.computed&&(r={value:e,computed:o})}),r.value},x.min=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&65535>e.length)return Math.min.apply(Math,e);if(!t&&x.isEmpty(e))return 1/0;var r={computed:1/0,value:1/0};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;r.computed>o&&(r={value:e,computed:o})}),r.value},x.shuffle=function(e){var t,n=0,r=[];return T(e,function(e){t=x.random(n++),r[n-1]=r[t],r[t]=e}),r};var k=function(e){return x.isFunction(e)?e:function(t){return t[e]}};x.sortBy=function(e,t,n){var r=k(t);return x.pluck(x.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(r>n||r===void 0)return-1}return e.index<t.index?-1:1}),"value")};var L=function(e,t,n,r){var i={},s=k(t||x.identity);return T(e,function(t,o){var u=s.call(n,t,o,e);r(i,u,t)}),i};x.groupBy=function(e,t,n){return L(e,t,n,function(e,t,n){(x.has(e,t)?e[t]:e[t]=[]).push(n)})},x.countBy=function(e,t,n){return L(e,t,n,function(e,t){x.has(e,t)||(e[t]=0),e[t]++})},x.sortedIndex=function(e,t,n,r){n=null==n?x.identity:k(n);for(var i=n.call(r,t),s=0,o=e.length;o>s;){var u=s+o>>>1;i>n.call(r,e[u])?s=u+1:o=u}return s},x.toArray=function(e){return e?x.isArray(e)?u.call(e):e.length===+e.length?x.map(e,x.identity):x.values(e):[]},x.size=function(e){return null==e?0:e.length===+e.length?e.length:x.keys(e).length},x.first=x.head=x.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:u.call(e,0,t)},x.initial=function(e,t,n){return u.call(e,0,e.length-(null==t||n?1:t))},x.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:u.call(e,Math.max(e.length-t,0))},x.rest=x.tail=x.drop=function(e,t,n){return u.call(e,null==t||n?1:t)},x.compact=function(e){return x.filter(e,x.identity)};var A=function(e,t,n){return T(e,function(e){x.isArray(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n};x.flatten=function(e,t){return A(e,t,[])},x.without=function(e){return x.difference(e,u.call(arguments,1))},x.uniq=x.unique=function(e,t,n,r){x.isFunction(t)&&(r=n,n=t,t=!1);var i=n?x.map(e,n,r):e,s=[],o=[];return T(i,function(n,r){(t?r&&o[o.length-1]===n:x.contains(o,n))||(o.push(n),s.push(e[r]))}),s},x.union=function(){return x.uniq(a.apply(r,arguments))},x.intersection=function(e){var t=u.call(arguments,1);return x.filter(x.uniq(e),function(e){return x.every(t,function(t){return x.indexOf(t,e)>=0})})},x.difference=function(e){var t=a.apply(r,u.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})},x.zip=function(){for(var e=u.call(arguments),t=x.max(x.pluck(e,"length")),n=Array(t),r=0;t>r;r++)n[r]=x.pluck(e,""+r);return n},x.object=function(e,t){if(null==e)return{};for(var n={},r=0,i=e.length;i>r;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},x.indexOf=function(e,t,n){if(null==e)return-1;var r=0,i=e.length;if(n){if("number"!=typeof n)return r=x.sortedIndex(e,t),e[r]===t?r:-1;r=0>n?Math.max(0,i+n):n}if(y&&e.indexOf===y)return e.indexOf(t,n);for(;i>r;r++)if(e[r]===t)return r;return-1},x.lastIndexOf=function(e,t,n){if(null==e)return-1;var r=null!=n;if(b&&e.lastIndexOf===b)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var i=r?n:e.length;i--;)if(e[i]===t)return i;return-1},x.range=function(e,t,n){1>=arguments.length&&(t=e||0,e=0),n=arguments[2]||1;for(var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=Array(r);r>i;)s[i++]=e,e+=n;return s},x.bind=function(e,t){if(e.bind===S&&S)return S.apply(e,u.call(arguments,1));var n=u.call(arguments,2);return function(){return e.apply(t,n.concat(u.call(arguments)))}},x.partial=function(e){var t=u.call(arguments,1);return function(){return e.apply(this,t.concat(u.call(arguments)))}},x.bindAll=function(e){var t=u.call(arguments,1);return 0===t.length&&(t=x.functions(e)),T(t,function(t){e[t]=x.bind(e[t],e)}),e},x.memoize=function(e,t){var n={};return t||(t=x.identity),function(){var r=t.apply(this,arguments);return x.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},x.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},x.defer=function(e){return x.delay.apply(x,[e,1].concat(u.call(arguments,1)))},x.throttle=function(e,t){var n,r,i,s,o=0,u=function(){o=new Date,i=null,s=e.apply(n,r)};return function(){var a=new Date,f=t-(a-o);return n=this,r=arguments,0>=f?(clearTimeout(i),i=null,o=a,s=e.apply(n,r)):i||(i=setTimeout(u,f)),s}},x.debounce=function(e,t,n){var r,i;return function(){var s=this,o=arguments,u=function(){r=null,n||(i=e.apply(s,o))},a=n&&!r;return clearTimeout(r),r=setTimeout(u,t),a&&(i=e.apply(s,o)),i}},x.once=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}},x.wrap=function(e,t){return function(){var n=[e];return o.apply(n,arguments),t.apply(this,n)}},x.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},x.after=function(e,t){return 0>=e?t():function(){return 1>--e?t.apply(this,arguments):void 0}},x.keys=E||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)x.has(e,n)&&(t[t.length]=n);return t},x.values=function(e){var t=[];for(var n in e)x.has(e,n)&&t.push(e[n]);return t},x.pairs=function(e){var t=[];for(var n in e)x.has(e,n)&&t.push([n,e[n]]);return t},x.invert=function(e){var t={};for(var n in e)x.has(e,n)&&(t[e[n]]=n);return t},x.functions=x.methods=function(e){var t=[];for(var n in e)x.isFunction(e[n])&&t.push(n);return t.sort()},x.extend=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},x.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return T(n,function(n){n in e&&(t[n]=e[n])}),t},x.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)x.contains(n,i)||(t[i]=e[i]);return t},x.defaults=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)null==e[n]&&(e[n]=t[n])}),e},x.clone=function(e){return x.isObject(e)?x.isArray(e)?e.slice():x.extend({},e):e},x.tap=function(e,t){return t(e),e};var O=function(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof x&&(e=e._wrapped),t instanceof x&&(t=t._wrapped);var i=f.call(e);if(i!=f.call(t))return!1;switch(i){case"[object String]":return e==t+"";case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var s=n.length;s--;)if(n[s]==e)return r[s]==t;n.push(e),r.push(t);var o=0,u=!0;if("[object Array]"==i){if(o=e.length,u=o==t.length)for(;o--&&(u=O(e[o],t[o],n,r)););}else{var a=e.constructor,l=t.constructor;if(a!==l&&!(x.isFunction(a)&&a instanceof a&&x.isFunction(l)&&l instanceof l))return!1;for(var c in e)if(x.has(e,c)&&(o++,!(u=x.has(t,c)&&O(e[c],t[c],n,r))))break;if(u){for(c in t)if(x.has(t,c)&&!(o--))break;u=!o}}return n.pop(),r.pop(),u};x.isEqual=function(e,t){return O(e,t,[],[])},x.isEmpty=function(e){if(null==e)return!0;if(x.isArray(e)||x.isString(e))return 0===e.length;for(var t in e)if(x.has(e,t))return!1;return!0},x.isElement=function(e){return!!e&&1===e.nodeType},x.isArray=w||function(e){return"[object Array]"==f.call(e)},x.isObject=function(e){return e===Object(e)},T(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return f.call(t)=="[object "+e+"]"}}),x.isArguments(arguments)||(x.isArguments=function(e){return!!e&&!!x.has(e,"callee")}),"function"!=typeof /./&&(x.isFunction=function(e){return"function"==typeof e}),x.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},x.isNaN=function(e){return x.isNumber(e)&&e!=+e},x.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==f.call(e)},x.isNull=function(e){return null===e},x.isUndefined=function(e){return e===void 0},x.has=function(e,t){return l.call(e,t)},x.noConflict=function(){return e._=t,this},x.identity=function(e){return e},x.times=function(e,t,n){for(var r=Array(e),i=0;e>i;i++)r[i]=t.call(n,i);return r},x.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var M={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};M.unescape=x.invert(M.escape);var _={escape:RegExp("["+x.keys(M.escape).join("")+"]","g"),unescape:RegExp("("+x.keys(M.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(e){x[e]=function(t){return null==t?"":(""+t).replace(_[e],function(t){return M[e][t]})}}),x.result=function(e,t){if(null==e)return null;var n=e[t];return x.isFunction(n)?n.call(e):n},x.mixin=function(e){T(x.functions(e),function(t){var n=x[t]=e[t];x.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),j.call(this,n.apply(x,e))}})};var D=0;x.uniqueId=function(e){var t=++D+"";return e?e+t:t},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var P=/(.)^/,H={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},B=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(e,t,n){var r;n=x.defaults({},n,x.templateSettings);var i=RegExp([(n.escape||P).source,(n.interpolate||P).source,(n.evaluate||P).source].join("|")+"|$","g"),s=0,o="__p+='";e.replace(i,function(t,n,r,i,u){return o+=e.slice(s,u).replace(B,function(e){return"\\"+H[e]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(o+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(o+="';\n"+i+"\n__p+='"),s=u+t.length,t}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{r=Function(n.variable||"obj","_",o)}catch(u){throw u.source=o,u}if(t)return r(t,x);var a=function(e){return r.call(this,e,x)};return a.source="function("+(n.variable||"obj")+"){\n"+o+"}",a},x.chain=function(e){return x(e).chain()};var j=function(e){return this._chain?x(e).chain():e};x.mixin(x),T(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];x.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!=e&&"splice"!=e||0!==n.length||delete n[0],j.call(this,n)}}),T(["concat","join","slice"],function(e){var t=r[e];x.prototype[e]=function(){return j.call(this,t.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this),typeof JSON!="object"&&(JSON={}),function(){"use strict";function f(e){return e<10?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];a&&typeof a=="object"&&typeof a.toJSON=="function"&&(a=a.toJSON(e)),typeof rep=="function"&&(a=rep.call(t,e,a));switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";gap+=indent,u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1)u[n]=str(n,a)||"null";return i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]",gap=o,i}if(rep&&typeof rep=="object"){s=rep.length;for(n=0;n<s;n+=1)typeof rep[n]=="string"&&(r=rep[n],i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i))}else for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i));return i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}",gap=o,i}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(e,t,n){var r;gap="",indent="";if(typeof n=="number")for(r=0;r<n;r+=1)indent+=" ";else typeof n=="string"&&(indent=n);rep=t;if(!t||typeof t=="function"||typeof t=="object"&&typeof t.length=="number")return str("",{"":e});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=="object")for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),r!==undefined?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(){var e=this,t=e.Backbone,n=Array.prototype.slice,r=Array.prototype.splice,i;typeof exports!="undefined"?i=exports:i=e.Backbone={},i.VERSION="0.9.2";var s=e._;!s&&typeof require!="undefined"&&(s=require("underscore"));var o=e.jQuery||e.Zepto||e.ender;i.setDomLibrary=function(e){o=e},i.noConflict=function(){return e.Backbone=t,this},i.emulateHTTP=!1,i.emulateJSON=!1;var u=/\s+/,a=i.Events={on:function(e,t,n){var r,i,s,o,a;if(!t)return this;e=e.split(u),r=this._callbacks||(this._callbacks={});while(i=e.shift())a=r[i],s=a?a.tail:{},s.next=o={},s.context=n,s.callback=t,r[i]={tail:o,next:a?a.next:s};return this},off:function(e,t,n){var r,i,o,a,f,l;if(!(i=this._callbacks))return;if(!(e||t||n))return delete this._callbacks,this;e=e?e.split(u):s.keys(i);while(r=e.shift()){o=i[r],delete i[r];if(!o||!t&&!n)continue;a=o.tail;while((o=o.next)!==a)f=o.callback,l=o.context,(t&&f!==t||n&&l!==n)&&this.on(r,f,l)}return this},trigger:function(e){var t,r,i,s,o,a,f;if(!(i=this._callbacks))return this;a=i.all,e=e.split(u),f=n.call(arguments,1);while(t=e.shift()){if(r=i[t]){s=r.tail;while((r=r.next)!==s)r.callback.apply(r.context||this,f)}if(r=a){s=r.tail,o=[t].concat(f);while((r=r.next)!==s)r.callback.apply(r.context||this,o)}}return this}};a.bind=a.on,a.unbind=a.off;var f=i.Model=function(e,t){var n;e||(e={}),t&&t.parse&&(e=this.parse(e));if(n=C(this,"defaults"))e=s.extend({},n,e);t&&t.collection&&(this.collection=t.collection),this.attributes={},this._escapedAttributes={},this.cid=s.uniqueId("c"),this.changed={},this._silent={},this._pending={},this.set(e,{silent:!0}),this.changed={},this._silent={},this._pending={},this._previousAttributes=s.clone(this.attributes),this.initialize.apply(this,arguments)};s.extend(f.prototype,a,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return s.clone(this.attributes)},get:function(e){return this.attributes[e]},escape:function(e){var t;if(t=this._escapedAttributes[e])return t;var n=this.get(e);return this._escapedAttributes[e]=s.escape(n==null?"":""+n)},has:function(e){return this.get(e)!=null},set:function(e,t,n){var r,i,o;s.isObject(e)||e==null?(r=e,n=t):(r={},r[e]=t),n||(n={});if(!r)return this;r instanceof f&&(r=r.attributes);if(n.unset)for(i in r)r[i]=void 0;if(!this._validate(r,n))return!1;this.idAttribute in r&&(this.id=r[this.idAttribute]);var u=n.changes={},a=this.attributes,l=this._escapedAttributes,c=this._previousAttributes||{};for(i in r){o=r[i];if(!s.isEqual(a[i],o)||n.unset&&s.has(a,i))delete l[i],(n.silent?this._silent:u)[i]=!0;n.unset?delete a[i]:a[i]=o,!s.isEqual(c[i],o)||s.has(a,i)!=s.has(c,i)?(this.changed[i]=o,n.silent||(this._pending[i]=!0)):(delete this.changed[i],delete this._pending[i])}return n.silent||this.change(n),this},unset:function(e,t){return(t||(t={})).unset=!0,this.set(e,null,t)},clear:function(e){return(e||(e={})).unset=!0,this.set(s.clone(this.attributes),e)},fetch:function(e){e=e?s.clone(e):{};var t=this,n=e.success;return e.success=function(r,i,s){if(!t.set(t.parse(r,s),e))return!1;n&&n(t,r)},e.error=i.wrapError(e.error,t,e),(this.sync||i.sync).call(this,"read",this,e)},save:function(e,t,n){var r,o;s.isObject(e)||e==null?(r=e,n=t):(r={},r[e]=t),n=n?s.clone(n):{};if(n.wait){if(!this._validate(r,n))return!1;o=s.clone(this.attributes)}var u=s.extend({},n,{silent:!0});if(r&&!this.set(r,n.wait?u:n))return!1;var a=this,f=n.success;n.success=function(e,t,i){var o=a.parse(e,i);n.wait&&(delete n.wait,o=s.extend(r||{},o));if(!a.set(o,n))return!1;f?f(a,e):a.trigger("sync",a,e,n)},n.error=i.wrapError(n.error,a,n);var l=this.isNew()?"create":"update",c=(this.sync||i.sync).call(this,l,this,n);return n.wait&&this.set(o,u),c},destroy:function(e){e=e?s.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};if(this.isNew())return r(),!1;e.success=function(i){e.wait&&r(),n?n(t,i):t.trigger("sync",t,i,e)},e.error=i.wrapError(e.error,t,e);var o=(this.sync||i.sync).call(this,"delete",this,e);return e.wait||r(),o},url:function(){var e=C(this,"urlRoot")||C(this.collection,"url")||k();return this.isNew()?e:e+(e.charAt(e.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},change:function(e){e||(e={});var t=this._changing;this._changing=!0;for(var n in this._silent)this._pending[n]=!0;var r=s.extend({},e.changes,this._silent);this._silent={};for(var n in r)this.trigger("change:"+n,this,this.get(n),e);if(t)return this;while(!s.isEmpty(this._pending)){this._pending={},this.trigger("change",this,e);for(var n in this.changed){if(this._pending[n]||this._silent[n])continue;delete this.changed[n]}this._previousAttributes=s.clone(this.attributes)}return this._changing=!1,this},hasChanged:function(e){return arguments.length?s.has(this.changed,e):!s.isEmpty(this.changed)},changedAttributes:function(e){if(!e)return this.hasChanged()?s.clone(this.changed):!1;var t,n=!1,r=this._previousAttributes;for(var i in e){if(s.isEqual(r[i],t=e[i]))continue;(n||(n={}))[i]=t}return n},previous:function(e){return!arguments.length||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return s.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(e,t){if(t.silent||!this.validate)return!0;e=s.extend({},this.attributes,e);var n=this.validate(e,t);return n?(t&&t.error?t.error(this,n,t):this.trigger("error",this,n,t),!1):!0}});var l=i.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,{silent:!0,parse:t.parse})};s.extend(l.prototype,a,{model:f,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},add:function(e,t){var n,i,o,u,a,f,l={},c={},h=[];t||(t={}),e=s.isArray(e)?e.slice():[e];for(n=0,o=e.length;n<o;n++){if(!(u=e[n]=this._prepareModel(e[n],t)))throw new Error("Can't add an invalid model to a collection");a=u.cid,f=u.id;if(l[a]||this._byCid[a]||f!=null&&(c[f]||this._byId[f])){h.push(n);continue}l[a]=c[f]=u}n=h.length;while(n--)e.splice(h[n],1);for(n=0,o=e.length;n<o;n++)(u=e[n]).on("all",this._onModelEvent,this),this._byCid[u.cid]=u,u.id!=null&&(this._byId[u.id]=u);this.length+=o,i=t.at!=null?t.at:this.models.length,r.apply(this.models,[i,0].concat(e)),this.comparator&&this.sort({silent:!0});if(t.silent)return this;for(n=0,o=this.models.length;n<o;n++){if(!l[(u=this.models[n]).cid])continue;t.index=n,u.trigger("add",u,this,t)}return this},remove:function(e,t){var n,r,i,o;t||(t={}),e=s.isArray(e)?e.slice():[e];for(n=0,r=e.length;n<r;n++){o=this.getByCid(e[n])||this.get(e[n]);if(!o)continue;delete this._byId[o.id],delete this._byCid[o.cid],i=this.indexOf(o),this.models.splice(i,1),this.length--,t.silent||(t.index=i,o.trigger("remove",o,this,t)),this._removeReference(o)}return this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,t),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,s.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},get:function(e){return e==null?void 0:this._byId[e.id!=null?e.id:e]},getByCid:function(e){return e&&this._byCid[e.cid||e]},at:function(e){return this.models[e]},where:function(e){return s.isEmpty(e)?[]:this.filter(function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},sort:function(e){e||(e={});if(!this.comparator)throw new Error("Cannot sort a set without a comparator");var t=s.bind(this.comparator,this);return this.comparator.length==1?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("reset",this,e),this},pluck:function(e){return s.map(this.models,function(t){return t.get(e)})},reset:function(e,t){e||(e=[]),t||(t={});for(var n=0,r=this.models.length;n<r;n++)this._removeReference(this.models[n]);return this._reset(),this.add(e,s.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},fetch:function(e){e=e?s.clone(e):{},e.parse===undefined&&(e.parse=!0);var t=this,n=e.success;return e.success=function(r,i,s){t[e.add?"add":"reset"](t.parse(r,s),e),n&&n(t,r)},e.error=i.wrapError(e.error,t,e),(this.sync||i.sync).call(this,"read",this,e)},create:function(e,t){var n=this;t=t?s.clone(t):{},e=this._prepareModel(e,t);if(!e)return!1;t.wait||n.add(e,t);var r=t.success;return t.success=function(i,s,o){t.wait&&n.add(i,t),r?r(i,s):i.trigger("sync",e,s,t)},e.save(null,t),e},parse:function(e,t){return e},chain:function(){return s(this.models).chain()},_reset:function(e){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(e,t){t||(t={});if(e instanceof f)e.collection||(e.collection=this);else{var n=e;t.collection=this,e=new this.model(n,t),e._validate(e.attributes,t)||(e=!1)}return e},_removeReference:function(e){this==e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e=="add"||e=="remove")&&n!=this)return;e=="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],this._byId[t.id]=t),this.trigger.apply(this,arguments)}});var c=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];s.each(c,function(e){l.prototype[e]=function(){return s[e].apply(s,[this.models].concat(s.toArray(arguments)))}});var h=i.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},p=/:\w+/g,d=/\*\w+/g,v=/[-[\]{}()+?.,\\^$|#\s]/g;s.extend(h.prototype,a,{initialize:function(){},route:function(e,t,n){return i.history||(i.history=new m),s.isRegExp(e)||(e=this._routeToRegExp(e)),n||(n=this[t]),i.history.route(e,s.bind(function(r){var s=this._extractParameters(e,r);n&&n.apply(this,s),this.trigger.apply(this,["route:"+t].concat(s)),i.history.trigger("route",this,t,s)},this)),this},navigate:function(e,t){i.history.navigate(e,t)},_bindRoutes:function(){if(!this.routes)return;var e=[];for(var t in this.routes)e.unshift([t,this.routes[t]]);for(var n=0,r=e.length;n<r;n++)this.route(e[n][0],e[n][1],this[e[n][1]])},_routeToRegExp:function(e){return e=e.replace(v,"\\$&").replace(p,"([^/]+)").replace(d,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){return e.exec(t).slice(1)}});var m=i.History=function(){this.handlers=[],s.bindAll(this,"checkUrl")},g=/^[#\/]/,y=/msie [\w.]+/;m.started=!1,s.extend(m.prototype,a,{interval:50,getHash:function(e){var t=e?e.location:window.location,n=t.href.match(/#(.*)$/);return n?n[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||t){e=window.location.pathname;var n=window.location.search;n&&(e+=n)}else e=this.getHash();return e.indexOf(this.options.root)||(e=e.substr(this.options.root.length)),e.replace(g,"")},start:function(e){if(m.started)throw new Error("Backbone.history has already been started");m.started=!0,this.options=s.extend({},{root:"/"},this.options,e),this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var t=this.getFragment(),n=document.documentMode,r=y.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);r&&(this.iframe=o('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?o(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?o(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t;var i=window.location,u=i.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!u)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&u&&i.hash&&(this.fragment=this.getHash().replace(g,""),window.history.replaceState({},document.title,i.protocol+"//"+i.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},stop:function(){o(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),m.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t==this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t==this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=s.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0});return n},navigate:function(e,t){if(!m.started)return!1;if(!t||t===!0)t={trigger:t};var n=(e||"").replace(g,"");if(this.fragment==n)return;this._hasPushState?(n.indexOf(this.options.root)!=0&&(n=this.options.root+n),this.fragment=n,window.history[t.replace?"replaceState":"pushState"]({},document.title,n)):this._wantsHashChange?(this.fragment=n,this._updateHash(window.location,n,t.replace),this.iframe&&n!=this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,n,t.replace))):window.location.assign(this.options.root+e),t.trigger&&this.loadUrl(e)},_updateHash:function(e,t,n){n?e.replace(e.toString().replace(/(javascript:|#).*$/,"")+"#"+t):e.hash=t}});var b=i.View=function(e){this.cid=s.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,E=["model","collection","el","id","attributes","className","tagName"];s.extend(b.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(e,t,n){var r=document.createElement(e);return t&&o(r).attr(t),n&&o(r).html(n),r},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof o?e:o(e),this.el=this.$el[0],t!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=C(this,"events")))return;this.undelegateEvents();for(var t in e){var n=e[t];s.isFunction(n)||(n=this[e[t]]);if(!n)throw new Error('Method "'+e[t]+'" does not exist');var r=t.match(w),i=r[1],o=r[2];n=s.bind(n,this),i+=".delegateEvents"+this.cid,o===""?this.$el.bind(i,n):this.$el.delegate(o,i,n)}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(e){this.options&&(e=s.extend({},this.options,e));for(var t=0,n=E.length;t<n;t++){var r=E[t];e[r]&&(this[r]=e[r])}this.options=e},_ensureElement:function(){if(!this.el){var e=C(this,"attributes")||{};this.id&&(e.id=this.id),this.className&&(e["class"]=this.className),this.setElement(this.make(this.tagName,e),!1)}else this.setElement(this.el,!1)}});var S=function(e,t){var n=N(this,e,t);return n.extend=this.extend,n};f.extend=l.extend=h.extend=b.extend=S;var x={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};i.sync=function(e,t,n){var r=x[e];n||(n={});var u={type:r,dataType:"json"};return n.url||(u.url=C(t,"url")||k()),!n.data&&t&&(e=="create"||e=="update")&&(u.contentType="application/json",u.data=JSON.stringify(t.toJSON())),i.emulateJSON&&(u.contentType="application/x-www-form-urlencoded",u.data=u.data?{model:u.data}:{}),i.emulateHTTP&&(r==="PUT"||r==="DELETE")&&(i.emulateJSON&&(u.data._method=r),u.type="POST",u.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",r)}),u.type!=="GET"&&!i.emulateJSON&&(u.processData=!1),o.ajax(s.extend(u,n))},i.wrapError=function(e,t,n){return function(r,i){i=r===t?i:r,e?e(t,i,n):t.trigger("error",t,i,n)}};var T=function(){},N=function(e,t,n){var r;return t&&t.hasOwnProperty("constructor")?r=t.constructor:r=function(){e.apply(this,arguments)},s.extend(r,e),T.prototype=e.prototype,r.prototype=new T,t&&s.extend(r.prototype,t),n&&s.extend(r,n),r.prototype.constructor=r,r.__super__=e.prototype,r},C=function(e,t){return!e||!e[t]?null:s.isFunction(e[t])?e[t]():e[t]},k=function(){throw new Error('A "url" property or function must be specified')}}.call(this),function(e,t,n){var r=e.L,i={};i.version="0.7.2",typeof module=="object"&&typeof module.exports=="object"?module.exports=i:typeof define=="function"&&define.amd&&define("cartodb",i),i.noConflict=function(){return e.L=r,this},e.L=i,i.Util={extend:function(e){var t=Array.prototype.slice.call(arguments,1),n,r,i,s;for(r=0,i=t.length;r<i;r++){s=t[r]||{};for(n in s)s.hasOwnProperty(n)&&(e[n]=s[n])}return e},bind:function(e,t){var n=arguments.length>2?Array.prototype.slice.call(arguments,2):null;return function(){return e.apply(t,n||arguments)}},stamp:function(){var e=0,t="_leaflet_id";return function(n){return n[t]=n[t]||++e,n[t]}}(),invokeEach:function(e,t,n){var r,i;if(typeof e=="object"){i=Array.prototype.slice.call(arguments,3);for(r in e)t.apply(n,[r,e[r]].concat(i));return!0}return!1},limitExecByInterval:function(e,t,n){var r,i;return function s(){var o=arguments;if(r){i=!0;return}r=!0,setTimeout(function(){r=!1,i&&(s.apply(n,o),i=!1)},t),e.apply(n,o)}},falseFn:function(){return!1},formatNum:function(e,t){var n=Math.pow(10,t||5);return Math.round(e*n)/n},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},splitWords:function(e){return i.Util.trim(e).split(/\s+/)},setOptions:function(e,t){return e.options=i.extend({},e.options,t),e.options},getParamString:function(e,t,n){var r=[];for(var i in e)r.push(encodeURIComponent(n?i.toUpperCase():i)+"="+encodeURIComponent(e[i]));return(!t||t.indexOf("?")===-1?"?":"&")+r.join("&")},template:function(e,t){return e.replace(/\{ *([\w_]+) *\}/g,function(e,r){var i=t[r];if(i===n)throw new Error("No value provided for variable "+e);return typeof i=="function"&&(i=i(t)),i})},isArray:Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function t(t){var n,r,i=["webkit","moz","o","ms"];for(n=0;n<i.length&&!r;n++)r=e[i[n]+t];return r}function n(t){var n=+(new Date),i=Math.max(0,16-(n-r));return r=n+i,e.setTimeout(t,i)}var r=0,s=e.requestAnimationFrame||t("RequestAnimationFrame")||n,o=e.cancelAnimationFrame||t("CancelAnimationFrame")||t("CancelRequestAnimationFrame")||function(t){e.clearTimeout(t)};i.Util.requestAnimFrame=function(t,r,o,u){t=i.bind(t,r);if(!o||s!==n)return s.call(e,t,u);t()},i.Util.cancelAnimFrame=function(t){t&&o.call(e,t)}}(),i.extend=i.Util.extend,i.bind=i.Util.bind,i.stamp=i.Util.stamp,i.setOptions=i.Util.setOptions,i.Class=function(){},i.Class.extend=function(e){var t=function(){this.initialize&&this.initialize.apply(this,arguments),this._initHooks&&this.callInitHooks()},n=function(){};n.prototype=this.prototype;var r=new n;r.constructor=t,t.prototype=r;for(var s in this)this.hasOwnProperty(s)&&s!=="prototype"&&(t[s]=this[s]);e.statics&&(i.extend(t,e.statics),delete e.statics),e.includes&&(i.Util.extend.apply(null,[r].concat(e.includes)),delete e.includes),e.options&&r.options&&(e.options=i.extend({},r.options,e.options)),i.extend(r,e),r._initHooks=[];var o=this;return t.__super__=o.prototype,r.callInitHooks=function(){if(this._initHooksCalled)return;o.prototype.callInitHooks&&o.prototype.callInitHooks.call(this),this._initHooksCalled=!0;for(var e=0,t=r._initHooks.length;e<t;e++)r._initHooks[e].call(this)},t},i.Class.include=function(e){i.extend(this.prototype,e)},i.Class.mergeOptions=function(e){i.extend(this.prototype.options,e)},i.Class.addInitHook=function(e){var t=Array.prototype.slice.call(arguments,1),n=typeof e=="function"?e:function(){this[e].apply(this,t)};this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(n)};var s="_leaflet_events";i.Mixin={},i.Mixin.Events={addEventListener:function(e,t,n){if(i.Util.invokeEach(e,this.addEventListener,this,t,n))return this;var r=this[s]=this[s]||{},o=n&&n!==this&&i.stamp(n),u,a,f,l,c,h,p;e=i.Util.splitWords(e);for(u=0,a=e.length;u<a;u++)f={action:t,context:n||this},l=e[u],o?(c=l+"_idx",h=c+"_len",p=r[c]=r[c]||{},p[o]||(p[o]=[],r[h]=(r[h]||0)+1),p[o].push(f)):(r[l]=r[l]||[],r[l].push(f));return this},hasEventListeners:function(e){var t=this[s];return!!t&&(e in t&&t[e].length>0||e+"_idx"in t&&t[e+"_idx_len"]>0)},removeEventListener:function(e,t,n){if(!this[s])return this;if(!e)return this.clearAllEventListeners();if(i.Util.invokeEach(e,this.removeEventListener,this,t,n))return this;var r=this[s],o=n&&n!==this&&i.stamp(n),u,a,f,l,c,h,p,d,v;e=i.Util.splitWords(e);for(u=0,a=e.length;u<a;u++){f=e[u],h=f+"_idx",p=h+"_len",d=r[h];if(!t)delete r[f],delete r[h],delete r[p];else{l=o&&d?d[o]:r[f];if(l){for(c=l.length-1;c>=0;c--)l[c].action===t&&(!n||l[c].context===n)&&(v=l.splice(c,1),v[0].action=i.Util.falseFn);n&&d&&l.length===0&&(delete d[o],r[p]--)}}}return this},clearAllEventListeners:function(){return delete this[s],this},fireEvent:function(e,t){if(!this.hasEventListeners(e))return this;var n=i.Util.extend({},t,{type:e,target:this}),r=this[s],o,u,a,f,l;if(r[e]){o=r[e].slice();for(u=0,a=o.length;u<a;u++)o[u].action.call(o[u].context,n)}f=r[e+"_idx"];for(l in f){o=f[l].slice();if(o)for(u=0,a=o.length;u<a;u++)o[u].action.call(o[u].context,n)}return this},addOneTimeEventListener:function(e,t,n){if(i.Util.invokeEach(e,this.addOneTimeEventListener,this,t,n))return this;var r=i.bind(function(){this.removeEventListener(e,t,n).removeEventListener(e,r,n)},this);return this.addEventListener(e,t,n).addEventListener(e,r,n)}},i.Mixin.Events.on=i.Mixin.Events.addEventListener,i.Mixin.Events.off=i.Mixin.Events.removeEventListener,i.Mixin.Events.once=i.Mixin.Events.addOneTimeEventListener,i.Mixin.Events.fire=i.Mixin.Events.fireEvent,function(){var r="ActiveXObject"in e,s=r&&!t.addEventListener,o=navigator.userAgent.toLowerCase(),u=o.indexOf("webkit")!==-1,a=o.indexOf("chrome")!==-1,f=o.indexOf("phantom")!==-1,l=o.indexOf("android")!==-1,c=o.search("android [23]")!==-1,h=o.indexOf("gecko")!==-1,p=typeof orientation!=n+"",d=e.navigator&&e.navigator.msPointerEnabled&&e.navigator.msMaxTouchPoints&&!e.PointerEvent,v=e.PointerEvent&&e.navigator.pointerEnabled&&e.navigator.maxTouchPoints||d,m="devicePixelRatio"in e&&e.devicePixelRatio>1||"matchMedia"in e&&e.matchMedia("(min-resolution:144dpi)")&&e.matchMedia("(min-resolution:144dpi)").matches,g=t.documentElement,y=r&&"transition"in g.style,b="WebKitCSSMatrix"in e&&"m11"in new e.WebKitCSSMatrix&&!c,w="MozPerspective"in g.style,E="OTransition"in g.style,S=!e.L_DISABLE_3D&&(y||b||w||E)&&!f,x=!e.L_NO_TOUCH&&!f&&function(){var e="ontouchstart";if(v||e in g)return!0;var n=t.createElement("div"),r=!1;return n.setAttribute?(n.setAttribute(e,"return;"),typeof n[e]=="function"&&(r=!0),n.removeAttribute(e),n=null,r):!1}();i.Browser={ie:r,ielt9:s,webkit:u,gecko:h&&!u&&!e.opera&&!r,android:l,android23:c,chrome:a,ie3d:y,webkit3d:b,gecko3d:w,opera3d:E,any3d:S,mobile:p,mobileWebkit:p&&u,mobileWebkit3d:p&&b,mobileOpera:p&&e.opera,touch:x,msPointer:d,pointer:v,retina:m}}(),i.Point=function(e,t,n){this.x=n?Math.round(e):e,this.y=n?Math.round(t):t},i.Point.prototype={clone:function(){return new i.Point(this.x,this.y)},add:function(e){return this.clone()._add(i.point(e))},_add:function(e){return this.x+=e.x,this.y+=e.y,this},subtract:function(e){return this.clone()._subtract(i.point(e))},_subtract:function(e){return this.x-=e.x,this.y-=e.y,this},divideBy:function(e){return this.clone()._divideBy(e)},_divideBy:function(e){return this.x/=e,this.y/=e,this},multiplyBy:function(e){return this.clone()._multiplyBy(e)},_multiplyBy:function(e){return this.x*=e,this.y*=e,this},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},distanceTo:function(e){e=i.point(e);var t=e.x-this.x,n=e.y-this.y;return Math.sqrt(t*t+n*n)},equals:function(e){return e=i.point(e),e.x===this.x&&e.y===this.y},contains:function(e){return e=i.point(e),Math.abs(e.x)<=Math.abs(this.x)&&Math.abs(e.y)<=Math.abs(this.y)},toString:function(){return"Point("+i.Util.formatNum(this.x)+", "+i.Util.formatNum(this.y)+")"}},i.point=function(e,t,r){return e instanceof i.Point?e:i.Util.isArray(e)?new i.Point(e[0],e[1]):e===n||e===null?e:new i.Point(e,t,r)},i.Bounds=function(e,t){if(!e)return;var n=t?[e,t]:e;for(var r=0,i=n.length;r<i;r++)this.extend(n[r])},i.Bounds.prototype={extend:function(e){return e=i.point(e),!this.min&&!this.max?(this.min=e.clone(),this.max=e.clone()):(this.min.x=Math.min(e.x,this.min.x),this.max.x=Math.max(e.x,this.max.x),this.min.y=Math.min(e.y,this.min.y),this.max.y=Math.max(e.y,this.max.y)),this},getCenter:function(e){return new i.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,e)},getBottomLeft:function(){return new i.Point(this.min.x,this.max.y)},getTopRight:function(){return new i.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(e){var t,n;return typeof e[0]=="number"||e instanceof i.Point?e=i.point(e):e=i.bounds(e),e instanceof i.Bounds?(t=e.min,n=e.max):t=n=e,t.x>=this.min.x&&n.x<=this.max.x&&t.y>=this.min.y&&n.y<=this.max.y},intersects:function(e){e=i.bounds(e);var t=this.min,n=this.max,r=e.min,s=e.max,o=s.x>=t.x&&r.x<=n.x,u=s.y>=t.y&&r.y<=n.y;return o&&u},isValid:function(){return!!this.min&&!!this.max}},i.bounds=function(e,t){return!e||e instanceof i.Bounds?e:new i.Bounds(e,t)},i.Transformation=function(e,t,n,r){this._a=e,this._b=t,this._c=n,this._d=r},i.Transformation.prototype={transform:function(e,t){return this._transform(e.clone(),t)},_transform:function(e,t){return t=t||1,e.x=t*(this._a*e.x+this._b),e.y=t*(this._c*e.y+this._d),e},untransform:function(e,t){return t=t||1,new i.Point((e.x/t-this._b)/this._a,(e.y/t-this._d)/this._c)}},i.DomUtil={get:function(e){return typeof e=="string"?t.getElementById(e):e},getStyle:function(e,n){var r=e.style[n];!r&&e.currentStyle&&(r=e.currentStyle[n]);if((!r||r==="auto")&&t.defaultView){var i=t.defaultView.getComputedStyle(e,null);r=i?i[n]:null}return r==="auto"?null:r},getViewportOffset:function(e){var n=0,r=0,s=e,o=t.body,u=t.documentElement,a;do{n+=s.offsetTop||0,r+=s.offsetLeft||0,n+=parseInt(i.DomUtil.getStyle(s,"borderTopWidth"),10)||0,r+=parseInt(i.DomUtil.getStyle(s,"borderLeftWidth"),10)||0,a=i.DomUtil.getStyle(s,"position");if(s.offsetParent===o&&a==="absolute")break;if(a==="fixed"){n+=o.scrollTop||u.scrollTop||0,r+=o.scrollLeft||u.scrollLeft||0;break}if(a==="relative"&&!s.offsetLeft){var f=i.DomUtil.getStyle(s,"width"),l=i.DomUtil.getStyle(s,"max-width"),c=s.getBoundingClientRect();if(f!=="none"||l!=="none")r+=c.left+s.clientLeft;n+=c.top+(o.scrollTop||u.scrollTop||0);break}s=s.offsetParent}while(s);s=e;do{if(s===o)break;n-=s.scrollTop||0,r-=s.scrollLeft||0,s=s.parentNode}while(s);return new i.Point(r,n)},documentIsLtr:function(){return i.DomUtil._docIsLtrCached||(i.DomUtil._docIsLtrCached=!0,i.DomUtil._docIsLtr=i.DomUtil.getStyle(t.body,"direction")==="ltr"),i.DomUtil._docIsLtr},create:function(e,n,r){var i=t.createElement(e);return i.className=n,r&&r.appendChild(i),i},hasClass:function(e,t){if(e.classList!==n)return e.classList.contains(t);var r=i.DomUtil._getClass(e);return r.length>0&&(new RegExp("(^|\\s)"+t+"(\\s|$)")).test(r)},addClass:function(e,t){if(e.classList!==n){var r=i.Util.splitWords(t);for(var s=0,o=r.length;s<o;s++)e.classList.add(r[s])}else if(!i.DomUtil.hasClass(e,t)){var u=i.DomUtil._getClass(e);i.DomUtil._setClass(e,(u?u+" ":"")+t)}},removeClass:function(e,t){e.classList!==n?e.classList.remove(t):i.DomUtil._setClass(e,i.Util.trim((" "+i.DomUtil._getClass(e)+" ").replace(" "+t+" "," ")))},_setClass:function(e,t){e.className.baseVal===n?e.className=t:e.className.baseVal=t},_getClass:function(e){return e.className.baseVal===n?e.className:e.className.baseVal},setOpacity:function(e,t){if("opacity"in e.style)e.style.opacity=t;else if("filter"in e.style){var n=!1,r="DXImageTransform.Microsoft.Alpha";try{n=e.filters.item(r)}catch(i){if(t===1)return}t=Math.round(t*100),n?(n.Enabled=t!==100,n.Opacity=t):e.style.filter+=" progid:"+r+"(opacity="+t+")"}},testProp:function(e){var n=t.documentElement.style;for(var r=0;r<e.length;r++)if(e[r]in n)return e[r];return!1},getTranslateString:function(e){var t=i.Browser.webkit3d,n="translate"+(t?"3d":"")+"(",r=(t?",0":"")+")";return n+e.x+"px,"+e.y+"px"+r},getScaleString:function(e,t){var n=i.DomUtil.getTranslateString(t.add(t.multiplyBy(-1*e))),r=" scale("+e+") ";return n+r},setPosition:function(e,t,n){e._leaflet_pos=t,!n&&i.Browser.any3d?e.style[i.DomUtil.TRANSFORM]=i.DomUtil.getTranslateString(t):(e.style.left=t.x+"px",e.style.top=t.y+"px")},getPosition:function(e){return e._leaflet_pos}},i.DomUtil.TRANSFORM=i.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),i.DomUtil.TRANSITION=i.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),i.DomUtil.TRANSITION_END=i.DomUtil.TRANSITION==="webkitTransition"||i.DomUtil.TRANSITION==="OTransition"?i.DomUtil.TRANSITION+"End":"transitionend",function(){if("onselectstart"in t)i.extend(i.DomUtil,{disableTextSelection:function(){i.DomEvent.on(e,"selectstart",i.DomEvent.preventDefault)},enableTextSelection:function(){i.DomEvent.off(e,"selectstart",i.DomEvent.preventDefault)}});else{var n=i.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);i.extend(i.DomUtil,{disableTextSelection:function(){if(n){var e=t.documentElement.style;this._userSelect=e[n],e[n]="none"}},enableTextSelection:function(){n&&(t.documentElement.style[n]=this._userSelect,delete this._userSelect)}})}i.extend(i.DomUtil,{disableImageDrag:function(){i.DomEvent.on(e,"dragstart",i.DomEvent.preventDefault)},enableImageDrag:function(){i.DomEvent.off(e,"dragstart",i.DomEvent.preventDefault)}})}(),i.LatLng=function(e,t,r){e=parseFloat(e),t=parseFloat(t);if(isNaN(e)||isNaN(t))throw new Error("Invalid LatLng object: ("+e+", "+t+")");this.lat=e,this.lng=t,r!==n&&(this.alt=parseFloat(r))},i.extend(i.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1e-9}),i.LatLng.prototype={equals:function(e){if(!e)return!1;e=i.latLng(e);var t=Math.max(Math.abs(this.lat-e.lat),Math.abs(this.lng-e.lng));return t<=i.LatLng.MAX_MARGIN},toString:function(e){return"LatLng("+i.Util.formatNum(this.lat,e)+", "+i.Util.formatNum(this.lng,e)+")"},distanceTo:function(e){e=i.latLng(e);var t=6378137,n=i.LatLng.DEG_TO_RAD,r=(e.lat-this.lat)*n,s=(e.lng-this.lng)*n,o=this.lat*n,u=e.lat*n,a=Math.sin(r/2),f=Math.sin(s/2),l=a*a+f*f*Math.cos(o)*Math.cos(u);return t*2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))},wrap:function(e,t){var n=this.lng;return e=e||-180,t=t||180,n=(n+t)%(t-e)+(n<e||n===t?t:e),new i.LatLng(this.lat,n)}},i.latLng=function(e,t){return e instanceof i.LatLng?e:i.Util.isArray(e)?typeof e[0]=="number"||typeof e[0]=="string"?new i.LatLng(e[0],e[1],e[2]):null:e===n||e===null?e:typeof e=="object"&&"lat"in e?new i.LatLng(e.lat,"lng"in e?e.lng:e.lon):t===n?null:new i.LatLng(e,t)},i.LatLngBounds=function(e,t){if(!e)return;var n=t?[e,t]:e;for(var r=0,i=n.length;r<i;r++)this.extend(n[r])},i.LatLngBounds.prototype={extend:function(e){if(!e)return this;var t=i.latLng(e);return t!==null?e=t:e=i.latLngBounds(e),e instanceof i.LatLng?!this._southWest&&!this._northEast?(this._southWest=new i.LatLng(e.lat,e.lng),this._northEast=new i.LatLng(e.lat,e.lng)):(this._southWest.lat=Math.min(e.lat,this._southWest.lat),this._southWest.lng=Math.min(e.lng,this._southWest.lng),this._northEast.lat=Math.max(e.lat,this._northEast.lat),this._northEast.lng=Math.max(e.lng,this._northEast.lng)):e instanceof i.LatLngBounds&&(this.extend(e._southWest),this.extend(e._northEast)),this},pad:function(e){var t=this._southWest,n=this._northEast,r=Math.abs(t.lat-n.lat)*e,s=Math.abs(t.lng-n.lng)*e;return new i.LatLngBounds(new i.LatLng(t.lat-r,t.lng-s),new i.LatLng(n.lat+r,n.lng+s))},getCenter:function(){return new i.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new i.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new i.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(e){typeof e[0]=="number"||e instanceof i.LatLng?e=i.latLng(e):e=i.latLngBounds(e);var t=this._southWest,n=this._northEast,r,s;return e instanceof i.LatLngBounds?(r=e.getSouthWest(),s=e.getNorthEast()):r=s=e,r.lat>=t.lat&&s.lat<=n.lat&&r.lng>=t.lng&&s.lng<=n.lng},intersects:function(e){e=i.latLngBounds(e);var t=this._southWest,n=this._northEast,r=e.getSouthWest(),s=e.getNorthEast(),o=s.lat>=t.lat&&r.lat<=n.lat,u=s.lng>=t.lng&&r.lng<=n.lng;return o&&u},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(e){return e?(e=i.latLngBounds(e),this._southWest.equals(e.getSouthWest())&&this._northEast.equals(e.getNorthEast())):!1},isValid:function(){return!!this._southWest&&!!this._northEast}},i.latLngBounds=function(e,t){return!e||e instanceof i.LatLngBounds?e:new i.LatLngBounds(e,t)},i.Projection={},i.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(e){var t=i.LatLng.DEG_TO_RAD,n=this.MAX_LATITUDE,r=Math.max(Math.min(n,e.lat),-n),s=e.lng*t,o=r*t;return o=Math.log(Math.tan(Math.PI/4+o/2)),new i.Point(s,o)},unproject:function(e){var t=i.LatLng.RAD_TO_DEG,n=e.x*t,r=(2*Math.atan(Math.exp(e.y))-Math.PI/2)*t;return new i.LatLng(r,n)}},i.Projection.LonLat={project:function(e){return new i.Point(e.lng,e.lat)},unproject:function(e){return new i.LatLng(e.y,e.x)}},i.CRS={latLngToPoint:function(e,t){var n=this.projection.project(e),r=this.scale(t);return this.transformation._transform(n,r)},pointToLatLng:function(e,t){var n=this.scale(t),r=this.transformation.untransform(e,n);return this.projection.unproject(r)},project:function(e){return this.projection.project(e)},scale:function(e){return 256*Math.pow(2,e)},getSize:function(e){var t=this.scale(e);return i.point(t,t)}},i.CRS.Simple=i.extend({},i.CRS,{projection:i.Projection.LonLat,transformation:new i.Transformation(1,0,-1,0),scale:function(e){return Math.pow(2,e)}}),i.CRS.EPSG3857=i.extend({},i.CRS,{code:"EPSG:3857",projection:i.Projection.SphericalMercator,transformation:new i.Transformation(.5/Math.PI,.5,-0.5/Math.PI,.5),project:function(e){var t=this.projection.project(e),n=6378137;return t.multiplyBy(n)}}),i.CRS.EPSG900913=i.extend({},i.CRS.EPSG3857,{code:"EPSG:900913"}),i.CRS.EPSG4326=i.extend({},i.CRS,{code:"EPSG:4326",projection:i.Projection.LonLat,transformation:new i.Transformation(1/360,.5,-1/360,.5)}),i.Map=i.Class.extend({includes:i.Mixin.Events,options:{crs:i.CRS.EPSG3857,fadeAnimation:i.DomUtil.TRANSITION&&!i.Browser.android23,trackResize:!0,markerZoomAnimation:i.DomUtil.TRANSITION&&i.Browser.any3d},initialize:function(e,t){t=i.setOptions(this,t),this._initContainer(e),this._initLayout(),this._onResize=i.bind(this._onResize,this),this._initEvents(),t.maxBounds&&this.setMaxBounds(t.maxBounds),t.center&&t.zoom!==n&&this.setView(i.latLng(t.center),t.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._tileLayersNum=0,this.callInitHooks(),this._addLayers(t.layers)},setView:function(e,t){return t=t===n?this.getZoom():t,this._resetView(i.latLng(e),this._limitZoom(t)),this},setZoom:function(e,t){return this._loaded?this.setView(this.getCenter(),e,{zoom:t}):(this._zoom=this._limitZoom(e),this)},zoomIn:function(e,t){return this.setZoom(this._zoom+(e||1),t)},zoomOut:function(e,t){return this.setZoom(this._zoom-(e||1),t)},setZoomAround:function(e,t,n){var r=this.getZoomScale(t),s=this.getSize().divideBy(2),o=e instanceof i.Point?e:this.latLngToContainerPoint(e),u=o.subtract(s).multiplyBy(1-1/r),a=this.containerPointToLatLng(s.add(u));return this.setView(a,t,{zoom:n})},fitBounds:function(e,t){t=t||{},e=e.getBounds?e.getBounds():i.latLngBounds(e);var n=i.point(t.paddingTopLeft||t.padding||[0,0]),r=i.point(t.paddingBottomRight||t.padding||[0,0]),s=this.getBoundsZoom(e,!1,n.add(r)),o=r.subtract(n).divideBy(2),u=this.project(e.getSouthWest(),s),a=this.project(e.getNorthEast(),s),f=this.unproject(u.add(a).divideBy(2).add(o),s);return s=t&&t.maxZoom?Math.min(t.maxZoom,s):s,this.setView(f,s,t)},fitWorld:function(e){return this.fitBounds([[-90,-180],[90,180]],e)},panTo:function(e,t){return this.setView(e,this._zoom,{pan:t})},panBy:function(e){return this.fire("movestart"),this._rawPanBy(i.point(e)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(e){return e=i.latLngBounds(e),this.options.maxBounds=e,e?(this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds,this)):this.off("moveend",this._panInsideMaxBounds,this)},panInsideBounds:function(e,t){var n=this.getCenter(),r=this._limitCenter(n,this._zoom,e);return n.equals(r)?this:this.panTo(r,t)},addLayer:function(e){var t=i.stamp(e);return this._layers[t]?this:(this._layers[t]=e,e.options&&(!isNaN(e.options.maxZoom)||!isNaN(e.options.minZoom))&&(this._zoomBoundLayers[t]=e,this._updateZoomLevels()),this.options.zoomAnimation&&i.TileLayer&&e instanceof i.TileLayer&&(this._tileLayersNum++,this._tileLayersToLoad++,e.on("load",this._onTileLayerLoad,this)),this._loaded&&this._layerAdd(e),this)},removeLayer:function(e){var t=i.stamp(e);return this._layers[t]?(this._loaded&&e.onRemove(this),delete this._layers[t],this._loaded&&this.fire("layerremove",{layer:e}),this._zoomBoundLayers[t]&&(delete this._zoomBoundLayers[t],this._updateZoomLevels()),this.options.zoomAnimation&&i.TileLayer&&e instanceof i.TileLayer&&(this._tileLayersNum--,this._tileLayersToLoad--,e.off("load",this._onTileLayerLoad,this)),this):this},hasLayer:function(e){return e?i.stamp(e)in this._layers:!1},eachLayer:function(e,t){for(var n in this._layers)e.call(t,this._layers[n]);return this},invalidateSize:function(e){if(!this._loaded)return this;e=i.extend({animate:!1,pan:!0},e===!0?{animate:!0}:e);var t=this.getSize();this._sizeChanged=!0,this._initialCenter=null;var n=this.getSize(),r=t.divideBy(2).round(),s=n.divideBy(2).round(),o=r.subtract(s);return!o.x&&!o.y?this:(e.animate&&e.pan?this.panBy(o):(e.pan&&this._rawPanBy(o),this.fire("move"),e.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(i.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:t,newSize:n}))},addHandler:function(e,t){if(!t)return this;var n=this[e]=new t(this);return this._handlers.push(n),this.options[e]&&n.enable(),this},remove:function(){this._loaded&&this.fire("unload"),this._initEvents("off");try{delete this._container._leaflet}catch(e){this._container._leaflet=n}return this._clearPanes(),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this},getCenter:function(){return this._checkIfLoaded(),this._initialCenter&&!this._moved()?this._initialCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var e=this.getPixelBounds(),t=this.unproject(e.getBottomLeft()),n=this.unproject(e.getTopRight());return new i.LatLngBounds(t,n)},getMinZoom:function(){return this.options.minZoom===n?this._layersMinZoom===n?0:this._layersMinZoom:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===n?this._layersMaxZoom===n?Infinity:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(e,t,n){e=i.latLngBounds(e);var r=this.getMinZoom()-(t?1:0),s=this.getMaxZoom(),o=this.getSize(),u=e.getNorthWest(),a=e.getSouthEast(),f=!0,l;n=i.point(n||[0,0]);do r++,l=this.project(a,r).subtract(this.project(u,r)).add(n),f=t?l.x<o.x||l.y<o.y:o.contains(l);while(f&&r<=s);return f&&t?null:t?r:r-1},getSize:function(){if(!this._size||this._sizeChanged)this._size=new i.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1;return this._size.clone()},getPixelBounds:function(){var e=this._getTopLeftPoint();return new i.Bounds(e,e.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._initialTopLeftPoint},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(e){var t=this.options.crs;return t.scale(e)/t.scale(this._zoom)},getScaleZoom:function(e){return this._zoom+Math.log(e)/Math.LN2},project:function(e,t){return t=t===n?this._zoom:t,this.options.crs.latLngToPoint(i.latLng(e),t)},unproject:function(e,t){return t=t===n?this._zoom:t,this.options.crs.pointToLatLng(i.point(e),t)},layerPointToLatLng:function(e){var t=i.point(e).add(this.getPixelOrigin());return this.unproject(t)},latLngToLayerPoint:function(e){var t=this.project(i.latLng(e))._round();return t._subtract(this.getPixelOrigin())},containerPointToLayerPoint:function(e){return i.point(e).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(e){return i.point(e).add(this._getMapPanePos())},containerPointToLatLng:function(e){var t=this.containerPointToLayerPoint(i.point(e));return this.layerPointToLatLng(t)},latLngToContainerPoint:function(e){return this.layerPointToContainerPoint(this.latLngToLayerPoint(i.latLng(e)))},mouseEventToContainerPoint:function(e){return i.DomEvent.getMousePosition(e,this._container)},mouseEventToLayerPoint:function(e){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(e))},mouseEventToLatLng:function(e){return this.layerPointToLatLng(this.mouseEventToLayerPoint(e))},_initContainer:function(e){var t=this._container=i.DomUtil.get(e);if(!t)throw new Error("Map container not found.");if(t._leaflet)throw new Error("Map container is already initialized.");t._leaflet=!0},_initLayout:function(){var e=this._container;i.DomUtil.addClass(e,"leaflet-container"+(i.Browser.touch?" leaflet-touch":"")+(i.Browser.retina?" leaflet-retina":"")+(i.Browser.ielt9?" leaflet-oldie":"")+(this.options.fadeAnimation?" leaflet-fade-anim":""));var t=i.DomUtil.getStyle(e,"position");t!=="absolute"&&t!=="relative"&&t!=="fixed"&&(e.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var e=this._panes={};this._mapPane=e.mapPane=this._createPane("leaflet-map-pane",this._container),this._tilePane=e.tilePane=this._createPane("leaflet-tile-pane",this._mapPane),e.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane),e.shadowPane=this._createPane("leaflet-shadow-pane"),e.overlayPane=this._createPane("leaflet-overlay-pane"),e.markerPane=this._createPane("leaflet-marker-pane"),e.popupPane=this._createPane("leaflet-popup-pane");var t=" leaflet-zoom-hide";this.options.markerZoomAnimation||(i.DomUtil.addClass(e.markerPane,t),i.DomUtil.addClass(e.shadowPane,t),i.DomUtil.addClass(e.popupPane,t))},_createPane:function(e,t){return i.DomUtil.create("div",e,t||this._panes.objectsPane)},_clearPanes:function(){this._container.removeChild(this._mapPane)},_addLayers:function(e){e=e?i.Util.isArray(e)?e:[e]:[];for(var t=0,n=e.length;t<n;t++)this.addLayer(e[t])},_resetView:function(e,t,n,r){var s=this._zoom!==t;r||(this.fire("movestart"),s&&this.fire("zoomstart")),this._zoom=t,this._initialCenter=e,this._initialTopLeftPoint=this._getNewTopLeftPoint(e),n?this._initialTopLeftPoint._add(this._getMapPanePos()):i.DomUtil.setPosition(this._mapPane,new i.Point(0,0)),this._tileLayersToLoad=this._tileLayersNum;var o=!this._loaded;this._loaded=!0,o&&(this.fire("load"),this.eachLayer(this._layerAdd,this)),this.fire("viewreset",{hard:!n}),this.fire("move"),(s||r)&&this.fire("zoomend"),this.fire("moveend",{hard:!n})},_rawPanBy:function(e){i.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(e))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_updateZoomLevels:function(){var e,t=Infinity,r=-Infinity,i=this._getZoomSpan();for(e in this._zoomBoundLayers){var s=this._zoomBoundLayers[e];isNaN(s.options.minZoom)||(t=Math.min(t,s.options.minZoom)),isNaN(s.options.maxZoom)||(r=Math.max(r,s.options.maxZoom))}e===n?this._layersMaxZoom=this._layersMinZoom=n:(this._layersMaxZoom=r,this._layersMinZoom=t),i!==this._getZoomSpan()&&this.fire("zoomlevelschange")},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){if(!i.DomEvent)return;t=t||"on",i.DomEvent[t](this._container,"click",this._onMouseClick,this);var n=["dblclick","mousedown","mouseup","mouseenter","mouseleave","mousemove","contextmenu"],r,s;for(r=0,s=n.length;r<s;r++)i.DomEvent[t](this._container,n[r],this._fireMouseEvent,this);this.options.trackResize&&i.DomEvent[t](e,"resize",this._onResize,this)},_onResize:function(){i.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=i.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this,!1,this._container)},_onMouseClick:function(e){if(!this._loaded||!e._simulated&&(this.dragging&&this.dragging.moved()||this.boxZoom&&this.boxZoom.moved())||i.DomEvent._skipped(e))return;this.fire("preclick"),this._fireMouseEvent(e)},_fireMouseEvent:function(e){if(!this._loaded||i.DomEvent._skipped(e))return;var t=e.type;t=t==="mouseenter"?"mouseover":t==="mouseleave"?"mouseout":t;if(!this.hasEventListeners(t))return;t==="contextmenu"&&i.DomEvent.preventDefault(e);var n=this.mouseEventToContainerPoint(e),r=this.containerPointToLayerPoint(n),s=this.layerPointToLatLng(r);this.fire(t,{latlng:s,layerPoint:r,containerPoint:n,originalEvent:e})},_onTileLayerLoad:function(){this._tileLayersToLoad--,this._tileLayersNum&&!this._tileLayersToLoad&&this.fire("tilelayersload")},_clearHandlers:function(){for(var e=0,t=this._handlers.length;e<t;e++)this._handlers[e].disable()},whenReady:function(e,t){return this._loaded?e.call(t||this,this):this.on("load",e,t),this},_layerAdd:function(e){e.onAdd(this),this.fire("layeradd",{layer:e})},_getMapPanePos:function(){return i.DomUtil.getPosition(this._mapPane)},_moved:function(){var e=this._getMapPanePos();return e&&!e.equals([0,0])},_getTopLeftPoint:function(){return this.getPixelOrigin().subtract(this._getMapPanePos())},_getNewTopLeftPoint:function(e,t){var n=this.getSize()._divideBy(2);return this.project(e,t)._subtract(n)._round()},_latLngToNewLayerPoint:function(e,t,n){var r=this._getNewTopLeftPoint(n,t).add(this._getMapPanePos());return this.project(e,t)._subtract(r)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(e){return this.latLngToLayerPoint(e).subtract(this._getCenterLayerPoint())},_limitCenter:function(e,t,n){if(!n)return e;var r=this.project(e,t),s=this.getSize().divideBy(2),o=new i.Bounds(r.subtract(s),r.add(s)),u=this._getBoundsOffset(o,n,t);return this.unproject(r.add(u),t)},_limitOffset:function(e,t){if(!t)return e;var n=this.getPixelBounds(),r=new i.Bounds(n.min.add(e),n.max.add(e));return e.add(this._getBoundsOffset(r,t))},_getBoundsOffset:function(e,t,n){var r=this.project(t.getNorthWest(),n).subtract(e.min),s=this.project(t.getSouthEast(),n).subtract(e.max),o=this._rebound(r.x,-s.x),u=this._rebound(r.y,-s.y);return new i.Point(o,u)},_rebound:function(e,t){return e+t>0?Math.round(e-t)/2:Math.max(0,Math.ceil(e))-Math.max(0,Math.floor(t))},_limitZoom:function(e){var t=this.getMinZoom(),n=this.getMaxZoom();return Math.max(t,Math.min(n,e))}}),i.map=function(e,t){return new i.Map(e,t)},i.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.314245179,R_MAJOR:6378137,project:function(e){var t=i.LatLng.DEG_TO_RAD,n=this.MAX_LATITUDE,r=Math.max(Math.min(n,e.lat),-n),s=this.R_MAJOR,o=this.R_MINOR,u=e.lng*t*s,a=r*t,f=o/s,l=Math.sqrt(1-f*f),c=l*Math.sin(a);c=Math.pow((1-c)/(1+c),l*.5);var h=Math.tan(.5*(Math.PI*.5-a))/c;return a=-s*Math.log(h),new i.Point(u,a)},unproject:function(e){var t=i.LatLng.RAD_TO_DEG,n=this.R_MAJOR,r=this.R_MINOR,s=e.x*t/n,o=r/n,u=Math.sqrt(1-o*o),a=Math.exp(-e.y/n),f=Math.PI/2-2*Math.atan(a),l=15,c=1e-7,h=l,p=.1,d;while(Math.abs(p)>c&&--h>0)d=u*Math.sin(f),p=Math.PI/2-2*Math.atan(a*Math.pow((1-d)/(1+d),.5*u))-f,f+=p;return new i.LatLng(f*t,s)}},i.CRS.EPSG3395=i.extend({},i.CRS,{code:"EPSG:3395",projection:i.Projection.Mercator,transformation:function(){var e=i.Projection.Mercator,t=e.R_MAJOR,n=.5/(Math.PI*t);return new i.Transformation(n,.5,-n,.5)}()}),i.TileLayer=i.Class.extend({includes:i.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",zoomOffset:0,opacity:1,unloadInvisibleTiles:i.Browser.mobile,updateWhenIdle:i.Browser.mobile},initialize:function(e,t){t=i.setOptions(this,t),t.detectRetina&&i.Browser.retina&&t.maxZoom>0&&(t.tileSize=Math.floor(t.tileSize/2),t.zoomOffset++,t.minZoom>0&&t.minZoom--,this.options.maxZoom--),t.bounds&&(t.bounds=i.latLngBounds(t.bounds)),this._url=e;var n=this.options.subdomains;typeof n=="string"&&(this.options.subdomains=n.split(""))},onAdd:function(e){this._map=e,this._animated=e._zoomAnimated,this._initContainer(),e.on({viewreset:this._reset,moveend:this._update},this),this._animated&&e.on({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||(this._limitedUpdate=i.Util.limitExecByInterval(this._update,150,this),e.on("move",this._limitedUpdate,this)),this._reset(),this._update()},addTo:function(e){return e.addLayer(this),this},onRemove:function(e){this._container.parentNode.removeChild(this._container),e.off({viewreset:this._reset,moveend:this._update},this),this._animated&&e.off({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||e.off("move",this._limitedUpdate,this),this._container=null,this._map=null},bringToFront:function(){var e=this._map._panes.tilePane;return this._container&&(e.appendChild(this._container),this._setAutoZIndex(e,Math.max)),this},bringToBack:function(){var e=this._map._panes.tilePane;return this._container&&(e.insertBefore(this._container,e.firstChild),this._setAutoZIndex(e,Math.min)),this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(e){return this.options.opacity=e,this._map&&this._updateOpacity(),this},setZIndex:function(e){return this.options.zIndex=e,this._updateZIndex(),this},setUrl:function(e,t){return this._url=e,t||this.redraw(),this},redraw:function(){return this._map&&(this._reset({hard:!0}),this._update()),this},_updateZIndex:function(){this._container&&this.options.zIndex!==n&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(e,t){var n=e.children,r=-t(Infinity,-Infinity),i,s,o;for(s=0,o=n.length;s<o;s++)n[s]!==this._container&&(i=parseInt(n[s].style.zIndex,10),isNaN(i)||(r=t(r,i)));this.options.zIndex=this._container.style.zIndex=(isFinite(r)?r:0)+t(1,-1)},_updateOpacity:function(){var e,t=this._tiles;if(i.Browser.ielt9)for(e in t)i.DomUtil.setOpacity(t[e],this.options.opacity);else i.DomUtil.setOpacity(this._container,this.options.opacity)},_initContainer:function(){var e=this._map._panes.tilePane;if(!this._container){this._container=i.DomUtil.create("div","leaflet-layer"),this._updateZIndex();if(this._animated){var t="leaflet-tile-container";this._bgBuffer=i.DomUtil.create("div",t,this._container),this._tileContainer=i.DomUtil.create("div",t,this._container)}else this._tileContainer=this._container;e.appendChild(this._container),this.options.opacity<1&&this._updateOpacity()}},_reset:function(e){for(var t in this._tiles)this.fire("tileunload",{tile:this._tiles[t]});this._tiles={},this._tilesToLoad=0,this.options.reuseTiles&&(this._unusedTiles=[]),this._tileContainer.innerHTML="",this._animated&&e&&e.hard&&this._clearBgBuffer(),this._initContainer()},_getTileSize:function(){var e=this._map,t=e.getZoom()+this.options.zoomOffset,n=this.options.maxNativeZoom,r=this.options.tileSize;return n&&t>n&&(r=Math.round(e.getZoomScale(t)/e.getZoomScale(n)*r)),r},_update:function(){if(!this._map)return;var e=this._map,t=e.getPixelBounds(),n=e.getZoom(),r=this._getTileSize();if(n>this.options.maxZoom||n<this.options.minZoom)return;var s=i.bounds(t.min.divideBy(r)._floor(),t.max.divideBy(r)._floor());this._addTilesFromCenterOut(s),(this.options.unloadInvisibleTiles||this.options.reuseTiles)&&this._removeOtherTiles(s)},_addTilesFromCenterOut:function(e){var n=[],r=e.getCenter(),s,o,u;for(s=e.min.y;s<=e.max.y;s++)for(o=e.min.x;o<=e.max.x;o++)u=new i.Point(o,s),this._tileShouldBeLoaded(u)&&n.push(u);var a=n.length;if(a===0)return;n.sort(function(e,t){return e.distanceTo(r)-t.distanceTo(r)});var f=t.createDocumentFragment();this._tilesToLoad||this.fire("loading"),this._tilesToLoad+=a;for(o=0;o<a;o++)this._addTile(n[o],f);this._tileContainer.appendChild(f)},_tileShouldBeLoaded:function(e){if(e.x+":"+e.y in this._tiles)return!1;var t=this.options;if(!t.continuousWorld){var n=this._getWrapTileNum();if(t.noWrap&&(e.x<0||e.x>=n.x)||e.y<0||e.y>=n.y)return!1}if(t.bounds){var r=t.tileSize,i=e.multiplyBy(r),s=i.add([r,r]),o=this._map.unproject(i),u=this._map.unproject(s);!t.continuousWorld&&!t.noWrap&&(o=o.wrap(),u=u.wrap());if(!t.bounds.intersects([o,u]))return!1}return!0},_removeOtherTiles:function(e){var t,n,r,i;for(i in this._tiles)t=i.split(":"),n=parseInt(t[0],10),r=parseInt(t[1],10),(n<e.min.x||n>e.max.x||r<e.min.y||r>e.max.y)&&this._removeTile(i)},_removeTile:function(e){var t=this._tiles[e];this.fire("tileunload",{tile:t,url:t.src}),this.options.reuseTiles?(i.DomUtil.removeClass(t,"leaflet-tile-loaded"),this._unusedTiles.push(t)):t.parentNode===this._tileContainer&&this._tileContainer.removeChild(t),i.Browser.android||(t.onload=null,t.src=i.Util.emptyImageUrl),delete this._tiles[e]},_addTile:function(e,t){var n=this._getTilePos(e),r=this._getTile();i.DomUtil.setPosition(r,n,i.Browser.chrome),this._tiles[e.x+":"+e.y]=r,this._loadTile(r,e),r.parentNode!==this._tileContainer&&t.appendChild(r)},_getZoomForUrl:function(){var e=this.options,t=this._map.getZoom();return e.zoomReverse&&(t=e.maxZoom-t),t+=e.zoomOffset,e.maxNativeZoom?Math.min(t,e.maxNativeZoom):t},_getTilePos:function(e){var t=this._map.getPixelOrigin(),n=this._getTileSize();return e.multiplyBy(n).subtract(t)},getTileUrl:function(e){return i.Util.template(this._url,i.extend({s:this._getSubdomain(e),z:e.z,x:e.x,y:e.y},this.options))},_getWrapTileNum:function(){var e=this._map.options.crs,t=e.getSize(this._map.getZoom());return t.divideBy(this._getTileSize())._floor()},_adjustTilePoint:function(e){var t=this._getWrapTileNum();!this.options.continuousWorld&&!this.options.noWrap&&(e.x=(e.x%t.x+t.x)%t.x),this.options.tms&&(e.y=t.y-e.y-1),e.z=this._getZoomForUrl()},_getSubdomain:function(e){var t=Math.abs(e.x+e.y)%this.options.subdomains.length;return this.options.subdomains[t]},_getTile:function(){if(this.options.reuseTiles&&this._unusedTiles.length>0){var e=this._unusedTiles.pop();return this._resetTile(e),e}return this._createTile()},_resetTile:function(){},_createTile:function(){var e=i.DomUtil.create("img","leaflet-tile");return e.style.width=e.style.height=this._getTileSize()+"px",e.galleryimg="no",e.onselectstart=e.onmousemove=i.Util.falseFn,i.Browser.ielt9&&this.options.opacity!==n&&i.DomUtil.setOpacity(e,this.options.opacity),i.Browser.mobileWebkit3d&&(e.style.WebkitBackfaceVisibility="hidden"),e},_loadTile:function(e,t){e._layer=this,e.onload=this._tileOnLoad,e.onerror=this._tileOnError,this._adjustTilePoint(t),e.src=this.getTileUrl(t),this.fire("tileloadstart",{tile:e,url:e.src})},_tileLoaded:function(){this._tilesToLoad--,this._animated&&i.DomUtil.addClass(this._tileContainer,"leaflet-zoom-animated"),this._tilesToLoad||(this.fire("load"),this._animated&&(clearTimeout(this._clearBgBufferTimer),this._clearBgBufferTimer=setTimeout(i.bind(this._clearBgBuffer,this),500)))},_tileOnLoad:function(){var e=this._layer;this.src!==i.Util.emptyImageUrl&&(i.DomUtil.addClass(this,"leaflet-tile-loaded"),e.fire("tileload",{tile:this,url:this.src})),e._tileLoaded()},_tileOnError:function(){var e=this._layer;e.fire("tileerror",{tile:this,url:this.src});var t=e.options.errorTileUrl;t&&(this.src=t),e._tileLoaded()}}),i.tileLayer=function(e,t){return new i.TileLayer(e,t)},i.TileLayer.WMS=i.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(e,t){this._url=e;var n=i.extend({},this.defaultWmsParams),r=t.tileSize||this.options.tileSize;t.detectRetina&&i.Browser.retina?n.width=n.height=r*2:n.width=n.height=r;for(var s in t)!this.options.hasOwnProperty(s)&&s!=="crs"&&(n[s]=t[s]);this.wmsParams=n,i.setOptions(this,t)},onAdd:function(e){this._crs=this.options.crs||e.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var t=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[t]=this._crs.code,i.TileLayer.prototype.onAdd.call(this,e)},getTileUrl:function(e){var t=this._map,n=this.options.tileSize,r=e.multiplyBy(n),s=r.add([n,n]),o=this._crs.project(t.unproject(r,e.z)),u=this._crs.project(t.unproject(s,e.z)),a=this._wmsVersion>=1.3&&this._crs===i.CRS.EPSG4326?[u.y,o.x,o.y,u.x].join(","):[o.x,u.y,u.x,o.y].join(","),f=i.Util.template(this._url,{s:this._getSubdomain(e)});return f+i.Util.getParamString(this.wmsParams,f,!0)+"&BBOX="+a},setParams:function(e,t){return i.extend(this.wmsParams,e),t||this.redraw(),this}}),i.tileLayer.wms=function(e,t){return new i.TileLayer.WMS(e,t)},i.TileLayer.Canvas=i.TileLayer.extend({options:{async:!1},initialize:function(e){i.setOptions(this,e)},redraw:function(){this._map&&(this._reset({hard:!0}),this._update());for(var e in this._tiles)this._redrawTile(this._tiles[e]);return this},_redrawTile:function(e){this.drawTile(e,e._tilePoint,this._map._zoom)},_createTile:function(){var e=i.DomUtil.create("canvas","leaflet-tile");return e.width=e.height=this.options.tileSize,e.onselectstart=e.onmousemove=i.Util.falseFn,e},_loadTile:function(e,t){e._layer=this,e._tilePoint=t,this._redrawTile(e),this.options.async||this.tileDrawn(e)},drawTile:function(){},tileDrawn:function(e){this._tileOnLoad.call(e)}}),i.tileLayer.canvas=function(e){return new i.TileLayer.Canvas(e)},i.ImageOverlay=i.Class.extend({includes:i.Mixin.Events,options:{opacity:1},initialize:function(e,t,n){this._url=e,this._bounds=i.latLngBounds(t),i.setOptions(this,n)},onAdd:function(e){this._map=e,this._image||this._initImage(),e._panes.overlayPane.appendChild(this._image),e.on("viewreset",this._reset,this),e.options.zoomAnimation&&i.Browser.any3d&&e.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(e){e.getPanes().overlayPane.removeChild(this._image),e.off("viewreset",this._reset,this),e.options.zoomAnimation&&e.off("zoomanim",this._animateZoom,this)},addTo:function(e){return e.addLayer(this),this},setOpacity:function(e){return this.options.opacity=e,this._updateOpacity(),this},bringToFront:function(){return this._image&&this._map._panes.overlayPane.appendChild(this._image),this},bringToBack:function(){var e=this._map._panes.overlayPane;return this._image&&e.insertBefore(this._image,e.firstChild),this},setUrl:function(e){this._url=e,this._image.src=this._url},getAttribution:function(){return this.options.attribution},_initImage:function(){this._image=i.DomUtil.create("img","leaflet-image-layer"),this._map.options.zoomAnimation&&i.Browser.any3d?i.DomUtil.addClass(this._image,"leaflet-zoom-animated"):i.DomUtil.addClass(this._image,"leaflet-zoom-hide"),this._updateOpacity(),i.extend(this._image,{galleryimg:"no",onselectstart:i.Util.falseFn,onmousemove:i.Util.falseFn,onload:i.bind(this._onImageLoad,this),src:this._url})},_animateZoom:function(e){var t=this._map,n=this._image,r=t.getZoomScale(e.zoom),s=this._bounds.getNorthWest(),o=this._bounds.getSouthEast(),u=t._latLngToNewLayerPoint(s,e.zoom,e.center),a=t._latLngToNewLayerPoint(o,e.zoom,e.center)._subtract(u),f=u._add(a._multiplyBy(.5*(1-1/r)));n.style[i.DomUtil.TRANSFORM]=i.DomUtil.getTranslateString(f)+" scale("+r+") "},_reset:function(){var e=this._image,t=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),n=this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(t);i.DomUtil.setPosition(e,t),e.style.width=n.x+"px",e.style.height=n.y+"px"},_onImageLoad:function(){this.fire("load")},_updateOpacity:function(){i.DomUtil.setOpacity(this._image,this.options.opacity)}}),i.imageOverlay=function(e,t,n){return new i.ImageOverlay(e,t,n)},i.Icon=i.Class.extend({options:{className:""},initialize:function(e){i.setOptions(this,e)},createIcon:function(e){return this._createIcon("icon",e)},createShadow:function(e){return this._createIcon("shadow",e)},_createIcon:function(e,t){var n=this._getIconUrl(e);if(!n){if(e==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var r;return!t||t.tagName!=="IMG"?r=this._createImg(n):r=this._createImg(n,t),this._setIconStyles(r,e),r},_setIconStyles:function(e,t){var n=this.options,r=i.point(n[t+"Size"]),s;t==="shadow"?s=i.point(n.shadowAnchor||n.iconAnchor):s=i.point(n.iconAnchor),!s&&r&&(s=r.divideBy(2,!0)),e.className="leaflet-marker-"+t+" "+n.className,s&&(e.style.marginLeft=-s.x+"px",e.style.marginTop=-s.y+"px"),r&&(e.style.width=r.x+"px",e.style.height=r.y+"px")},_createImg:function(e,n){return n=n||t.createElement("img"),n.src=e,n},_getIconUrl:function(e){return i.Browser.retina&&this.options[e+"RetinaUrl"]?this.options[e+"RetinaUrl"]:this.options[e+"Url"]}}),i.icon=function(e){return new i.Icon(e)},i.Icon.Default=i.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},_getIconUrl:function(e){var t=e+"Url";if(this.options[t])return this.options[t];i.Browser.retina&&e==="icon"&&(e+="-2x");var n=i.Icon.Default.imagePath;if(!n)throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return n+"/marker-"+e+".png"}}),i.Icon.Default.imagePath=function(){var e=t.getElementsByTagName("script"),n=/[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/,r,i,s,o,u;for(r=0,i=e.length;r<i;r++){s=e[r].src,o=s.match(n);if(o)return u=s.split(n)[0],(u?u+"/":"")+"images"}}(),i.Marker=i.Class.extend({includes:i.Mixin.Events,options:{icon:new i.Icon.Default,title:"",alt:"",clickable:!0,draggable:!1,keyboard:!0,zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250},initialize:function(e,t){i.setOptions(this,t),this._latlng=i.latLng(e)},onAdd:function(e){this._map=e,e.on("viewreset",this.update,this),this._initIcon(),this.update(),this.fire("add"),e.options.zoomAnimation&&e.options.markerZoomAnimation&&e.on("zoomanim",this._animateZoom,this)},addTo:function(e){return e.addLayer(this),this},onRemove:function(e){this.dragging&&this.dragging.disable(),this._removeIcon(),this._removeShadow(),this.fire("remove"),e.off({viewreset:this.update,zoomanim:this._animateZoom},this),this._map=null},getLatLng:function(){return this._latlng},setLatLng:function(e){return this._latlng=i.latLng(e),this.update(),this.fire("move",{latlng:this._latlng})},setZIndexOffset:function(e){return this.options.zIndexOffset=e,this.update(),this},setIcon:function(e){return this.options.icon=e,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup),this},update:function(){if(this._icon){var e=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(e)}return this},_initIcon:function(){var e=this.options,t=this._map,n=t.options.zoomAnimation&&t.options.markerZoomAnimation,r=n?"leaflet-zoom-animated":"leaflet-zoom-hide",s=e.icon.createIcon(this._icon),o=!1;s!==this._icon&&(this._icon&&this._removeIcon(),o=!0,e.title&&(s.title=e.title),e.alt&&(s.alt=e.alt)),i.DomUtil.addClass(s,r),e.keyboard&&(s.tabIndex="0"),this._icon=s,this._initInteraction(),e.riseOnHover&&i.DomEvent.on(s,"mouseover",this._bringToFront,this).on(s,"mouseout",this._resetZIndex,this);var u=e.icon.createShadow(this._shadow),a=!1;u!==this._shadow&&(this._removeShadow(),a=!0),u&&i.DomUtil.addClass(u,r),this._shadow=u,e.opacity<1&&this._updateOpacity();var f=this._map._panes;o&&f.markerPane.appendChild(this._icon),u&&a&&f.shadowPane.appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&i.DomEvent.off(this._icon,"mouseover",this._bringToFront).off(this._icon,"mouseout",this._resetZIndex),this._map._panes.markerPane.removeChild(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&this._map._panes.shadowPane.removeChild(this._shadow),this._shadow=null},_setPos:function(e){i.DomUtil.setPosition(this._icon,e),this._shadow&&i.DomUtil.setPosition(this._shadow,e),this._zIndex=e.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(e){this._icon.style.zIndex=this._zIndex+e},_animateZoom:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center).round();this._setPos(t)},_initInteraction:function(){if(!this.options.clickable)return;var e=this._icon,t=["dblclick","mousedown","mouseover","mouseout","contextmenu"];i.DomUtil.addClass(e,"leaflet-clickable"),i.DomEvent.on(e,"click",this._onMouseClick,this),i.DomEvent.on(e,"keypress",this._onKeyPress,this);for(var n=0;n<t.length;n++)i.DomEvent.on(e,t[n],this._fireMouseEvent,this);i.Handler.MarkerDrag&&(this.dragging=new i.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())},_onMouseClick:function(e){var t=this.dragging&&this.dragging.moved();(this.hasEventListeners(e.type)||t)&&i.DomEvent.stopPropagation(e);if(t)return;if((!this.dragging||!this.dragging._enabled)&&this._map.dragging&&this._map.dragging.moved())return;this.fire(e.type,{originalEvent:e,latlng:this._latlng})},_onKeyPress:function(e){e.keyCode===13&&this.fire("click",{originalEvent:e,latlng:this._latlng})},_fireMouseEvent:function(e){this.fire(e.type,{originalEvent:e,latlng:this._latlng}),e.type==="contextmenu"&&this.hasEventListeners(e.type)&&i.DomEvent.preventDefault(e),e.type!=="mousedown"?i.DomEvent.stopPropagation(e):i.DomEvent.preventDefault(e)},setOpacity:function(e){return this.options.opacity=e,this._map&&this._updateOpacity(),this},_updateOpacity:function(){i.DomUtil.setOpacity(this._icon,this.options.opacity),this._shadow&&i.DomUtil.setOpacity(this._shadow,this.options.opacity)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}}),i.marker=function(e,t){return new i.Marker(e,t)},i.DivIcon=i.Icon.extend({options:{iconSize:[12,12],className:"leaflet-div-icon",html:!1},createIcon:function(e){var n=e&&e.tagName==="DIV"?e:t.createElement("div"),r=this.options;return r.html!==!1?n.innerHTML=r.html:n.innerHTML="",r.bgPos&&(n.style.backgroundPosition=-r.bgPos.x+"px "+ -r.bgPos.y+"px"),this._setIconStyles(n,"icon"),n},createShadow:function(){return null}}),i.divIcon=function(e){return new i.DivIcon(e)},i.Map.mergeOptions({closePopupOnClick:!0}),i.Popup=i.Class.extend({includes:i.Mixin.Events,options:{minWidth:50,maxWidth:300,autoPan:!0,closeButton:!0,offset:[0,7],autoPanPadding:[5,5],keepInView:!1,className:"",zoomAnimation:!0},initialize:function(e,t){i.setOptions(this,e),this._source=t,this._animated=i.Browser.any3d&&this.options.zoomAnimation,this._isOpen=!1},onAdd:function(e){this._map=e,this._container||this._initLayout();var t=e.options.fadeAnimation;t&&i.DomUtil.setOpacity(this._container,0),e._panes.popupPane.appendChild(this._container),e.on(this._getEvents(),this),this.update(),t&&i.DomUtil.setOpacity(this._container,1),this.fire("open"),e.fire("popupopen",{popup:this}),this._source&&this._source.fire("popupopen",{popup:this})},addTo:function(e){return e.addLayer(this),this},openOn:function(e){return e.openPopup(this),this},onRemove:function(e){e._panes.popupPane.removeChild(this._container),i.Util.falseFn(this._container.offsetWidth),e.off(this._getEvents(),this),e.options.fadeAnimation&&i.DomUtil.setOpacity(this._container,0),this._map=null,this.fire("close"),e.fire("popupclose",{popup:this}),this._source&&this._source.fire("popupclose",{popup:this})},getLatLng:function(){return this._latlng},setLatLng:function(e){return this._latlng=i.latLng(e),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(e){return this._content=e,this.update(),this},update:function(){if(!this._map)return;this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan()},_getEvents:function(){var e={viewreset:this._updatePosition};this._animated&&(e.zoomanim=this._zoomAnimation);if("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)e.preclick=this._close;return this.options.keepInView&&(e.moveend=this._adjustPan),e},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var e="leaflet-popup",t=e+" "+this.options.className+" leaflet-zoom-"+(this._animated?"animated":"hide"),n=this._container=i.DomUtil.create("div",t),r;this.options.closeButton&&(r=this._closeButton=i.DomUtil.create("a",e+"-close-button",n),r.href="#close",r.innerHTML="&#215;",i.DomEvent.disableClickPropagation(r),i.DomEvent.on(r,"click",this._onCloseButtonClick,this));var s=this._wrapper=i.DomUtil.create("div",e+"-content-wrapper",n);i.DomEvent.disableClickPropagation(s),this._contentNode=i.DomUtil.create("div",e+"-content",s),i.DomEvent.disableScrollPropagation(this._contentNode),i.DomEvent.on(s,"contextmenu",i.DomEvent.stopPropagation),this._tipContainer=i.DomUtil.create("div",e+"-tip-container",n),this._tip=i.DomUtil.create("div",e+"-tip",this._tipContainer)},_updateContent:function(){if(!this._content)return;if(typeof this._content=="string")this._contentNode.innerHTML=this._content;else{while(this._contentNode.hasChildNodes())this._contentNode.removeChild(this._contentNode.firstChild);this._contentNode.appendChild(this._content)}this.fire("contentupdate")},_updateLayout:function(){var e=this._contentNode,t=e.style;t.width="",t.whiteSpace="nowrap";var n=e.offsetWidth;n=Math.min(n,this.options.maxWidth),n=Math.max(n,this.options.minWidth),t.width=n+1+"px",t.whiteSpace="",t.height="";var r=e.offsetHeight,s=this.options.maxHeight,o="leaflet-popup-scrolled";s&&r>s?(t.height=s+"px",i.DomUtil.addClass(e,o)):i.DomUtil.removeClass(e,o),this._containerWidth=this._container.offsetWidth},_updatePosition:function(){if(!this._map)return;var e=this._map.latLngToLayerPoint(this._latlng),t=this._animated,n=i.point(this.options.offset);t&&i.DomUtil.setPosition(this._container,e),this._containerBottom=-n.y-(t?0:e.y),this._containerLeft=-Math.round(this._containerWidth/2)+n.x+(t?0:e.x),this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"},_zoomAnimation:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center);i.DomUtil.setPosition(this._container,t)},_adjustPan:function(){if(!this.options.autoPan)return;var e=this._map,t=this._container.offsetHeight,n=this._containerWidth,r=new i.Point(this._containerLeft,-t-this._containerBottom);this._animated&&r._add(i.DomUtil.getPosition(this._container));var s=e.layerPointToContainerPoint(r),o=i.point(this.options.autoPanPadding),u=i.point(this.options.autoPanPaddingTopLeft||o),a=i.point(this.options.autoPanPaddingBottomRight||o),f=e.getSize(),l=0,c=0;s.x+n+a.x>f.x&&(l=s.x+n-f.x+a.x),s.x-l-u.x<0&&(l=s.x-u.x),s.y+t+a.y>f.y&&(c=s.y+t-f.y+a.y),s.y-c-u.y<0&&(c=s.y-u.y),(l||c)&&e.fire("autopanstart").panBy([l,c])},_onCloseButtonClick:function(e){this._close(),i.DomEvent.stop(e)}}),i.popup=function(e,t){return new i.Popup(e,t)},i.Map.include({openPopup:function(e,t,n){this.closePopup();if(!(e instanceof i.Popup)){var r=e;e=(new i.Popup(n)).setLatLng(t).setContent(r)}return e._isOpen=!0,this._popup=e,this.addLayer(e)},closePopup:function(e){if(!e||e===this._popup)e=this._popup,this._popup=null;return e&&(this.removeLayer(e),e._isOpen=!1),this}}),i.Marker.include({openPopup:function(){return this._popup&&this._map&&!this._map.hasLayer(this._popup)&&(this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(){return this._popup&&(this._popup._isOpen?this.closePopup():this.openPopup()),this},bindPopup:function(e,t){var n=i.point(this.options.icon.options.popupAnchor||[0,0]);return n=n.add(i.Popup.prototype.options.offset),t&&t.offset&&(n=n.add(t.offset)),t=i.extend({offset:n},t),this._popupHandlersAdded||(this.on("click",this.togglePopup,this).on("remove",this.closePopup,this).on("move",this._movePopup,this),this._popupHandlersAdded=!0),e instanceof i.Popup?(i.setOptions(e,t),this._popup=e):this._popup=(new i.Popup(t,this)).setContent(e),this},setPopupContent:function(e){return this._popup&&this._popup.setContent(e),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this.togglePopup,this).off("remove",this.closePopup,this).off("move",this._movePopup,this),this._popupHandlersAdded=!1),this},getPopup:function(){return this._popup},_movePopup:function(e){this._popup.setLatLng(e.latlng)}}),i.LayerGroup=i.Class.extend({initialize:function(e){this._layers={};var t,n;if(e)for(t=0,n=e.length;t<n;t++)this.addLayer(e[t])},addLayer:function(e){var t=this.getLayerId(e);return this._layers[t]=e,this._map&&this._map.addLayer(e),this},removeLayer:function(e){var t=e in this._layers?e:this.getLayerId(e);return this._map&&this._layers[t]&&this._map.removeLayer(this._layers[t]),delete this._layers[t],this},hasLayer:function(e){return e?e in this._layers||this.getLayerId(e)in this._layers:!1},clearLayers:function(){return this.eachLayer(this.removeLayer,this),this},invoke:function(e){var t=Array.prototype.slice.call(arguments,1),n,r;for(n in this._layers)r=this._layers[n],r[e]&&r[e].apply(r,t);return this},onAdd:function(e){this._map=e,this.eachLayer(e.addLayer,e)},onRemove:function(e){this.eachLayer(e.removeLayer,e),this._map=null},addTo:function(e){return e.addLayer(this),this},eachLayer:function(e,t){for(var n in this._layers)e.call(t,this._layers[n]);return this},getLayer:function(e){return this._layers[e]},getLayers:function(){var e=[];for(var t in this._layers)e.push(this._layers[t]);return e},setZIndex:function(e){return this.invoke("setZIndex",e)},getLayerId:function(e){return i.stamp(e)}}),i.layerGroup=function(e){return new i.LayerGroup(e)},i.FeatureGroup=i.LayerGroup.extend({includes:i.Mixin.Events,statics:{EVENTS:"click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose"},addLayer:function(e){return this.hasLayer(e)?this:("on"in e&&e.on(i.FeatureGroup.EVENTS,this._propagateEvent,this),i.LayerGroup.prototype.addLayer.call(this,e),this._popupContent&&e.bindPopup&&e.bindPopup(this._popupContent,this._popupOptions),this.fire("layeradd",{layer:e}))},removeLayer:function(e){return this.hasLayer(e)?(e in this._layers&&(e=this._layers[e]),e.off(i.FeatureGroup.EVENTS,this._propagateEvent,this),i.LayerGroup.prototype.removeLayer.call(this,e),this._popupContent&&this.invoke("unbindPopup"),this.fire("layerremove",{layer:e})):this},bindPopup:function(e,t){return this._popupContent=e,this._popupOptions=t,this.invoke("bindPopup",e,t)},openPopup:function(e){for(var t in this._layers){this._layers[t].openPopup(e);break}return this},setStyle:function(e){return this.invoke("setStyle",e)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var e=new i.LatLngBounds;return this.eachLayer(function(t){e.extend(t instanceof i.Marker?t.getLatLng():t.getBounds())}),e},_propagateEvent:function(e){e=i.extend({layer:e.target,target:this},e),this.fire(e.type,e)}}),i.featureGroup=function(e){return new i.FeatureGroup(e)},i.Path=i.Class.extend({includes:[i.Mixin.Events],statics:{CLIP_PADDING:function(){var t=i.Browser.mobile?1280:2e3,n=(t/Math.max(e.outerWidth,e.outerHeight)-1)/2;return Math.max(0,Math.min(.5,n))}()},options:{stroke:!0,color:"#0033ff",dashArray:null,lineCap:null,lineJoin:null,weight:5,opacity:.5,fill:!1,fillColor:null,fillOpacity:.2,clickable:!0},initialize:function(e){i.setOptions(this,e)},onAdd:function(e){this._map=e,this._container||(this._initElements(),this._initEvents()),this.projectLatlngs(),this._updatePath(),this._container&&this._map._pathRoot.appendChild(this._container),this.fire("add"),e.on({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},addTo:function(e){return e.addLayer(this),this},onRemove:function(e){e._pathRoot.removeChild(this._container),this.fire("remove"),this._map=null,i.Browser.vml&&(this._container=null,this._stroke=null,this._fill=null),e.off({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},projectLatlngs:function(){},setStyle:function(e){return i.setOptions(this,e),this._container&&this._updateStyle(),this},redraw:function(){return this._map&&(this.projectLatlngs(),this._updatePath()),this}}),i.Map.include({_updatePathViewport:function(){var e=i.Path.CLIP_PADDING,t=this.getSize(),n=i.DomUtil.getPosition(this._mapPane),r=n.multiplyBy(-1)._subtract(t.multiplyBy(e)._round()),s=r.add(t.multiplyBy(1+e*2)._round());this._pathViewport=new i.Bounds(r,s)}}),i.Path.SVG_NS="http://www.w3.org/2000/svg",i.Browser.svg=!!t.createElementNS&&!!t.createElementNS(i.Path.SVG_NS,"svg").createSVGRect,i.Path=i.Path.extend({statics:{SVG:i.Browser.svg},bringToFront:function(){var e=this._map._pathRoot,t=this._container;return t&&e.lastChild!==t&&e.appendChild(t),this},bringToBack:function(){var e=this._map._pathRoot,t=this._container,n=e.firstChild;return t&&n!==t&&e.insertBefore(t,n),this},getPathString:function(){},_createElement:function(e){return t.createElementNS(i.Path.SVG_NS,e)},_initElements:function(){this._map._initPathRoot(),this._initPath(),this._initStyle()},_initPath:function(){this._container=this._createElement("g"),this._path=this._createElement("path"),this.options.className&&i.DomUtil.addClass(this._path,this.options.className),this._container.appendChild(this._path)},_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round")),this.options.fill&&this._path.setAttribute("fill-rule","evenodd"),this.options.pointerEvents&&this._path.setAttribute("pointer-events",this.options.pointerEvents),!this.options.clickable&&!this.options.pointerEvents&&this._path.setAttribute("pointer-events","none"),this._updateStyle()},_updateStyle:function(){this.options.stroke?(this._path.setAttribute("stroke",this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight),this.options.dashArray?this._path.setAttribute("stroke-dasharray",this.options.dashArray):this._path.removeAttribute("stroke-dasharray"),this.options.lineCap&&this._path.setAttribute("stroke-linecap",this.options.lineCap),this.options.lineJoin&&this._path.setAttribute("stroke-linejoin",this.options.lineJoin)):this._path.setAttribute("stroke","none"),this.options.fill?(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity)):this._path.setAttribute("fill","none")},_updatePath:function(){var e=this.getPathString();e||(e="M0 0"),this._path.setAttribute("d",e)},_initEvents:function(){if(this.options.clickable){(i.Browser.svg||!i.Browser.vml)&&i.DomUtil.addClass(this._path,"leaflet-clickable"),i.DomEvent.on(this._container,"click",this._onMouseClick,this);var e=["dblclick","mousedown","mouseover","mouseout","mousemove","contextmenu"];for(var t=0;t<e.length;t++)i.DomEvent.on(this._container,e[t],this._fireMouseEvent,this)}},_onMouseClick:function(e){if(this._map.dragging&&this._map.dragging.moved())return;this._fireMouseEvent(e)},_fireMouseEvent:function(e){if(!this.hasEventListeners(e.type))return;var t=this._map,n=t.mouseEventToContainerPoint(e),r=t.containerPointToLayerPoint(n),s=t.layerPointToLatLng(r);this.fire(e.type,{latlng:s,layerPoint:r,containerPoint:n,originalEvent:e}),e.type==="contextmenu"&&i.DomEvent.preventDefault(e),e.type!=="mousemove"&&i.DomEvent.stopPropagation(e)}}),i.Map.include({_initPathRoot:function(){this._pathRoot||(this._pathRoot=i.Path.prototype._createElement("svg"),this._panes.overlayPane.appendChild(this._pathRoot),this.options.zoomAnimation&&i.Browser.any3d?(i.DomUtil.addClass(this._pathRoot,"leaflet-zoom-animated"),this.on({zoomanim:this._animatePathZoom,zoomend:this._endPathZoom})):i.DomUtil.addClass(this._pathRoot,"leaflet-zoom-hide"),this.on("moveend",this._updateSvgViewport),this._updateSvgViewport())},_animatePathZoom:function(e){var t=this.getZoomScale(e.zoom),n=this._getCenterOffset(e.center)._multiplyBy(-t)._add(this._pathViewport.min);this._pathRoot.style[i.DomUtil.TRANSFORM]=i.DomUtil.getTranslateString(n)+" scale("+t+") ",this._pathZooming=!0},_endPathZoom:function(){this._pathZooming=!1},_updateSvgViewport:function(){if(this._pathZooming)return;this._updatePathViewport();var e=this._pathViewport,t=e.min,n=e.max,r=n.x-t.x,s=n.y-t.y,o=this._pathRoot,u=this._panes.overlayPane;i.Browser.mobileWebkit&&u.removeChild(o),i.DomUtil.setPosition(o,t),o.setAttribute("width",r),o.setAttribute("height",s),o.setAttribute("viewBox",[t.x,t.y,r,s].join(" ")),i.Browser.mobileWebkit&&u.appendChild(o)}}),i.Path.include({bindPopup:function(e,t){if(e instanceof i.Popup)this._popup=e;else{if(!this._popup||t)this._popup=new i.Popup(t,this);this._popup.setContent(e)}return this._popupHandlersAdded||(this.on("click",this._openPopup,this).on("remove",this.closePopup,this),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this._openPopup).off("remove",this.closePopup),this._popupHandlersAdded=!1),this},openPopup:function(e){return this._popup&&(e=e||this._latlng||this._latlngs[Math.floor(this._latlngs.length/2)],this._openPopup({latlng:e})),this},closePopup:function(){return this._popup&&this._popup._close(),this},_openPopup:function(e){this._popup.setLatLng(e.latlng),this._map.openPopup(this._popup)}}),i.Browser.vml=!i.Browser.svg&&function(){try{var e=t.createElement("div");e.innerHTML='<v:shape adj="1"/>';var n=e.firstChild;return n.style.behavior="url(#default#VML)",n&&typeof n.adj=="object"}catch(r){return!1}}(),i.Path=i.Browser.svg||!i.Browser.vml?i.Path:i.Path.extend({statics:{VML:!0,CLIP_PADDING:.02},_createElement:function(){try{return t.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(e){return t.createElement("<lvml:"+e+' class="lvml">')}}catch(e){return function(e){return t.createElement("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_initPath:function(){var e=this._container=this._createElement("shape");i.DomUtil.addClass(e,"leaflet-vml-shape"+(this.options.className?" "+this.options.className:"")),this.options.clickable&&i.DomUtil.addClass(e,"leaflet-clickable"),e.coordsize="1 1",this._path=this._createElement("path"),e.appendChild(this._path),this._map._pathRoot.appendChild(e)},_initStyle:function(){this._updateStyle()},_updateStyle:function(){var e=this._stroke,t=this._fill,n=this.options,r=this._container;r.stroked=n.stroke,r.filled=n.fill,n.stroke?(e||(e=this._stroke=this._createElement("stroke"),e.endcap="round",r.appendChild(e)),e.weight=n.weight+"px",e.color=n.color,e.opacity=n.opacity,n.dashArray?e.dashStyle=i.Util.isArray(n.dashArray)?n.dashArray.join(" "):n.dashArray.replace(/( *, *)/g," "):e.dashStyle="",n.lineCap&&(e.endcap=n.lineCap.replace("butt","flat")),n.lineJoin&&(e.joinstyle=n.lineJoin)):e&&(r.removeChild(e),this._stroke=null),n.fill?(t||(t=this._fill=this._createElement("fill"),r.appendChild(t)),t.color=n.fillColor||n.color,t.opacity=n.fillOpacity):t&&(r.removeChild(t),this._fill=null)},_updatePath:function(){var e=this._container.style;e.display="none",this._path.v=this.getPathString()+" ",e.display=""}}),i.Map.include(i.Browser.svg||!i.Browser.vml?{}:{_initPathRoot:function(){if(this._pathRoot)return;var e=this._pathRoot=t.createElement("div");e.className="leaflet-vml-container",this._panes.overlayPane.appendChild(e),this.on("moveend",this._updatePathViewport),this._updatePathViewport()}}),i.Browser.canvas=function(){return!!t.createElement("canvas").getContext}(),i.Path=i.Path.SVG&&!e.L_PREFER_CANVAS||!i.Browser.canvas?i.Path:i.Path.extend({statics:{CANVAS:!0,SVG:!1},redraw:function(){return this._map&&(this.projectLatlngs(),this._requestUpdate()),this},setStyle:function(e){return i.setOptions(this,e),this._map&&(this._updateStyle(),this._requestUpdate()),this},onRemove:function(e){e.off("viewreset",this.projectLatlngs,this).off("moveend",this._updatePath,this),this.options.clickable&&(this._map.off("click",this._onClick,this),this._map.off("mousemove",this._onMouseMove,this)),this._requestUpdate(),this._map=null},_requestUpdate:function(){this._map&&!i.Path._updateRequest&&(i.Path._updateRequest=i.Util.requestAnimFrame(this._fireMapMoveEnd,this._map))},_fireMapMoveEnd:function(){i.Path._updateRequest=null,this.fire("moveend")},_initElements:function(){this._map._initPathRoot(),this._ctx=this._map._canvasCtx},_updateStyle:function(){var e=this.options;e.stroke&&(this._ctx.lineWidth=e.weight,this._ctx.strokeStyle=e.color),e.fill&&(this._ctx.fillStyle=e.fillColor||e.color)},_drawPath:function(){var e,t,n,r,s,o;this._ctx.beginPath();for(e=0,n=this._parts.length;e<n;e++){for(t=0,r=this._parts[e].length;t<r;t++)s=this._parts[e][t],o=(t===0?"move":"line")+"To",this._ctx[o](s.x,s.y);this instanceof i.Polygon&&this._ctx.closePath()}},_checkIfEmpty:function(){return!this._parts.length},_updatePath:function(){if(this._checkIfEmpty())return;var e=this._ctx,t=this.options;this._drawPath(),e.save(),this._updateStyle(),t.fill&&(e.globalAlpha=t.fillOpacity,e.fill()),t.stroke&&(e.globalAlpha=t.opacity,e.stroke()),e.restore()},_initEvents:function(){this.options.clickable&&(this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onClick,this))},_onClick:function(e){this._containsPoint(e.layerPoint)&&this.fire("click",e)},_onMouseMove:function(e){if(!this._map||this._map._animatingZoom)return;this._containsPoint(e.layerPoint)?(this._ctx.canvas.style.cursor="pointer",this._mouseInside=!0,this.fire("mouseover",e)):this._mouseInside&&(this._ctx.canvas.style.cursor="",this._mouseInside=!1,this.fire("mouseout",e))}}),i.Map.include(i.Path.SVG&&!e.L_PREFER_CANVAS||!i.Browser.canvas?{}:{_initPathRoot:function(){var e=this._pathRoot,n;e||(e=this._pathRoot=t.createElement("canvas"),e.style.position="absolute",n=this._canvasCtx=e.getContext("2d"),n.lineCap="round",n.lineJoin="round",this._panes.overlayPane.appendChild(e),this.options.zoomAnimation&&(this._pathRoot.className="leaflet-zoom-animated",this.on("zoomanim",this._animatePathZoom),this.on("zoomend",this._endPathZoom)),this.on("moveend",this._updateCanvasViewport),this._updateCanvasViewport())},_updateCanvasViewport:function(){if(this._pathZooming)return;this._updatePathViewport();var e=this._pathViewport,t=e.min,n=e.max.subtract(t),r=this._pathRoot;i.DomUtil.setPosition(r,t),r.width=n.x,r.height=n.y,r.getContext("2d").translate(-t.x,-t.y)}}),i.LineUtil={simplify:function(e,t){if(!t||!e.length)return e.slice();var n=t*t;return e=this._reducePoints(e,n),e=this._simplifyDP(e,n),e},pointToSegmentDistance:function(e,t,n){return Math.sqrt(this._sqClosestPointOnSegment(e,t,n,!0))},closestPointOnSegment:function(e,t,n){return this._sqClosestPointOnSegment(e,t,n)},_simplifyDP:function(e,t){var r=e.length,i=typeof Uint8Array!=n+""?Uint8Array:Array,s=new i(r);s[0]=s[r-1]=1,this._simplifyDPStep(e,s,t,0,r-1);var o,u=[];for(o=0;o<r;o++)s[o]&&u.push(e[o]);return u},_simplifyDPStep:function(e,t,n,r,i){var s=0,o,u,a;for(u=r+1;u<=i-1;u++)a=this._sqClosestPointOnSegment(e[u],e[r],e[i],!0),a>s&&(o=u,s=a);s>n&&(t[o]=1,this._simplifyDPStep(e,t,n,r,o),this._simplifyDPStep(e,t,n,o,i))},_reducePoints:function(e,t){var n=[e[0]];for(var r=1,i=0,s=e.length;r<s;r++)this._sqDist(e[r],e[i])>t&&(n.push(e[r]),i=r);return i<s-1&&n.push(e[s-1]),n},clipSegment:function(e,t,n,r){var i=r?this._lastCode:this._getBitCode(e,n),s=this._getBitCode(t,n),o,u,a;this._lastCode=s;for(;;){if(!(i|s))return[e,t];if(i&s)return!1;o=i||s,u=this._getEdgeIntersection(e,t,o,n),a=this._getBitCode(u,n),o===i?(e=u,i=a):(t=u,s=a)}},_getEdgeIntersection:function(e,t,n,r){var s=t.x-e.x,o=t.y-e.y,u=r.min,a=r.max;if(n&8)return new i.Point(e.x+s*(a.y-e.y)/o,a.y);if(n&4)return new i.Point(e.x+s*(u.y-e.y)/o,u.y);if(n&2)return new i.Point(a.x,e.y+o*(a.x-e.x)/s);if(n&1)return new i.Point(u.x,e.y+o*(u.x-e.x)/s)},_getBitCode:function(e,t){var n=0;return e.x<t.min.x?n|=1:e.x>t.max.x&&(n|=2),e.y<t.min.y?n|=4:e.y>t.max.y&&(n|=8),n},_sqDist:function(e,t){var n=t.x-e.x,r=t.y-e.y;return n*n+r*r},_sqClosestPointOnSegment:function(e,t,n,r){var s=t.x,o=t.y,u=n.x-s,a=n.y-o,f=u*u+a*a,l;return f>0&&(l=((e.x-s)*u+(e.y-o)*a)/f,l>1?(s=n.x,o=n.y):l>0&&(s+=u*l,o+=a*l)),u=e.x-s,a=e.y-o,r?u*u+a*a:new i.Point(s,o)}},i.Polyline=i.Path.extend({initialize:function(e,t){i.Path.prototype.initialize.call(this,t),this._latlngs=this._convertLatLngs(e)},options:{smoothFactor:1,noClip:!1},projectLatlngs:function(){this._originalPoints=[];for(var e=0,t=this._latlngs.length;e<t;e++)this._originalPoints[e]=this._map.latLngToLayerPoint(this._latlngs[e])},getPathString:function(){for(var e=0,t=this._parts.length,n="";e<t;e++)n+=this._getPathPartStr(this._parts[e]);return n},getLatLngs:function(){return this._latlngs},setLatLngs:function(e){return this._latlngs=this._convertLatLngs(e),this.redraw()},addLatLng:function(e){return this._latlngs.push(i.latLng(e)),this.redraw()},spliceLatLngs:function(){var e=[].splice.apply(this._latlngs,arguments);return this._convertLatLngs(this._latlngs,!0),this.redraw(),e},closestLayerPoint:function(e){var t=Infinity,n=this._parts,r,s,o=null;for(var u=0,a=n.length;u<a;u++){var f=n[u];for(var l=1,c=f.length;l<c;l++){r=f[l-1],s=f[l];var h=i.LineUtil._sqClosestPointOnSegment(e,r,s,!0);h<t&&(t=h,o=i.LineUtil._sqClosestPointOnSegment(e,r,s))}}return o&&(o.distance=Math.sqrt(t)),o},getBounds:function(){return new i.LatLngBounds(this.getLatLngs())},_convertLatLngs:function(e,t){var n,r,s=t?e:[];for(n=0,r=e.length;n<r;n++){if(i.Util.isArray(e[n])&&typeof e[n][0]!="number")return;s[n]=i.latLng(e[n])}return s},_initEvents:function(){i.Path.prototype._initEvents.call(this)},_getPathPartStr:function(e){var t=i.Path.VML;for(var n=0,r=e.length,s="",o;n<r;n++)o=e[n],t&&o._round(),s+=(n?"L":"M")+o.x+" "+o.y;return s},_clipPoints:function(){var e=this._originalPoints,t=e.length,n,r,s;if(this.options.noClip){this._parts=[e];return}this._parts=[];var o=this._parts,u=this._map._pathViewport,a=i.LineUtil;for(n=0,r=0;n<t-1;n++){s=a.clipSegment(e[n],e[n+1],u,n);if(!s)continue;o[r]=o[r]||[],o[r].push(s[0]);if(s[1]!==e[n+1]||n===t-2)o[r].push(s[1]),r++}},_simplifyPoints:function(){var e=this._parts,t=i.LineUtil;for(var n=0,r=e.length;n<r;n++)e[n]=t.simplify(e[n],this.options.smoothFactor)},_updatePath:function(){if(!this._map)return;this._clipPoints(),this._simplifyPoints(),i.Path.prototype._updatePath.call(this)}}),i.polyline=function(e,t){return new i.Polyline(e,t)},i.PolyUtil={},i.PolyUtil.clipPolygon=function(e,t){var n,r=[1,4,2,8],s,o,u,a,f,l,c,h,p=i.LineUtil;for(s=0,l=e.length;s<l;s++)e[s]._code=p._getBitCode(e[s],t);for(u=0;u<4;u++){c=r[u],n=[];for(s=0,l=e.length,o=l-1;s<l;o=s++)a=e[s],f=e[o],a._code&c?f._code&c||(h=p._getEdgeIntersection(f,a,c,t),h._code=p._getBitCode(h,t),n.push(h)):(f._code&c&&(h=p._getEdgeIntersection(f,a,c,t),h._code=p._getBitCode(h,t),n.push(h)),n.push(a));e=n}return e},i.Polygon=i.Polyline.extend({options:{fill:!0},initialize:function(e,t){i.Polyline.prototype.initialize.call(this,e,t),this._initWithHoles(e)},_initWithHoles:function(e){var t,n,r;if(e&&i.Util.isArray(e[0])&&typeof e[0][0]!="number"){this._latlngs=this._convertLatLngs(e[0]),this._holes=e.slice(1);for(t=0,n=this._holes.length;t<n;t++)r=this._holes[t]=this._convertLatLngs(this._holes[t]),r[0].equals(r[r.length-1])&&r.pop()}e=this._latlngs,e.length>=2&&e[0].equals(e[e.length-1])&&e.pop()},projectLatlngs:function(){i.Polyline.prototype.projectLatlngs.call(this),this._holePoints=[];if(!this._holes)return;var e,t,n,r;for(e=0,n=this._holes.length;e<n;e++){this._holePoints[e]=[];for(t=0,r=this._holes[e].length;t<r;t++)this._holePoints[e][t]=this._map.latLngToLayerPoint(this._holes[e][t])}},setLatLngs:function(e){return e&&i.Util.isArray(e[0])&&typeof e[0][0]!="number"?(this._initWithHoles(e),this.redraw()):i.Polyline.prototype.setLatLngs.call(this,e)},_clipPoints:function(){var e=this._originalPoints,t=[];this._parts=[e].concat(this._holePoints);if(this.options.noClip)return;for(var n=0,r=this._parts.length;n<r;n++){var s=i.PolyUtil.clipPolygon(this._parts[n],this._map._pathViewport);s.length&&t.push(s)}this._parts=t},_getPathPartStr:function(e){var t=i.Polyline.prototype._getPathPartStr.call(this,e);return t+(i.Browser.svg?"z":"x")}}),i.polygon=function(e,t){return new i.Polygon(e,t)},function(){function e(e){return i.FeatureGroup.extend({initialize:function(e,t){this._layers={},this._options=t,this.setLatLngs(e)},setLatLngs:function(t){var n=0,r=t.length;this.eachLayer(function(e){n<r?e.setLatLngs(t[n++]):this.removeLayer(e)},this);while(n<r)this.addLayer(new e(t[n++],this._options));return this},getLatLngs:function(){var e=[];return this.eachLayer(function(t){e.push(t.getLatLngs())}),e}})}i.MultiPolyline=e(i.Polyline),i.MultiPolygon=e(i.Polygon),i.multiPolyline=function(e,t){return new i.MultiPolyline(e,t)},i.multiPolygon=function(e,t){return new i.MultiPolygon(e,t)}}(),i.Rectangle=i.Polygon.extend({initialize:function(e,t){i.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(e),t)},setBounds:function(e){this.setLatLngs(this._boundsToLatLngs(e))},_boundsToLatLngs:function(e){return e=i.latLngBounds(e),[e.getSouthWest(),e.getNorthWest(),e.getNorthEast(),e.getSouthEast()]}}),i.rectangle=function(e,t){return new i.Rectangle(e,t)},i.Circle=i.Path.extend({initialize:function(e,t,n){i.Path.prototype.initialize.call(this,n),this._latlng=i.latLng(e),this._mRadius=t},options:{fill:!0},setLatLng:function(e){return this._latlng=i.latLng(e),this.redraw()},setRadius:function(e){return this._mRadius=e,this.redraw()},projectLatlngs:function(){var e=this._getLngRadius(),t=this._latlng,n=this._map.latLngToLayerPoint([t.lat,t.lng-e]);this._point=this._map.latLngToLayerPoint(t),this._radius=Math.max(this._point.x-n.x,1)},getBounds:function(){var e=this._getLngRadius(),t=this._mRadius/40075017*360,n=this._latlng;return new i.LatLngBounds([n.lat-t,n.lng-e],[n.lat+t,n.lng+e])},getLatLng:function(){return this._latlng},getPathString:function(){var e=this._point,t=this._radius;return this._checkIfEmpty()?"":i.Browser.svg?"M"+e.x+","+(e.y-t)+"A"+t+","+t+",0,1,1,"+(e.x-.1)+","+(e.y-t)+" z":(e._round(),t=Math.round(t),"AL "+e.x+","+e.y+" "+t+","+t+" 0,"+23592600)},getRadius:function(){return this._mRadius},_getLatRadius:function(){return this._mRadius/40075017*360},_getLngRadius:function(){return this._getLatRadius()/Math.cos(i.LatLng.DEG_TO_RAD*this._latlng.lat)},_checkIfEmpty:function(){if(!this._map)return!1;var e=this._map._pathViewport,t=this._radius,n=this._point;return n.x-t>e.max.x||n.y-t>e.max.y||n.x+t<e.min.x||n.y+t<e.min.y}}),i.circle=function(e,t,n){return new i.Circle(e,t,n)},i.CircleMarker=i.Circle.extend({options:{radius:10,weight:2},initialize:function(e,t){i.Circle.prototype.initialize.call(this,e,null,t),this._radius=this.options.radius},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},_updateStyle:function(){i.Circle.prototype._updateStyle.call(this),this.setRadius(this.options.radius)},setLatLng:function(e){return i.Circle.prototype.setLatLng.call(this,e),this._popup&&this._popup._isOpen&&this._popup.setLatLng(e),this},setRadius:function(e){return this.options.radius=this._radius=e,this.redraw()},getRadius:function(){return this._radius}}),i.circleMarker=function(e,t){return new i.CircleMarker(e,t)},i.Polyline.include(i.Path.CANVAS?{_containsPoint:function(e,t){var n,r,s,o,u,a,f,l=this.options.weight/2;i.Browser.touch&&(l+=10);for(n=0,o=this._parts.length;n<o;n++){f=this._parts[n];for(r=0,u=f.length,s=u-1;r<u;s=r++){if(!t&&r===0)continue;a=i.LineUtil.pointToSegmentDistance(e,f[s],f[r]);if(a<=l)return!0}}return!1}}:{}),i.Polygon.include(i.Path.CANVAS?{_containsPoint:function(e){var t=!1,n,r,s,o,u,a,f,l;if(i.Polyline.prototype._containsPoint.call(this,e,!0))return!0;for(o=0,f=this._parts.length;o<f;o++){n=this._parts[o];for(u=0,l=n.length,a=l-1;u<l;a=u++)r=n[u],s=n[a],r.y>e.y!=s.y>e.y&&e.x<(s.x-r.x)*(e.y-r.y)/(s.y-r.y)+r.x&&(t=!t)}return t}}:{}),i.Circle.include(i.Path.CANVAS?{_drawPath:function(){var e=this._point;this._ctx.beginPath(),this._ctx.arc(e.x,e.y,this._radius,0,Math.PI*2,!1)},_containsPoint:function(e){var t=this._point,n=this.options.stroke?this.options.weight/2:0;return e.distanceTo(t)<=this._radius+n}}:{}),i.CircleMarker.include(i.Path.CANVAS?{_updateStyle:function(){i.Path.prototype._updateStyle.call(this)}}:{}),i.GeoJSON=i.FeatureGroup.extend({initialize:function(e,t){i.setOptions(this,t),this._layers={},e&&this.addData(e)},addData:function(e){var t=i.Util.isArray(e)?e:e.features,n,r,s;if(t){for(n=0,r=t.length;n<r;n++)s=t[n],(s.geometries||s.geometry||s.features||s.coordinates)&&this.addData(t[n]);return this}var o=this.options;if(o.filter&&!o.filter(e))return;var u=i.GeoJSON.geometryToLayer(e,o.pointToLayer,o.coordsToLatLng,o);return u.feature=i.GeoJSON.asFeature(e),u.defaultOptions=u.options,this.resetStyle(u),o.onEachFeature&&o.onEachFeature(e,u),this.addLayer(u)},resetStyle:function(e){var t=this.options.style;t&&(i.Util.extend(e.options,e.defaultOptions),this._setLayerStyle(e,t))},setStyle:function(e){this.eachLayer(function(t){this._setLayerStyle(t,e)},this)},_setLayerStyle:function(e,t){typeof t=="function"&&(t=t(e.feature)),e.setStyle&&e.setStyle(t)}}),i.extend(i.GeoJSON,{geometryToLayer:function(e,t,n,r){var s=e.type==="Feature"?e.geometry:e,o=s.coordinates,u=[],a,f,l,c;n=n||this.coordsToLatLng;switch(s.type){case"Point":return a=n(o),t?t(e,a):new i.Marker(a);case"MultiPoint":for(l=0,c=o.length;l<c;l++)a=n(o[l]),u.push(t?t(e,a):new i.Marker(a));return new i.FeatureGroup(u);case"LineString":return f=this.coordsToLatLngs(o,0,n),new i.Polyline(f,r);case"Polygon":if(o.length===2&&!o[1].length)throw new Error("Invalid GeoJSON object.");return f=this.coordsToLatLngs(o,1,n),new i.Polygon(f,r);case"MultiLineString":return f=this.coordsToLatLngs(o,1,n),new i.MultiPolyline(f,r);case"MultiPolygon":return f=this.coordsToLatLngs(o,2,n),new i.MultiPolygon(f,r);case"GeometryCollection":for(l=0,c=s.geometries.length;l<c;l++)u.push(this.geometryToLayer({geometry:s.geometries[l],type:"Feature",properties:e.properties},t,n,r));return new i.FeatureGroup(u);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(e){return new i.LatLng(e[1],e[0],e[2])},coordsToLatLngs:function(e,t,n){var r,i,s,o=[];for(i=0,s=e.length;i<s;i++)r=t?this.coordsToLatLngs(e[i],t-1,n):(n||this.coordsToLatLng)(e[i]),o.push(r);return o},latLngToCoords:function(e){var t=[e.lng,e.lat];return e.alt!==n&&t.push(e.alt),t},latLngsToCoords:function(e){var t=[];for(var n=0,r=e.length;n<r;n++)t.push(i.GeoJSON.latLngToCoords(e[n]));return t},getFeature:function(e,t){return e.feature?i.extend({},e.feature,{geometry:t}):i.GeoJSON.asFeature(t)},asFeature:function(e){return e.type==="Feature"?e:{type:"Feature",properties:{},geometry:e}}});var o={toGeoJSON:function(){return i.GeoJSON.getFeature(this,{type:"Point",coordinates:i.GeoJSON.latLngToCoords(this.getLatLng())})}};i.Marker.include(o),i.Circle.include(o),i.CircleMarker.include(o),i.Polyline.include({toGeoJSON:function(){return i.GeoJSON.getFeature(this,{type:"LineString",coordinates:i.GeoJSON.latLngsToCoords(this.getLatLngs())})}}),i.Polygon.include({toGeoJSON:function(){var e=[i.GeoJSON.latLngsToCoords(this.getLatLngs())],t,n,r;e[0].push(e[0][0]);if(this._holes)for(t=0,n=this._holes.length;t<n;t++)r=i.GeoJSON.latLngsToCoords(this._holes[t]),r.push(r[0]),e.push(r);return i.GeoJSON.getFeature(this,{type:"Polygon",coordinates:e})}}),function(){function e(e){return function(){var t=[];return this.eachLayer(function(e){t.push(e.toGeoJSON().geometry.coordinates)}),i.GeoJSON.getFeature(this,{type:e,coordinates:t})}}i.MultiPolyline.include({toGeoJSON:e("MultiLineString")}),i.MultiPolygon.include({toGeoJSON:e("MultiPolygon")}),i.LayerGroup.include({toGeoJSON:function(){var t=this.feature&&this.feature.geometry,n=[],r;if(t&&t.type==="MultiPoint")return e("MultiPoint").call(this);var s=t&&t.type==="GeometryCollection";return this.eachLayer(function(e){e.toGeoJSON&&(r=e.toGeoJSON(),n.push(s?r.geometry:i.GeoJSON.asFeature(r)))}),s?i.GeoJSON.getFeature(this,{geometries:n,type:"GeometryCollection"}):{type:"FeatureCollection",features:n}}})}(),i.geoJson=function(e,t){return new i.GeoJSON(e,t)},i.DomEvent={addListener:function(e,t,n,r){var s=i.stamp(n),o="_leaflet_"+t+s,u,a,f;return e[o]?this:(u=function(t){return n.call(r||e,t||i.DomEvent._getEvent())},i.Browser.pointer&&t.indexOf("touch")===0?this.addPointerListener(e,t,u,s):(i.Browser.touch&&t==="dblclick"&&this.addDoubleTapListener&&this.addDoubleTapListener(e,u,s),"addEventListener"in e?t==="mousewheel"?(e.addEventListener("DOMMouseScroll",u,!1),e.addEventListener(t,u,!1)):t==="mouseenter"||t==="mouseleave"?(a=u,f=t==="mouseenter"?"mouseover":"mouseout",u=function(t){if(!i.DomEvent._checkMouse(e,t))return;return a(t)},e.addEventListener(f,u,!1)):t==="click"&&i.Browser.android?(a=u,u=function(e){return i.DomEvent._filterClick(e,a)},e.addEventListener(t,u,!1)):e.addEventListener(t,u,!1):"attachEvent"in e&&e.attachEvent("on"+t,u),e[o]=u,this))},removeListener:function(e,t,n){var r=i.stamp(n),s="_leaflet_"+t+r,o=e[s];return o?(i.Browser.pointer&&t.indexOf("touch")===0?this.removePointerListener(e,t,r):i.Browser.touch&&t==="dblclick"&&this.removeDoubleTapListener?this.removeDoubleTapListener(e,r):"removeEventListener"in e?t==="mousewheel"?(e.removeEventListener("DOMMouseScroll",o,!1),e.removeEventListener(t,o,!1)):t==="mouseenter"||t==="mouseleave"?e.removeEventListener(t==="mouseenter"?"mouseover":"mouseout",o,!1):e.removeEventListener(t,o,!1):"detachEvent"in e&&e.detachEvent("on"+t,o),e[s]=null,this):this},stopPropagation:function(e){return e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,i.DomEvent._skipped(e),this},disableScrollPropagation:function(e){var t=i.DomEvent.stopPropagation;return i.DomEvent.on(e,"mousewheel",t).on(e,"MozMousePixelScroll",t)},disableClickPropagation:function(e){var t=i.DomEvent.stopPropagation;for(var n=i.Draggable.START.length-1;n>=0;n--)i.DomEvent.on(e,i.Draggable.START[n],t);return i.DomEvent.on(e,"click",i.DomEvent._fakeStop).on(e,"dblclick",t)},preventDefault:function(e){return e.preventDefault?e.preventDefault():e.returnValue=!1,this},stop:function(e){return i.DomEvent.preventDefault(e).stopPropagation(e)},getMousePosition:function(e,t){if(!t)return new i.Point(e.clientX,e.clientY);var n=t.getBoundingClientRect();return new i.Point(e.clientX-n.left-t.clientLeft,e.clientY-n.top-t.clientTop)},getWheelDelta:function(e){var t=0;return e.wheelDelta&&(t=e.wheelDelta/120),e.detail&&(t=-e.detail/3),t},_skipEvents:{},_fakeStop:function(e){i.DomEvent._skipEvents[e.type]=!0},_skipped:function(e){var t=this._skipEvents[e.type];return this._skipEvents[e.type]=!1,t},_checkMouse:function(e,t){var n=t.relatedTarget;if(!n)return!0;try{while(n&&n!==e)n=n.parentNode}catch(r){return!1}return n!==e},_getEvent:function(){var t=e.event;if(!t){var n=arguments.callee.caller;while(n){t=n.arguments[0];if(t&&e.Event===t.constructor)break;n=n.caller}}return t},_filterClick:function(e,t){var n=e.timeStamp||e.originalEvent.timeStamp,r=i.DomEvent._lastClick&&n-i.DomEvent._lastClick;if(r&&r>100&&r<1e3||e.target._simulatedClick&&!e._simulated){i.DomEvent.stop(e);return}return i.DomEvent._lastClick=n,t(e)}},i.DomEvent.on=i.DomEvent.addListener,i.DomEvent.off=i.DomEvent.removeListener,i.Draggable=i.Class.extend({includes:i.Mixin.Events,statics:{START:i.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(e,t){this._element=e,this._dragStartTarget=t||e},enable:function(){if(this._enabled)return;for(var e=i.Draggable.START.length-1;e>=0;e--)i.DomEvent.on(this._dragStartTarget,i.Draggable.START[e],this._onDown,this);this._enabled=!0},disable:function(){if(!this._enabled)return;for(var e=i.Draggable.START.length-1;e>=0;e--)i.DomEvent.off(this._dragStartTarget,i.Draggable.START[e],this._onDown,this);this._enabled=!1,this._moved=!1},_onDown:function(e){this._moved=!1;if(e.shiftKey||e.which!==1&&e.button!==1&&!e.touches)return;i.DomEvent.stopPropagation(e);if(i.Draggable._disabled)return;i.DomUtil.disableImageDrag(),i.DomUtil.disableTextSelection();if(this._moving)return;var n=e.touches?e.touches[0]:e;this._startPoint=new i.Point(n.clientX,n.clientY),this._startPos=this._newPos=i.DomUtil.getPosition(this._element),i.DomEvent.on(t,i.Draggable.MOVE[e.type],this._onMove,this).on(t,i.Draggable.END[e.type],this._onUp,this)},_onMove:function(e){if(e.touches&&e.touches.length>1){this._moved=!0;return}var n=e.touches&&e.touches.length===1?e.touches[0]:e,r=new i.Point(n.clientX,n.clientY),s=r.subtract(this._startPoint);if(!s.x&&!s.y)return;i.DomEvent.preventDefault(e),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=i.DomUtil.getPosition(this._element).subtract(s),i.DomUtil.addClass(t.body,"leaflet-dragging"),i.DomUtil.addClass(e.target||e.srcElement,"leaflet-drag-target")),this._newPos=this._startPos.add(s),this._moving=!0,i.Util.cancelAnimFrame(this._animRequest),this._animRequest=i.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget)},_updatePosition:function(){this.fire("predrag"),i.DomUtil.setPosition(this._element,this._newPos),this.fire("drag")},_onUp:function(e){i.DomUtil.removeClass(t.body,"leaflet-dragging"),i.DomUtil.removeClass(e.target||e.srcElement,"leaflet-drag-target");for(var n in i.Draggable.MOVE)i.DomEvent.off(t,i.Draggable.MOVE[n],this._onMove).off(t,i.Draggable.END[n],this._onUp);i.DomUtil.enableImageDrag(),i.DomUtil.enableTextSelection(),this._moved&&this._moving&&(i.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1}}),i.Handler=i.Class.extend({initialize:function(e){this._map=e},enable:function(){if(this._enabled)return;this._enabled=!0,this.addHooks()},disable:function(){if(!this._enabled)return;this._enabled=!1,this.removeHooks()},enabled:function(){return!!this._enabled}}),i.Map.mergeOptions({dragging:!0,inertia:!i.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:Infinity,inertiaThreshold:i.Browser.touch?32:18,easeLinearity:.25,worldCopyJump:!1}),i.Map.Drag=i.Handler.extend({addHooks:function(){if(!this._draggable){var e=this._map;this._draggable=new i.Draggable(e._mapPane,e._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),e.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDrag,this),e.on("viewreset",this._onViewReset,this),e.whenReady(this._onViewReset,this))}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){var e=this._map;e._panAnim&&e._panAnim.stop(),e.fire("movestart").fire("dragstart"),e.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(){if(this._map.options.inertia){var e=this._lastTime=+(new Date),t=this._lastPos=this._draggable._newPos;this._positions.push(t),this._times.push(e),e-this._times[0]>200&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onViewReset:function(){var e=this._map.getSize()._divideBy(2),t=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=t.subtract(e).x,this._worldWidth=this._map.project([0,180]).x},_onPreDrag:function(){var e=this._worldWidth,t=Math.round(e/2),n=this._initialWorldOffset,r=this._draggable._newPos.x,i=(r-t+n)%e+t-n,s=(r+t+n)%e-t-n,o=Math.abs(i+n)<Math.abs(s+n)?i:s;this._draggable._newPos.x=o},_onDragEnd:function(e){var t=this._map,n=t.options,r=+(new Date)-this._lastTime,s=!n.inertia||r>n.inertiaThreshold||!this._positions[0];t.fire("dragend",e);if(s)t.fire("moveend");else{var o=this._lastPos.subtract(this._positions[0]),u=(this._lastTime+r-this._times[0])/1e3,a=n.easeLinearity,f=o.multiplyBy(a/u),l=f.distanceTo([0,0]),c=Math.min(n.inertiaMaxSpeed,l),h=f.multiplyBy(c/l),p=c/(n.inertiaDeceleration*a),d=h.multiplyBy(-p/2).round();!d.x||!d.y?t.fire("moveend"):(d=t._limitOffset(d,t.options.maxBounds),i.Util.requestAnimFrame(function(){t.panBy(d,{duration:p,easeLinearity:a,noMoveStart:!0})}))}}}),i.Map.addInitHook("addHandler","dragging",i.Map.Drag),i.Map.mergeOptions({doubleClickZoom:!0}),i.Map.DoubleClickZoom=i.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(e){var t=this._map,n=t.getZoom()+(e.originalEvent.shiftKey?-1:1);t.options.doubleClickZoom==="center"?t.setZoom(n):t.setZoomAround(e.containerPoint,n)}}),i.Map.addInitHook("addHandler","doubleClickZoom",i.Map.DoubleClickZoom),i.Map.mergeOptions({scrollWheelZoom:!0}),i.Map.ScrollWheelZoom=i.Handler.extend({addHooks:function(){i.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),i.DomEvent.on(this._map._container,"MozMousePixelScroll",i.DomEvent.preventDefault),this._delta=0},removeHooks:function(){i.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll),i.DomEvent.off(this._map._container,"MozMousePixelScroll",i.DomEvent.preventDefault)},_onWheelScroll:function(e){var t=i.DomEvent.getWheelDelta(e);this._delta+=t,this._lastMousePos=this._map.mouseEventToContainerPoint(e),this._startTime||(this._startTime=+(new Date));var n=Math.max(40-(+(new Date)-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(i.bind(this._performZoom,this),n),i.DomEvent.preventDefault(e),i.DomEvent.stopPropagation(e)},_performZoom:function(){var e=this._map,t=this._delta,n=e.getZoom();t=t>0?Math.ceil(t):Math.floor(t),t=Math.max(Math.min(t,4),-4),t=e._limitZoom(n+t)-n,this._delta=0,this._startTime=null;if(!t)return;e.options.scrollWheelZoom==="center"?e.setZoom(n+t):e.setZoomAround(this._lastMousePos,n+t)}}),i.Map.addInitHook("addHandler","scrollWheelZoom",i.Map.ScrollWheelZoom),i.extend(i.DomEvent,{_touchstart:i.Browser.msPointer?"MSPointerDown":i.Browser.pointer?"pointerdown":"touchstart",_touchend:i.Browser.msPointer?"MSPointerUp":i.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(e,n,r){function s(e){var t;i.Browser.pointer?(d.push(e.pointerId),t=d.length):t=e.touches.length;if(t>1)return;var n=Date.now(),r=n-(u||n);l=e.touches?e.touches[0]:e,a=r>0&&r<=f,u=n}function o(e){if(i.Browser.pointer){var t=d.indexOf(e.pointerId);if(t===-1)return;d.splice(t,1)}if(a){if(i.Browser.pointer){var r={},s;for(var o in l)s=l[o],typeof s=="function"?r[o]=s.bind(l):r[o]=s;l=r}l.type="dblclick",n(l),u=null}}var u,a=!1,f=250,l,c="_leaflet_",h=this._touchstart,p=this._touchend,d=[];e[c+h+r]=s,e[c+p+r]=o;var v=i.Browser.pointer?t.documentElement:e;return e.addEventListener(h,s,!1),v.addEventListener(p,o,!1),i.Browser.pointer&&v.addEventListener(i.DomEvent.POINTER_CANCEL,o,!1),this},removeDoubleTapListener:function(e,n){var r="_leaflet_";return e.removeEventListener(this._touchstart,e[r+this._touchstart+n],!1),(i.Browser.pointer?t.documentElement:e).removeEventListener(this._touchend,e[r+this._touchend+n],!1),i.Browser.pointer&&t.documentElement.removeEventListener(i.DomEvent.POINTER_CANCEL,e[r+this._touchend+n],!1),this}}),i.extend(i.DomEvent,{POINTER_DOWN:i.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:i.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:i.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:i.Browser.msPointer?"MSPointerCancel":"pointercancel",_pointers:[],_pointerDocumentListener:!1,addPointerListener:function(e,t,n,r){switch(t){case"touchstart":return this.addPointerListenerStart(e,t,n,r);case"touchend":return this.addPointerListenerEnd(e,t,n,r);case"touchmove":return this.addPointerListenerMove(e,t,n,r);default:throw"Unknown touch event type"}},addPointerListenerStart:function(e,n,r,s){var o="_leaflet_",u=this._pointers,a=function(e){i.DomEvent.preventDefault(e);var t=!1;for(var n=0;n<u.length;n++)if(u[n].pointerId===e.pointerId){t=!0;break}t||u.push(e),e.touches=u.slice(),e.changedTouches=[e],r(e)};e[o+"touchstart"+s]=a,e.addEventListener(this.POINTER_DOWN,a,!1);if(!this._pointerDocumentListener){var f=function(e){for(var t=0;t<u.length;t++)if(u[t].pointerId===e.pointerId){u.splice(t,1);break}};t.documentElement.addEventListener(this.POINTER_UP,f,!1),t.documentElement.addEventListener(this.POINTER_CANCEL,f,!1),this._pointerDocumentListener=!0}return this},addPointerListenerMove:function(e,t,n,r){function i(e){if((e.pointerType===e.MSPOINTER_TYPE_MOUSE||e.pointerType==="mouse")&&e.buttons===0)return;for(var t=0;t<o.length;t++)if(o[t].pointerId===e.pointerId){o[t]=e;break}e.touches=o.slice(),e.changedTouches=[e],n(e)}var s="_leaflet_",o=this._pointers;return e[s+"touchmove"+r]=i,e.addEventListener(this.POINTER_MOVE,i,!1),this},addPointerListenerEnd:function(e,t,n,r){var i="_leaflet_",s=this._pointers,o=function(e){for(var t=0;t<s.length;t++)if(s[t].pointerId===e.pointerId){s.splice(t,1);break}e.touches=s.slice(),e.changedTouches=[e],n(e)};return e[i+"touchend"+r]=o,e.addEventListener(this.POINTER_UP,o,!1),e.addEventListener(this.POINTER_CANCEL,o,!1),this},removePointerListener:function(e,t,n){var r="_leaflet_",i=e[r+t+n];switch(t){case"touchstart":e.removeEventListener(this.POINTER_DOWN,i,!1);break;case"touchmove":e.removeEventListener(this.POINTER_MOVE,i,!1);break;case"touchend":e.removeEventListener(this.POINTER_UP,i,!1),e.removeEventListener(this.POINTER_CANCEL,i,!1)}return this}}),i.Map.mergeOptions({touchZoom:i.Browser.touch&&!i.Browser.android23,bounceAtZoomLimits:!0}),i.Map.TouchZoom=i.Handler.extend({addHooks:function(){i.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){i.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(e){var n=this._map;if(!e.touches||e.touches.length!==2||n._animatingZoom||this._zooming)return;var r=n.mouseEventToLayerPoint(e.touches[0]),s=n.mouseEventToLayerPoint(e.touches[1]),o=n._getCenterLayerPoint();this._startCenter=r.add(s)._divideBy(2),this._startDist=r.distanceTo(s),this._moved=!1,this._zooming=!0,this._centerOffset=o.subtract(this._startCenter),n._panAnim&&n._panAnim.stop(),i.DomEvent.on(t,"touchmove",this._onTouchMove,this).on(t,"touchend",this._onTouchEnd,this),i.DomEvent.preventDefault(e)},_onTouchMove:function(e){var t=this._map;if(!e.touches||e.touches.length!==2||!this._zooming)return;var n=t.mouseEventToLayerPoint(e.touches[0]),r=t.mouseEventToLayerPoint(e.touches[1]);this._scale=n.distanceTo(r)/this._startDist,this._delta=n._add(r)._divideBy(2)._subtract(this._startCenter);if(this._scale===1)return;if(!t.options.bounceAtZoomLimits)if(t.getZoom()===t.getMinZoom()&&this._scale<1||t.getZoom()===t.getMaxZoom()&&this._scale>1)return;this._moved||(i.DomUtil.addClass(t._mapPane,"leaflet-touching"),t.fire("movestart").fire("zoomstart"),this._moved=!0),i.Util.cancelAnimFrame(this._animRequest),this._animRequest=i.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container),i.DomEvent.preventDefault(e)},_updateOnMove:function(){var e=this._map,t=this._getScaleOrigin(),n=e.layerPointToLatLng(t),r=e.getScaleZoom(this._scale);e._animateZoom(n,r,this._startCenter,this._scale,this._delta)},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}var e=this._map;this._zooming=!1,i.DomUtil.removeClass(e._mapPane,"leaflet-touching"),i.Util.cancelAnimFrame(this._animRequest),i.DomEvent.off(t,"touchmove",this._onTouchMove).off(t,"touchend",this._onTouchEnd);var n=this._getScaleOrigin(),r=e.layerPointToLatLng(n),s=e.getZoom(),o=e.getScaleZoom(this._scale)-s,u=o>0?Math.ceil(o):Math.floor(o),a=e._limitZoom(s+u),f=e.getZoomScale(a)/this._scale;e._animateZoom(r,a,n,f)},_getScaleOrigin:function(){var e=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(e)}}),i.Map.addInitHook("addHandler","touchZoom",i.Map.TouchZoom),i.Map.mergeOptions({tap:!0,tapTolerance:15}),i.Map.Tap=i.Handler.extend({addHooks:function(){i.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){i.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(e){if(!e.touches)return;i.DomEvent.preventDefault(e),this._fireClick=!0;if(e.touches.length>1){this._fireClick=!1,clearTimeout(this._holdTimeout);return}var n=e.touches[0],r=n.target;this._startPos=this._newPos=new i.Point(n.clientX,n.clientY),r.tagName&&r.tagName.toLowerCase()==="a"&&i.DomUtil.addClass(r,"leaflet-active"),this._holdTimeout=setTimeout(i.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",n))},this),1e3),i.DomEvent.on(t,"touchmove",this._onMove,this).on(t,"touchend",this._onUp,this)},_onUp:function(e){clearTimeout(this._holdTimeout),i.DomEvent.off(t,"touchmove",this._onMove,this).off(t,"touchend",this._onUp,this);if(this._fireClick&&e&&e.changedTouches){var n=e.changedTouches[0],r=n.target;r&&r.tagName&&r.tagName.toLowerCase()==="a"&&i.DomUtil.removeClass(r,"leaflet-active"),this._isTapValid()&&this._simulateEvent("click",n)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(e){var t=e.touches[0];this._newPos=new i.Point(t.clientX,t.clientY)},_simulateEvent:function(n,r){var i=t.createEvent("MouseEvents");i._simulated=!0,r.target._simulatedClick=!0,i.initMouseEvent(n,!0,!0,e,1,r.screenX,r.screenY,r.clientX,r.clientY,!1,!1,!1,!1,0,null),r.target.dispatchEvent(i)}}),i.Browser.touch&&!i.Browser.pointer&&i.Map.addInitHook("addHandler","tap",i.Map.Tap),i.Map.mergeOptions({boxZoom:!0}),i.Map.BoxZoom=i.Handler.extend({initialize:function(e){this._map=e,this._container=e._container,this._pane=e._panes.overlayPane,this._moved=!1},addHooks:function(){i.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){i.DomEvent.off(this._container,"mousedown",this._onMouseDown),this._moved=!1},moved:function(){return this._moved},_onMouseDown:function(e){this._moved=!1;if(!e.shiftKey||e.which!==1&&e.button!==1)return!1;i.DomUtil.disableTextSelection(),i.DomUtil.disableImageDrag(),this._startLayerPoint=this._map.mouseEventToLayerPoint(e),i.DomEvent.on(t,"mousemove",this._onMouseMove,this).on(t,"mouseup",this._onMouseUp,this).on(t,"keydown",this._onKeyDown,this)},_onMouseMove:function(e){this._moved||(this._box=i.DomUtil.create("div","leaflet-zoom-box",this._pane),i.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",this._map.fire("boxzoomstart"));var t=this._startLayerPoint,n=this._box,r=this._map.mouseEventToLayerPoint(e),s=r.subtract(t),o=new i.Point(Math.min(r.x,t.x),Math.min(r.y,t.y));i.DomUtil.setPosition(n,o),this._moved=!0,n.style.width=Math.max(0,Math.abs(s.x)-4)+"px",n.style.height=Math.max(0,Math.abs(s.y)-4)+"px"},_finish:function(){this._moved&&(this._pane.removeChild(this._box),this._container.style.cursor=""),i.DomUtil.enableTextSelection(),i.DomUtil.enableImageDrag(),i.DomEvent.off(t,"mousemove",this._onMouseMove).off(t,"mouseup",this._onMouseUp).off(t,"keydown",this._onKeyDown)},_onMouseUp:function(e){this._finish();var t=this._map,n=t.mouseEventToLayerPoint(e);if(this._startLayerPoint.equals(n))return;var r=new i.LatLngBounds(t.layerPointToLatLng(this._startLayerPoint),t.layerPointToLatLng(n));t.fitBounds(r),t.fire("boxzoomend",{boxZoomBounds:r})},_onKeyDown:function(e){e.keyCode===27&&this._finish()}}),i.Map.addInitHook("addHandler","boxZoom",i.Map.BoxZoom),i.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,keyboardZoomOffset:1}),i.Map.Keyboard=i.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,173]},initialize:function(e){this._map=e,this._setPanOffset(e.options.keyboardPanOffset),this._setZoomOffset(e.options.keyboardZoomOffset)},addHooks:function(){var e=this._map._container;e.tabIndex===-1&&(e.tabIndex="0"),i.DomEvent.on(e,"focus",this._onFocus,this).on(e,"blur",this._onBlur,this).on(e,"mousedown",this._onMouseDown,this),this._map.on("focus",this._addHooks,this).on("blur",this._removeHooks,this)},removeHooks:function(){this._removeHooks();var e=this._map._container;i.DomEvent.off(e,"focus",this._onFocus,this).off(e,"blur",this._onBlur,this).off(e,"mousedown",this._onMouseDown,this),this._map.off("focus",this._addHooks,this).off("blur",this._removeHooks,this)},_onMouseDown:function(){if(this._focused)return;var n=t.body,r=t.documentElement,i=n.scrollTop||r.scrollTop,s=n.scrollLeft||r.scrollLeft;this._map._container.focus(),e.scrollTo(s,i)},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanOffset:function(e){var t=this._panKeys={},n=this.keyCodes,r,i;for(r=0,i=n.left.length;r<i;r++)t[n.left[r]]=[-1*e,0];for(r=0,i=n.right.length;r<i;r++)t[n.right[r]]=[e,0];for(r=0,i=n.down.length;r<i;r++)t[n.down[r]]=[0,e];for(r=0,i=n.up.length;r<i;r++)t[n.up[r]]=[0,-1*e]},_setZoomOffset:function(e){var t=this._zoomKeys={},n=this.keyCodes,r,i;for(r=0,i=n.zoomIn.length;r<i;r++)t[n.zoomIn[r]]=e;for(r=0,i=n.zoomOut.length;r<i;r++)t[n.zoomOut[r]]=-e},_addHooks:function(){i.DomEvent.on(t,"keydown",this._onKeyDown,this)},_removeHooks:function(){i.DomEvent.off(t,"keydown",this._onKeyDown,this)},_onKeyDown:function(e){var t=e.keyCode,n=this._map;if(t in this._panKeys){if(n._panAnim&&n._panAnim._inProgress)return;n.panBy(this._panKeys[t]),n.options.maxBounds&&n.panInsideBounds(n.options.maxBounds)}else{if(!(t in this._zoomKeys))return;n.setZoom(n.getZoom()+this._zoomKeys[t])}i.DomEvent.stop(e)}}),i.Map.addInitHook("addHandler","keyboard",i.Map.Keyboard),i.Handler.MarkerDrag=i.Handler.extend({initialize:function(e){this._marker=e},addHooks:function(){var e=this._marker._icon;this._draggable||(this._draggable=new i.Draggable(e,e)),this._draggable.on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this),this._draggable.enable(),i.DomUtil.addClass(this._marker._icon,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off("dragstart",this._onDragStart,this).off("drag",this._onDrag,this).off("dragend",this._onDragEnd,this),this._draggable.disable(),i.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(){var e=this._marker,t=e._shadow,n=i.DomUtil.getPosition(e._icon),r=e._map.layerPointToLatLng(n);t&&i.DomUtil.setPosition(t,n),e._latlng=r,e.fire("move",{latlng:r}).fire("drag")},_onDragEnd:function(e){this._marker.fire("moveend").fire("dragend",e)}}),i.Control=i.Class.extend({options:{position:"topright"},initialize:function(e){i.setOptions(this,e)},getPosition:function(){return this.options.position},setPosition:function(e){var t=this._map;return t&&t.removeControl(this),this.options.position=e,t&&t.addControl(this),this},getContainer:function(){return this._container},addTo:function(e){this._map=e;var t=this._container=this.onAdd(e),n=this.getPosition(),r=e._controlCorners[n];return i.DomUtil.addClass(t,"leaflet-control"),n.indexOf("bottom")!==-1?r.insertBefore(t,r.firstChild):r.appendChild(t),this},removeFrom:function(e){var t=this.getPosition(),n=e._controlCorners[t];return n.removeChild(this._container),this._map=null,this.onRemove&&this.onRemove(e),this},_refocusOnMap:function(){this._map&&this._map.getContainer().focus()}}),i.control=function(e){return new i.Control(e)},i.Map.include({addControl:function(e){return e.addTo(this),this},removeControl:function(e){return e.removeFrom(this),this},_initControlPos:function(){function e(e,s){var o=n+e+" "+n+s;t[e+s]=i.DomUtil.create("div",o,r)}var t=this._controlCorners={},n="leaflet-",r=this._controlContainer=i.DomUtil.create("div",n+"control-container",this._container);e("top","left"),e("top","right"),e("bottom","left"),e("bottom","right")},_clearControlPos:function(){this._container.removeChild(this._controlContainer)}}),i.Control.Zoom=i.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(e){var t="leaflet-control-zoom",n=i.DomUtil.create("div",t+" leaflet-bar");return this._map=e,this._zoomInButton=this._createButton(this.options.zoomInText,this.options.zoomInTitle,t+"-in",n,this._zoomIn,this),this._zoomOutButton=this._createButton(this.options.zoomOutText,this.options.zoomOutTitle,t+"-out",n,this._zoomOut,this),this._updateDisabled(),e.on("zoomend zoomlevelschange",this._updateDisabled,this),n},onRemove:function(e){e.off("zoomend zoomlevelschange",this._updateDisabled,this)},_zoomIn:function(e){this._map.zoomIn(e.shiftKey?3:1)},_zoomOut:function(e){this._map.zoomOut(e.shiftKey?3:1)},_createButton:function(e,t,n,r,s,o){var u=i.DomUtil.create("a",n,r);u.innerHTML=e,u.href="#",u.title=t;var a=i.DomEvent.stopPropagation;return i.DomEvent.on(u,"click",a).on(u,"mousedown",a).on(u,"dblclick",a).on(u,"click",i.DomEvent.preventDefault).on(u,"click",s,o).on(u,"click",this._refocusOnMap,o),u},_updateDisabled:function(){var e=this._map,t="leaflet-disabled";i.DomUtil.removeClass(this._zoomInButton,t),i.DomUtil.removeClass(this._zoomOutButton,t),e._zoom===e.getMinZoom()&&i.DomUtil.addClass(this._zoomOutButton,t),e._zoom===e.getMaxZoom()&&i.DomUtil.addClass(this._zoomInButton,t)}}),i.Map.mergeOptions({zoomControl:!0}),i.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new i.Control.Zoom,this.addControl(this.zoomControl))}),i.control.zoom=function(e){return new i.Control.Zoom(e)},i.Control.Attribution=i.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(e){i.setOptions(this,e),this._attributions={}},onAdd:function(e){this._container=i.DomUtil.create("div","leaflet-control-attribution"),i.DomEvent.disableClickPropagation(this._container);for(var t in e._layers)e._layers[t].getAttribution&&this.addAttribution(e._layers[t].getAttribution());return e.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this),this._update(),this._container},onRemove:function(e){e.off("layeradd",this._onLayerAdd).off("layerremove",this._onLayerRemove)},setPrefix:function(e){return this.options.prefix=e,this._update(),this},addAttribution:function(e){if(!e)return;return this._attributions[e]||(this._attributions[e]=0),this._attributions[e]++,this._update(),this},removeAttribution:function(e){if(!e)return;return this._attributions[e]&&(this._attributions[e]--,this._update()),this},_update:function(){if(!this._map)return;var e=[];for(var t in this._attributions)this._attributions[t]&&e.push(t);var n=[];this.options.prefix&&n.push(this.options.prefix),e.length&&n.push(e.join(", ")),this._container.innerHTML=n.join(" | ")},_onLayerAdd:function(e){e.layer.getAttribution&&this.addAttribution(e.layer.getAttribution())},_onLayerRemove:function(e){e.layer.getAttribution&&this.removeAttribution(e.layer.getAttribution())}}),i.Map.mergeOptions({attributionControl:!0}),i.Map.addInitHook(function(){this.options.attributionControl&&(this.attributionControl=(new i.Control.Attribution).addTo(this))}),i.control.attribution=function(e){return new i.Control.Attribution(e)},i.Control.Scale=i.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0,updateWhenIdle:!1},onAdd:function(e){this._map=e;var t="leaflet-control-scale",n=i.DomUtil.create("div",t),r=this.options;return this._addScales(r,t,n),e.on(r.updateWhenIdle?"moveend":"move",this._update,this),e.whenReady(this._update,this),n},onRemove:function(e){e.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(e,t,n){e.metric&&(this._mScale=i.DomUtil.create("div",t+"-line",n)),e.imperial&&(this._iScale=i.DomUtil.create("div",t+"-line",n))},_update:function(){var e=this._map.getBounds(),t=e.getCenter().lat,n=6378137*Math.PI*Math.cos(t*Math.PI/180),r=n*(e.getNorthEast().lng-e.getSouthWest().lng)/180,i=this._map.getSize(),s=this.options,o=0;i.x>0&&(o=r*(s.maxWidth/i.x)),this._updateScales(s,o)},_updateScales:function(e,t){e.metric&&t&&this._updateMetric(t),e.imperial&&t&&this._updateImperial(t)},_updateMetric:function(e){var t=this._getRoundNum(e);this._mScale.style.width=this._getScaleWidth(t/e)+"px",this._mScale.innerHTML=t<1e3?t+" m":t/1e3+" km"},_updateImperial:function(e){var t=e*3.2808399,n=this._iScale,r,i,s;t>5280?(r=t/5280,i=this._getRoundNum(r),n.style.width=this._getScaleWidth(i/r)+"px",n.innerHTML=i+" mi"):(s=this._getRoundNum(t),n.style.width=this._getScaleWidth(s/t)+"px",n.innerHTML=s+" ft")},_getScaleWidth:function(e){return Math.round(this.options.maxWidth*e)-10},_getRoundNum:function(e){var t=Math.pow(10,(Math.floor(e)+"").length-1),n=e/t;return n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1,t*n}}),i.control.scale=function(e){return new i.Control.Scale(e)},i.Control.Layers=i.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(e,t,n){i.setOptions(this,n),this._layers={},this._lastZIndex=0,this._handlingClick=!1;for(var r in e)this._addLayer(e[r],r);for(r in t)this._addLayer(t[r],r,!0)},onAdd:function(e){return this._initLayout(),this._update(),e.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,this),this._container},onRemove:function(e){e.off("layeradd",this._onLayerChange).off("layerremove",this._onLayerChange)},addBaseLayer:function(e,t){return this._addLayer(e,t),this._update(),this},addOverlay:function(e,t){return this._addLayer(e,t,!0),this._update(),this},removeLayer:function(e){var t=i.stamp(e);return delete this._layers[t],this._update(),this},_initLayout:function(){var e="leaflet-control-layers",t=this._container=i.DomUtil.create("div",e);t.setAttribute("aria-haspopup",!0),i.Browser.touch?i.DomEvent.on(t,"click",i.DomEvent.stopPropagation):i.DomEvent.disableClickPropagation(t).disableScrollPropagation(t);var n=this._form=i.DomUtil.create("form",e+"-list");if(this.options.collapsed){i.Browser.android||i.DomEvent.on(t,"mouseover",this._expand,this).on(t,"mouseout",this._collapse,this);var r=this._layersLink=i.DomUtil.create("a",e+"-toggle",t);r.href="#",r.title="Layers",i.Browser.touch?i.DomEvent.on(r,"click",i.DomEvent.stop).on(r,"click",this._expand,this):i.DomEvent.on(r,"focus",this._expand,this),i.DomEvent.on(n,"click",function(){setTimeout(i.bind(this._onInputClick,this),0)},this),this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=i.DomUtil.create("div",e+"-base",n),this._separator=i.DomUtil.create("div",e+"-separator",n),this._overlaysList=i.DomUtil.create("div",e+"-overlays",n),t.appendChild(n)},_addLayer:function(e,t,n){var r=i.stamp(e);this._layers[r]={layer:e,name:t,overlay:n},this.options.autoZIndex&&e.setZIndex&&(this._lastZIndex++,e.setZIndex(this._lastZIndex))},_update:function(){if(!this._container)return;this._baseLayersList.innerHTML="",this._overlaysList.innerHTML="";var e=!1,t=!1,n,r;for(n in this._layers)r=this._layers[n],this._addItem(r),t=t||r.overlay,e=e||!r.overlay;this._separator.style.display=t&&e?"":"none"},_onLayerChange:function(e){var t=this._layers[i.stamp(e.layer)];if(!t)return;this._handlingClick||this._update();var n=t.overlay?e.type==="layeradd"?"overlayadd":"overlayremove":e.type==="layeradd"?"baselayerchange":null;n&&this._map.fire(n,t)},_createRadioElement:function(e,n){var r='<input type="radio" class="leaflet-control-layers-selector" name="'+e+'"';n&&(r+=' checked="checked"'),r+="/>";var i=t.createElement("div");return i.innerHTML=r,i.firstChild},_addItem:function(e){var n=t.createElement("label"),r,s=this._map.hasLayer(e.layer);e.overlay?(r=t.createElement("input"),r.type="checkbox",r.className="leaflet-control-layers-selector",r.defaultChecked=s):r=this._createRadioElement("leaflet-base-layers",s),r.layerId=i.stamp(e.layer),i.DomEvent.on(r,"click",this._onInputClick,this);var o=t.createElement("span");o.innerHTML=" "+e.name,n.appendChild(r),n.appendChild(o);var u=e.overlay?this._overlaysList:this._baseLayersList;return u.appendChild(n),n},_onInputClick:function(){var e,t,n,r=this._form.getElementsByTagName("input"),i=r.length;this._handlingClick=!0;for(e=0;e<i;e++)t=r[e],n=this._layers[t.layerId],t.checked&&!this._map.hasLayer(n.layer)?this._map.addLayer(n.layer):!t.checked&&this._map.hasLayer(n.layer)&&this._map.removeLayer(n.layer);this._handlingClick=!1,this._refocusOnMap()},_expand:function(){i.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")}}),i.control.layers=function(e,t,n){return new i.Control.Layers(e,t,n)},i.PosAnimation=i.Class.extend({includes:i.Mixin.Events,run:function(e,t,n,r){this.stop(),this._el=e,this._inProgress=!0,this._newPos=t,this.fire("start"),e.style[i.DomUtil.TRANSITION]="all "+(n||.25)+"s cubic-bezier(0,0,"+(r||.5)+",1)",i.DomEvent.on(e,i.DomUtil.TRANSITION_END,this._onTransitionEnd,this),i.DomUtil.setPosition(e,t),i.Util.falseFn(e.offsetWidth),this._stepTimer=setInterval(i.bind(this._onStep,this),50)},stop:function(){if(!this._inProgress)return;i.DomUtil.setPosition(this._el,this._getPos()),this._onTransitionEnd(),i.Util.falseFn(this._el.offsetWidth)},_onStep:function(){var e=this._getPos();if(!e){this._onTransitionEnd();return}this._el._leaflet_pos=e,this.fire("step")},_transformRe:/([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/,_getPos:function(){var t,n,r,s=this._el,o=e.getComputedStyle(s);if(i.Browser.any3d){r=o[i.DomUtil.TRANSFORM].match(this._transformRe);if(!r)return;t=parseFloat(r[1]),n=parseFloat(r[2])}else t=parseFloat(o.left),n=parseFloat(o.top);return new i.Point(t,n,!0)},_onTransitionEnd:function(){i.DomEvent.off(this._el,i.DomUtil.TRANSITION_END,this._onTransitionEnd,this);if(!this._inProgress)return;this._inProgress=!1,this._el.style[i.DomUtil.TRANSITION]="",this._el._leaflet_pos=this._newPos,clearInterval(this._stepTimer),this.fire("step").fire("end")}}),i.Map.include({setView:function(e,t,r){t=t===n?this._zoom:this._limitZoom(t),e=this._limitCenter(i.latLng(e),t,this.options.maxBounds),r=r||{},this._panAnim&&this._panAnim.stop();if(this._loaded&&!r.reset&&r!==!0){r.animate!==n&&(r.zoom=i.extend({animate:r.animate},r.zoom),r.pan=i.extend({animate:r.animate},r.pan));var s=this._zoom!==t?this._tryAnimatedZoom&&this._tryAnimatedZoom(e,t,r.zoom):this._tryAnimatedPan(e,r.pan);if(s)return clearTimeout(this._sizeTimer),this}return this._resetView(e,t),this},panBy:function(e,t){e=i.point(e).round(),t=t||{};if(!e.x&&!e.y)return this;this._panAnim||(this._panAnim=new i.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),t.noMoveStart||this.fire("movestart");if(t.animate!==!1){i.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(e);this._panAnim.run(this._mapPane,n,t.duration||.25,t.easeLinearity)}else this._rawPanBy(e),this.fire("move").fire("moveend");return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){i.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(e,t){var n=this._getCenterOffset(e)._floor();return(t&&t.animate)!==!0&&!this.getSize().contains(n)?!1:(this.panBy(n,t),!0)}}),i.PosAnimation=i.DomUtil.TRANSITION?i.PosAnimation:i.PosAnimation.extend({run:function(e,t,n,r){this.stop(),this._el=e,this._inProgress=!0,this._duration=n||.25,this._easeOutPower=1/Math.max(r||.5,.2),this._startPos=i.DomUtil.getPosition(e),this._offset=t.subtract(this._startPos),this._startTime=+(new Date),this.fire("start"),this._animate()},stop:function(){if(!this._inProgress)return;this._step(),this._complete()},_animate:function(){this._animId=i.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(){var e=+(new Date)-this._startTime,t=this._duration*1e3;e<t?this._runFrame(this._easeOut(e/t)):(this._runFrame(1),this._complete())},_runFrame:function(e){var t=this._startPos.add(this._offset.multiplyBy(e));i.DomUtil.setPosition(this._el,t),this.fire("step")},_complete:function(){i.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(e){return 1-Math.pow(1-e,this._easeOutPower)}}),i.Map.mergeOptions({zoomAnimation:!0,zoomAnimationThreshold:4}),i.DomUtil.TRANSITION&&i.Map.addInitHook(function(){this._zoomAnimated=this.options.zoomAnimation&&i.DomUtil.TRANSITION&&i.Browser.any3d&&!i.Browser.android23&&!i.Browser.mobileOpera,this._zoomAnimated&&i.DomEvent.on(this._mapPane,i.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)}),i.Map.include(i.DomUtil.TRANSITION?{_catchTransitionEnd:function(e){this._animatingZoom&&e.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(e,t,n){if(this._animatingZoom)return!0;n=n||{};if(!this._zoomAnimated||n.animate===!1||this._nothingToAnimate()||Math.abs(t-this._zoom)>this.options.zoomAnimationThreshold)return!1;var r=this.getZoomScale(t),i=this._getCenterOffset(e)._divideBy(1-1/r),s=this._getCenterLayerPoint()._add(i);return n.animate!==!0&&!this.getSize().contains(i)?!1:(this.fire("movestart").fire("zoomstart"),this._animateZoom(e,t,s,r,null,!0),!0)},_animateZoom:function(e,t,n,r,s,o){this._animatingZoom=!0,i.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim"),this._animateToCenter=e,this._animateToZoom=t,i.Draggable&&(i.Draggable._disabled=!0),this.fire("zoomanim",{center:e,zoom:t,origin:n,scale:r,delta:s,backwards:o})},_onZoomTransitionEnd:function(){this._animatingZoom=!1,i.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),this._resetView(this._animateToCenter,this._animateToZoom,!0,!0),i.Draggable&&(i.Draggable._disabled=!1)}}:{}),i.TileLayer.include({_animateZoom:function(e){this._animating||(this._animating=!0,this._prepareBgBuffer());var t=this._bgBuffer,n=i.DomUtil.TRANSFORM,r=e.delta?i.DomUtil.getTranslateString(e.delta):t.style[n],s=i.DomUtil.getScaleString(e.scale,e.origin);t.style[n]=e.backwards?s+" "+r:r+" "+s},_endZoomAnim:function(){var e=this._tileContainer,t=this._bgBuffer;e.style.visibility="",e.parentNode.appendChild(e),i.Util.falseFn(t.offsetWidth),this._animating=!1},_clearBgBuffer:function(){var e=this._map;e&&!e._animatingZoom&&!e.touchZoom._zooming&&(this._bgBuffer.innerHTML="",this._bgBuffer.style[i.DomUtil.TRANSFORM]="")},_prepareBgBuffer:function(){var e=this._tileContainer,t=this._bgBuffer,n=this._getLoadedTilesPercentage(t),r=this._getLoadedTilesPercentage(e);if(t&&n>.5&&r<.5){e.style.visibility="hidden",this._stopLoadingImages(e);return}t.style.visibility="hidden",t.style[i.DomUtil.TRANSFORM]="",this._tileContainer=t,t=this._bgBuffer=e,this._stopLoadingImages(t),clearTimeout(this._clearBgBufferTimer)},_getLoadedTilesPercentage:function(e){var t=e.getElementsByTagName("img"),n,r,i=0;for(n=0,r=t.length;n<r;n++)t[n].complete&&i++;return i/r},_stopLoadingImages:function(e){var t=Array.prototype.slice.call(e.getElementsByTagName("img")),n,r,s;for(n=0,r=t.length;n<r;n++)s=t[n],s.complete||(s.onload=i.Util.falseFn,s.onerror=i.Util.falseFn,s.src=i.Util.emptyImageUrl,s.parentNode.removeChild(s))}}),i.Map.include({_defaultLocateOptions:{watch:!1,setView:!1,maxZoom:Infinity,timeout:1e4,maximumAge:0,enableHighAccuracy:!1},locate:function(e){e=this._locateOptions=i.extend(this._defaultLocateOptions,e);if(!navigator.geolocation)return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var t=i.bind(this._handleGeolocationResponse,this),n=i.bind(this._handleGeolocationError,this);return e.watch?this._locationWatchId=navigator.geolocation.watchPosition(t,n,e):navigator.geolocation.getCurrentPosition(t,n,e),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(e){var t=e.code,n=e.message||(t===1?"permission denied":t===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:t,message:"Geolocation error: "+n+"."})},_handleGeolocationResponse:function(e){var t=e.coords.latitude,n=e.coords.longitude,r=new i.LatLng(t,n),s=180*e.coords.accuracy/40075017,o=s/Math.cos(i.LatLng.DEG_TO_RAD*t),u=i.latLngBounds([t-s,n-o],[t+s,n+o]),a=this._locateOptions;if(a.setView){var f=Math.min(this.getBoundsZoom(u),a.maxZoom);this.setView(r,f)}var l={latlng:r,bounds:u,timestamp:e.timestamp};for(var c in e.coords)typeof e.coords[c]=="number"&&(l[c]=e.coords[c]);this.fire("locationfound",l)}})}(window,document),!function(e,t,n){t[e]=n(e,t)}("bean",this,function(e,t){var n=window,r=t[e],i=/over|out/,s=/[^\.]*(?=\..*)\.|.*/,o=/\..*/,u="addEventListener",a="attachEvent",f="removeEventListener",l="detachEvent",c=document||{},h=c.documentElement||{},p=h[u],d=p?u:a,v=Array.prototype.slice,m=/click|mouse(?!(.*wheel|scroll))|menu|drag|drop/i,g=/mouse.*(wheel|scroll)/i,y=/^text/i,b=/^touch|^gesture/i,w={one:1},E=function(e,t,n){for(n=0;n<t.length;n++)e[t[n]]=1;return e}({},("click dblclick mouseup mousedown contextmenu mousewheel mousemultiwheel DOMMouseScroll mouseover mouseout mousemove selectstart selectend keydown keypress keyup orientationchange focus blur change reset select submit load unload beforeunload resize move DOMContentLoaded readystatechange error abort scroll "+(p?"show input invalid touchstart touchmove touchend touchcancel gesturestart gesturechange gestureend MSPointerUp MSPointerDown MSPointerCancel MSPointerMove MSPointerOver MSPointerOut message readystatechange pageshow pagehide popstate hashchange offline online afterprint beforeprint dragstart dragenter dragover dragleave drag drop dragend loadstart progress suspend emptied stalled loadmetadata loadeddata canplay canplaythrough playing waiting seeking seeked ended durationchange timeupdate play pause ratechange volumechange cuechange checking noupdate downloading cached updateready obsolete ":"")).split(" ")),S=function(){function e(e,t){while((t=t.parentNode)!==null)if(t===e)return!0;return!1}function t(t){var n=t.relatedTarget;return n?n!==this&&n.prefix!=="xul"&&!/document/.test(this.toString())&&!e(this,n):n===null}return{mouseenter:{base:"mouseover",condition:t},mouseleave:{base:"mouseout",condition:t},mousewheel:{base:/Firefox/.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel"}}}(),x=function(){var e="altKey attrChange attrName bubbles cancelable ctrlKey currentTarget detail eventPhase getModifierState isTrusted metaKey relatedNode relatedTarget shiftKey srcElement target timeStamp type view which".split(" "),t=e.concat("button buttons clientX clientY dataTransfer fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" ")),n=t.concat("wheelDelta wheelDeltaX wheelDeltaY wheelDeltaZ axis".split(" ")),r=e.concat("char charCode key keyCode keyIdentifier keyLocation".split(" ")),s=e.concat(["data"]),o=e.concat("touches targetTouches changedTouches scale rotation".split(" ")),u="preventDefault",a=function(e){return function(){e[u]?e[u]():e.returnValue=!1}},f="stopPropagation",l=function(e){return function(){e[f]?e[f]():e.cancelBubble=!0}},p=function(e){return function(){e[u](),e[f](),e.stopped=!0}},d=function(e,t,n){var r,i;for(r=n.length;r--;)i=n[r],!(i in t)&&i in e&&(t[i]=e[i])};return function(v,w){var E={originalEvent:v,isNative:w};if(!v)return E;var S,x=v.type,T=v.target||v.srcElement;E[u]=a(v),E[f]=l(v),E.stop=p(E),E.target=T&&T.nodeType===3?T.parentNode:T;if(w){if(x.indexOf("key")!==-1)S=r,E.keyCode=v.which||v.keyCode;else if(m.test(x)){S=t,E.rightClick=v.which===3||v.button===2,E.pos={x:0,y:0};if(v.pageX||v.pageY)E.clientX=v.pageX,E.clientY=v.pageY;else if(v.clientX||v.clientY)E.clientX=v.clientX+c.body.scrollLeft+h.scrollLeft,E.clientY=v.clientY+c.body.scrollTop+h.scrollTop;i.test(x)&&(E.relatedTarget=v.relatedTarget||v[(x==="mouseover"?"from":"to")+"Element"])}else b.test(x)?S=o:g.test(x)?S=n:y.test(x)&&(S=s);d(v,E,S||e)}return E}}(),T=function(e,t){return!p&&!t&&(e===c||e===n)?h:e},N=function(){function e(e,t,n,r,i){this.element=e,this.type=t,this.handler=n,this.original=r,this.namespaces=i,this.custom=S[t],this.isNative=E[t]&&e[d],this.eventType=p||this.isNative?t:"propertychange",this.customType=!p&&!this.isNative&&t,this.target=T(e,this.isNative),this.eventSupport=this.target[d]}return e.prototype={inNamespaces:function(e){var t,n;if(!e)return!0;if(!this.namespaces)return!1;for(t=e.length;t--;)for(n=this.namespaces.length;n--;)if(e[t]===this.namespaces[n])return!0;return!1},matches:function(e,t,n){return this.element===e&&(!t||this.original===t)&&(!n||this.handler===n)}},e}(),C=function(){var e={},t=function(n,r,i,s,o){if(!r||r==="*")for(var u in e)u.charAt(0)==="$"&&t(n,u.substr(1),i,s,o);else{var a=0,f,l=e["$"+r],c=n==="*";if(!l)return;for(f=l.length;a<f;a++)if(c||l[a].matches(n,i,s))if(!o(l[a],l,a,r))return}},n=function(t,n,r){var i,s=e["$"+n];if(s)for(i=s.length;i--;)if(s[i].matches(t,r,null))return!0;return!1},r=function(e,n,r){var i=[];return t(e,n,r,null,function(e){return i.push(e)}),i},i=function(t){return(e["$"+t.type]||(e["$"+t.type]=[])).push(t),t},s=function(n){t(n.element,n.type,null,n.handler,function(t,n,r){return n.splice(r,1),n.length===0&&delete e["$"+t.type],!1})},o=function(){var t,n=[];for(t in e)t.charAt(0)==="$"&&(n=n.concat(e[t]));return n};return{has:n,get:r,put:i,del:s,entries:o}}(),k=p?function(e,t,n,r){e[r?u:f](t,n,!1)}:function(e,t,n,r,i){i&&r&&e["_on"+i]===null&&(e["_on"+i]=0),e[r?a:l]("on"+t,n)},L=function(e,t,r){return function(i){return i=x(i||((this.ownerDocument||this.document||this).parentWindow||n).event,!0),t.apply(e,[i].concat(r))}},A=function(e,t,r,i,s,o){return function(u){if(i?i.apply(this,arguments):p?!0:u&&u.propertyName==="_on"+r||!u)u&&(u=x(u||((this.ownerDocument||this.document||this).parentWindow||n).event,o)),t.apply(e,u&&(!s||s.length===0)?arguments:v.call(arguments,u?0:1).concat(s))}},O=function(e,t,n,r,i){return function(){e(t,n,i),r.apply(this,arguments)}},M=function(e,t,n,r){var i,s,u,a=t&&t.replace(o,""),f=C.get(e,a,n);for(i=0,s=f.length;i<s;i++)f[i].inNamespaces(r)&&((u=f[i]).eventSupport&&k(u.target,u.eventType,u.handler,!1,u.type),C.del(u))},_=function(e,t,n,r,i){var u,a=t.replace(o,""),f=t.replace(s,"").split(".");if(C.has(e,a,n))return e;a==="unload"&&(n=O(M,e,a,n,r)),S[a]&&(S[a].condition&&(n=A(e,n,a,S[a].condition,!0)),a=S[a].base||a),u=C.put(new N(e,a,n,r,f[0]&&f)),u.handler=u.isNative?L(e,u.handler,i):A(e,u.handler,a,!1,i,!1),u.eventSupport&&k(u.target,u.eventType,u.handler,!0,u.customType)},D=function(e,t,n){return function(r){var i,s,o=typeof e=="string"?n(e,this):e;for(i=r.target;i&&i!==this;i=i.parentNode)for(s=o.length;s--;)if(o[s]===i)return t.apply(i,arguments)}},P=function(e,t,n){var r,i,u,a,f,l=M,c=t&&typeof t=="string";if(c&&t.indexOf(" ")>0){t=t.split(" ");for(f=t.length;f--;)P(e,t[f],n);return e}u=c&&t.replace(o,""),u&&S[u]&&(u=S[u].type);if(!t||c){if(a=c&&t.replace(s,""))a=a.split(".");l(e,u,n,a)}else if(typeof t=="function")l(e,null,t);else for(r in t)t.hasOwnProperty(r)&&P(e,r,t[r]);return e},H=function(e,t,n,r,i){var s,o,u,a,f=n,l=n&&typeof n=="string";if(t&&!n&&typeof t=="object")for(s in t)t.hasOwnProperty(s)&&H.apply(this,[e,s,t[s]]);else{a=arguments.length>3?v.call(arguments,3):[],o=(l?n:t).split(" "),l&&(n=D(t,f=r,i))&&(a=v.call(a,1)),this===w&&(n=O(P,e,t,n,f));for(u=o.length;u--;)_(e,o[u],n,f,a)}return e},B=function(){return H.apply(w,arguments)},j=p?function(e,t,r){var i=c.createEvent(e?"HTMLEvents":"UIEvents");i[e?"initEvent":"initUIEvent"](t,!0,!0,n,1),r.dispatchEvent(i)}:function(e,t,n){n=T(n,e),e?n.fireEvent("on"+t,c.createEventObject()):n["_on"+t]++},F=function(e,t,n){var r,i,u,a,f,l=t.split(" ");for(r=l.length;r--;){t=l[r].replace(o,"");if(a=l[r].replace(s,""))a=a.split(".");if(!a&&!n&&e[d])j(E[t],t,e);else{f=C.get(e,t),n=[!1].concat(n);for(i=0,u=f.length;i<u;i++)f[i].inNamespaces(a)&&f[i].handler.apply(e,n)}}return e},I=function(e,t,n){var r=0,i=C.get(t,n),s=i.length;for(;r<s;r++)i[r].original&&H(e,i[r].type,i[r].original);return e},q={add:H,one:B,remove:P,clone:I,fire:F,noConflict:function(){return t[e]=r,this}};if(n[a]){var R=function(){var e,t=C.entries();for(e in t)t[e].type&&t[e].type!=="unload"&&P(t[e].element,t[e].type);n[l]("onunload",R),n.CollectGarbage&&n.CollectGarbage()};n[a]("onunload",R)}return q});var html4={};html4.atype={NONE:0,URI:1,URI_FRAGMENT:11,SCRIPT:2,STYLE:3,ID:4,IDREF:5,IDREFS:6,GLOBAL_NAME:7,LOCAL_NAME:8,CLASSES:9,FRAME_TARGET:10},html4.ATTRIBS={"*::class":9,"*::dir":0,"*::id":4,"*::lang":0,"*::onclick":2,"*::ondblclick":2,"*::onkeydown":2,"*::onkeypress":2,"*::onkeyup":2,"*::onload":2,"*::onmousedown":2,"*::onmousemove":2,"*::onmouseout":2,"*::onmouseover":2,"*::onmouseup":2,"*::style":3,"*::title":0,"a::accesskey":0,"a::coords":0,"a::href":1,"a::hreflang":0,"a::name":7,"a::onblur":2,"a::onfocus":2,"a::rel":0,"a::rev":0,"a::shape":0,"a::tabindex":0,"a::target":10,"a::type":0,"area::accesskey":0,"area::alt":0,"area::coords":0,"area::href":1,"area::nohref":0,"area::onblur":2,"area::onfocus":2,"area::shape":0,"area::tabindex":0,"area::target":10,"bdo::dir":0,"blockquote::cite":1,"br::clear":0,"button::accesskey":0,"button::disabled":0,"button::name":8,"button::onblur":2,"button::onfocus":2,"button::tabindex":0,"button::type":0,"button::value":0,"canvas::height":0,"canvas::width":0,"caption::align":0,"col::align":0,"col::char":0,"col::charoff":0,"col::span":0,"col::valign":0,"col::width":0,"colgroup::align":0,"colgroup::char":0,"colgroup::charoff":0,"colgroup::span":0,"colgroup::valign":0,"colgroup::width":0,"del::cite":1,"del::datetime":0,"dir::compact":0,"div::align":0,"dl::compact":0,"font::color":0,"font::face":0,"font::size":0,"form::accept":0,"form::action":1,"form::autocomplete":0,"form::enctype":0,"form::method":0,"form::name":7,"form::onreset":2,"form::onsubmit":2,"form::target":10,"h1::align":0,"h2::align":0,"h3::align":0,"h4::align":0,"h5::align":0,"h6::align":0,"hr::align":0,"hr::noshade":0,"hr::size":0,"hr::width":0,"iframe::align":0,"iframe::frameborder":0,"iframe::height":0,"iframe::marginheight":0,"iframe::marginwidth":0,"iframe::width":0,"img::align":0,"img::alt":0,"img::border":0,"img::height":0,"img::hspace":0,"img::ismap":0,"img::name":7,"img::src":1,"img::usemap":11,"img::vspace":0,"img::width":0,"input::accept":0,"input::accesskey":0,"input::align":0,"input::alt":0,"input::autocomplete":0,"input::checked":0,"input::disabled":0,"input::ismap":0,"input::maxlength":0,"input::name":8,"input::onblur":2,"input::onchange":2,"input::onfocus":2,"input::onselect":2,"input::readonly":0,"input::size":0,"input::src":1,"input::tabindex":0,"input::type":0,"input::usemap":11,"input::value":0,"ins::cite":1,"ins::datetime":0,"label::accesskey":0,"label::for":5,"label::onblur":2,"label::onfocus":2,"legend::accesskey":0,"legend::align":0,"li::type":0,"li::value":0,"map::name":7,"menu::compact":0,"ol::compact":0,"ol::start":0,"ol::type":0,"optgroup::disabled":0,"optgroup::label":0,"option::disabled":0,"option::label":0,"option::selected":0,"option::value":0,"p::align":0,"pre::width":0,"q::cite":1,"select::disabled":0,"select::multiple":0,"select::name":8,"select::onblur":2,"select::onchange":2,"select::onfocus":2,"select::size":0,"select::tabindex":0,"table::align":0,"table::bgcolor":0,"table::border":0,"table::cellpadding":0,"table::cellspacing":0,"table::frame":0,"table::rules":0,"table::summary":0,"table::width":0,"tbody::align":0,"tbody::char":0,"tbody::charoff":0,"tbody::valign":0,"td::abbr":0,"td::align":0,"td::axis":0,"td::bgcolor":0,"td::char":0,"td::charoff":0,"td::colspan":0,"td::headers":6,"td::height":0,"td::nowrap":0,"td::rowspan":0,"td::scope":0,"td::valign":0,"td::width":0,"textarea::accesskey":0,"textarea::cols":0,"textarea::disabled":0,"textarea::name":8,"textarea::onblur":2,"textarea::onchange":2,"textarea::onfocus":2,"textarea::onselect":2,"textarea::readonly":0,"textarea::rows":0,"textarea::tabindex":0,"tfoot::align":0,"tfoot::char":0,"tfoot::charoff":0,"tfoot::valign":0,"th::abbr":0,"th::align":0,"th::axis":0,"th::bgcolor":0,"th::char":0,"th::charoff":0,"th::colspan":0,"th::headers":6,"th::height":0,"th::nowrap":0,"th::rowspan":0,"th::scope":0,"th::valign":0,"th::width":0,"thead::align":0,"thead::char":0,"thead::charoff":0,"thead::valign":0,"tr::align":0,"tr::bgcolor":0,"tr::char":0,"tr::charoff":0,"tr::valign":0,"ul::compact":0,"ul::type":0},html4.eflags={OPTIONAL_ENDTAG:1,EMPTY:2,CDATA:4,RCDATA:8,UNSAFE:16,FOLDABLE:32,SCRIPT:64,STYLE:128},html4.ELEMENTS={a:0,abbr:0,acronym:0,address:0,applet:16,area:2,b:0,base:18,basefont:18,bdo:0,big:0,blockquote:0,body:49,br:2,button:0,canvas:0,caption:0,center:0,cite:0,code:0,col:2,colgroup:1,dd:1,del:0,dfn:0,dir:0,div:0,dl:0,dt:1,em:0,fieldset:0,font:0,form:0,frame:18,frameset:16,h1:0,h2:0,h3:0,h4:0,h5:0,h6:0,head:49,hr:2,html:49,i:0,iframe:4,img:2,input:2,ins:0,isindex:18,kbd:0,label:0,legend:0,li:1,link:18,map:0,menu:0,meta:18,nobr:0,noembed:4,noframes:20,noscript:20,object:16,ol:0,optgroup:0,option:1,p:1,param:18,pre:0,q:0,s:0,samp:0,script:84,select:0,small:0,span:0,strike:0,strong:0,style:148,sub:0,sup:0,table:0,tbody:1,td:1,textarea:8,tfoot:1,th:1,thead:1,title:24,tr:1,tt:0,u:0,ul:0,"var":0},html4.ueffects={NOT_LOADED:0,SAME_DOCUMENT:1,NEW_DOCUMENT:2},html4.URIEFFECTS={"a::href":2,"area::href":2,"blockquote::cite":0,"body::background":1,"del::cite":0,"form::action":2,"img::src":1,"input::src":1,"ins::cite":0,"q::cite":0},html4.ltypes={UNSANDBOXED:2,SANDBOXED:1,DATA:0},html4.LOADERTYPES={"a::href":2,"area::href":2,"blockquote::cite":2,"body::background":1,"del::cite":2,"form::action":2,"img::src":1,"input::src":1,"ins::cite":2,"q::cite":2};var html=function(e){function t(e){e=l(e);if(c.hasOwnProperty(e))return c[e];var t=e.match(p);return t?String.fromCharCode(parseInt(t[1],10)):(t=e.match(d))?String.fromCharCode(parseInt(t[1],16)):""}function n(e,n){return t(n)}function r(e){return e.replace(v,"")}function i(e){return e.replace(m,n)}function s(e){return e.replace(g,"&amp;").replace(b,"&lt;").replace(w,"&gt;").replace(E,"&#34;").replace(S,"&#61;")}function o(e){return e.replace(y,"&amp;$1").replace(b,"&lt;").replace(w,"&gt;")}function u(t){return function(n,s){n=String(n);var u=null,a=!1,f=[],c=void 0,h=void 0,p=void 0;t.startDoc&&t.startDoc(s);while(n){var d=n.match(a?x:T);n=n.substring(d[0].length);if(a){if(d[1]){var v=l(d[1]),m;if(d[2]){var g=d[3];switch(g.charCodeAt(0)){case 34:case 39:g=g.substring(1,g.length-1)}m=i(r(g))}else m=v;f.push(v,m)}else if(d[4]){h!==void 0&&(p?t.startTag&&t.startTag(c,f,s):t.endTag&&t.endTag(c,s));if(p&&h&(e.eflags.CDATA|e.eflags.RCDATA)){u===null?u=l(n):u=u.substring(u.length-n.length);var y=u.indexOf("</"+c);y<0&&(y=n.length),y&&(h&e.eflags.CDATA?t.cdata&&t.cdata(n.substring(0,y),s):t.rcdata&&t.rcdata(o(n.substring(0,y)),s),n=n.substring(y))}c=h=p=void 0,f.length=0,a=!1}}else if(d[1])t.pcdata&&t.pcdata(d[0],s);else if(d[3])p=!d[2],a=!0,c=l(d[3]),h=e.ELEMENTS.hasOwnProperty(c)?e.ELEMENTS[c]:void 0;else if(d[4])t.pcdata&&t.pcdata(d[4],s);else if(d[5]&&t.pcdata){var b=d[5];t.pcdata(b==="<"?"&lt;":b===">"?"&gt;":"&amp;",s)}}t.endDoc&&t.endDoc(s)}}function a(t){var n,r;return u({startDoc:function(e){n=[],r=!1},startTag:function(i,o,u){if(r)return;if(!e.ELEMENTS.hasOwnProperty(i))return;var a=e.ELEMENTS[i];if(a&e.eflags.FOLDABLE)return;if(a&e.eflags.UNSAFE){r=!(a&e.eflags.EMPTY);return}o=t(i,o);if(o){a&e.eflags.EMPTY||n.push(i),u.push("<",i);for(var f=0,l=o.length;f<l;f+=2){var c=o[f],h=o[f+1];h!==null&&h!==void 0&&u.push(" ",c,'="',s(h),'"')}u.push(">")}},endTag:function(t,i){if(r){r=!1;return}if(!e.ELEMENTS.hasOwnProperty(t))return;var s=e.ELEMENTS[t];if(!(s&(e.eflags.UNSAFE|e.eflags.EMPTY|e.eflags.FOLDABLE))){var o;if(s&e.eflags.OPTIONAL_ENDTAG)for(o=n.length;--o>=0;){var u=n[o];if(u===t)break;if(!(e.ELEMENTS[u]&e.eflags.OPTIONAL_ENDTAG))return}else for(o=n.length;--o>=0;)if(n[o]===t)break;if(o<0)return;for(var a=n.length;--a>o;){var u=n[a];e.ELEMENTS[u]&e.eflags.OPTIONAL_ENDTAG||i.push("</",u,">")}n.length=o,i.push("</",t,">")}},pcdata:function(e,t){r||t.push(e)},rcdata:function(e,t){r||t.push(e)},cdata:function(e,t){r||t.push(e)},endDoc:function(e){for(var t=n.length;--t>=0;)e.push("</",n[t],">");n.length=0}})}function f(t,n,r){var i=[];return a(function(t,i){for(var s=0;s<i.length;s+=2){var o=i[s],u=i[s+1],a=null,f;if((f=t+"::"+o,e.ATTRIBS.hasOwnProperty(f))||(f="*::"+o,e.ATTRIBS.hasOwnProperty(f)))a=e.ATTRIBS[f];if(a!==null)switch(a){case e.atype.NONE:break;case e.atype.SCRIPT:case e.atype.STYLE:u=null;break;case e.atype.ID:case e.atype.IDREF:case e.atype.IDREFS:case e.atype.GLOBAL_NAME:case e.atype.LOCAL_NAME:case e.atype.CLASSES:u=r?r(u):u;break;case e.atype.URI:var l=(""+u).match(N);l?!l[1]||h.test(l[1])?u=n&&n(u):u=null:u=null;break;case e.atype.URI_FRAGMENT:u&&"#"===u.charAt(0)?(u=r?r(u):u,u&&(u="#"+u)):u=null;break;default:u=null}else u=null;i[s+1]=u}return i})(t,i),i.join("")}var l;"script"==="SCRIPT".toLowerCase()?l=function(e){return e.toLowerCase()}:l=function(e){return e.replace(/[A-Z]/g,function(e){return String.fromCharCode(e.charCodeAt(0)|32)})};var c={lt:"<",gt:">",amp:"&",nbsp:" ",quot:'"',apos:"'"},h=/^(?:https?|mailto|data)$/i,p=/^#(\d+)$/,d=/^#x([0-9A-Fa-f]+)$/,v=/\0/g,m=/&(#\d+|#x[0-9A-Fa-f]+|\w+);/g,g=/&/g,y=/&([^a-z#]|#(?:[^0-9x]|x(?:[^0-9a-f]|$)|$)|$)/gi,b=/</g,w=/>/g,E=/\"/g,S=/\=/g,x=new RegExp("^\\s*(?:(?:([a-z][a-z-]*)(\\s*=\\s*(\"[^\"]*\"|'[^']*'|(?=[a-z][a-z-]*\\s*=)|[^>\"'\\s]*))?)|(/?>)|[\\s\\S][^a-z\\s>]*)","i"),T=new RegExp("^(?:&(\\#[0-9]+|\\#[x][0-9a-f]+|\\w+);|<!--[\\s\\S]*?-->|<!\\w[^>]*>|<\\?[^>*]*>|<(/)?([a-z][a-z0-9]*)|([^<&>]+)|([<&>]))","i"),N=new RegExp("^(?:([^:/?#]+):)?");return{escapeAttrib:s,makeHtmlSanitizer:a,makeSaxParser:u,normalizeRCData:o,sanitize:f,unescapeEntities:i}}(html4),html_sanitize=html.sanitize;typeof window!="undefined"&&(window.html=html,window.html_sanitize=html_sanitize),html4.ATTRIBS["*::style"]=0,html4.ELEMENTS.style=0,html4.ATTRIBS["a::target"]=0,html4.ELEMENTS.video=0,html4.ATTRIBS["video::src"]=0,html4.ATTRIBS["video::poster"]=0,html4.ATTRIBS["video::controls"]=0,html4.ELEMENTS.audio=0,html4.ATTRIBS["audio::src"]=0,html4.ATTRIBS["video::autoplay"]=0,html4.ATTRIBS["video::controls"]=0;var Mustache=typeof module!="undefined"&&module.exports||{};(function(e){function t(e){return g.test(e)}function n(e){return String(e).replace(/[&<>"'\/]/g,function(e){return E[e]||e})}function r(e,t,n,r){r=r||"<template>";var i=t.split("\n"),s=Math.max(n-3,0),o=Math.min(i.length,n+3),u=i.slice(s,o),a;for(var f=0,l=u.length;f<l;++f)a=f+s+1,u[f]=(a===n?" >> ":"    ")+u[f];return e.template=t,e.line=n,e.file=r,e.message=[r+":"+n,u.join("\n"),"",e.message].join("\n"),e}function i(e,t,n){if(e===".")return t[t.length-1];var r=e.split("."),i=r.length-1,s=r[i],o,u,a=t.length,f,l;while(a){l=t.slice(0),u=t[--a],f=0;while(f<i){u=u[r[f++]];if(u==null)break;l.push(u)}if(u&&typeof u=="object"&&s in u){o=u[s];break}}return typeof o=="function"&&(o=o.call(l[l.length-1])),o==null?n:o}function s(e,t,n,r){var s="",o=i(e,t);if(r){if(o==null||o===!1||v(o)&&o.length===0)s+=n()}else if(v(o))m(o,function(e){t.push(e),s+=n(),t.pop()});else if(typeof o=="object")t.push(o),s+=n(),t.pop();else if(typeof o=="function"){var u=t[t.length-1],a=function(e){return l(e,u)};s+=o.call(u,n(),a)||""}else o&&(s+=n());return s}function o(n,i){i=i||{};var s=i.tags||e.tags,o=s[0],u=s[s.length-1],a=['var buffer = "";',"\nvar line = 1;","\ntry {",'\nbuffer += "'],f=[],l=!1,c=!1,h=function(){if(l&&!c&&!i.space)while(f.length)a.splice(f.pop(),1);else f=[];l=!1,c=!1},p=[],d,v,m,g=function(e){s=y(e).split(/\s+/),v=s[0],m=s[s.length-1]},b=function(e){a.push('";',d,'\nvar partial = partials["'+y(e)+'"];',"\nif (partial) {","\n  buffer += render(partial,stack[stack.length - 1],partials);","\n}",'\nbuffer += "')},w=function(e,t){var s=y(e);if(s==="")throw r(new Error("Section name may not be empty"),n,N,i.file);p.push({name:s,inverted:t}),a.push('";',d,'\nvar name = "'+s+'";',"\nvar callback = (function () {","\n  return function () {",'\n    var buffer = "";','\nbuffer += "')},E=function(e){w(e,!0)},S=function(e){var t=y(e),s=p.length!=0&&p[p.length-1].name;if(!s||t!=s)throw r(new Error('Section named "'+t+'" was never opened'),n,N,i.file);var o=p.pop();a.push('";',"\n    return buffer;","\n  };","\n})();"),o.inverted?a.push("\nbuffer += renderSection(name,stack,callback,true);"):a.push("\nbuffer += renderSection(name,stack,callback);"),a.push('\nbuffer += "')},x=function(e){a.push('";',d,'\nbuffer += lookup("'+y(e)+'",stack,"");','\nbuffer += "')},T=function(e){a.push('";',d,'\nbuffer += escapeHTML(lookup("'+y(e)+'",stack,""));','\nbuffer += "')},N=1,C,k;for(var L=0,A=n.length;L<A;++L)if(n.slice(L,L+o.length)===o){L+=o.length,C=n.substr(L,1),d="\nline = "+N+";",v=o,m=u,l=!0;switch(C){case"!":L++,k=null;break;case"=":L++,u="="+u,k=g;break;case">":L++,k=b;break;case"#":L++,k=w;break;case"^":L++,k=E;break;case"/":L++,k=S;break;case"{":u="}"+u;case"&":L++,c=!0,k=x;break;default:c=!0,k=T}var O=n.indexOf(u,L);if(O===-1)throw r(new Error('Tag "'+o+'" was not closed properly'),n,N,i.file);var M=n.substring(L,O);k&&k(M);var _=0;while(~(_=M.indexOf("\n",_)))N++,_++;L=O+u.length-1,o=v,u=m}else{C=n.substr(L,1);switch(C){case'"':case"\\":c=!0,a.push("\\"+C);break;case"\r":break;case"\n":f.push(a.length),a.push("\\n"),h(),N++;break;default:t(C)?f.push(a.length):c=!0,a.push(C)}}if(p.length!=0)throw r(new Error('Section "'+p[p.length-1].name+'" was not closed properly'),n,N,i.file);h(),a.push('";',"\nreturn buffer;","\n} catch (e) { throw {error: e, line: line}; }");var D=a.join("").replace(/buffer \+= "";\n/g,"");return i.debug&&(typeof console!="undefined"&&console.log?console.log(D):typeof print=="function"&&print(D)),D}function u(e,t){var u="view,partials,stack,lookup,escapeHTML,renderSection,render",a=o(e,t),f=new Function(u,a);return function(o,u){u=u||{};var a=[o];try{return f(o,u,a,i,n,s,l)}catch(c){throw r(c.error,e,c.line,t.file)}}}function a(){S={}}function f(e,t){return t=t||{},t.cache!==!1?(S[e]||(S[e]=u(e,t)),S[e]):u(e,t)}function l(e,t,n){return f(e)(t,n)}e.name="mustache.js",e.version="0.5.0-dev",e.tags=["{{","}}"],e.parse=o,e.compile=f,e.render=l,e.clearCache=a,e.to_html=function(e,t,n,r){var i=l(e,t,n);if(typeof r!="function")return i;r(i)};var c=Object.prototype.toString,h=Array.isArray,p=Array.prototype.forEach,d=String.prototype.trim,v;h?v=h:v=function(e){return c.call(e)==="[object Array]"};var m;p?m=function(e,t,n){return p.call(e,t,n)}:m=function(e,t,n){for(var r=0,i=e.length;r<i;++r)t.call(n,e[r],r,e)};var g=/^\s*$/,y;if(d)y=function(e){return e==null?"":d.call(e)};else{var b,w;t(" ")?(b=/^\s+/,w=/\s+$/):(b=/^[\s\xA0]+/,w=/[\s\xA0]+$/),y=function(e){return e==null?"":String(e).replace(b,"").replace(w,"")}}var E={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},S={}})(Mustache),function(e,t,n){t[e]=n()}("reqwest",this,function(){function handleReadyState(e,t,n){return function(){if(e._aborted)return n(e.request);e.request&&e.request[readyState]==4&&(e.request.onreadystatechange=noop,twoHundo.test(e.request.status)?t(e.request):n(e.request))}}function setHeaders(e,t){var n=t.headers||{},r;n.Accept=n.Accept||defaultHeaders.accept[t.type]||defaultHeaders.accept["*"],!t.crossOrigin&&!n[requestedWith]&&(n[requestedWith]=defaultHeaders.requestedWith),n[contentType]||(n[contentType]=t.contentType||defaultHeaders.contentType);for(r in n)n.hasOwnProperty(r)&&e.setRequestHeader(r,n[r])}function setCredentials(e,t){typeof t.withCredentials!="undefined"&&typeof e.withCredentials!="undefined"&&(e.withCredentials=!!t.withCredentials)}function generalCallback(e){lastValue=e}function urlappend(e,t){return e+(/\?/.test(e)?"&":"?")+t}function handleJsonp(e,t,n,r){var i=uniqid++,s=e.jsonpCallback||"callback",o=e.jsonpCallbackName||reqwest.getcallbackPrefix(i),u=new RegExp("((^|\\?|&)"+s+")=([^&]+)"),a=r.match(u),f=doc.createElement("script"),l=0,c=navigator.userAgent.indexOf("MSIE 10.0")!==-1;return a?a[3]==="?"?r=r.replace(u,"$1="+o):o=a[3]:r=urlappend(r,s+"="+o),win[o]=generalCallback,f.type="text/javascript",typeof f.onreadystatechange!="undefined"&&!c&&(f.event="onclick",f.htmlFor=f.id="_reqwest_"+i),f.onload=f.onreadystatechange=function(){if(f[readyState]&&f[readyState]!=="complete"&&f[readyState]!=="loaded"||l)return!1;f.onload=f.onreadystatechange=null,f.onclick&&f.onclick(),e.success&&e.success(lastValue),lastValue=undefined,head.removeChild(f),l=1},f.src=r,f.async=!0,head.appendChild(f),{abort:function(){f.onload=f.onreadystatechange=null,e.error&&e.error({},"Request is aborted: timeout",{}),lastValue=undefined,head.removeChild(f),l=1}}}function getRequest(e,t){var n=this.o,r=(n.method||"GET").toUpperCase(),i=typeof n=="string"?n:n.url,s=n.processData!==!1&&n.data&&typeof n.data!="string"?reqwest.toQueryString(n.data):n.data||null,o;return(n.type=="jsonp"||r=="GET")&&s&&(i=urlappend(i,s),s=null),n.type=="jsonp"?handleJsonp(n,e,t,i):(o=xhr(),o.open(r,i,!0),setHeaders(o,n),setCredentials(o,n),o.onreadystatechange=handleReadyState(this,e,t),n.before&&n.before(o),o.send(s),o)}function Reqwest(e,t){this.o=e,this.fn=t,init.apply(this,arguments)}function setType(e){var t=e.match(/\.(json|jsonp|html|xml)(\?|$)/);return t?t[1]:"js"}function init(o,fn){function complete(e){o.timeout&&clearTimeout(self.timeout),self.timeout=null;while(self._completeHandlers.length>0)self._completeHandlers.shift()(e)}function success(resp){var r=resp.responseText;if(r)switch(type){case"json":try{resp=win.JSON?win.JSON.parse(r):eval("("+r+")")}catch(err){return error(resp,"Could not parse JSON in response",err)}break;case"js":resp=eval(r);break;case"html":resp=r;break;case"xml":resp=resp.responseXML&&resp.responseXML.parseError&&resp.responseXML.parseError.errorCode&&resp.responseXML.parseError.reason?null:resp.responseXML}self._responseArgs.resp=resp,self._fulfilled=!0,fn(resp);while(self._fulfillmentHandlers.length>0)self._fulfillmentHandlers.shift()(resp);complete(resp)}function error(e,t,n){self._responseArgs.resp=e,self._responseArgs.msg=t,self._responseArgs.t=n,self._erred=!0;while(self._errorHandlers.length>0)self._errorHandlers.shift()(e,t,n);complete(e)}this.url=typeof o=="string"?o:o.url,this.timeout=null,this._fulfilled=!1,this._fulfillmentHandlers=[],this._errorHandlers=[],this._completeHandlers=[],this._erred=!1,this._responseArgs={};var self=this,type=o.type||setType(this.url);fn=fn||function(){},o.timeout&&(this.timeout=setTimeout(function(){self.abort()},o.timeout)),o.success&&this._fulfillmentHandlers.push(function(){o.success.apply(o,arguments)}),o.error&&this._errorHandlers.push(function(){o.error.apply(o,arguments)}),o.complete&&this._completeHandlers.push(function(){o.complete.apply(o,arguments)}),this.request=getRequest.call(this,success,error)}function reqwest(e,t){return new Reqwest(e,t)}function normalize(e){return e?e.replace(/\r?\n/g,"\r\n"):""}function serial(e,t){var n=e.name,r=e.tagName.toLowerCase(),i=function(e){e&&!e.disabled&&t(n,normalize(e.attributes.value&&e.attributes.value.specified?e.value:e.text))},s,o,u,a;if(e.disabled||!n)return;switch(r){case"input":/reset|button|image|file/i.test(e.type)||(s=/checkbox/i.test(e.type),o=/radio/i.test(e.type),u=e.value,(!s&&!o||e.checked)&&t(n,normalize(s&&u===""?"on":u)));break;case"textarea":t(n,normalize(e.value));break;case"select":if(e.type.toLowerCase()==="select-one")i(e.selectedIndex>=0?e.options[e.selectedIndex]:null);else for(a=0;e.length&&a<e.length;a++)e.options[a].selected&&i(e.options[a])}}function eachFormElement(){var e=this,t,n,r=function(t,n){var r,i,s;for(r=0;r<n.length;r++){s=t[byTag](n[r]);for(i=0;i<s.length;i++)serial(s[i],e)}};for(n=0;n<arguments.length;n++)t=arguments[n],/input|select|textarea/i.test(t.tagName)&&serial(t,e),r(t,["input","select","textarea"])}function serializeQueryString(){return reqwest.toQueryString(reqwest.serializeArray.apply(null,arguments))}function serializeHash(){var e={};return eachFormElement.apply(function(t,n){t in e?(e[t]&&!isArray(e[t])&&(e[t]=[e[t]]),e[t].push(n)):e[t]=n},arguments),e}var win=window,doc=document,twoHundo=/^20\d$/,byTag="getElementsByTagName",readyState="readyState",contentType="Content-Type",requestedWith="X-Requested-With",head=doc[byTag]("head")[0],uniqid=0,callbackPrefix="reqwest_"+ +(new Date),lastValue,xmlHttpRequest="XMLHttpRequest",noop=function(){},isArray=typeof Array.isArray=="function"?Array.isArray:function(e){return e instanceof Array},defaultHeaders={contentType:"application/x-www-form-urlencoded",requestedWith:xmlHttpRequest,accept:{"*":"text/javascript, text/html, application/xml, text/xml, */*",xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"}},xhr=win[xmlHttpRequest]?function(){return new XMLHttpRequest}:function(){return new ActiveXObject("Microsoft.XMLHTTP")};return Reqwest.prototype={abort:function(){this._aborted=!0,this.request.abort()},retry:function(){init.call(this,this.o,this.fn)},then:function(e,t){return this._fulfilled?e(this._responseArgs.resp):this._erred?t(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):(this._fulfillmentHandlers.push(e),this._errorHandlers.push(t)),this},always:function(e){return this._fulfilled||this._erred?e(this._responseArgs.resp):this._completeHandlers.push(e),this},fail:function(e){return this._erred?e(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):this._errorHandlers.push(e),this}},reqwest.serializeArray=function(){var e=[];return eachFormElement.apply(function(t,n){e.push({name:t,value:n})},arguments),e},reqwest.serialize=function(){if(arguments.length===0)return"";var e,t,n=Array.prototype.slice.call(arguments,0);return e=n.pop(),e&&e.nodeType&&n.push(e)&&(e=null),e&&(e=e.type),e=="map"?t=serializeHash:e=="array"?t=reqwest.serializeArray:t=serializeQueryString,t.apply(null,n)},reqwest.toQueryString=function(e){var t="",n,r=encodeURIComponent,i=function(e,n){t+=r(e)+"="+r(n)+"&"},s,o;if(isArray(e))for(n=0;e&&n<e.length;n++)i(e[n].name,e[n].value);else for(s in e){if(!Object.hasOwnProperty.call(e,s))continue;o=e[s];if(isArray(o))for(n=0;n<o.length;n++)i(s,o[n]);else i(s,e[s])}return t.replace(/&$/,"").replace(/%20/g,"+")},reqwest.getcallbackPrefix=function(){return callbackPrefix},reqwest.compat=function(e,t){return e&&(e.type&&(e.method=e.type)&&delete e.type,e.dataType&&(e.type=e.dataType),e.jsonpCallback&&(e.jsonpCallbackName=e.jsonpCallback)&&delete e.jsonpCallback,e.jsonp&&(e.jsonpCallback=e.jsonp)),new Reqwest(e,t)},reqwest}),wax=wax||{},wax.attribution=function(){var e={},t=document.createElement("div");return t.className="map-attribution",e.content=function(e){return typeof e=="undefined"?t.innerHTML:(t.innerHTML=wax.u.sanitize(e),this)},e.element=function(){return t},e.init=function(){return this},e},wax=wax||{},wax.bwdetect=function(e,t){function n(){wax.bw=-1;var e=new Image;e.src=o;var t=!0,n=setTimeout(function(){t&&wax.bw==-1&&(r.bw(0),t=!1)},s);e.onload=function(){t&&wax.bw==-1&&(clearTimeout(n),r.bw(1),t=!1)}}var r={},s=e.threshold||400,o="http://a.tiles.mapbox.com/mapbox/1.0.0/blue-marble-topo-bathy-jul/0/0/0.png?preventcache="+ +(new Date),u=1,a=e.auto===undefined?!0:e.auto;return r.bw=function(e){if(!arguments.length)return u;var n=u;wax.bwlisteners&&wax.bwlisteners.length&&function(){listeners=wax.bwlisteners,wax.bwlisteners=[];for(i=0;i<listeners;i++)listeners[i](e)}(),wax.bw=e,u!=(u=e)&&t(e)},r.add=function(){return a&&n(),this},wax.bw==-1?(wax.bwlisteners=wax.bwlisteners||[],wax.bwlisteners.push(r.bw)):wax.bw!==undefined?r.bw(wax.bw):r.add(),r},wax.formatter=function(x){var formatter={},f;if(x&&typeof x=="string")try{eval("f = "+x)}catch(e){console&&console.log(e)}else x&&typeof x=="function"?f=x:f=function(){};return formatter.format=function(e,t){try{return wax.u.sanitize(f(e,t))}catch(n){console&&console.log(n)}},formatter},wax.gi=function(e,t){function n(e){return e>=93&&e--,e>=35&&e--,e-=32,e}t=t||{};var r={},i=t.resolution||4,s=t.tileSize||256;return r.grid_tile=function(){return e},r.getKey=function(t,r){if(!e||!e.grid)return;if(r<0||t<0)return;if(Math.floor(r)>=s||Math.floor(t)>=s)return;return n(e.grid[Math.floor(r/i)].charCodeAt(Math.floor(t/i)))},r.gridFeature=function(t,n){var r=this.getKey(t,n),i=e.keys;if(i&&i[r]&&e.data[i[r]])return e.data[i[r]]},r.tileFeature=function(t,n,r){if(!e)return;var i=wax.u.offset(r);return feature=this.gridFeature(t-i.left,n-i.top),feature},r},wax.gm=function(){function e(e){return typeof e=="string"&&(e=[e]),function(t){if(!t)return;var n=new RegExp(r.tileRegexp()),i=n.exec(t);if(!i)return;return e[parseInt(i[2],10)%e.length].replace(/\{z\}/g,i[1]).replace(/\{x\}/g,i[2]).replace(/\{y\}/g,i[3])}}var t=4,n={},r={},i,s,o=function(e){if(e)return e.replace(/(\.png|\.jpg|\.jpeg)(\d*)/,".grid.json")};return r.tileRegexp=function(){var e=i.tiles[0],t=e.indexOf("?");t!==-1&&(e=e.substr(0,t)),e=e.replace(/[\(\)\?\$\*\+\^]/g,"."),e.indexOf("https")===0?e=e.replace(":443","[:0-9]*"):e.indexOf("http")===0&&(e=e.replace(":80","[:0-9]*"));var n="";if(i.tiles.length>1){var r=i.tiles[0],s=i.tiles[1];for(var o=0;o<r.length;++o)r.charAt(o)!=s.charAt(o)?n+=".":n+=e.charAt(o)||""}else n=e;return n.replace(/\{x\}/,"(\\d+)").replace(/\{y\}/,"(\\d+)").replace(/\{z\}/,"(\\d+)")},r.formatter=function(e){return arguments.length?(s=wax.formatter(e),r):s},r.template=function(e){return arguments.length?(s=wax.template(e),r):s},r.gridUrl=function(t){return arguments.length?(t?o=typeof t=="function"?t:e(t):o=function(){return null},r):o},r.getGrid=function(e,n){var i=o(e);return!s||!i?n(null,null):(wax.request.get(i,function(e,r){if(e)return n(e,null);n(null,wax.gi(r,{formatter:s,resolution:t}))}),r)},r.tilejson=function(e){return arguments.length?(e.template?r.template(e.template):e.formatter?r.formatter(e.formatter):s=undefined,r.gridUrl(e.grids),e.resolution&&(t=e.resolution),i=e,r):i},r},wax=wax||{},wax.hash=function(e){function t(){return location.hash.substring(1)}function n(e){var t=window.location;t.replace(t.toString().replace(t.hash||/$/,"#"+e))}function r(t){var n=t.split("/");for(var r=0;r<n.length;r++){n[r]=Number(n[r]);if(isNaN(n[r]))return!0}if(n.length<3)return!0;n.length==3&&e.setCenterZoom(n)}function i(){var t=e.getCenterZoom();o!==t&&(o=t,n(o))}function s(e){if(e===o)return;r(o=e)&&i()}e=e||{};var o,u={},a=90-1e-8,f=wax.u.throttle(i,500);return u.add=function(){return s(t()),e.bindChange(f),u},u.remove=function(){return e.unbindChange(f),u},u},wax=wax||{},wax.interaction=function(){function e(e){var t=p(),n=new RegExp(u.tileRegexp());for(var r=0;r<t.length;r++)if(e){var i=t[r][0]<=e.y&&t[r][0]+256>e.y&&t[r][1]<=e.x&&t[r][1]+256>e.x;if(i&&n.exec(t[r][2].src))return t[r][2]}return!1}function t(){return l?(window.clearTimeout(l),l=null,!0):!1}function n(e){if(f)return;var t=e.type!="MSPointerMove"?e:e.originalEvent,n=wax.u.eventoffset(t);a.screen_feature(n,function(t){t?bean.fire(a,"on",{parent:m(),data:t,formatter:u.formatter().format,e:e}):bean.fire(a,"off")})}function r(e){f=!0;var t=e.type!="MSPointerDown"?e:e.originalEvent;c=wax.u.eventoffset(t),e.type==="mousedown"?(bean.add(document.body,"click",o),bean.add(document.body,"mouseup",i)):e.type==="touchstart"&&e.touches.length===1?(bean.fire(a,"off"),bean.add(m(),w)):e.originalEvent.type==="MSPointerDown"&&e.originalEvent.touches.length===1&&(bean.fire(a,"off"),bean.add(m(),E))}function i(){f=!1}function s(){bean.remove(m(),w),bean.remove(m(),E),f=!1}function o(e){var n={},r=e.type!="MSPointerMove"&&e.type!="MSPointerUp"?e:e.originalEvent,i=wax.u.eventoffset(r);f=!1;for(var s in r)n[s]=r[s];return n.changedTouches=[],bean.remove(document.body,"mouseup",o),bean.remove(m(),w),bean.remove(m(),E),e.type==="touchend"?a.click(e,c):n.type==="MSPointerMove"||n.type==="MSPointerUp"?a.click(n,i):Math.round(i.y/h)===Math.round(c.y/h)&&Math.round(i.x/h)===Math.round(c.x/h)&&(l?t():l=window.setTimeout(function(){l=null,a.click(n,i)},150)),o}var u=wax.gm(),a={},f=!1,l=null,c,h=4,p,d,v,m,g,y,b={mousemove:n,touchstart:r,mousedown:r},w={touchend:o,touchmove:o,touchcancel:s},E={MSPointerUp:o,MSPointerMove:o,MSPointerCancel:s};return a.click=function(e,t){a.screen_feature(t,function(t){t&&bean.fire(a,"on",{parent:m(),data:t,formatter:u.formatter().format,e:e})})},a.screen_feature=function(t,n){var r=e(t);r||n(null),u.getGrid(r.src,function(e,i){if(e||!i)return n(null);var s=i.tileFeature(t.x,t.y,r);n(s)})},a.attach=function(e){return arguments.length?(d=e,a):d},a.detach=function(e){return arguments.length?(v=e,a):v},a.map=function(e){return arguments.length?(g=e,d&&d(g),bean.add(m(),b),bean.add(m(),"touchstart",r),bean.add(m(),"MSPointerDown",r),a):g},a.grid=function(e){return arguments.length?(p=e,a):p},a.remove=function(e){return v&&v(g),bean.remove(m(),b),bean.fire(a,"remove"),a},a.tilejson=function(e){return arguments.length?(u.tilejson(e),a):u.tilejson()},a.formatter=function(){return u.formatter()},a.on=function(e,t){return bean.add(a,e,t),a},a.off=function(e,t){return bean.remove(a,e,t),a},a.gridmanager=function(e){return arguments.length?(u=e,a):u},a.parent=function(e){return m=e,a},a};var wax=wax||{};wax.location=function(){function e(e){if(e.e.type==="mousemove"||!e.e.type)return;var t=e.formatter({format:"location"},e.data);t&&(window.location.href=t)}var t={};return t.events=function(){return{on:e}},t};var wax=wax||{};wax.request={cache:{},locks:{},promises:{},get:function(e,t){if(this.cache[e])return t(this.cache[e][0],this.cache[e][1]);this.promises[e]=this.promises[e]||[],this.promises[e].push(t);if(this.locks[e])return;var n=this;this.locks[e]=!0,reqwest({url:e+(~e.indexOf("?")?"&":"?")+"callback=grid",type:"jsonp",jsonpCallback:"callback",success:function(t){n.locks[e]=!1,n.cache[e]=[null,t];for(var r=0;r<n.promises[e].length;r++)n.promises[e][r](n.cache[e][0],n.cache[e][1])},error:function(t){n.locks[e]=!1,n.cache[e]=[t,null];for(var r=0;r<n.promises[e].length;r++)n.promises[e][r](n.cache[e][0],n.cache[e][1])}})}},wax.template=function(e){var t={};return t.format=function(t,n){var r={};for(var i in n)r[i]=n[i];return t.format&&(r["__"+t.format+"__"]=!0),wax.u.sanitize(Mustache.to_html(e,r))},t};if(!wax)var wax={};wax.tilejson=function(e,t){reqwest({url:e+(~e.indexOf("?")?"&":"?")+"callback=grid",type:"jsonp",jsonpCallback:"callback",success:t,error:t})};var wax=wax||{};wax.u={offset:function(e){var t=e.offsetWidth||parseInt(e.style.width,10),n=e.offsetHeight||parseInt(e.style.height,10),r=document.body,i=0,s=0,o=function(e){if(e===r||e===document.documentElement)return;i+=e.offsetTop,s+=e.offsetLeft;var t=e.style.transform||e.style.WebkitTransform||e.style.OTransform||e.style.MozTransform||e.style.msTransform;if(t){var n;if(n=t.match(/translate\((.+)px, (.+)px\)/))i+=parseInt(n[2],10),s+=parseInt(n[1],10);else if(n=t.match(/translate3d\((.+)px, (.+)px, (.+)px\)/))i+=parseInt(n[2],10),s+=parseInt(n[1],10);else if(n=t.match(/matrix3d\(([\-\d,\s]+)\)/)){var o=n[1].split(",");i+=parseInt(o[13],10),s+=parseInt(o[12],10)}else if(n=t.match(/matrix\(.+, .+, .+, .+, (.+), (.+)\)/))i+=parseInt(n[2],10),s+=parseInt(n[1],10)}};if(typeof e.getBoundingClientRect!="undefined"){var u=document.body,a=e.ownerDocument.documentElement,f=document.clientTop||u.clientTop||0,l=document.clientLeft||u.clientLeft||0,c=window.pageYOffset||a.scrollTop,h=window.pageXOffset||a.scrollLeft,p=e.getBoundingClientRect();i=p.top+c-f,s=p.left+h-l}else{o(e);try{while(e=e.offsetParent)o(e)}catch(d){}}i+=r.offsetTop,s+=r.offsetLeft,i+=r.parentNode.offsetTop,s+=r.parentNode.offsetLeft;var v=document.defaultView?window.getComputedStyle(r.parentNode,null):r.parentNode.currentStyle;return r.parentNode.offsetTop!==parseInt(v.marginTop,10)&&!isNaN(parseInt(v.marginTop,10))&&(i+=parseInt(v.marginTop,10),s+=parseInt(v.marginLeft,10)),{top:i,left:s,height:n,width:t}},$:function(e){return typeof e=="string"?document.getElementById(e):e},eventoffset:function(e){var t=0,n=0;e||(e=window.event);if(e.type=="MSPointerMove"||e.type=="MSPointerDown"||e.type=="MSPointerUp")return{x:e.pageX+window.pageXOffset,y:e.pageY+window.pageYOffset};if(e.pageX||e.pageY)return{x:e.pageX,y:e.pageY};if(e.clientX||e.clientY)return{x:e.clientX,y:e.clientY};if(e.touches&&e.touches.length===1)return{x:e.touches[0].pageX,y:e.touches[0].pageY}},limit:function(e,t,n){var r;return function(){var i=this,s=arguments,o=function(){r=null,e.apply(i,s)};n&&clearTimeout(r);if(n||!r)r=setTimeout(o,t)}},throttle:function(e,t){return this.limit(e,t,!1)},sanitize:function(e){function t(e){if(/^(https?:\/\/|data:image)/.test(e))return e}function n(e){return e}return e?html_sanitize(e,t,n):""}},wax=wax||{},wax.leaf=wax.leaf||{},wax.leaf.hash=function(e){return wax.hash({getCenterZoom:function(){var t=e.getCenter(),n=e.getZoom(),r=Math.max(0,Math.ceil(Math.log(n)/Math.LN2));return[n,t.lat.toFixed(r),t.lng.toFixed(r)].join("/")},setCenterZoom:function(t){e.setView(new L.LatLng(t[1],t[2]),t[0])},bindChange:function(t){e.on("moveend",t)},unbindChange:function(t){e.off("moveend",t)}})},wax=wax||{},wax.leaf=wax.leaf||{},wax.leaf.interaction=function(){function e(){i=!0}function t(){return!i&&s?s:s=function(e){var t=[];for(var n in e)if(e[n]._tiles)for(var r in e[n]._tiles){var i=e[n]._tiles[r];if(i.src){var s=wax.u.offset(i);t.push([s.top,s.left,i])}}return t}(o._layers)}function n(t){if(!arguments.length)return o;o=t;var n=["moveend"];for(var r=0;r<n.length;r++)o.on(n[r],e)}function r(t){if(!arguments.length)return o;o=t;var n=["moveend"];for(var r=0;r<n.length;r++)o.off(n[r],e)}var i=!1,s,o;return wax.interaction().attach(n).detach(r).parent(function(){return o._container}).grid(t)},wax=wax||{},wax.leaf=wax.leaf||{},wax.leaf.connector=L.TileLayer.extend({initialize:function(e){e=e||{},e.minZoom=e.minzoom||0,e.maxZoom=e.maxzoom||22,L.TileLayer.prototype.initialize.call(this,e.tiles[0],e)}}),wax=wax||{},wax.g=wax.g||{},wax.g.attribution=function(e,t){t=t||{};var n,r={};return r.element=function(){return n.element()},r.appendTo=function(e){return wax.u.$(e).appendChild(n.element()),this},r.init=function(){return n=wax.attribution(),n.content(t.attribution),n.element().className="map-attribution map-g",this},r.init()},wax=wax||{},wax.g=wax.g||{},wax.g.bwdetect=function(e,t){t=t||{};var n=t.png||".png128",r=t.jpg||".jpg70";if(!e.mapTypes["mb-low"]){var i=e.mapTypes.mb,s={tiles:[],scheme:i.options.scheme,blankImage:i.options.blankImage,minzoom:i.minZoom,maxzoom:i.maxZoom,name:i.name,description:i.description};for(var o=0;o<i.options.tiles.length;o++)s.tiles.push(i.options.tiles[o].replace(".png",n).replace(".jpg",r));m.mapTypes.set("mb-low",new wax.g.connector(s))}return wax.bwdetect(t,function(t){e.setMapTypeId(t?"mb":"mb-low")})},wax=wax||{},wax.g=wax.g||{},wax.g.hash=function(e){return wax.hash({getCenterZoom:function(){var t=e.getCenter(),n=e.getZoom(),r=Math.max(0,Math.ceil(Math.log(n)/Math.LN2));return[n.toFixed(2),t.lat().toFixed(r),t.lng().toFixed(r)].join("/")},setCenterZoom:function(t){e.setCenter(new google.maps.LatLng(t[1],t[2])),e.setZoom(t[0])},bindChange:function(t){google.maps.event.addListener(e,"idle",t)},unbindChange:function(t){google.maps.event.removeListener(e,"idle",t)}})},wax=wax||{},wax.g=wax.g||{},wax.g.interaction=function(){function e(){i=!0}function t(){if(!i&&s)return s;s=[];var e=o.getZoom(),t=wax.u.offset(o.getDiv()),n=function(t){if(!t.interactive)return;for(var n in t.cache){if(n.split("/")[0]!=e)continue;var r=wax.u.offset(t.cache[n]);s.push([r.top,r.left,t.cache[n]])}};for(var r in o.mapTypes)n(o.mapTypes[r]);return o.overlayMapTypes.forEach(n),s}function n(t){if(!arguments.length)return o;o=t,u=google.maps.event.addListener(o,"tileloaded",e),a=google.maps.event.addListener(o,"idle",e)}function r(e){u&&google.maps.event.removeListener(u),a&&google.maps.event.removeListener(a)}var i=!1,s,o,u=null,a=null;return wax.interaction().attach(n).detach(r).parent(function(){return o.getDiv()}).grid(t)};var wax=wax||{};wax.g=wax.g||{},wax.g.connector=function(e){e=e||{},this.options={tiles:e.tiles,scheme:e.scheme||"xyz",blankImage:e.blankImage||"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},this.opacity=e.opacity||0,this.minZoom=e.minzoom||0,this.maxZoom=e.maxzoom||22,this.name=e.name||"",this.description=e.description||"",this.interactive=!0,this.tileSize=new google.maps.Size(256,256),this.cache={}},wax.g.connector.prototype.getTile=function(e,t,n){var r=t+"/"+e.x+"/"+e.y;if(!this.cache[r]){var i=this.cache[r]=new Image(256,256);this.cache[r].src=this.getTileUrl(e,t),this.cache[r].setAttribute("gTileKey",r),this.cache[r].setAttribute("style","opacity: "+this.opacity+"; filter: alpha(opacity="+this.opacity*100+");"),this.cache[r].onerror=function(){i.style.display="none"}}return this.cache[r]},wax.g.connector.prototype.releaseTile=function(e){var t=e.getAttribute("gTileKey");this.cache[t]&&delete this.cache[t],e.parentNode&&e.parentNode.removeChild(e)},wax.g.connector.prototype.getTileUrl=function(e,t){var n=Math.pow(2,t),r=this.options.scheme==="tms"?n-1-e.y:e.y,i=e.x%n;return i=i<0?e.x%n+n:i,r<0?this.options.blankImage:this.options.tiles[parseInt(i+r,10)%this.options.tiles.length].replace(/\{z\}/g,t).replace(/\{x\}/g,i).replace(/\{y\}/g,r)};var GeoJSON=function(e,t){var n=function(e,t,s){var o;switch(e.type){case"Point":t.position=new google.maps.LatLng(e.coordinates[1],e.coordinates[0]),o=new google.maps.Marker(t),s&&o.set("geojsonProperties",s);break;case"MultiPoint":o=[];for(var u=0;u<e.coordinates.length;u++)t.position=new google.maps.LatLng(e.coordinates[u][1],e.coordinates[u][0]),o.push(new google.maps.Marker(t));if(s)for(var a=0;a<o.length;a++)o[a].set("geojsonProperties",s);break;case"LineString":var f=[];for(var u=0;u<e.coordinates.length;u++){var l=e.coordinates[u],c=new google.maps.LatLng(l[1],l[0]);f.push(c)}t.path=f,o=new google.maps.Polyline(t),s&&o.set("geojsonProperties",s);break;case"MultiLineString":o=[];for(var u=0;u<e.coordinates.length;u++){var f=[];for(var h=0;h<e.coordinates[u].length;h++){var l=e.coordinates[u][h],c=new google.maps.LatLng(l[1],l[0]);f.push(c)}t.path=f,o.push(new google.maps.Polyline(t))}if(s)for(var a=0;a<o.length;a++)o[a].set("geojsonProperties",s);break;case"Polygon":var p=[],d,v;for(var u=0;u<e.coordinates.length;u++){var f=[];for(var h=0;h<e.coordinates[u].length;h++){var c=new google.maps.LatLng(e.coordinates[u][h][1],e.coordinates[u][h][0]);f.push(c)}u?u==1?(v=i(f),d==v?p.push(f.reverse()):p.push(f)):d==v?p.push(f.reverse()):p.push(f):(d=i(f),p.push(f))}t.paths=p,o=new google.maps.Polygon(t),s&&o.set("geojsonProperties",s);break;case"MultiPolygon":o=[];for(var u=0;u<e.coordinates.length;u++){var p=[],d,v;for(var h=0;h<e.coordinates[u].length;h++){var f=[];for(var a=0;a<e.coordinates[u][h].length-1;a++){var c=new google.maps.LatLng(e.coordinates[u][h][a][1],e.coordinates[u][h][a][0]);f.push(c)}h?h==1?(v=i(f),d==v?p.push(f.reverse()):p.push(f)):d==v?p.push(f.reverse()):p.push(f):(d=i(f),p.push(f))}t.paths=p,o.push(new google.maps.Polygon(t))}if(s)for(var a=0;a<o.length;a++)o[a].set("geojsonProperties",s);break;case"GeometryCollection":o=[];if(!e.geometries)o=r('Invalid GeoJSON object: GeometryCollection object missing "geometries" member.');else for(var u=0;u<e.geometries.length;u++)o.push(n(e.geometries[u],t,s||null));break;default:o=r('Invalid GeoJSON object: Geometry object must be one of "Point", "LineString", "Polygon" or "MultiPolygon".')}return o},r=function(e){return{type:"Error",message:e}},i=function(e){var t,n=0;for(var r=0;r<e.length-2;r++)n+=(e[r+1].lat()-e[r].lat())*(e[r+2].lng()-e[r].lng())-(e[r+2].lat()-e[r].lat())*(e[r+1].lng()-e[r].lng());return n>0?t=!0:t=!1,t},s,o=t||{};switch(e.type){case"FeatureCollection":if(!e.features)s=r('Invalid GeoJSON object: FeatureCollection object missing "features" member.');else{s=[];for(var u=0;u<e.features.length;u++)s.push(n(e.features[u].geometry,o,e.features[u].properties))}break;case"GeometryCollection":if(!e.geometries)s=r('Invalid GeoJSON object: GeometryCollection object missing "geometries" member.');else{s=[];for(var u=0;u<e.geometries.length;u++)s.push(n(e.geometries[u],o))}break;case"Feature":!e.properties||!e.geometry?s=r('Invalid GeoJSON object: Feature object missing "properties" or "geometry" member.'):s=n(e.geometry,o,e.properties);break;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":s=e.coordinates?s=n(e,o):r('Invalid GeoJSON object: Geometry object missing "coordinates" member.');break;default:s=r('Invalid GeoJSON object: GeoJSON object must be one of "Point", "LineString", "Polygon", "MultiPolygon", "Feature", "FeatureCollection" or "GeometryCollection".')}return s};(function(e,t,n){e.fn.jScrollPane=function(r){function i(r,i){function s(t){var i,u,f,c,h,p,m=!1,g=!1;R=t;if(z===n)h=r.scrollTop(),p=r.scrollLeft(),r.css({overflow:"hidden",padding:0}),W=r.innerWidth()+wt,X=r.innerHeight(),r.width(W),z=e('<div class="jspPane" />').css("padding",bt).append(r.children()),V=e('<div class="jspContainer" />').css({width:W+"px",height:X+"px"}).append(z).appendTo(r);else{r.css("width",""),m=R.stickToBottom&&L(),g=R.stickToRight&&A(),c=r.innerWidth()+wt!=W||r.outerHeight()!=X,c&&(W=r.innerWidth()+wt,X=r.innerHeight(),V.css({width:W+"px",height:X+"px"}));if(!c&&Et==$&&z.outerHeight()==J){r.width(W);return}Et=$,z.css("width",""),r.width(W),V.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}z.css("overflow","auto"),t.contentWidth?$=t.contentWidth:$=z[0].scrollWidth,J=z[0].scrollHeight,z.css("overflow",""),K=$/W,Q=J/X,G=Q>1,Y=K>1,!Y&&!G?(r.removeClass("jspScrollable"),z.css({top:0,width:V.width()-wt}),M(),P(),B(),v()):(r.addClass("jspScrollable"),i=R.maintainPosition&&(tt||it),i&&(u=C(),f=k()),o(),a(),l(),i&&(T(g?$-W:u,!1),x(m?J-X:f,!1)),D(),O(),I(),R.enableKeyboardNavigation&&H(),R.clickOnTrack&&d(),j(),R.hijackInternalLinks&&F()),R.autoReinitialise&&!yt?yt=setInterval(function(){s(R)},R.autoReinitialiseDelay):!R.autoReinitialise&&yt&&clearInterval(yt),h&&r.scrollTop(0)&&x(h,!1),p&&r.scrollLeft(0)&&T(p,!1),r.trigger("jsp-initialised",[Y||G])}function o(){G&&(V.append(e('<div class="jspVerticalBar" />').append(e('<div class="jspCap jspCapTop" />'),e('<div class="jspTrack" />').append(e('<div class="jspDrag" />').append(e('<div class="jspDragTop" />'),e('<div class="jspDragBottom" />'))),e('<div class="jspCap jspCapBottom" />'))),st=V.find(">.jspVerticalBar"),ot=st.find(">.jspTrack"),Z=ot.find(">.jspDrag"),R.showArrows&&(lt=e('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",h(0,-1)).bind("click.jsp",_),ct=e('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",h(0,1)).bind("click.jsp",_),R.arrowScrollOnHover&&(lt.bind("mouseover.jsp",h(0,-1,lt)),ct.bind("mouseover.jsp",h(0,1,ct))),c(ot,R.verticalArrowPositions,lt,ct)),at=X,V.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){at-=e(this).outerHeight()}),Z.hover(function(){Z.addClass("jspHover")},function(){Z.removeClass("jspHover")}).bind("mousedown.jsp",function(t){e("html").bind("dragstart.jsp selectstart.jsp",_),Z.addClass("jspActive");var n=t.pageY-Z.position().top;return e("html").bind("mousemove.jsp",function(e){g(e.pageY-n,!1)}).bind("mouseup.jsp mouseleave.jsp",m),!1}),u())}function u(){ot.height(at+"px"),tt=0,ut=R.verticalGutter+ot.outerWidth(),z.width(W-ut-wt);try{st.position().left===0&&z.css("margin-left",ut+"px")}catch(e){}}function a(){Y&&(V.append(e('<div class="jspHorizontalBar" />').append(e('<div class="jspCap jspCapLeft" />'),e('<div class="jspTrack" />').append(e('<div class="jspDrag" />').append(e('<div class="jspDragLeft" />'),e('<div class="jspDragRight" />'))),e('<div class="jspCap jspCapRight" />'))),ht=V.find(">.jspHorizontalBar"),pt=ht.find(">.jspTrack"),nt=pt.find(">.jspDrag"),R.showArrows&&(mt=e('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",h(-1,0)).bind("click.jsp",_),gt=e('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",h(1,0)).bind("click.jsp",_),R.arrowScrollOnHover&&(mt.bind("mouseover.jsp",h(-1,0,mt)),gt.bind("mouseover.jsp",h(1,0,gt))),c(pt,R.horizontalArrowPositions,mt,gt)),nt.hover(function(){nt.addClass("jspHover")},function(){nt.removeClass("jspHover")}).bind("mousedown.jsp",function(t){e("html").bind("dragstart.jsp selectstart.jsp",_),nt.addClass("jspActive");var n=t.pageX-nt.position().left;return e("html").bind("mousemove.jsp",function(e){b(e.pageX-n,!1)}).bind("mouseup.jsp mouseleave.jsp",m),!1}),dt=V.innerWidth(),f())}function f(){V.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){dt-=e(this).outerWidth()}),pt.width(dt+"px"),it=0}function l(){if(Y&&G){var t=pt.outerHeight(),n=ot.outerWidth();at-=t,e(ht).find(">.jspCap:visible,>.jspArrow").each(function(){dt+=e(this).outerWidth()}),dt-=n,X-=n,W-=t,pt.parent().append(e('<div class="jspCorner" />').css("width",t+"px")),u(),f()}Y&&z.width(V.outerWidth()-wt+"px"),J=z.outerHeight(),Q=J/X,Y&&(vt=Math.ceil(1/K*dt),vt>R.horizontalDragMaxWidth?vt=R.horizontalDragMaxWidth:vt<R.horizontalDragMinWidth&&(vt=R.horizontalDragMinWidth),nt.width(vt+"px"),rt=dt-vt,w(it)),G&&(ft=Math.ceil(1/Q*at),ft>R.verticalDragMaxHeight?ft=R.verticalDragMaxHeight:ft<R.verticalDragMinHeight&&(ft=R.verticalDragMinHeight),Z.height(ft+"px"),et=at-ft,y(tt))}function c(e,t,n,r){var i="before",s="after",o;t=="os"&&(t=/Mac/.test(navigator.platform)?"after":"split"),t==i?s=t:t==s&&(i=t,o=n,n=r,r=o),e[i](n)[s](r)}function h(e,t,n){return function(){return p(e,t,this,n),this.blur(),!1}}function p(t,n,r,i){r=e(r).addClass("jspActive");var s,o,u=!0,a=function(){t!==0&&U.scrollByX(t*R.arrowButtonSpeed),n!==0&&U.scrollByY(n*R.arrowButtonSpeed),o=setTimeout(a,u?R.initialDelay:R.arrowRepeatFreq),u=!1};a(),s=i?"mouseout.jsp":"mouseup.jsp",i=i||e("html"),i.bind(s,function(){r.removeClass("jspActive"),o&&clearTimeout(o),o=null,i.unbind(s)})}function d(){v(),G&&ot.bind("mousedown.jsp",function(t){if(t.originalTarget===n||t.originalTarget==t.currentTarget){var r=e(this),i=r.offset(),s=t.pageY-i.top-tt,o,u=!0,a=function(){var e=r.offset(),n=t.pageY-e.top-ft/2,i=X*R.scrollPagePercent,l=et*i/(J-X);if(s<0)tt-l>n?U.scrollByY(-i):g(n);else{if(!(s>0)){f();return}tt+l<n?U.scrollByY(i):g(n)}o=setTimeout(a,u?R.initialDelay:R.trackClickRepeatFreq),u=!1},f=function(){o&&clearTimeout(o),o=null,e(document).unbind("mouseup.jsp",f)};return a(),e(document).bind("mouseup.jsp",f),!1}}),Y&&pt.bind("mousedown.jsp",function(t){if(t.originalTarget===n||t.originalTarget==t.currentTarget){var r=e(this),i=r.offset(),s=t.pageX-i.left-it,o,u=!0,a=function(){var e=r.offset(),n=t.pageX-e.left-vt/2,i=W*R.scrollPagePercent,l=rt*i/($-W);if(s<0)it-l>n?U.scrollByX(-i):b(n);else{if(!(s>0)){f();return}it+l<n?U.scrollByX(i):b(n)}o=setTimeout(a,u?R.initialDelay:R.trackClickRepeatFreq),u=!1},f=function(){o&&clearTimeout(o),o=null,e(document).unbind("mouseup.jsp",f)};return a(),e(document).bind("mouseup.jsp",f),!1}})}function v(){pt&&pt.unbind("mousedown.jsp"),ot&&ot.unbind("mousedown.jsp")}function m(){e("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp"),Z&&Z.removeClass("jspActive"),nt&&nt.removeClass("jspActive")}function g(e,t){if(!G)return;e<0?e=0:e>et&&(e=et),t===n&&(t=R.animateScroll),t?U.animate(Z,"top",e,y):(Z.css("top",e),y(e))}function y(e){e===n&&(e=Z.position().top),V.scrollTop(0),tt=e;var t=tt===0,i=tt==et,s=e/et,o=-s*(J-X);if(St!=t||Tt!=i)St=t,Tt=i,r.trigger("jsp-arrow-change",[St,Tt,xt,Nt]);E(t,i),z.css("top",o),r.trigger("jsp-scroll-y",[-o,t,i]).trigger("scroll")}function b(e,t){if(!Y)return;e<0?e=0:e>rt&&(e=rt),t===n&&(t=R.animateScroll),t?U.animate(nt,"left",e,w):(nt.css("left",e),w(e))}function w(e){e===n&&(e=nt.position().left),V.scrollTop(0),it=e;var t=it===0,i=it==rt,s=e/rt,o=-s*($-W);if(xt!=t||Nt!=i)xt=t,Nt=i,r.trigger("jsp-arrow-change",[St,Tt,xt,Nt]);S(t,i),z.css("left",o),r.trigger("jsp-scroll-x",[-o,t,i]).trigger("scroll")}function E(e,t){R.showArrows&&(lt[e?"addClass":"removeClass"]("jspDisabled"),ct[t?"addClass":"removeClass"]("jspDisabled"))}function S(e,t){R.showArrows&&(mt[e?"addClass":"removeClass"]("jspDisabled"),gt[t?"addClass":"removeClass"]("jspDisabled"))}function x(e,t){var n=e/(J-X);g(n*et,t)}function T(e,t){var n=e/($-W);b(n*rt,t)}function N(t,n,r){var i,s,o,u=0,a=0,f,l,c,h,p,d;try{i=e(t)}catch(v){return}s=i.outerHeight(),o=i.outerWidth(),V.scrollTop(0),V.scrollLeft(0);while(!i.is(".jspPane")){u+=i.position().top,a+=i.position().left,i=i.offsetParent();if(/^body|html$/i.test(i[0].nodeName))return}f=k(),c=f+X,u<f||n?p=u-R.verticalGutter:u+s>c&&(p=u-X+s+R.verticalGutter),p&&x(p,r),l=C(),h=l+W,a<l||n?d=a-R.horizontalGutter:a+o>h&&(d=a-W+o+R.horizontalGutter),d&&T(d,r)}function C(){return-z.position().left}function k(){return-z.position().top}function L(){var e=J-X;return e>20&&e-k()<10}function A(){var e=$-W;return e>20&&e-C()<10}function O(){V.unbind(kt).bind(kt,function(e,t,n,r){var i=it,s=tt;return U.scrollBy(n*R.mouseWheelSpeed,-r*R.mouseWheelSpeed,!1),i==it&&s==tt})}function M(){V.unbind(kt)}function _(){return!1}function D(){z.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(e){N(e.target,!1)})}function P(){z.find(":input,a").unbind("focus.jsp")}function H(){function t(){var e=it,t=tt;switch(n){case 40:U.scrollByY(R.keyboardSpeed,!1);break;case 38:U.scrollByY(-R.keyboardSpeed,!1);break;case 34:case 32:U.scrollByY(X*R.scrollPagePercent,!1);break;case 33:U.scrollByY(-X*R.scrollPagePercent,!1);break;case 39:U.scrollByX(R.keyboardSpeed,!1);break;case 37:U.scrollByX(-R.keyboardSpeed,!1)}return i=e!=it||t!=tt,i}var n,i,s=[];Y&&s.push(ht[0]),G&&s.push(st[0]),z.focus(function(){r.focus()}),r.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(r){if(r.target!==this&&(!s.length||!e(r.target).closest(s).length))return;var o=it,u=tt;switch(r.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:n=r.keyCode,t();break;case 35:x(J-X),n=null;break;case 36:x(0),n=null}return i=r.keyCode==n&&o!=it||u!=tt,!i}).bind("keypress.jsp",function(e){return e.keyCode==n&&t(),!i}),R.hideFocus?(r.css("outline","none"),"hideFocus"in V[0]&&r.attr("hideFocus",!0)):(r.css("outline",""),"hideFocus"in V[0]&&r.attr("hideFocus",!1))}function B(){r.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp")}function j(){if(location.hash&&location.hash.length>1){var t,n,r=escape(location.hash.substr(1));try{t=e("#"+r+', a[name="'+r+'"]')}catch(i){return}t.length&&z.find(r)&&(V.scrollTop()===0?n=setInterval(function(){V.scrollTop()>0&&(N(t,!0),e(document).scrollTop(V.position().top),clearInterval(n))},50):(N(t,!0),e(document).scrollTop(V.position().top)))}}function F(){if(e(document.body).data("jspHijack"))return;e(document.body).data("jspHijack",!0),e(document.body).delegate("a[href*=#]","click",function(n){var r=this.href.substr(0,this.href.indexOf("#")),i=location.href,s,o,u,a,f,l;location.href.indexOf("#")!==-1&&(i=location.href.substr(0,location.href.indexOf("#")));if(r!==i)return;s=escape(this.href.substr(this.href.indexOf("#")+1)),o;try{o=e("#"+s+', a[name="'+s+'"]')}catch(c){return}if(!o.length)return;u=o.closest(".jspScrollable"),a=u.data("jsp"),a.scrollToElement(o,!0),u[0].scrollIntoView&&(f=e(t).scrollTop(),l=o.offset().top,(l<f||l>f+e(t).height())&&u[0].scrollIntoView()),n.preventDefault()})}function I(){var e,t,n,r,i,s=!1;V.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(o){var u=o.originalEvent.touches[0];e=C(),t=k(),n=u.pageX,r=u.pageY,i=!1,s=!0}).bind("touchmove.jsp",function(o){if(!s)return;var u=o.originalEvent.touches[0],a=it,f=tt;return U.scrollTo(e+n-u.pageX,t+r-u.pageY),i=i||Math.abs(n-u.pageX)>5||Math.abs(r-u.pageY)>5,a==it&&f==tt}).bind("touchend.jsp",function(e){s=!1}).bind("click.jsp-touchclick",function(e){if(i)return i=!1,!1})}function q(){var e=k(),t=C();r.removeClass("jspScrollable").unbind(".jsp"),r.replaceWith(Ct.append(z.children())),Ct.scrollTop(e),Ct.scrollLeft(t),yt&&clearInterval(yt)}var R,U=this,z,W,X,V,$,J,K,Q,G,Y,Z,et,tt,nt,rt,it,st,ot,ut,at,ft,lt,ct,ht,pt,dt,vt,mt,gt,yt,bt,wt,Et,St=!0,xt=!0,Tt=!1,Nt=!1,Ct=r.clone(!1,!1).empty(),kt=e.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";bt=r.css("paddingTop")+" "+r.css("paddingRight")+" "+r.css("paddingBottom")+" "+r.css("paddingLeft"),wt=(parseInt(r.css("paddingLeft"),10)||0)+(parseInt(r.css("paddingRight"),10)||0),e.extend(U,{reinitialise:function(t){t=e.extend({},R,t),s(t)},scrollToElement:function(e,t,n){N(e,t,n)},scrollTo:function(e,t,n){T(e,n),x(t,n)},scrollToX:function(e,t){T(e,t)},scrollToY:function(e,t){x(e,t)},scrollToPercentX:function(e,t){T(e*($-W),t)},scrollToPercentY:function(e,t){x(e*(J-X),t)},scrollBy:function(e,t,n){U.scrollByX(e,n),U.scrollByY(t,n)},scrollByX:function(e,t){var n=C()+Math[e<0?"floor":"ceil"](e),r=n/($-W);b(r*rt,t)},scrollByY:function(e,t){var n=k()+Math[e<0?"floor":"ceil"](e),r=n/(J-X);g(r*et,t)},positionDragX:function(e,t){b(e,t)},positionDragY:function(e,t){g(e,t)},animate:function(e,t,n,r){var i={};i[t]=n,e.animate(i,{duration:R.animateDuration,easing:R.animateEase,queue:!1,step:r})},getContentPositionX:function(){return C()},getContentPositionY:function(){return k()},getContentWidth:function(){return $},getContentHeight:function(){return J},getPercentScrolledX:function(){return C()/($-W)},getPercentScrolledY:function(){return k()/(J-X)},getIsScrollableH:function(){return Y},getIsScrollableV:function(){return G},getContentPane:function(){return z},scrollToBottom:function(e){g(et,e)},hijackInternalLinks:e.noop,destroy:function(){q()}}),s(i)}return r=e.extend({},e.fn.jScrollPane.defaults,r),e.each(["mouseWheelSpeed","arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){r[this]=r[this]||r.speed}),this.each(function(){var t=e(this),n=t.data("jsp");n?n.reinitialise(r):(e("script",t).filter('[type="text/javascript"],:not([type])').remove(),n=new i(t,r),t.data("jsp",n))})},e.fn.jScrollPane.defaults={showArrows:!1,maintainPosition:!0,stickToBottom:!1,stickToRight:!1,clickOnTrack:!0,autoReinitialise:!1,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:n,animateScroll:!1,animateDuration:300,animateEase:"linear",hijackInternalLinks:!1,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:0,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:!1,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:!0,hideFocus:!1,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8}})(jQuery,this),function(e){function t(t){var n=t||window.event,r=[].slice.call(arguments,1),i=0,s=!0,o=0,u=0;return t=e.event.fix(n),t.type="mousewheel",n.wheelDelta&&(i=n.wheelDelta/120),n.detail&&(i=-n.detail/3),u=i,n.axis!==undefined&&n.axis===n.HORIZONTAL_AXIS&&(u=0,o=-1*i),n.wheelDeltaY!==undefined&&(u=n.wheelDeltaY/120),n.wheelDeltaX!==undefined&&(o=-1*n.wheelDeltaX/120),r.unshift(t,i,o,u),(e.event.dispatch||e.event.handle).apply(this,r)}var n=["DOMMouseScroll","mousewheel"];if(e.event.fixHooks)for(var r=n.length;r;)e.event.fixHooks[n[--r]]=e.event.mouseHooks;e.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var e=n.length;e;)this.addEventListener(n[--e],t,!1);else this.onmousewheel=t},teardown:function(){if(this.removeEventListener)for(var e=n.length;e;)this.removeEventListener(n[--e],t,!1);else this.onmousewheel=null}},e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}(jQuery),function(e){function t(){this===n.elem&&(n.pos=[-260,-260],n.elem=!1,r=3)}var n={pos:[-260,-260]},r=3,i=document,s=i.documentElement,o=i.body,u,a;e.event.special.mwheelIntent={setup:function(){var n=e(this).bind("mousewheel",e.event.special.mwheelIntent.handler);return this!==i&&this!==s&&this!==o&&n.bind("mouseleave",t),n=null,!0},teardown:function(){return e(this).unbind("mousewheel",e.event.special.mwheelIntent.handler).unbind("mouseleave",t),!0},handler:function(t,i){var s=[t.clientX,t.clientY];if(this===n.elem||Math.abs(n.pos[0]-s[0])>r||Math.abs(n.pos[1]-s[1])>r)return n.elem=this,n.pos=s,r=250,clearTimeout(a),a=setTimeout(function(){r=10},200),clearTimeout(u),u=setTimeout(function(){r=3},1500),t=e.extend({},t,{type:"mwheelIntent"}),e.event.handle.apply(this,arguments)}},e.fn.extend({mwheelIntent:function(e){return e?this.bind("mwheelIntent",e):this.trigger("mwheelIntent")},unmwheelIntent:function(e){return this.unbind("mwheelIntent",e)}}),e(function(){o=i.body,e(i).bind("mwheelIntent.mwheelIntentDefault",e.noop)})}(jQuery),function(e,t,n){function r(e,n){var r=t.createElement(e||"div"),i;for(i in n)r[i]=n[i];return r}function i(e){for(var t=1,n=arguments.length;t<n;t++)e.appendChild(arguments[t]);return e}function s(e,t,n,r){var i=["opacity",t,~~(e*100),n,r].join("-"),s=.01+n/r*100,o=Math.max(1-(1-e)/t*(100-s),e),u=h.substring(0,h.indexOf("Animation")).toLowerCase(),a=u&&"-"+u+"-"||"";return c[i]||(p.insertRule("@"+a+"keyframes "+i+"{"+"0%{opacity:"+o+"}"+s+"%{opacity:"+e+"}"+(s+.01)+"%{opacity:1}"+(s+t)%100+"%{opacity:"+e+"}"+"100%{opacity:"+o+"}"+"}",0),c[i]=1),i}function o(e,t){var r=e.style,i,s;if(r[t]!==n)return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(s=0;s<l.length;s++){i=l[s]+t;if(r[i]!==n)return i}}function u(e,t){for(var n in t)e.style[o(e,n)||n]=t[n];return e}function a(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)e[i]===n&&(e[i]=r[i])}return e}function f(e){var t={x:e.offsetLeft,y:e.offsetTop};while(e=e.offsetParent)t.x+=e.offsetLeft,t.y+=e.offsetTop;return t}var l=["webkit","Moz","ms","O"],c={},h,p=function(){var e=r("style");return i(t.getElementsByTagName("head")[0],e),e.sheet||e.styleSheet}(),d={lines:12,length:7,width:5,radius:10,rotate:0,color:"#000",speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto"},v=function m(e){if(!this.spin)return new m(e);this.opts=a(e||{},m.defaults,d)};v.defaults={},a(v.prototype,{spin:function(e){this.stop();var t=this,n=t.opts,i=t.el=u(r(0,{className:n.className}),{position:"relative",zIndex:n.zIndex}),s=n.radius+n.length+n.width,o,a;e&&(e.insertBefore(i,e.firstChild||null),a=f(e),o=f(i),u(i,{left:(n.left=="auto"?a.x-o.x+(e.offsetWidth>>1):n.left+s)+"px",top:(n.top=="auto"?a.y-o.y+(e.offsetHeight>>1):n.top+s)+"px"})),i.setAttribute("aria-role","progressbar"),t.lines(i,t.opts);if(!h){var l=0,c=n.fps,p=c/n.speed,d=(1-n.opacity)/(p*n.trail/100),v=p/n.lines;!function m(){l++;for(var e=n.lines;e;e--){var r=Math.max(1-(l+e*v)%p*d,n.opacity);t.opacity(i,n.lines-e,r,n)}t.timeout=t.el&&setTimeout(m,~~(1e3/c))}()}return t},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=n),this},lines:function(e,t){function n(e,n){return u(r(),{position:"absolute",width:t.length+t.width+"px",height:t.width+"px",background:e,boxShadow:n,transformOrigin:"left",transform:"rotate("+~~(360/t.lines*o+t.rotate)+"deg) translate("+t.radius+"px"+",0)",borderRadius:(t.width>>1)+"px"})}var o=0,a;for(;o<t.lines;o++)a=u(r(),{position:"absolute",top:1+~(t.width/2)+"px",transform:t.hwaccel?"translate3d(0,0,0)":"",opacity:t.opacity,animation:h&&s(t.opacity,t.trail,o,t.lines)+" "+1/t.speed+"s linear infinite"}),t.shadow&&i(a,u(n("#000","0 0 4px #000"),{top:"2px"})),i(e,i(a,n(t.color,"0 0 1px rgba(0,0,0,.1)")));return e},opacity:function(e,t,n){t<e.childNodes.length&&(e.childNodes[t].style.opacity=n)}}),!function(){function e(e,t){return r("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',t)}var t=u(r("group"),{behavior:"url(#default#VML)"});!o(t,"transform")&&t.adj?(p.addRule(".spin-vml","behavior:url(#default#VML)"),v.prototype.lines=function(t,n){function r(){return u(e("group",{coordsize:a+" "+a,coordorigin:-o+" "+ -o}),{width:a,height:a})}function s(t,s,a){i(l,i(u(r(),{rotation:360/n.lines*t+"deg",left:~~s}),i(u(e("roundrect",{arcsize:1}),{width:o,height:n.width,left:n.radius,top:-n.width>>1,filter:a}),e("fill",{color:n.color,opacity:n.opacity}),e("stroke",{opacity:0}))))}var o=n.length+n.width,a=2*o,f=-(n.width+n.length)*2+"px",l=u(r(),{position:"absolute",top:f,left:f}),c;if(n.shadow)for(c=1;c<=n.lines;c++)s(c,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(c=1;c<=n.lines;c++)s(c);return i(t,l)},v.prototype.opacity=function(e,t,n,r){var i=e.firstChild;r=r.shadow&&r.lines||0,i&&t+r<i.childNodes.length&&(i=i.childNodes[t+r],i=i&&i.firstChild,i=i&&i.firstChild,i&&(i.opacity=n))}):h=o(t,"animation")}(),e.Spinner=v}(window,document);var LZMA=function(){function e(e,t){postMessage({action:3,callback_num:t,result:e})}function t(){return eo}function n(){}function r(){return to}function i(){}function s(){return no}function o(){}function u(e,t){return e.detailMessage=t,e}function a(){return ro}function f(){}function l(e,t){return e}function c(){return io}function h(){}function p(e,t){e[e.explicitLength++]=t}function d(e,t){e[e.explicitLength++]=t}function v(e){var t,n;return t=(n=e.join(""),e.length=e.explicitLength=0,n),e[e.explicitLength++]=t,t}function m(e,t){var n=new Array(t);if(e>0){var r=[null,0,!1,[0,0]][e];for(var i=0;i<t;++i)n[i]=r}return n}function g(){return this.arrayClass$}function y(e,t,n,r,i){var s;return s=m(i,r),S(),T(s,Fs,Is),s.arrayClass$=e,s.typeId$=t,s.queryId$=n,s}function b(e,t,n,r){return S(),T(r,Fs,Is),r.arrayClass$=e,r.typeId$=t,r.queryId$=n,r}function w(e,t,n){if(n!=null){if(e.queryId$>0&&!C(n.typeId$,e.queryId$))throw new kt;if(e.queryId$<0&&(n.typeMarker$==ws||n.typeId$==2))throw new kt}return e[t]=n}function E(){}function S(){S=ws,Fs=[],Is=[],x(new E,Fs,Is)}function x(e,t,n){var r=0,i;for(var s in e)if(i=e[s])t[r]=s,n[r]=i,++r}function T(e,t,n){S();for(var r=0,i=t.length;r<i;++r)e[t[r]]=n[r]}function N(e,t){return e&&!!qs[e][t]}function C(e,t){return e&&qs[e][t]}function k(e,t){if(e!=null&&!C(e.typeId$,t))throw new Pt;return e}function L(e,t){return e!=null&&N(e.typeId$,t)}function A(e){return~~Math.max(Math.min(e,2147483647),-2147483648)}function O(e){return e!=null&&N(e.typeId$,2)?e:l(new h,e)}function M(e,t){var n,r;return n=e[1]+t[1],r=e[0]+t[0],H(r,n)}function _(e,t,n){return t==0?e:n==0?e:M(e,H(t*n,0))}function D(e,t){return U(~~Math.max(Math.min(e[1]/4294967296,2147483647),-2147483648)&~~Math.max(Math.min(t[1]/4294967296,2147483647),-2147483648),R(e)&R(t))}function P(e,t){var n,r;return e[0]==t[0]&&e[1]==t[1]?0:(n=e[1]<0,r=t[1]<0,n&&!r?-1:!n&&r?1:Q(e,t)[1]<0?-1:1)}function H(e,t){var n,r;t%=0x10000000000000000,e%=0x10000000000000000,n=t%4294967296,r=Math.floor(e/4294967296)*4294967296,t=t-n+r,e=e-r+n;while(e<0)e+=4294967296,t-=4294967296;while(e>4294967295)e-=4294967296,t+=4294967296;t%=0x10000000000000000;while(t>0x7fffffff00000000)t-=0x10000000000000000;while(t<-0x8000000000000000)t+=0x10000000000000000;return[e,t]}function B(e,t){var n,r,i,s,o,u;if(t[0]==0&&t[1]==0)throw St(new Tt,"/ by zero");if(e[0]==0&&e[1]==0)return tt(),Ks;if(j(e,(tt(),Ws)))return j(t,Vs)||j(t,Xs)?Ws:(s=J(e,1),n=$(B(s,t),1),o=Q(e,z(t,n)),M(n,B(o,t)));if(j(t,Ws))return Ks;if(e[1]<0)return t[1]<0?B(X(e),X(t)):X(B(X(e),t));if(t[1]<0)return X(B(e,X(t)));u=Ks,o=e;while(P(o,t)>=0)i=F(Math.floor(G(o)/Y(t))),i[0]==0&&i[1]==0&&(i=Vs),r=z(i,t),u=M(u,i),o=Q(o,r);return u}function j(e,t){return e[0]==t[0]&&e[1]==t[1]}function F(e){return isNaN(e)?(tt(),Ks):e<-0x8000000000000000?(tt(),Ws):e>=0x8000000000000000?(tt(),zs):e>0?H(Math.floor(e),0):H(Math.ceil(e),0)}function I(e){var t,n;return e>-129&&e<128?(t=e+128,n=(et(),Rs)[t],n==null&&(n=Rs[t]=q(e)),n):q(e)}function q(e){return e>=0?[e,0]:[e+4294967296,-4294967296]}function R(e){return e[0]>=2147483648?~~Math.max(Math.min(e[0]-4294967296,2147483647),-2147483648):~~Math.max(Math.min(e[0],2147483647),-2147483648)}function U(e,t){var n,r;return n=e*4294967296,r=t,t<0&&(r+=4294967296),[r,n]}function z(e,t){var n,r,i,s,o,u,a,f,l;return e[0]==0&&e[1]==0?(tt(),Ks):t[0]==0&&t[1]==0?(tt(),Ks):j(e,(tt(),Ws))?W(t):j(t,Ws)?W(e):e[1]<0?t[1]<0?z(X(e),X(t)):X(z(X(e),t)):t[1]<0?X(z(e,X(t))):P(e,Js)<0&&P(t,Js)<0?H((e[1]+e[0])*(t[1]+t[0]),0):(i=e[1]%281474976710656,s=e[1]-i,n=e[0]%65536,r=e[0]-n,a=t[1]%281474976710656,f=t[1]-a,o=t[0]%65536,u=t[0]-o,l=Ks,l=_(l,s,o),l=_(l,i,u),l=_(l,i,o),l=_(l,r,a),l=_(l,r,u),l=_(l,r,o),l=_(l,n,f),l=_(l,n,a),l=_(l,n,u),l=_(l,n,o),l)}function W(e){return(R(e)&1)==1?(tt(),Ws):(tt(),Ks)}function X(e){var t,n;return j(e,(tt(),Ws))?Ws:(t=-e[1],n=-e[0],n>4294967295&&(n-=4294967296,t+=4294967296),n<0&&(n+=4294967296,t-=4294967296),[n,t])}function V(e){return e<=30?1<<e:V(30)*V(e-30)}function $(e,t){var n,r,i,s;return t&=63,j(e,(tt(),Ws))?t==0?e:Ks:e[1]<0?X($(X(e),t)):(s=V(t),r=e[1]*s%0x10000000000000000,i=e[0]*s,n=i-i%4294967296,r+=n,i-=n,r>=0x8000000000000000&&(r-=0x10000000000000000),[i,r])}function J(e,t){var n,r,i;return t&=63,i=V(t),n=e[1]/i,r=Math.floor(e[0]/i),H(r,n)}function K(e,t){var n;return t&=63,n=J(e,t),e[1]<0&&(n=M(n,$((tt(),$s),63-t))),n}function Q(e,t){var n,r;return n=e[1]-t[1],r=e[0]-t[0],H(r,n)}function G(e){var t,n,r;return n=A(Math.log(e[1])/(tt(),Us)),n<=48?e[1]+e[0]:(t=n-48,r=(1<<t)-1,e[1]+(e[0]-r))}function Y(e){var t,n,r;return n=A(Math.log(e[1])/(tt(),Us)),n<=48?e[1]+e[0]:(t=n-48,r=(1<<t)-1,e[1]+(e[0]+r))}function Z(e){var t,n,r,i,s,o;if(e[0]==0&&e[1]==0)return"0";if(j(e,(tt(),Ws)))return"-9223372036854775808";if(e[1]<0)return"-"+Z(X(e));n=e,i="";while(n[0]!=0||n[1]!=0){s=I(1e9),r=B(n,s),t=""+R(Q(n,z(r,s))),n=r;if(n[0]!=0||n[1]!=0){o=9-t.length;for(;o>0;--o)t="0"+t}i=t+i}return i}function et(){et=ws,Rs=y(oo,0,9,256,0)}function tt(){tt=ws,Us=Math.log(2),zs=js,Ws=ks,Xs=I(-1),Vs=I(1),$s=I(2),Js=Ps,Ks=I(0)}function nt(){return uo}function rt(){}function it(e,t){return st(e,t,0,t.length),e}function st(e,t,n,r){return e.buf=t,e.pos=n,e.count=n+r,e.count>t.length&&(e.count=t.length),e}function ot(e){return e.pos>=e.count?-1:e.buf[e.pos++]&255}function ut(e,t,n,r){return e.pos>=e.count?-1:(r=Xt(r,e.count-e.pos),en(e.buf,e.pos,t,n,r),e.pos+=r,r)}function at(){return ao}function ft(){}function lt(){return lo}function ct(){}function ht(e){return e.buf=y(fo,0,-1,32,1),e}function pt(e,t){var n;if(t<=e.buf.length)return;t=Wt(t,e.buf.length*2),n=y(fo,0,-1,t,1),en(e.buf,0,n,0,e.buf.length),e.buf=n}function dt(e){var t;return t=y(fo,0,-1,e.count,1),en(e.buf,0,t,0,e.count),t}function vt(e,t){pt(e,e.count+1),e.buf[e.count++]=t<<24>>24}function mt(e,t,n,r){pt(e,e.count+r),en(t,n,e.buf,e.count,r),e.count+=r}function gt(){return co}function yt(){}function bt(e,t){return e.detailMessage=t,e}function wt(){return ho}function Et(){}function St(e,t){return e.detailMessage=t,e}function xt(){return vo}function Tt(){}function Nt(e,t){return e.detailMessage=t,e}function Ct(){return mo}function kt(){}function Lt(e,t){var n;return n=new _t,n.typeName=e+t,n}function At(e,t){var n;return n=new _t,n.typeName=e+t,n}function Ot(e,t){var n;return n=new _t,n.typeName=e+t,n}function Mt(){return yo}function _t(){}function Dt(){return bo}function Pt(){}function Ht(){return po}function Bt(){}function jt(e,t){return e.detailMessage=t,e}function Ft(){return wo}function It(){}function qt(){return Eo}function Rt(){}function Ut(){return So}function zt(){}function Wt(e,t){return e>t?e:t}function Xt(e,t){return e<t?e:t}function Vt(){return To}function $t(){}function Jt(e,t){return t==null?!1:String(e)==t}function Kt(e,t,n,r,i){var s;for(s=t;s<n;++s)r[i++]=e.charCodeAt(s)}function Qt(){return No}function Gt(e){var t;return e.data=(t=[],t.explicitLength=0,t),e}function Yt(){return Co}function Zt(){}function en(e,t,n,r,i){var s,o,u,a,f,l,c,h;if(e==null||n==null)throw new $t;c=(e.typeMarker$==ws||e.typeId$==2?e.getClass$():so).typeName,u=(n.typeMarker$==ws||n.typeId$==2?n.getClass$():so).typeName;if(c.charCodeAt(0)!=91||u.charCodeAt(0)!=91)throw Nt(new kt,"Must be array types");if(c.charCodeAt(1)!=u.charCodeAt(1))throw Nt(new kt,"Array types must match");h=e.length,a=n.length;if(t<0||r<0||i<0||t+i>h||r+i>a)throw new zt;if(c.charCodeAt(1)!=76&&c.charCodeAt(1)!=91||!!Jt(c,u))for(f=0;f<i;++f)n[r+f]=e[t+f];else{l=k(e,3),s=k(n,3);if((e==null?null:e)===(n==null?null:n)&&t<r){t+=i;for(o=r+i;o-->r;)w(s,o,l[--t])}else for(o=r+i;r<o;)w(s,r++,l[t++])}}function tn(e,t){if(!Jr(t,1<<e.dictionarySize))throw u(new f,"unexpected failure");if(!Gr(t,e.fb))throw u(new f,"unexpected failure");if(!Qr(t,e.matchFinder))throw u(new f,"unexpected failure");if(!Kr(t,e.lc,e.lp,e.pb))throw u(new f,"unexpected failure")}function nn(){return Zo}function rn(){}function sn(e){var t;try{return Zn(e.chunker)}catch(t){t=O(t);if(L(t,10))return!1;throw t}}function on(e,t,n,r,i){var s,o;if(!i)throw jt(new It,"null mode");if(P(r,Ls)<0)throw jt(new It,"invalid length "+Z(r));e.length_0=r,s=Hr(new ri),tn(i,s),s._writeEndMark=!0,Yr(s,n);for(o=0;o<64;o+=8)vt(n,R(J(r,o))&255);e.chunker=(s._needReleaseMFStream=!1,s._inStream=t,s._finished=!1,Pr(s),s._rangeEncoder.Stream=n,zr(s),jr(s),Br(s),s._lenEncoder._tableSize=s._numFastBytes+1-2,pi(s._lenEncoder,1<<s._posStateBits),s._repMatchLenEncoder._tableSize=s._numFastBytes+1-2,pi(s._repMatchLenEncoder,1<<s._posStateBits),s.nowPos64=As,undefined,Gn(new rr,s))}function un(){return eu}function an(){}function fn(e,t,n){var r;e.output=ht(new yt);try{on(e,it(new ft,t),e.output,I(t.length),n)}catch(r){throw r=O(r),L(r,10)?u(new f,"impossible exception"):r}return e}function ln(){return tu}function cn(){}function hn(e){var t,n;try{return Zn(e.chunker)}catch(t){t=O(t);if(L(t,10))return n=t,e.exception=n,!1;throw t}}function pn(e,t,n){var r,i="",s,o,u,a;o=y(fo,0,-1,5,1);for(s=0;s<o.length;++s){u=ot(t);if(u==-1)throw bt(new Et,"truncated input");o[s]=u<<24>>24}r=ur(new pr);if(!fr(r,o))throw bt(new Et,"corrupted input");for(s=0;s<64;s+=8){u=ot(t);if(u==-1)throw bt(new Et,"truncated input");u=u.toString(16),u.length==1&&(u="0"+u),i=u+""+i}i.toLowerCase()=="ffffffffffffffffff"||i==0?e.length_0=Ls:(a=parseInt(i,16),a>4294967295?e.length_0=Ls:e.length_0=F(a)),e.chunker=sr(r,t,n,e.length_0)}function dn(){return nu}function vn(){}function mn(e,t){return e.output=ht(new yt),pn(e,it(new ft,t),e.output),e}function gn(){return ru}function yn(){}function bn(e,t,n,r){var i;e._keepSizeBefore=t,e._keepSizeAfter=n,i=t+n+r;if(e._bufferBase==null||e._blockSize!=i)e._bufferBase=null,e._blockSize=i,e._bufferBase=y(fo,0,-1,e._blockSize,1);e._pointerToLastSafePosition=e._blockSize-n}function wn(e,t){return e._bufferBase[e._bufferOffset+e._pos+t]}function En(e,t,n,r){var i,s;e._streamEndWasReached&&e._pos+t+r>e._streamPos&&(r=e._streamPos-(e._pos+t)),++n,s=e._bufferOffset+e._pos+t;for(i=0;i<r&&e._bufferBase[s+i]==e._bufferBase[s+i-n];++i);return i}function Sn(e){return e._streamPos-e._pos}function xn(e){var t,n,r;r=e._bufferOffset+e._pos-e._keepSizeBefore,r>0&&--r,n=e._bufferOffset+e._streamPos-r;for(t=0;t<n;++t)e._bufferBase[t]=e._bufferBase[r+t];e._bufferOffset-=r}function Tn(e){var t;++e._pos,e._pos>e._posLimit&&(t=e._bufferOffset+e._pos,t>e._pointerToLastSafePosition&&xn(e),Nn(e))}function Nn(e){var t,n,r;if(e._streamEndWasReached)return;for(;;){r=-e._bufferOffset+e._blockSize-e._streamPos;if(r==0)return;t=ut(e._stream,e._bufferBase,e._bufferOffset+e._streamPos,r);if(t==-1){e._posLimit=e._streamPos,n=e._bufferOffset+e._posLimit,n>e._pointerToLastSafePosition&&(e._posLimit=e._pointerToLastSafePosition-e._bufferOffset),e._streamEndWasReached=!0;return}e._streamPos+=t,e._streamPos>=e._pos+e._keepSizeAfter&&(e._posLimit=e._streamPos-e._keepSizeAfter)}}function Cn(e,t){e._bufferOffset+=t,e._posLimit-=t,e._pos-=t,e._streamPos-=t}function kn(){return ko}function Ln(){}function An(){An=ws;var e,t,n;Qs=y(xo,0,-1,256,1);for(e=0;e<256;++e){n=e;for(t=0;t<8;++t)(n&1)!=0?n=n>>>1^-306674912:n>>>=1;Qs[e]=n}}function On(e,t,n,r,i){var s,o,u;return t>1073741567?!1:(e._cutValue=16+(r>>1),u=~~((t+n+r+i)/2)+256,bn(e,t+n,r+i,u),e._matchMaxLen=r,s=t+1,e._cyclicBufferSize!=s&&(e._son=y(xo,0,-1,(e._cyclicBufferSize=s)*2,1)),o=65536,e.HASH_ARRAY&&(o=t-1,o|=o>>1,o|=o>>2,o|=o>>4,o|=o>>8,o>>=1,o|=65535,o>16777216&&(o>>=1),e._hashMask=o,++o,o+=e.kFixHashSize),o!=e._hashSizeSum&&(e._hash=y(xo,0,-1,e._hashSizeSum=o,1)),!0)}function Mn(e,t){var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S;if(e._pos+e._matchMaxLen<=e._streamPos)v=e._matchMaxLen;else{v=e._streamPos-e._pos;if(v<e.kMinMatchCheck)return Dn(e),0}y=0,m=e._pos>e._cyclicBufferSize?e._pos-e._cyclicBufferSize:0,r=e._bufferOffset+e._pos,g=1,f=0,l=0,e.HASH_ARRAY?(S=Qs[e._bufferBase[r]&255]^e._bufferBase[r+1]&255,f=S&1023,S^=(e._bufferBase[r+2]&255)<<8,l=S&65535,c=(S^Qs[e._bufferBase[r+3]&255]<<5)&e._hashMask):c=e._bufferBase[r]&255^(e._bufferBase[r+1]&255)<<8,i=e._hash[e.kFixHashSize+c],e.HASH_ARRAY&&(s=e._hash[f],o=e._hash[1024+l],e._hash[f]=e._pos,e._hash[1024+l]=e._pos,s>m&&e._bufferBase[e._bufferOffset+s]==e._bufferBase[r]&&(t[y++]=g=2,t[y++]=e._pos-s-1),o>m&&e._bufferBase[e._bufferOffset+o]==e._bufferBase[r]&&(o==s&&(y-=2),t[y++]=g=3,t[y++]=e._pos-o-1,s=o),y!=0&&s==i&&(y-=2,g=1)),e._hash[e.kFixHashSize+c]=e._pos,w=(e._cyclicBufferPos<<1)+1,E=e._cyclicBufferPos<<1,p=d=e.kNumHashDirectBytes,e.kNumHashDirectBytes!=0&&i>m&&e._bufferBase[e._bufferOffset+i+e.kNumHashDirectBytes]!=e._bufferBase[r+e.kNumHashDirectBytes]&&(t[y++]=g=e.kNumHashDirectBytes,t[y++]=e._pos-i-1),n=e._cutValue;for(;;){if(i<=m||n--==0){e._son[w]=e._son[E]=0;break}a=e._pos-i,u=(a<=e._cyclicBufferPos?e._cyclicBufferPos-a:e._cyclicBufferPos-a+e._cyclicBufferSize)<<1,b=e._bufferOffset+i,h=p<d?p:d;if(e._bufferBase[b+h]==e._bufferBase[r+h]){while(++h!=v)if(e._bufferBase[b+h]!=e._bufferBase[r+h])break;if(g<h){t[y++]=g=h,t[y++]=a-1;if(h==v){e._son[E]=e._son[u],e._son[w]=e._son[u+1];break}}}(e._bufferBase[b+h]&255)<(e._bufferBase[r+h]&255)?(e._son[E]=i,E=u+1,i=e._son[E],d=h):(e._son[w]=i,w=u,i=e._son[w],p=h)}return Dn(e),y}function _n(e){var t;e._bufferOffset=0,e._pos=0,e._streamPos=0,e._streamEndWasReached=!1,Nn(e);for(t=0;t<e._hashSizeSum;++t)e._hash[t]=0;e._cyclicBufferPos=0,Cn(e,-1)}function Dn(e){var t;++e._cyclicBufferPos>=e._cyclicBufferSize&&(e._cyclicBufferPos=0),Tn(e),e._pos==1073741823&&(t=e._pos-e._cyclicBufferSize,Pn(e._son,e._cyclicBufferSize*2,t),Pn(e._hash,e._hashSizeSum,t),Cn(e,t))}function Pn(e,t,n){var r,i;for(r=0;r<t;++r)i=e[r],i<=n?i=0:i-=n,e[r]=i}function Hn(e,t){e.HASH_ARRAY=t>2,e.HASH_ARRAY?(e.kNumHashDirectBytes=0,e.kMinMatchCheck=4,e.kFixHashSize=66560):(e.kNumHashDirectBytes=2,e.kMinMatchCheck=3,e.kFixHashSize=0)}function Bn(e,t){var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y;do{if(e._pos+e._matchMaxLen<=e._streamPos)p=e._matchMaxLen;else{p=e._streamPos-e._pos;if(p<e.kMinMatchCheck){Dn(e);continue}}d=e._pos>e._cyclicBufferSize?e._pos-e._cyclicBufferSize:0,r=e._bufferOffset+e._pos,e.HASH_ARRAY?(y=Qs[e._bufferBase[r]&255]^e._bufferBase[r+1]&255,u=y&1023,e._hash[u]=e._pos,y^=(e._bufferBase[r+2]&255)<<8,a=y&65535,e._hash[1024+a]=e._pos,f=(y^Qs[e._bufferBase[r+3]&255]<<5)&e._hashMask):f=e._bufferBase[r]&255^(e._bufferBase[r+1]&255)<<8,i=e._hash[e.kFixHashSize+f],e._hash[e.kFixHashSize+f]=e._pos,m=(e._cyclicBufferPos<<1)+1,g=e._cyclicBufferPos<<1,c=h=e.kNumHashDirectBytes,n=e._cutValue;for(;;){if(i<=d||n--==0){e._son[m]=e._son[g]=0;break}o=e._pos-i,s=(o<=e._cyclicBufferPos?e._cyclicBufferPos-o:e._cyclicBufferPos-o+e._cyclicBufferSize)<<1,v=e._bufferOffset+i,l=c<h?c:h;if(e._bufferBase[v+l]==e._bufferBase[r+l]){while(++l!=p)if(e._bufferBase[v+l]!=e._bufferBase[r+l])break;if(l==p){e._son[g]=e._son[s],e._son[m]=e._son[s+1];break}}(e._bufferBase[v+l]&255)<(e._bufferBase[r+l]&255)?(e._son[g]=i,g=s+1,i=e._son[g],h=l):(e._son[m]=i,m=s,i=e._son[m],c=l)}Dn(e)}while(--t!=0)}function jn(){return Lo}function Fn(){}function In(e,t,n){var r;r=e._pos-t-1,r<0&&(r+=e._windowSize);for(;n!=0;--n)r>=e._windowSize&&(r=0),e._buffer[e._pos++]=e._buffer[r++],e._pos>=e._windowSize&&Rn(e)}function qn(e,t){if(e._buffer==null||e._windowSize!=t)e._buffer=y(fo,0,-1,t,1);e._windowSize=t,e._pos=0,e._streamPos=0}function Rn(e){var t;t=e._pos-e._streamPos;if(t==0)return;mt(e._stream,e._buffer,e._streamPos,t),e._pos>=e._windowSize&&(e._pos=0),e._streamPos=e._pos}function Un(e,t){var n;return n=e._pos-t-1,n<0&&(n+=e._windowSize),e._buffer[n]}function zn(e,t){t||(e._streamPos=0,e._pos=0)}function Wn(e,t){e._buffer[e._pos++]=t,e._pos>=e._windowSize&&Rn(e)}function Xn(e){Rn(e),e._stream=null}function Vn(e,t){Rn(e),e._stream=null,e._stream=t}function $n(){return Ao}function Jn(){}function Kn(e){return e-=2,e<4?e:3}function Qn(e){return e<4?0:e<10?e-3:e-6}function Gn(e,t){return e.encoder=t,e.decoder=null,e.alive=!0,e}function Yn(e,t){return e.decoder=t,e.encoder=null,e.alive=!0,e}function Zn(e){var t;if(!e.alive)throw new Rt;t=!0;try{return e.encoder?tr(e):er(e),t=!1,e.alive}finally{t&&(e.alive=!1)}}function er(e){var t;t=or(e.decoder);if(t==-1)throw bt(new Et,"corrupted input");e.inBytesProcessed=Ls,e.outBytesProcessed=e.decoder.nowPos64;if(t==1||P(e.decoder.outSize,As)>=0&&P(e.decoder.nowPos64,e.decoder.outSize)>=0)ir(e.decoder),e.alive=!1}function tr(e){Dr(e.encoder,e.encoder.processedInSize,e.encoder.processedOutSize,e.encoder.finished),e.inBytesProcessed=e.encoder.processedInSize[0],e.encoder.finished[0]&&($r(e.encoder),e.alive=!1)}function nr(){return Oo}function rr(){}function ir(e){Rn(e.m_OutWindow),Xn(e.m_OutWindow),e.m_RangeDecoder.Stream=null}function sr(e,t,n,r){return e.m_RangeDecoder.Stream=t,Vn(e.m_OutWindow,n),ar(e),e.state=0,e.rep0=0,e.rep1=0,e.rep2=0,e.rep3=0,e.outSize=r,e.nowPos64=As,e.prevByte=0,Yn(new rr,e)}function or(e){var t,n,r,i,s,o;o=R(e.nowPos64)&e.m_PosStateMask;if(Vi(e.m_RangeDecoder,e.m_IsMatchDecoders,(e.state<<4)+o)==0)t=Er(e.m_LiteralDecoder,R(e.nowPos64),e.prevByte),e.state<7?e.prevByte=Nr(t,e.m_RangeDecoder):e.prevByte=Cr(t,e.m_RangeDecoder,Un(e.m_OutWindow,e.rep0)),Wn(e.m_OutWindow,e.prevByte),e.state=Qn(e.state),e.nowPos64=M(e.nowPos64,Os);else{if(Vi(e.m_RangeDecoder,e.m_IsRepDecoders,e.state)==1)r=0,Vi(e.m_RangeDecoder,e.m_IsRepG0Decoders,e.state)==0?Vi(e.m_RangeDecoder,e.m_IsRep0LongDecoders,(e.state<<4)+o)==0&&(e.state=e.state<7?9:11,r=1):(Vi(e.m_RangeDecoder,e.m_IsRepG1Decoders,e.state)==0?n=e.rep1:(Vi(e.m_RangeDecoder,e.m_IsRepG2Decoders,e.state)==0?n=e.rep2:(n=e.rep3,e.rep3=e.rep2),e.rep2=e.rep1),e.rep1=e.rep0,e.rep0=n),r==0&&(r=vr(e.m_RepLenDecoder,e.m_RangeDecoder,o)+2,e.state=e.state<7?8:11);else{e.rep3=e.rep2,e.rep2=e.rep1,e.rep1=e.rep0,r=2+vr(e.m_LenDecoder,e.m_RangeDecoder,o),e.state=e.state<7?7:10,s=_i(e.m_PosSlotDecoder[Kn(r)],e.m_RangeDecoder);if(s>=4){i=(s>>1)-1,e.rep0=(2|s&1)<<i;if(s<14)e.rep0+=Pi(e.m_PosDecoders,e.rep0-s-1,e.m_RangeDecoder,i);else{e.rep0+=$i(e.m_RangeDecoder,i-4)<<4,e.rep0+=Di(e.m_PosAlignDecoder,e.m_RangeDecoder);if(e.rep0<0)return e.rep0==-1?1:-1}}else e.rep0=s}if(P(I(e.rep0),e.nowPos64)>=0||e.rep0>=e.m_DictionarySizeCheck)return-1;In(e.m_OutWindow,e.rep0,r),e.nowPos64=M(e.nowPos64,I(r)),e.prevByte=Un(e.m_OutWindow,0)}return 0}function ur(e){var t;e.m_OutWindow=new Jn,e.m_RangeDecoder=new Gi,e.m_IsMatchDecoders=y(Mo,0,-1,192,1),e.m_IsRepDecoders=y(Mo,0,-1,12,1),e.m_IsRepG0Decoders=y(Mo,0,-1,12,1),e.m_IsRepG1Decoders=y(Mo,0,-1,12,1),e.m_IsRepG2Decoders=y(Mo,0,-1,12,1),e.m_IsRep0LongDecoders=y(Mo,0,-1,192,1),e.m_PosSlotDecoder=y(_o,0,7,4,0),e.m_PosDecoders=y(Mo,0,-1,114,1),e.m_PosAlignDecoder=Mi(new Bi,4),e.m_LenDecoder=mr(new br),e.m_RepLenDecoder=mr(new br),e.m_LiteralDecoder=new Tr;for(t=0;t<4;++t)e.m_PosSlotDecoder[t]=Mi(new Bi,6);return e}function ar(e){var t;zn(e.m_OutWindow,!1),Ki(e.m_IsMatchDecoders),Ki(e.m_IsRep0LongDecoders),Ki(e.m_IsRepDecoders),Ki(e.m_IsRepG0Decoders),Ki(e.m_IsRepG1Decoders),Ki(e.m_IsRepG2Decoders),Ki(e.m_PosDecoders),Sr(e.m_LiteralDecoder);for(t=0;t<4;++t)Ki(e.m_PosSlotDecoder[t].Models);gr(e.m_LenDecoder),gr(e.m_RepLenDecoder),Ki(e.m_PosAlignDecoder.Models),Ji(e.m_RangeDecoder)}function fr(e,t){var n,r,i,s,o,u,a;if(t.length<5)return!1;a=t[0]&255,i=a%9,u=~~(a/9),s=u%5,o=~~(u/5),n=0;for(r=0;r<4;++r)n+=(t[1+r]&255)<<r*8;return cr(e,i,s,o)?lr(e,n):!1}function lr(e,t){return t<0?!1:(e.m_DictionarySize!=t&&(e.m_DictionarySize=t,e.m_DictionarySizeCheck=Wt(e.m_DictionarySize,1),qn(e.m_OutWindow,Wt(e.m_DictionarySizeCheck,4096))),!0)}function cr(e,t,n,r){var i;return t>8||n>4||r>4?!1:(wr(e.m_LiteralDecoder,n,t),i=1<<r,dr(e.m_LenDecoder,i),dr(e.m_RepLenDecoder,i),e.m_PosStateMask=i-1,!0)}function hr(){return Do}function pr(){}function dr(e,t){for(;e.m_NumPosStates<t;++e.m_NumPosStates)e.m_LowCoder[e.m_NumPosStates]=Mi(new Bi,3),e.m_MidCoder[e.m_NumPosStates]=Mi(new Bi,3)}function vr(e,t,n){var r;return Vi(t,e.m_Choice,0)==0?_i(e.m_LowCoder[n],t):(r=8,Vi(t,e.m_Choice,1)==0?r+=_i(e.m_MidCoder[n],t):r+=8+_i(e.m_HighCoder,t),r)}function mr(e){return e.m_Choice=y(Mo,0,-1,2,1),e.m_LowCoder=y(_o,0,7,16,0),e.m_MidCoder=y(_o,0,7,16,0),e.m_HighCoder=Mi(new Bi,8),e}function gr(e){var t;Ki(e.m_Choice);for(t=0;t<e.m_NumPosStates;++t)Ki(e.m_LowCoder[t].Models),Ki(e.m_MidCoder[t].Models);Ki(e.m_HighCoder.Models)}function yr(){return Po}function br(){}function wr(e,t,n){var r,i;if(e.m_Coders!=null&&e.m_NumPrevBits==n&&e.m_NumPosBits==t)return;e.m_NumPosBits=t,e.m_PosMask=(1<<t)-1,e.m_NumPrevBits=n,i=1<<e.m_NumPrevBits+e.m_NumPosBits,e.m_Coders=y(Ho,0,4,i,0);for(r=0;r<i;++r)e.m_Coders[r]=kr(new Ar)}function Er(e,t,n){return e.m_Coders[((t&e.m_PosMask)<<e.m_NumPrevBits)+((n&255)>>>8-e.m_NumPrevBits)]}function Sr(e){var t,n;n=1<<e.m_NumPrevBits+e.m_NumPosBits;for(t=0;t<n;++t)Ki(e.m_Coders[t].m_Decoders)}function xr(){return Bo}function Tr(){}function Nr(e,t){var n;n=1;do n=n<<1|Vi(t,e.m_Decoders,n);while(n<256);return n<<24>>24}function Cr(e,t,n){var r,i,s;s=1;do{i=n>>7&1,n<<=1,r=Vi(t,e.m_Decoders,(1+i<<8)+s),s=s<<1|r;if(i!=r){while(s<256)s=s<<1|Vi(t,e.m_Decoders,s);break}}while(s<256);return s<<24>>24}function kr(e){return e.m_Decoders=y(Mo,0,-1,768,1),e}function Lr(){return jo}function Ar(){}function Or(){Or=ws;var e,t,n,r;Gs=y(fo,0,-1,2048,1),e=2,Gs[0]=0,Gs[1]=1;for(r=2;r<22;++r){n=1<<(r>>1)-1;for(t=0;t<n;++t,++e)Gs[e]=r<<24>>24}}function Mr(e,t){var n,r,i,s;e._optimumEndIndex=t,i=e._optimum[t].PosPrev,r=e._optimum[t].BackPrev;do e._optimum[t].Prev1IsChar&&(ki(e._optimum[i]),e._optimum[i].PosPrev=i-1,e._optimum[t].Prev2&&(e._optimum[i-1].Prev1IsChar=!1,e._optimum[i-1].PosPrev=e._optimum[t].PosPrev2,e._optimum[i-1].BackPrev=e._optimum[t].BackPrev2)),s=i,n=r,r=e._optimum[s].BackPrev,i=e._optimum[s].PosPrev,e._optimum[s].BackPrev=n,e._optimum[s].PosPrev=t,t=s;while(t>0);return e.backRes=e._optimum[0].BackPrev,e._optimumCurrentIndex=e._optimum[0].PosPrev,e._optimumCurrentIndex}function _r(e){var t;e._state=0,e._previousByte=0;for(t=0;t<4;++t)e._repDistances[t]=0}function Dr(e,t,n,r){var i,s,o,u,a,f,l,c,h,p,d,v,m,g,y;t[0]=As,n[0]=As,r[0]=!0,e._inStream&&(e._matchFinder._stream=e._inStream,_n(e._matchFinder),e._needReleaseMFStream=!0,e._inStream=null);if(e._finished)return;e._finished=!0,g=e.nowPos64;if(j(e.nowPos64,As)){if(Sn(e._matchFinder)==0){Fr(e,R(e.nowPos64));return}Xr(e),m=R(e.nowPos64)&e._posStateMask,Zi(e._rangeEncoder,e._isMatch,(e._state<<4)+m,0),e._state=Qn(e._state),o=wn(e._matchFinder,-e._additionalOffset),Ei(gi(e._literalEncoder,R(e.nowPos64),e._previousByte),e._rangeEncoder,o),e._previousByte=o,--e._additionalOffset,e.nowPos64=M(e.nowPos64,Os)}if(Sn(e._matchFinder)==0){Fr(e,R(e.nowPos64));return}for(;;){l=Ir(e,R(e.nowPos64)),p=e.backRes,m=R(e.nowPos64)&e._posStateMask,s=(e._state<<4)+m;if(l==1&&p==-1)Zi(e._rangeEncoder,e._isMatch,s,0),o=wn(e._matchFinder,-e._additionalOffset),y=gi(e._literalEncoder,R(e.nowPos64),e._previousByte),e._state<7?Ei(y,e._rangeEncoder,o):(h=wn(e._matchFinder,-e._repDistances[0]-1-e._additionalOffset),Si(y,e._rangeEncoder,h,o)),e._previousByte=o,e._state=Qn(e._state);else{Zi(e._rangeEncoder,e._isMatch,s,1);if(p<4){Zi(e._rangeEncoder,e._isRep,e._state,1),p==0?(Zi(e._rangeEncoder,e._isRepG0,e._state,0),l==1?Zi(e._rangeEncoder,e._isRep0Long,s,0):Zi(e._rangeEncoder,e._isRep0Long,s,1)):(Zi(e._rangeEncoder,e._isRepG0,e._state,1),p==1?Zi(e._rangeEncoder,e._isRepG1,e._state,0):(Zi(e._rangeEncoder,e._isRepG1,e._state,1),Zi(e._rangeEncoder,e._isRepG2,e._state,p-2))),l==1?e._state=e._state<7?9:11:(li(e._repMatchLenEncoder,e._rangeEncoder,l-2,m),e._state=e._state<7?8:11),u=e._repDistances[p];if(p!=0){for(f=p;f>=1;--f)e._repDistances[f]=e._repDistances[f-1];e._repDistances[0]=u}}else{Zi(e._rangeEncoder,e._isRep,e._state,0),e._state=e._state<7?7:10,li(e._lenEncoder,e._rangeEncoder,l-2,m),p-=4,v=ei(p),c=Kn(l),Fi(e._posSlotEncoder[c],e._rangeEncoder,v),v>=4&&(a=(v>>1)-1,i=(2|v&1)<<a,d=p-i,v<14?Ui(e._posEncoders,i-v-1,e._rangeEncoder,a,d):(es(e._rangeEncoder,d>>4,a-4),qi(e._posAlignEncoder,e._rangeEncoder,d&15),++e._alignPriceCount)),u=p;for(f=3;f>=1;--f)e._repDistances[f]=e._repDistances[f-1];e._repDistances[0]=u,++e._matchPriceCount}e._previousByte=wn(e._matchFinder,l-1-e._additionalOffset)}e._additionalOffset-=l,e.nowPos64=M(e.nowPos64,I(l));if(e._additionalOffset==0){e._matchPriceCount>=128&&jr(e),e._alignPriceCount>=16&&Br(e),t[0]=e.nowPos64,n[0]=ns(e._rangeEncoder);if(Sn(e._matchFinder)==0){Fr(e,R(e.nowPos64));return}if(P(Q(e.nowPos64,g),_s)>=0){e._finished=!1,r[0]=!1;return}}}}function Pr(e){var t,n;e._matchFinder||(t=(An(),new Fn),n=4,e._matchFinderType==0&&(n=2),Hn(t,n),e._matchFinder=t),mi(e._literalEncoder,e._numLiteralPosStateBits,e._numLiteralContextBits);if(e._dictionarySize==e._dictionarySizePrev&&e._numFastBytesPrev==e._numFastBytes)return;On(e._matchFinder,e._dictionarySize,4096,e._numFastBytes,274),e._dictionarySizePrev=e._dictionarySize,e._numFastBytesPrev=e._numFastBytes}function Hr(e){var t;Or(),e._repDistances=y(xo,0,-1,4,1),e._optimum=y(Fo,0,6,4096,0),e._rangeEncoder=(Yi(),new as),e._isMatch=y(Mo,0,-1,192,1),e._isRep=y(Mo,0,-1,12,1),e._isRepG0=y(Mo,0,-1,12,1),e._isRepG1=y(Mo,0,-1,12,1),e._isRepG2=y(Mo,0,-1,12,1),e._isRep0Long=y(Mo,0,-1,192,1),e._posSlotEncoder=y(Io,0,8,4,0),e._posEncoders=y(Mo,0,-1,114,1),e._posAlignEncoder=ji(new Xi,4),e._lenEncoder=ci(new vi),e._repMatchLenEncoder=ci(new vi),e._literalEncoder=new wi,e._matchDistances=y(xo,0,-1,548,1),e._posSlotPrices=y(xo,0,-1,256,1),e._distancesPrices=y(xo,0,-1,512,1),e._alignPrices=y(xo,0,-1,16,1),e.reps=y(xo,0,-1,4,1),e.repLens=y(xo,0,-1,4,1),e.processedInSize=y(qo,0,-1,1,3),e.processedOutSize=y(qo,0,-1,1,3),e.finished=y(Ro,0,-1,1,2),e.properties=y(fo,0,-1,5,1),e.tempPrices=y(xo,0,-1,128,1);for(t=0;t<4096;++t)e._optimum[t]=new Oi;for(t=0;t<4;++t)e._posSlotEncoder[t]=ji(new Xi,6);return e}function Br(e){var t;for(t=0;t<16;++t)e._alignPrices[t]=Ri(e._posAlignEncoder,t);e._alignPriceCount=0}function jr(e){var t,n,r,i,s,o,u,a;for(i=4;i<128;++i)o=ei(i),r=(o>>1)-1,t=(2|o&1)<<r,e.tempPrices[i]=zi(e._posEncoders,t-o-1,r,i-t);for(s=0;s<4;++s){n=e._posSlotEncoder[s],u=s<<6;for(o=0;o<e._distTableSize;++o)e._posSlotPrices[u+o]=Ii(n,o);for(o=14;o<e._distTableSize;++o)e._posSlotPrices[u+o]+=(o>>1)-1-4<<6;a=s*128;for(i=0;i<4;++i)e._distancesPrices[a+i]=e._posSlotPrices[u+i];for(;i<128;++i)e._distancesPrices[a+i]=e._posSlotPrices[u+ei(i)]+e.tempPrices[i]}e._matchPriceCount=0}function Fr(e,t){Vr(e),Zr(e,t&e._posStateMask),ts(e._rangeEncoder)}function Ir(e,t){var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G;if(e._optimumEndIndex!=e._optimumCurrentIndex)return d=e._optimum[e._optimumCurrentIndex].PosPrev-e._optimumCurrentIndex,e.backRes=e._optimum[e._optimumCurrentIndex].BackPrev,e._optimumCurrentIndex=e._optimum[e._optimumCurrentIndex].PosPrev,d;e._optimumCurrentIndex=e._optimumEndIndex=0,e._longestMatchWasFound?(p=e._longestMatchLength,e._longestMatchWasFound=!1):p=Xr(e),L=e._numDistancePairs,C=Sn(e._matchFinder)+1;if(C<2)return e.backRes=-1,1;C>273&&(C=273),R=0;for(l=0;l<4;++l)e.reps[l]=e._repDistances[l],e.repLens[l]=En(e._matchFinder,-1,e.reps[l],273),e.repLens[l]>e.repLens[R]&&(R=l);if(e.repLens[R]>=e._numFastBytes)return e.backRes=R,d=e.repLens[R],Wr(e,d-1),d;if(p>=e._numFastBytes)return e.backRes=e._matchDistances[L-1]+4,Wr(e,p-1),p;a=wn(e._matchFinder,-1),y=wn(e._matchFinder,-e._repDistances[0]-1-1);if(p<2&&a!=y&&e.repLens[R]<2)return e.backRes=-1,1;e._optimum[0].State=e._state,H=t&e._posStateMask,e._optimum[1].Price=(Yi(),Ys[e._isMatch[(e._state<<4)+H]>>>2])+Ti(gi(e._literalEncoder,t,e._previousByte),e._state>=7,y,a),ki(e._optimum[1]),b=Ys[2048-e._isMatch[(e._state<<4)+H]>>>2],q=b+Ys[2048-e._isRep[e._state]>>>2],y==a&&(U=q+Ur(e,e._state,H),U<e._optimum[1].Price&&(e._optimum[1].Price=U,Li(e._optimum[1]))),h=p>=e.repLens[R]?p:e.repLens[R];if(h<2)return e.backRes=e._optimum[1].BackPrev,1;e._optimum[1].PosPrev=0,e._optimum[0].Backs0=e.reps[0],e._optimum[0].Backs1=e.reps[1],e._optimum[0].Backs2=e.reps[2],e._optimum[0].Backs3=e.reps[3],c=h;do e._optimum[c--].Price=268435455;while(c>=2);for(l=0;l<4;++l){I=e.repLens[l];if(I<2)continue;j=q+Rr(e,l,e._state,H);do s=j+hi(e._repMatchLenEncoder,I-2,H),_=e._optimum[I],s<_.Price&&(_.Price=s,_.PosPrev=0,_.BackPrev=l,_.Prev1IsChar=!1);while(--I>=2)}N=b+Ys[e._isRep[e._state]>>>2],c=e.repLens[0]>=2?e.repLens[0]+1:2;if(c<=p){A=0;while(c>e._matchDistances[A])A+=2;for(;;++c){f=e._matchDistances[A+1],s=N+qr(e,f,c,H),_=e._optimum[c],s<_.Price&&(_.Price=s,_.PosPrev=0,_.BackPrev=f+4,_.Prev1IsChar=!1);if(c==e._matchDistances[A]){A+=2;if(A==L)break}}}n=0;for(;;){++n;if(n==h)return Mr(e,n);w=Xr(e),L=e._numDistancePairs;if(w>=e._numFastBytes)return e._longestMatchLength=w,e._longestMatchWasFound=!0,Mr(e,n);++t,P=e._optimum[n].PosPrev,e._optimum[n].Prev1IsChar?(--P,e._optimum[n].Prev2?(W=e._optimum[e._optimum[n].PosPrev2].State,e._optimum[n].BackPrev2<4?W=W<7?8:11:W=W<7?7:10):W=e._optimum[P].State,W=Qn(W)):W=e._optimum[P].State,P==n-1?e._optimum[n].BackPrev==0?W=W<7?9:11:W=Qn(W):(e._optimum[n].Prev1IsChar&&e._optimum[n].Prev2?(P=e._optimum[n].PosPrev2,D=e._optimum[n].BackPrev2,W=W<7?8:11):(D=e._optimum[n].BackPrev,D<4?W=W<7?8:11:W=W<7?7:10),M=e._optimum[P],D<4?D==0?(e.reps[0]=M.Backs0,e.reps[1]=M.Backs1,e.reps[2]=M.Backs2,e.reps[3]=M.Backs3):D==1?(e.reps[0]=M.Backs1,e.reps[1]=M.Backs0,e.reps[2]=M.Backs2,e.reps[3]=M.Backs3):D==2?(e.reps[0]=M.Backs2,e.reps[1]=M.Backs0,e.reps[2]=M.Backs1,e.reps[3]=M.Backs3):(e.reps[0]=M.Backs3,e.reps[1]=M.Backs0,e.reps[2]=M.Backs1,e.reps[3]=M.Backs2):(e.reps[0]=D-4,e.reps[1]=M.Backs0,e.reps[2]=M.Backs1,e.reps[3]=M.Backs2)),e._optimum[n].State=W,e._optimum[n].Backs0=e.reps[0],e._optimum[n].Backs1=e.reps[1],e._optimum[n].Backs2=e.reps[2],e._optimum[n].Backs3=e.reps[3],u=e._optimum[n].Price,a=wn(e._matchFinder,-1),y=wn(e._matchFinder,-e.reps[0]-1-1),H=t&e._posStateMask,r=u+Ys[e._isMatch[(W<<4)+H]>>>2]+Ti(gi(e._literalEncoder,t,wn(e._matchFinder,-2)),W>=7,y,a),x=e._optimum[n+1],E=!1,r<x.Price&&(x.Price=r,x.PosPrev=n,x.BackPrev=-1,x.Prev1IsChar=!1,E=!0),b=u+Ys[2048-e._isMatch[(W<<4)+H]>>>2],q=b+Ys[2048-e._isRep[W]>>>2],y==a&&!(x.PosPrev<n&&x.BackPrev==0)&&(U=q+(Ys[e._isRepG0[W]>>>2]+Ys[e._isRep0Long[(W<<4)+H]>>>2]),U<=x.Price&&(x.Price=U,x.PosPrev=n,x.BackPrev=0,x.Prev1IsChar=!1,E=!0)),k=Sn(e._matchFinder)+1,k=4095-n<k?4095-n:k,C=k;if(C<2)continue;C>e._numFastBytes&&(C=e._numFastBytes);if(!E&&y!=a){V=Xt(k-1,e._numFastBytes),m=En(e._matchFinder,0,e.reps[0],V);if(m>=2){X=Qn(W),B=t+1&e._posStateMask,T=r+Ys[2048-e._isMatch[(X<<4)+B]>>>2]+Ys[2048-e._isRep[X]>>>2],O=n+1+m;while(h<O)e._optimum[++h].Price=268435455;s=T+($=hi(e._repMatchLenEncoder,m-2,B),$+Rr(e,0,X,B)),_=e._optimum[O],s<_.Price&&(_.Price=s,_.PosPrev=n+1,_.BackPrev=0,_.Prev1IsChar=!0,_.Prev2=!1)}}z=2;for(F=0;F<4;++F){v=En(e._matchFinder,-1,e.reps[F],C);if(v<2)continue;g=v;do{while(h<n+v)e._optimum[++h].Price=268435455;s=q+(J=hi(e._repMatchLenEncoder,v-2,H),J+Rr(e,F,W,H)),_=e._optimum[n+v],s<_.Price&&(_.Price=s,_.PosPrev=n,_.BackPrev=F,_.Prev1IsChar=!1)}while(--v>=2);v=g,F==0&&(z=v+1);if(v<k){V=Xt(k-1-v,e._numFastBytes),m=En(e._matchFinder,v,e.reps[F],V);if(m>=2){X=W<7?8:11,B=t+v&e._posStateMask,i=q+(K=hi(e._repMatchLenEncoder,v-2,H),K+Rr(e,F,W,H))+Ys[e._isMatch[(X<<4)+B]>>>2]+Ti(gi(e._literalEncoder,t+v,wn(e._matchFinder,v-1-1)),!0,wn(e._matchFinder,v-1-(e.reps[F]+1)),wn(e._matchFinder,v-1)),X=Qn(X),B=t+v+1&e._posStateMask,S=i+Ys[2048-e._isMatch[(X<<4)+B]>>>2],T=S+Ys[2048-e._isRep[X]>>>2],O=v+1+m;while(h<n+O)e._optimum[++h].Price=268435455;s=T+(Q=hi(e._repMatchLenEncoder,m-2,B),Q+Rr(e,0,X,B)),_=e._optimum[n+O],s<_.Price&&(_.Price=s,_.PosPrev=n+v+1,_.BackPrev=0,_.Prev1IsChar=!0,_.Prev2=!0,_.PosPrev2=n,_.BackPrev2=F)}}}if(w>C){w=C;for(L=0;w>e._matchDistances[L];L+=2);e._matchDistances[L]=w,L+=2}if(w>=z){N=b+Ys[e._isRep[W]>>>2];while(h<n+w)e._optimum[++h].Price=268435455;A=0;while(z>e._matchDistances[A])A+=2;for(v=z;;++v){o=e._matchDistances[A+1],s=N+qr(e,o,v,H),_=e._optimum[n+v],s<_.Price&&(_.Price=s,_.PosPrev=n,_.BackPrev=o+4,_.Prev1IsChar=!1);if(v==e._matchDistances[A]){if(v<k){V=Xt(k-1-v,e._numFastBytes),m=En(e._matchFinder,v,o,V);if(m>=2){X=W<7?7:10,B=t+v&e._posStateMask,i=s+Ys[e._isMatch[(X<<4)+B]>>>2]+Ti(gi(e._literalEncoder,t+v,wn(e._matchFinder,v-1-1)),!0,wn(e._matchFinder,v-(o+1)-1),wn(e._matchFinder,v-1)),X=Qn(X),B=t+v+1&e._posStateMask,S=i+Ys[2048-e._isMatch[(X<<4)+B]>>>2],T=S+Ys[2048-e._isRep[X]>>>2],O=v+1+m;while(h<n+O)e._optimum[++h].Price=268435455;s=T+(G=hi(e._repMatchLenEncoder,m-2,B),G+Rr(e,0,X,B)),_=e._optimum[n+O],s<_.Price&&(_.Price=s,_.PosPrev=n+v+1,_.BackPrev=0,_.Prev1IsChar=!0,_.Prev2=!0,_.PosPrev2=n,_.BackPrev2=o+4)}}A+=2;if(A==L)break}}}}}function qr(e,t,n,r){var i,s;return i=Kn(n),t<128?s=e._distancesPrices[i*128+t]:s=e._posSlotPrices[(i<<6)+ti(t)]+e._alignPrices[t&15],s+hi(e._lenEncoder,n-2,r)}function Rr(e,t,n,r){var i;return t==0?(i=(Yi(),Ys[e._isRepG0[n]>>>2]),i+=Ys[2048-e._isRep0Long[(n<<4)+r]>>>2]):(i=(Yi(),Ys[2048-e._isRepG0[n]>>>2]),t==1?i+=Ys[e._isRepG1[n]>>>2]:(i+=Ys[2048-e._isRepG1[n]>>>2],i+=ss(e._isRepG2[n],t-2))),i}function Ur(e,t,n){return(Yi(),Ys[e._isRepG0[t]>>>2])+Ys[e._isRep0Long[(t<<4)+n]>>>2]}function zr(e){var t;_r(e),rs(e._rangeEncoder),os(e._isMatch),os(e._isRep0Long),os(e._isRep),os(e._isRepG0),os(e._isRepG1),os(e._isRepG2),os(e._posEncoders),yi(e._literalEncoder);for(t=0;t<4;++t)Ki(e._posSlotEncoder[t].Models);oi(e._lenEncoder,1<<e._posStateBits),oi(e._repMatchLenEncoder,1<<e._posStateBits),Ki(e._posAlignEncoder.Models),e._longestMatchWasFound=!1,e._optimumEndIndex=0,e._optimumCurrentIndex=0,e._additionalOffset=0}function Wr(e,t){t>0&&(Bn(e._matchFinder,t),e._additionalOffset+=t)}function Xr(e){var t;return t=0,e._numDistancePairs=Mn(e._matchFinder,e._matchDistances),e._numDistancePairs>0&&(t=e._matchDistances[e._numDistancePairs-2],t==e._numFastBytes&&(t+=En(e._matchFinder,t-1,e._matchDistances[e._numDistancePairs-1],273-t))),++e._additionalOffset,t}function Vr(e){!!e._matchFinder&&e._needReleaseMFStream&&(e._matchFinder._stream=null,e._needReleaseMFStream=!1)}function $r(e){Vr(e),e._rangeEncoder.Stream=null}function Jr(e,t){var n;if(t<1||t>536870912)return!1;e._dictionarySize=t;for(n=0;t>1<<n;++n);return e._distTableSize=n*2,!0}function Kr(e,t,n,r){return n<0||n>4||t<0||t>8||r<0||r>4?!1:(e._numLiteralPosStateBits=n,e._numLiteralContextBits=t,e._posStateBits=r,e._posStateMask=(1<<e._posStateBits)-1,!0)}function Qr(e,t){var n;return t<0||t>2?!1:(n=e._matchFinderType,e._matchFinderType=t,!!e._matchFinder&&n!=e._matchFinderType&&(e._dictionarySizePrev=-1,e._matchFinder=null),!0)}function Gr(e,t){return t<5||t>273?!1:(e._numFastBytes=t,!0)}function Yr(e,t){var n;e.properties[0]=(e._posStateBits*5+e._numLiteralPosStateBits)*9+e._numLiteralContextBits<<24>>24;for(n=0;n<4;++n)e.properties[1+n]=e._dictionarySize>>8*n<<24>>24;mt(t,e.properties,0,5)}function Zr(e,t){var n;if(!e._writeEndMark)return;Zi(e._rangeEncoder,e._isMatch,(e._state<<4)+t,1),Zi(e._rangeEncoder,e._isRep,e._state,0),e._state=e._state<7?7:10,li(e._lenEncoder,e._rangeEncoder,0,t),n=Kn(2),Fi(e._posSlotEncoder[n],e._rangeEncoder,63),es(e._rangeEncoder,67108863,26),qi(e._posAlignEncoder,e._rangeEncoder,15)}function ei(e){return e<2048?Gs[e]:e<2097152?Gs[e>>10]+20:Gs[e>>20]+40}function ti(e){return e<131072?Gs[e>>6]+12:e<134217728?Gs[e>>16]+32:Gs[e>>26]+52}function ni(){return Uo}function ri(){}function ii(e,t,n,r){n<8?(Zi(t,e._choice,0,0),Fi(e._lowCoder[r],t,n)):(n-=8,Zi(t,e._choice,0,1),n<8?(Zi(t,e._choice,1,0),Fi(e._midCoder[r],t,n)):(Zi(t,e._choice,1,1),Fi(e._highCoder,t,n-8)))}function si(e){var t;e._choice=y(Mo,0,-1,2,1),e._lowCoder=y(Io,0,8,16,0),e._midCoder=y(Io,0,8,16,0),e._highCoder=ji(new Xi,8);for(t=0;t<16;++t)e._lowCoder[t]=ji(new Xi,3),e._midCoder[t]=ji(new Xi,3);return e}function oi(e,t){var n;os(e._choice);for(n=0;n<t;++n)Ki(e._lowCoder[n].Models),Ki(e._midCoder[n].Models);Ki(e._highCoder.Models)}function ui(e,t,n,r,i){var s,o,u,a,f;s=(Yi(),Ys[e._choice[0]>>>2]),o=Ys[2048-e._choice[0]>>>2],u=o+Ys[e._choice[1]>>>2],a=o+Ys[2048-e._choice[1]>>>2],f=0;for(f=0;f<8;++f){if(f>=n)return;r[i+f]=s+Ii(e._lowCoder[t],f)}for(;f<16;++f){if(f>=n)return;r[i+f]=u+Ii(e._midCoder[t],f-8)}for(;f<n;++f)r[i+f]=a+Ii(e._highCoder,f-8-8)}function ai(){return Vo}function fi(){}function li(e,t,n,r){ii(e,t,n,r),--e._counters[r]==0&&(ui(e,r,e._tableSize,e._prices,r*272),e._counters[r]=e._tableSize)}function ci(e){return si(e),e._prices=y(xo,0,-1,4352,1),e._counters=y(xo,0,-1,16,1),e}function hi(e,t,n){return e._prices[n*272+t]}function pi(e,t){var n;for(n=0;n<t;++n)ui(e,n,e._tableSize,e._prices,n*272),e._counters[n]=e._tableSize}function di(){return $o}function vi(){}function mi(e,t,n){var r,i;if(e.m_Coders!=null&&e.m_NumPrevBits==n&&e.m_NumPosBits==t)return;e.m_NumPosBits=t,e.m_PosMask=(1<<t)-1,e.m_NumPrevBits=n,i=1<<e.m_NumPrevBits+e.m_NumPosBits,e.m_Coders=y(zo,0,5,i,0);for(r=0;r<i;++r)e.m_Coders[r]=xi(new Ci)}function gi(e,t,n){return e.m_Coders[((t&e.m_PosMask)<<e.m_NumPrevBits)+((n&255)>>>8-e.m_NumPrevBits)]}function yi(e){var t,n;n=1<<e.m_NumPrevBits+e.m_NumPosBits;for(t=0;t<n;++t)os(e.m_Coders[t].m_Encoders)}function bi(){return Wo}function wi(){}function Ei(e,t,n){var r,i,s;i=1;for(s=7;s>=0;--s)r=n>>s&1,Zi(t,e.m_Encoders,i,r),i=i<<1|r}function Si(e,t,n,r){var i,s,o,u,a,f;s=1,a=!0;for(o=7;o>=0;--o)i=r>>o&1,f=s,a&&(u=n>>o&1,f+=1+u<<8,a=u==i),Zi(t,e.m_Encoders,f,i),s=s<<1|i}function xi(e){return e.m_Encoders=y(Mo,0,-1,768,1),e}function Ti(e,t,n,r){var i,s,o,u,a;a=0,s=1,o=7;if(t)for(;o>=0;--o){u=n>>o&1,i=r>>o&1,a+=ss(e.m_Encoders[(1+u<<8)+s],i),s=s<<1|i;if(u!=i){--o;break}}for(;o>=0;--o)i=r>>o&1,a+=ss(e.m_Encoders[s],i),s=s<<1|i;return a}function Ni(){return Xo}function Ci(){}function ki(e){e.BackPrev=-1,e.Prev1IsChar=!1}function Li(e){e.BackPrev=0,e.Prev1IsChar=!1}function Ai(){return Jo}function Oi(){}function Mi(e,t){return e.NumBitLevels=t,e.Models=y(Mo,0,-1,1<<t,1),e}function _i(e,t){var n,r;r=1;for(n=e.NumBitLevels;n!=0;--n)r=(r<<1)+Vi(t,e.Models,r);return r-(1<<e.NumBitLevels)}function Di(e,t){var n,r,i,s;i=1,s=0;for(r=0;r<e.NumBitLevels;++r)n=Vi(t,e.Models,i),i<<=1,i+=n,s|=n<<r;return s}function Pi(e,t,n,r){var i,s,o,u;o=1,u=0;for(s=0;s<r;++s)i=Vi(n,e,t+o),o<<=1,o+=i,u|=i<<s;return u}function Hi(){return Ko}function Bi(){}function ji(e,t){return e.NumBitLevels=t,e.Models=y(Mo,0,-1,1<<t,1),e}function Fi(e,t,n){var r,i,s;s=1;for(i=e.NumBitLevels;i!=0;)--i,r=n>>>i&1,Zi(t,e.Models,s,r),s=s<<1|r}function Ii(e,t){var n,r,i,s;s=0,i=1;for(r=e.NumBitLevels;r!=0;)--r,n=t>>>r&1,s+=ss(e.Models[i],n),i=(i<<1)+n;return s}function qi(e,t,n){var r,i,s;s=1;for(i=0;i<e.NumBitLevels;++i)r=n&1,Zi(t,e.Models,s,r),s=s<<1|r,n>>=1}function Ri(e,t){var n,r,i,s;s=0,i=1;for(r=e.NumBitLevels;r!=0;--r)n=t&1,t>>>=1,s+=ss(e.Models[i],n),i=i<<1|n;return s}function Ui(e,t,n,r,i){var s,o,u;u=1;for(o=0;o<r;++o)s=i&1,Zi(n,e,t+u,s),u=u<<1|s,i>>=1}function zi(e,t,n,r){var i,s,o,u;u=0,o=1;for(s=n;s!=0;--s)i=r&1,r>>>=1,u+=(Yi(),Ys[((e[t+o]-i^-i)&2047)>>>2]),o=o<<1|i;return u}function Wi(){return Qo}function Xi(){}function Vi(e,t,n){var r,i;return i=t[n],r=(e.Range>>>11)*i,(e.Code^-2147483648)<(r^-2147483648)?(e.Range=r,t[n]=i+(2048-i>>>5)<<16>>16,(e.Range&-16777216)==0&&(e.Code=e.Code<<8|ot(e.Stream),e.Range<<=8),0):(e.Range-=r,e.Code-=r,t[n]=i-(i>>>5)<<16>>16,(e.Range&-16777216)==0&&(e.Code=e.Code<<8|ot(e.Stream),e.Range<<=8),1)}function $i(e,t){var n,r,i;r=0;for(n=t;n!=0;--n)e.Range>>>=1,i=e.Code-e.Range>>>31,e.Code-=e.Range&i-1,r=r<<1|1-i,(e.Range&-16777216)==0&&(e.Code=e.Code<<8|ot(e.Stream),e.Range<<=8);return r}function Ji(e){var t;e.Code=0,e.Range=-1;for(t=0;t<5;++t)e.Code=e.Code<<8|ot(e.Stream)}function Ki(e){var t;for(t=0;t<e.length;++t)e[t]=1024}function Qi(){return Go}function Gi(){}function Yi(){Yi=ws;var e,t,n,r;Ys=y(xo,0,-1,512,1);for(t=8;t>=0;--t){r=1<<9-t-1,e=1<<9-t;for(n=r;n<e;++n)Ys[n]=(t<<6)+(e-n<<6>>>9-t-1)}}function Zi(e,t,n,r){var i,s;s=t[n],i=(e.Range>>>11)*s,r==0?(e.Range=i,t[n]=s+(2048-s>>>5)<<16>>16):(e.Low=M(e.Low,D(I(i),Bs)),e.Range-=i,t[n]=s-(s>>>5)<<16>>16),(e.Range&-16777216)==0&&(e.Range<<=8,is(e))}function es(e,t,n){var r;for(r=n-1;r>=0;--r)e.Range>>>=1,(t>>>r&1)==1&&(e.Low=M(e.Low,I(e.Range))),(e.Range&-16777216)==0&&(e.Range<<=8,is(e))}function ts(e){var t;for(t=0;t<5;++t)is(e)}function ns(e){return M(M(I(e._cacheSize),e._position),Ms)}function rs(e){e._position=As,e.Low=As,e.Range=-1,e._cacheSize=1,e._cache=0}function is(e){var t,n;t=R(K(e.Low,32));if(t!=0||P(e.Low,Hs)<0){e._position=M(e._position,I(e._cacheSize)),n=e._cache;do vt(e.Stream,n+t),n=255;while(--e._cacheSize!=0);e._cache=R(e.Low)>>>24}++e._cacheSize,e.Low=$(D(e.Low,Ds),8)}function ss(e,t){return Yi(),Ys[((e-t^-t)&2047)>>>2]}function os(e){Yi();var t;for(t=0;t<e.length;++t)e[t]=1024}function us(){return Yo}function as(){}function fs(e){var t,n,r,i,s;t=Gt(new Zt);for(n=0;n<e.length;++n){r=e[n]&255;if((r&128)==0){if(r==0)throw jt(new It,"invalid UTF-8");d(t.data,String.fromCharCode(r&65535))}else if((r&224)==192){if(n+1>=e.length)throw jt(new It,"invalid UTF-8");i=e[++n]&255;if((i&192)!=128)throw jt(new It,"invalid UTF-8");p(t.data,String.fromCharCode((r&31)<<6&65535|i&63))}else{if((r&240)!=224)throw jt(new It,"invalid UTF-8");if(n+2>=e.length)throw jt(new It,"invalid UTF-8");i=e[++n]&255;if((i&192)!=128)throw jt(new It,"invalid UTF-8");s=e[++n]&255;if((s&192)!=128)throw jt(new It,"invalid UTF-8");d(t.data,String.fromCharCode(((r&15)<<12|(i&63)<<6|s&63)&65535))}}return v(t.data)}function ls(e){var t,n,r,i,s,o,u;n=(u=e.length,o=y(go,0,-1,u,1),Kt(e,0,u,o,0),o),i=0;for(s=0;s<e.length;++s)t=n[s],t>=1&&t<=127?++i:t==0||t>=128&&t<=2047?i+=2:i+=3;r=y(fo,0,-1,i,1),i=0;for(s=0;s<e.length;++s)t=n[s],t>=1&&t<=127?r[i++]=t<<24>>24:t==0||t>=128&&t<=2047?(r[i++]=(192|t>>6&31)<<24>>24,r[i++]=(128|t&63)<<24>>24):(r[i++]=(224|t>>12&15)<<24>>24,r[i++]=(128|t>>6&63)<<24>>24,r[i++]=(128|t&63)<<24>>24);return r}function cs(e){return e}function hs(e){return e[1]+e[0]}function ps(){function t(){var s;i=(new Date).getTime();while(sn(n.c)){r=hs(n.c.chunker.inBytesProcessed)/hs(n.c.length_0);if((new Date).getTime()-i>200)return f?f(r):typeof u!="undefined"&&e(r,u),setTimeout(t,0),!1}f?f(1):typeof u!="undefined"&&e(1,u),s=dt(n.c.output).slice(0),a?a(s):typeof u!="undefined"&&postMessage({action:Es,callback_num:u,result:s})}var n=cs(new gs),r,i,s=arguments[0],o=arguments[1],u,a,f;typeof arguments[2]=="function"?(a=arguments[2],typeof arguments[3]=="function"&&(f=arguments[3])):u=arguments[2],n.mode=su(o),n.c=fn(new cn,ls(s),n.mode),f?f(0):typeof u!="undefined"&&e(0,u),setTimeout(t,1)}function ds(){function t(){var i;s=(new Date).getTime();while(hn(n.d)){r=hs(n.d.chunker.decoder.nowPos64)/hs(n.d.length_0);if((new Date).getTime()-s>200)return l?l(r):typeof a!="undefined"&&e(r,a),setTimeout(t,0),!1}l?l(1):typeof a!="undefined"&&e(1,a),i=fs(dt(n.d.output)),f?f(i):typeof a!="undefined"&&postMessage({action:Ss,callback_num:a,result:i})}var n=cs(new gs),r,i,s,o,u=arguments[0],a,f,l;typeof arguments[1]=="function"?(f=arguments[1],typeof arguments[2]=="function"&&(l=arguments[2])):a=arguments[1],i=b(fo,0,-1,u),n.d=mn(new yn,i),l?l(0):typeof a!="undefined"&&e(0,a),setTimeout(t,0)}function vs(e){ps(e),ds(e)}function ms(){return iu}function gs(){}function ys(){!!$stats&&$stats({moduleName:Ts,subSystem:"startup",evtGroup:"moduleStartup",millis:(new Date).getTime(),type:"onModuleLoadStart",className:"org.dellroad.lzma.demo.client.LZMADemo"})}function bs(e,t,n){Ts=t,Ns=n;if(e)try{ys()}catch(r){e(t)}else ys()}function ws(){}var Es=1,Ss=2,xs=3,Ts,Ns,Cs,ks=[0,-0x8000000000000000],Ls=[4294967295,-4294967296],As=[0,0],Os=[1,0],Ms=[4,0],_s=[4096,0],Ds=[16777215,0],Ps=[16777216,0],Hs=[4278190080,0],Bs=[4294967295,0],js=[4294967295,0x7fffffff00000000];Cs=n.prototype={},Cs.getClass$=t,Cs.typeMarker$=ws,Cs.typeId$=1,Cs=i.prototype=new n,Cs.getClass$=r,Cs.typeId$=3,Cs.detailMessage=null,Cs=o.prototype=new i,Cs.getClass$=s,Cs.typeId$=4,Cs=f.prototype=new o,Cs.getClass$=a,Cs.typeId$=5,Cs=h.prototype=new f,Cs.getClass$=c,Cs.typeId$=6,Cs=E.prototype=new n,Cs.getClass$=g,Cs.typeId$=0,Cs.arrayClass$=null,Cs.length=0,Cs.queryId$=0;var Fs,Is,qs=[{},{},{1:1},{2:1},{2:1},{2:1},{2:1},{2:1,10:1},{2:1},{2:1},{2:1},{2:1},{2:1},{2:1,11:1},{2:1},{2:1},{2:1},{4:1},{5:1},{6:1},{7:1},{8:1},{9:1}],Rs,Us,zs,Ws,Xs,Vs,$s,Js,Ks;Cs=rt.prototype=new n,Cs.getClass$=nt,Cs.typeId$=0,Cs=ft.prototype=new rt,Cs.getClass$=at,Cs.typeId$=0,Cs.buf=null,Cs.count=0,Cs.pos=0,Cs=ct.prototype=new n,Cs.getClass$=lt,Cs.typeId$=0,Cs=yt.prototype=new ct,Cs.getClass$=gt,Cs.typeId$=0,Cs.buf=null,Cs.count=0,Cs=Et.prototype=new o,Cs.getClass$=wt,Cs.typeId$=7,Cs=Tt.prototype=new f,Cs.getClass$=xt,Cs.typeId$=8,Cs=kt.prototype=new f,Cs.getClass$=Ct,Cs.typeId$=9,Cs=_t.prototype=new n,Cs.getClass$=Mt,Cs.typeId$=0,Cs.typeName=null,Cs=Pt.prototype=new f,Cs.getClass$=Dt,Cs.typeId$=12,Cs=Bt.prototype=new n,Cs.getClass$=Ht,Cs.typeId$=0,Cs=It.prototype=new f,Cs.getClass$=Ft,Cs.typeId$=13,Cs=Rt.prototype=new f,Cs.getClass$=qt,Cs.typeId$=14,Cs=zt.prototype=new f,Cs.getClass$=Ut,Cs.typeId$=15,Cs=$t.prototype=new f,Cs.getClass$=Vt,Cs.typeId$=16,Cs=String.prototype,Cs.getClass$=Qt,Cs.typeId$=2,Cs=Zt.prototype=new n,Cs.getClass$=Yt,Cs.typeId$=0,Cs=rn.prototype=new Bt,Cs.getClass$=nn,Cs.typeId$=0,Cs.dictionarySize=0,Cs.fb=0,Cs.lc=0,Cs.lp=0,Cs.matchFinder=0,Cs.pb=0,Cs=an.prototype=new n,Cs.getClass$=un,Cs.typeId$=0,Cs.chunker=null,Cs=cn.prototype=new an,Cs.getClass$=ln,Cs.typeId$=0,Cs.output=null,Cs=vn.prototype=new n,Cs.getClass$=dn,Cs.typeId$=0,Cs.chunker=null,Cs.exception=null,Cs.length_0=As,Cs=yn.prototype=new vn,Cs.getClass$=gn,Cs.typeId$=0,Cs.output=null,Cs=Ln.prototype=new n,Cs.getClass$=kn,Cs.typeId$=0,Cs._blockSize=0,Cs._bufferBase=null,Cs._bufferOffset=0,Cs._keepSizeAfter=0,Cs._keepSizeBefore=0,Cs._pointerToLastSafePosition=0,Cs._pos=0,Cs._posLimit=0,Cs._stream=null,Cs._streamEndWasReached=!1,Cs._streamPos=0,Cs=Fn.prototype=new Ln,Cs.getClass$=jn,Cs.typeId$=0,Cs.HASH_ARRAY=!0,Cs._cutValue=255,Cs._cyclicBufferPos=0,Cs._cyclicBufferSize=0,Cs._hash=null,Cs._hashMask=0,Cs._hashSizeSum=0,Cs._matchMaxLen=0,Cs._son=null,Cs.kFixHashSize=66560,Cs.kMinMatchCheck=4,Cs.kNumHashDirectBytes=0;var Qs;Cs=Jn.prototype=new n,Cs.getClass$=$n,Cs.typeId$=0,Cs._buffer=null,Cs._pos=0,Cs._stream=null,Cs._streamPos=0,Cs._windowSize=0,Cs=rr.prototype=new n,Cs.getClass$=nr,Cs.typeId$=0,Cs.alive=!1,Cs.decoder=null,Cs.encoder=null,Cs=pr.prototype=new n,Cs.getClass$=hr,Cs.typeId$=0,Cs.m_DictionarySize=-1,Cs.m_DictionarySizeCheck=-1,Cs.m_PosStateMask=0,Cs.nowPos64=As,Cs.outSize=As,Cs.prevByte=0,Cs.rep0=0,Cs.rep1=0,Cs.rep2=0,Cs.rep3=0,Cs.state=0,Cs=br.prototype=new n,Cs.getClass$=yr,Cs.typeId$=0,Cs.m_NumPosStates=0,Cs=Tr.prototype=new n,Cs.getClass$=xr,Cs.typeId$=0,Cs.m_Coders=null,Cs.m_NumPosBits=0,Cs.m_NumPrevBits=0,Cs.m_PosMask=0,Cs=Ar.prototype=new n,Cs.getClass$=Lr,Cs.typeId$=17,Cs=ri.prototype=new n,Cs.getClass$=ni,Cs.typeId$=0,Cs._additionalOffset=0,Cs._alignPriceCount=0,Cs._dictionarySize=4194304,Cs._dictionarySizePrev=-1,Cs._distTableSize=44,Cs._finished=!1,Cs._inStream=null,Cs._longestMatchLength=0,Cs._longestMatchWasFound=!1,Cs._matchFinder=null,Cs._matchFinderType=1,Cs._matchPriceCount=0,Cs._needReleaseMFStream=!1,Cs._numDistancePairs=0,Cs._numFastBytes=32,Cs._numFastBytesPrev=-1,Cs._numLiteralContextBits=3,Cs._numLiteralPosStateBits=0,Cs._optimumCurrentIndex=0,Cs._optimumEndIndex=0,Cs._posStateBits=2,Cs._posStateMask=3,Cs._previousByte=0,Cs._state=0,Cs._writeEndMark=!1,Cs.backRes=0,Cs.nowPos64=As;var Gs;Cs=fi.prototype=new n,Cs.getClass$=ai,Cs.typeId$=0,Cs=vi.prototype=new fi,Cs.getClass$=di,Cs.typeId$=0,Cs._tableSize=0,Cs=wi.prototype=new n,Cs.getClass$=bi,Cs.typeId$=0,Cs.m_Coders=null,Cs.m_NumPosBits=0,Cs.m_NumPrevBits=0,Cs.m_PosMask=0,Cs=Ci.prototype=new n,Cs.getClass$=Ni,Cs.typeId$=18,Cs=Oi.prototype=new n,Cs.getClass$=Ai,Cs.typeId$=19,Cs.BackPrev=0,Cs.BackPrev2=0,Cs.Backs0=0,Cs.Backs1=0,Cs.Backs2=0,Cs.Backs3=0,Cs.PosPrev=0,Cs.PosPrev2=0,Cs.Prev1IsChar=!1,Cs.Prev2=!1,Cs.Price=0,Cs.State=0,Cs=Bi.prototype=new n,Cs.getClass$=Hi,Cs.typeId$=20,Cs.Models=null,Cs.NumBitLevels=0,Cs=Xi.prototype=new n,Cs.getClass$=Wi,Cs.typeId$=21,Cs.Models=null,Cs.NumBitLevels=0,Cs=Gi.prototype=new n,Cs.getClass$=Qi,Cs.typeId$=0,Cs.Code=0,Cs.Range=0,Cs.Stream=null,Cs=as.prototype=new n,Cs.getClass$=us,Cs.typeId$=0,Cs.Low=As,Cs.Range=0,Cs.Stream=null,Cs._cache=0,Cs._cacheSize=0,Cs._position=As;var Ys;Cs=gs.prototype=new n,Cs.getClass$=ms,Cs.typeId$=0,Cs.c=null,Cs.d=null;var Zs,eo=At("java.lang.","Object"),to=At("java.lang.","Throwable"),no=At("java.lang.","Exception"),ro=At("java.lang.","RuntimeException"),io=At("com.google.gwt.core.client.","JavaScriptException"),so=At("com.google.gwt.core.client.","JavaScriptObject$"),oo=Lt("","[[D"),uo=At("java.io.","InputStream"),ao=At("java.io.","ByteArrayInputStream"),fo=Lt("","[B"),lo=At("java.io.","OutputStream"),co=At("java.io.","ByteArrayOutputStream"),ho=At("java.io.","IOException"),po=At("java.lang.","Enum"),vo=At("java.lang.","ArithmeticException"),mo=At("java.lang.","ArrayStoreException"),go=Lt("","[C"),yo=At("java.lang.","Class"),bo=At("java.lang.","ClassCastException"),wo=At("java.lang.","IllegalArgumentException"),Eo=At("java.lang.","IllegalStateException"),So=At("java.lang.","IndexOutOfBoundsException"),xo=Lt("","[I"),To=At("java.lang.","NullPointerException"),No=At("java.lang.","String"),Co=At("java.lang.","StringBuilder"),ko=At("org.dellroad.lzma.client.SevenZip.Compression.LZ.","InWindow"),Lo=At("org.dellroad.lzma.client.SevenZip.Compression.LZ.","BinTree"),Ao=At("org.dellroad.lzma.client.SevenZip.Compression.LZ.","OutWindow"),Oo=At("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Chunker"),Mo=Lt("","[S"),_o=Lt("[Lorg.dellroad.lzma.client.SevenZip.Compression.RangeCoder.","BitTreeDecoder;"),Do=At("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Decoder"),Po=At("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Decoder$LenDecoder"),Ho=Lt("[Lorg.dellroad.lzma.client.SevenZip.Compression.LZMA.","Decoder$LiteralDecoder$Decoder2;"),Bo=At("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Decoder$LiteralDecoder"),jo=At("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Decoder$LiteralDecoder$Decoder2"),Fo=Lt("[Lorg.dellroad.lzma.client.SevenZip.Compression.LZMA.","Encoder$Optimal;"),Io=Lt("[Lorg.dellroad.lzma.client.SevenZip.Compression.RangeCoder.","BitTreeEncoder;"),qo=Lt("","[J"),Ro=Lt("","[Z"),Uo=At("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Encoder"),zo=Lt("[Lorg.dellroad.lzma.client.SevenZip.Compression.LZMA.","Encoder$LiteralEncoder$Encoder2;"),Wo=At("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Encoder$LiteralEncoder"),Xo=At("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Encoder$LiteralEncoder$Encoder2"),Vo=At("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Encoder$LenEncoder"),$o=At("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Encoder$LenPriceTableEncoder"),Jo=At("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Encoder$Optimal"),Ko=At("org.dellroad.lzma.client.SevenZip.Compression.RangeCoder.","BitTreeDecoder"),Qo=At("org.dellroad.lzma.client.SevenZip.Compression.RangeCoder.","BitTreeEncoder"),Go=At("org.dellroad.lzma.client.SevenZip.Compression.RangeCoder.","Decoder"),Yo=At("org.dellroad.lzma.client.SevenZip.Compression.RangeCoder.","Encoder"),Zo=Ot("org.dellroad.lzma.client.","CompressionMode"),eu=At("org.dellroad.lzma.client.","LZMACompressor"),tu=At("org.dellroad.lzma.client.","LZMAByteArrayCompressor"),nu=At("org.dellroad.lzma.client.","LZMADecompressor"),ru=At("org.dellroad.lzma.client.","LZMAByteArrayDecompressor"),iu=At("org.dellroad.lzma.demo.client.","LZMADemo");bs(function(){},"lzma_demo","");var su=function(){function e(e){return!isNaN(parseFloat(e))&&isFinite(e)}var t=[{dictionarySize:16,fb:64,matchFinder:0,lc:3,lp:0,pb:2},{dictionarySize:20,fb:64,matchFinder:0,lc:3,lp:0,pb:2},{dictionarySize:19,fb:64,matchFinder:1,lc:3,lp:0,pb:2},{dictionarySize:20,fb:64,matchFinder:1,lc:3,lp:0,pb:2},{dictionarySize:21,fb:128,matchFinder:1,lc:3,lp:0,pb:2},{dictionarySize:22,fb:128,matchFinder:1,lc:3,lp:0,pb:2},{dictionarySize:23,fb:128,matchFinder:1,lc:3,lp:0,pb:2},{dictionarySize:24,fb:255,matchFinder:1,lc:3,lp:0,pb:2},{dictionarySize:25,fb:255,matchFinder:1,lc:3,lp:0,pb:2}];return function(n){return e(n)?n<1?n=1:n>9&&(n=9):n=1,t[n-1]}}();return{compress:ps,decompress:ds}}();this.LZMA=LZMA,root.Mustache=Mustache,function(){function GeometryView(){}function Map(e){var t=this;this.options=_.defaults(e,{ajax:window.$?window.$.ajax:reqwest.compat,pngParams:["map_key","api_key","cache_policy","updated_at"],gridParams:["map_key","api_key","cache_policy","updated_at"],cors:this.isCORSSupported(),btoa:this.isBtoaSupported()?this._encodeBase64Native:this._encodeBase64,MAX_GET_SIZE:2033,force_cors:!1}),this.layerToken=null,this.urls=null,this.silent=!1,this.interactionEnabled=[],this._layerTokenQueue=[],this._timeout=-1,this._queue=[],this._waiting=!1,this.lastTimeUpdated=null,this._refreshTimer=-1}function NamedMap(e,t){var n=this;Map.call(this,t),this.options.pngParams.push("auth_token"),this.options.gridParams.push("auth_token"),this.endPoint=Map.BASE_URL+"/named/"+e.name,this.JSONPendPoint=Map.BASE_URL+"/named/"+e.name+"/jsonp",this.layers=_.clone(e.layers)||[];for(var r=0;r<this.layers.length;++r){var i=this.layers[r];i.options=i.options||{hidden:!1},i.options.layer_name=i.layer_name}this.named_map=e;var s=e.auth_token||t.auth_token;s&&this.setAuthToken(s)}function LayerDefinition(e,t){var n=this;Map.call(this,t),this.endPoint=Map.BASE_URL,this.setLayerDefinition(e,{silent:!0})}function SubLayer(e,t){this._parent=e,this._position=t,this._added=!0,this._bindInteraction(),this.infowindow=new Backbone.Model(this._parent.getLayer(this._position).infowindow),this.infowindow.bind("change",function(){var e=this._parent.getLayer(this._position);e.infowindow=this.infowindow.toJSON(),this._parent.setLayer(this._position,e)},this)}function CartoDBLayerCommon(){}var $=root.$,jQuery=root.jQuery,L=root.L,Mustache=root.Mustache,Backbone=root.Backbone,_=root._;(function(){var e=this,t=e.cdb={};t.VERSION="3.8.09",t.DEBUG=!1,t.CARTOCSS_VERSIONS={"2.0.0":"","2.1.0":""},t.CARTOCSS_DEFAULT_VERSION="2.1.1",t.CDB_HOST={http:"api.cartocdn.com",https:"cartocdn.global.ssl.fastly.net"},e.cdb.config={},e.cdb.core={},e.cdb.geo={},e.cdb.geo.ui={},e.cdb.geo.geocoder={},e.cdb.ui={},e.cdb.ui.common={},e.cdb.vis={},e.cdb.decorators={},e.JST=e.JST||{},e.cartodb=t,t.files=["../vendor/jquery.min.js","../vendor/underscore-min.js","../vendor/json2.js","../vendor/backbone.js","../vendor/leaflet.js","../vendor/wax.cartodb.js","../vendor/GeoJSON.js","../vendor/jscrollpane.js","../vendor/mousewheel.js","../vendor/mwheelIntent.js","../vendor/spin.js","../vendor/lzma.js","core/decorator.js","core/config.js","core/log.js","core/profiler.js","core/template.js","core/model.js","core/view.js","geo/geocoder.js","geo/geometry.js","geo/map.js","geo/ui/zoom.js","geo/ui/zoom_info.js","geo/ui/mobile.js","geo/ui/legend.js","geo/ui/switcher.js","geo/ui/infowindow.js","geo/ui/header.js","geo/ui/search.js","geo/ui/layer_selector.js","geo/ui/tiles_loader.js","geo/ui/infobox.js","geo/ui/tooltip.js","geo/ui/fullscreen.js","geo/layer_definition.js","geo/common.js","geo/leaflet/leaflet_base.js","geo/leaflet/leaflet_plainlayer.js","geo/leaflet/leaflet_tiledlayer.js","geo/leaflet/leaflet_wmslayer.js","geo/leaflet/leaflet_cartodb_layergroup.js","geo/leaflet/leaflet_cartodb_layer.js","geo/leaflet/leaflet.js","geo/gmaps/gmaps_base.js","geo/gmaps/gmaps_baselayer.js","geo/gmaps/gmaps_plainlayer.js","geo/gmaps/gmaps_tiledlayer.js","geo/gmaps/gmaps_cartodb_layergroup.js","geo/gmaps/gmaps_cartodb_layer.js","geo/gmaps/gmaps.js","ui/common/dialog.js","ui/common/share.js","ui/common/notification.js","ui/common/table.js","ui/common/dropdown.js","vis/vis.js","vis/overlays.js","vis/layers.js","api/layers.js","api/sql.js","api/vis.js"],t.init=function(n){var r=t.Class=function(){};_.extend(r.prototype,Backbone.Events),t._loadJST(),e.cdb.god=new Backbone.Model,n&&n()},t.load=function(e,n){var r=0,i=function(){var s=document.createElement("script");s.src=e+t.files[r],document.body.appendChild(s),++r,r==t.files.length?n&&(s.onload=n):s.onload=i};i()}})(),cdb.decorators.elder=function(){var e=Backbone.Router.extend,t=function(e,t){var n=null;if(this.parent!=null){var r=this.parent;this.parent=this.parent.parent;var t=Array.prototype.slice.call(arguments,1);r.hasOwnProperty(e)?n=r[e].apply(this,t):(t.splice(0,0,e),n=r.elder.apply(this,t)),this.parent=r}return n},n=function(n,r){var i=e.call(this,n,r);return i.prototype.parent=this.prototype,i.prototype.elder=function(e){var n=Array.prototype.slice.call(arguments,1);return e?(n.splice(0,0,e),t.apply(this,n)):i.prototype.parent},i},r=function(e){e.extend=n,e.prototype.elder=function(){},e.prototype.parent=null};return r}(),cdb.decorators.elder(Backbone.Model),cdb.decorators.elder(Backbone.View),cdb.decorators.elder(Backbone.Collection),window.JSON||(window.JSON={stringify:function(e){if(typeof e=="number"||typeof e=="boolean")return e.toString();if(typeof e=="string")return'"'+e.toString()+'"';if(_.isArray(e)){var t="[";for(var n in e)n>0&&(t+=", "),t+=JSON.stringify(e[n]);return t+="]",t}var t="{";for(var r in e)e.hasOwnProperty(r)&&(t+='"'+r+'": '+JSON.stringify(e[r]));return t+="}",t},parse:function(param){return eval(param)}}),function(){Config=Backbone.Model.extend({VERSION:2,initialize:function(){this.modules=new Backbone.Collection,this.modules.bind("add",function(e){this.trigger("moduleLoaded")},this)},REPORT_ERROR_URL:"/api/v0/error",ERROR_TRACK_ENABLED:!1,getSqlApiUrl:function(){var e=this.get("sql_api_protocol")+"://"+this.get("user_name")+"."+this.get("sql_api_domain")+":"+this.get("sql_api_port");return e}}),cdb.config=new Config,cdb.config.set({cartodb_attributions:"CartoDB <a href='http://cartodb.com/attributions' target='_blank'>attribution</a>",cartodb_logo_link:"http://www.cartodb.com"})}(),function(){cdb.core.Error=Backbone.Model.extend({url:cdb.config.REPORT_ERROR_URL,initialize:function(){this.set({browser:JSON.stringify($.browser)})}}),cdb.core.ErrorList=Backbone.Collection.extend({model:cdb.core.Error,enableTrack:function(){var e=window.onerror;window.onerror=function(t,n,r){cdb.errors.create({msg:t,url:n,line:r}),e&&e.apply(window,arguments)}}}),cdb.errors=new cdb.core.ErrorList,cdb.config.ERROR_TRACK_ENABLED&&cdb.errors.enableTrack();var e=function(){};e.prototype.error=function(){},e.prototype.log=function(){};if(typeof console!="undefined"){_console=console;try{_console.log.apply(_console,["cartodb.js "+cartodb.VERSION])}catch(t){_console=new e}}else _console=new e;cdb.core.Log=Backbone.Model.extend({error:function(){_console.error.apply(_console,arguments),cdb.config.ERROR_TRACK_ENABLED&&cdb.errors.create({msg:Array.prototype.slice.call(arguments).join("")})},log:function(){_console.log.apply(_console,arguments)},info:function(){_console.log.apply(_console,arguments)},debug:function(){_console.log.apply(_console,arguments)}})}(),cdb.log=new cdb.core.Log({tag:"cdb"}),function(e){function t(){}function n(e){this.t0=null,this.name=e,this.count=0}var r=1024;t.metrics={},t._backend=null,t.get=function(e){return t.metrics[e]||{max:0,min:Number.MAX_VALUE,avg:0,total:0,count:0,last:0,history:typeof Float32Array!="undefined"?new Float32Array(r):[]}},t.backend=function(e){t._backend=e},t.new_value=function(e,n,i,s){i=i||"i";var o=t.metrics[e]=t.get(e);o.max=Math.max(o.max,n),o.min=Math.min(o.min,n),o.total+=n,++o.count,o.avg=o.total/o.count,o.history[o.count%r]=n;if(!s)t._backend&&t._backend([i,e,n]);else{var u=(new Date).getTime();u-o.last>1e3&&(t._backend&&t._backend([i,e,o.avg]),o.last=u)}},t.print_stats=function(){for(k in t.metrics){var e=t.metrics[k];console.log(" === "+k+" === "),console.log(" max: "+e.max),console.log(" min: "+e.min),console.log(" avg: "+e.avg),console.log(" count: "+e.count),console.log(" total: "+e.total)}},n.prototype={start:function(){return this.t0=+(new Date),this},_elapsed:function(){return+(new Date)-this.t0},end:function(e){this.t0!==null&&(t.new_value(this.name,this._elapsed(),"t",e),this.t0=null)},inc:function(e){e=e===undefined?1:e,t.new_value(this.name,e,"i")},dec:function(e){e=e===undefined?1:e,t.new_value(this.name,e,"d")},mark:function(){++this.count;if(this.t0===null){this.start();return}var e=this._elapsed();e>1&&(t.new_value(this.name,this.count),this.count=0,this.start())}},t.metric=function(e){return new n(e)},e.Profiler=t}(cdb.core),cdb.core.Template=Backbone.Model.extend({initialize:function(){this.bind("change",this._invalidate),this._invalidate()},url:function(){return this.get("template_url")},parse:function(e){return{template:e}},_invalidate:function(){this.compiled=null,this.get("template_url")&&this.fetch()},compile:function(){var e=this.get("type")||"underscore",t=cdb.core.Template.compilers[e];return t?t(this.get("template")):(cdb.log.error("can't get rendered for "+e),null)},render:function(e){var t=this.compiled=this.compiled||this.get("compiled")||this.compile(),n=cdb.core.Profiler.metric("template_render");n.start();var r=t(e);return n.end(),r},asFunction:function(){return _.bind(this.render,this)}},{compilers:{underscore:_.template,mustache:typeof Mustache=="undefined"?null:Mustache.compile},compile:function(e,t){var n=new cdb.core.Template({template:e,type:t||"underscore"});return _.bind(n.render,n)}}),cdb.core.TemplateList=Backbone.Collection.extend({model:cdb.core.Template,getTemplate:function(e){this.namespace&&(e=this.namespace+e);var t=this.find(function(t){return t.get("name")===e});return t?_.bind(t.render,t):(cdb.log.error(e+" not found"),null)}}),cdb.templates=new cdb.core.TemplateList,cdb._loadJST=function(){typeof window.JST!==undefined&&cdb.templates.reset(_(JST).map(function(e,t){return{name:t,compiled:e}}))},function(){cdb._debugCallbacks=function(e){var t=e._callbacks;for(var n in t){var r=t[n];console.log(" * ",n);var i=r.tail;while((r=r.next)!==i)console.log("    - ",r.context,r.context&&r.context.el||"none")}};var e=cdb.core.Model=Backbone.Model.extend({initialize:function(e){return _.bindAll(this,"fetch","save","retrigger"),Backbone.Model.prototype.initialize.call(this,e)},fetch:function(e){var t=this;this.trigger("loadModelStarted"),$.when(this.elder("fetch",e)).done(function(e){t.trigger("loadModelCompleted",e)}).fail(function(e){t.trigger("loadModelFailed",e)})},setIdAttribute:function(e){this.idAttribute=e},retrigger:function(e,t,n){n||(n=e);var r=this;t.bind&&t.bind(e,function(){r.trigger(n)},r)},save:function(e,t){var n=this;return(!t||!t.silent)&&this.trigger("saving"),$promise=Backbone.Model.prototype.save.call(this,e,t),$.when($promise).done(function(){(!t||!t.silent)&&n.trigger("saved")}).fail(function(){(!t||!t.silent)&&n.trigger("errorSaving")}),$promise}})}(),function(){var e=cdb.core.View=Backbone.View.extend({classLabel:"cdb.core.View",constructor:function(t){this._models=[],this._subviews={},Backbone.View.call(this,t),e.viewCount++,e.views[this.cid]=this,this._created_at=new Date,cdb.core.Profiler.new_value("total_views",e.viewCount)},add_related_model:function(e){if(!e)throw"added non valid model";this._models.push(e)},addView:function(e){this._subviews[e.cid]=e,e._parent=this},removeView:function(e){delete this._subviews[e.cid]},clearSubViews:function(){_(this._subviews).each(function(e){e.clean()}),this._subviews={}},clean:function(){var t=this;return this.trigger("clean"),this.clearSubViews(),this._parent&&(this._parent.removeView(this),this._parent=null),this.remove(),this.unbind(),this.model&&this.model.unbind&&this.model.unbind(null,null,this),_(this._models).each(function(e){e.unbind(null,null,t)}),this._models=[],e.viewCount--,delete e.views[this.cid],this},getTemplate:function(e){return this.options.template?_.template(this.options.template):cdb.templates.getTemplate(e)},show:function(){this.$el.show()},hide:function(){this.$el.hide()},retrigger:function(e,t,n){n||(n=e);var r=this;t.bind&&t.bind(e,function(){r.trigger(n)},r),this.add_related_model(t)},killEvent:function(e){e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation()},cleanTooltips:function(){this.$(".tipsy").remove()}},{viewCount:0,views:{},extendEvents:function(e){return function(){return _.extend(e,this.constructor.__super__.events)}},runChecker:function(){_.each(cdb.core.View.views,function(e){_.each(e,function(t,n){n!=="_parent"&&e.hasOwnProperty(n)&&t instanceof cdb.core.View&&e._subviews[t.cid]===undefined&&(console.log("========="),console.log("untracked view: "),console.log(t.el),console.log("parent"),console.log(e.el),console.log(" "))})})}})}(),cdb.geo.geocoder.YAHOO={keys:{app_id:"nLQPTdTV34FB9L3yK2dCXydWXRv3ZKzyu_BdCSrmCBAM1HgGErsCyCbBbVP2Yg--"},geocode:function(e,t){e=e.toLowerCase().replace(/é/g,"e").replace(/á/g,"a").replace(/í/g,"i").replace(/ó/g,"o").replace(/ú/g,"u").replace(/ /g,"+");var n="";location.protocol.indexOf("http")===-1&&(n="http:"),$.getJSON(n+"//query.yahooapis.com/v1/public/yql?q="+encodeURIComponent('SELECT * FROM json WHERE url="http://where.yahooapis.com/geocode?q='+e+"&appid="+this.keys.app_id+'&flags=JX"')+"&format=json&callback=?",function(e){var n=[];if(e&&e.query&&e.query.results&&e.query.results.json&&e.query.results.json.ResultSet&&e.query.results.json.ResultSet.Found!="0"){var r;_.isArray(e.query.results.json.ResultSet.Results)?r=e.query.results.json.ResultSet.Results:r=[e.query.results.json.ResultSet.Results];for(var i in r){var s=r[i],o;o={lat:s.latitude,lon:s.longitude},s.boundingbox&&(o.boundingbox=s.boundingbox),n.push(o)}}t(n)})}},cdb.geo.geocoder.NOKIA={keys:{app_id:"KuYppsdXZznpffJsKT24",app_code:"A7tBPacePg9Mj_zghvKt9Q"},geocode:function(e,t){e=e.toLowerCase().replace(/é/g,"e").replace(/á/g,"a").replace(/í/g,"i").replace(/ó/g,"o").replace(/ú/g,"u").replace(/ /g,"+");var n="";location.protocol.indexOf("http")===-1&&(n="http:"),$.getJSON(n+"//places.nlp.nokia.com/places/v1/discover/search/?q="+encodeURIComponent(e)+"&app_id="+this.keys.app_id+"&app_code="+this.keys.app_code+"&Accept-Language=en-US&at=0,0&callback=?",function(e){var n=[];if(e&&e.results&&e.results.items&&e.results.items.length>0){var r=e.results.items;for(var i in r){var s=r[i],o;o={lat:s.position[0],lon:s.position[1]},s.bbox&&(o.boundingbox={north:s.bbox[3],south:s.bbox[1],east:s.bbox[2],west:s.bbox[0]}),n.push(o)}}t(n)})}},cdb.geo.Geometry=cdb.core.Model.extend({isPoint:function(){var e=this.get("geojson").type;return e&&e.toLowerCase()==="point"?!0:!1}}),cdb.geo.Geometries=Backbone.Collection.extend({}),_.extend(GeometryView.prototype,Backbone.Events,{edit:function(){throw new Error("to be implemented")}}),cdb.geo.MapLayer=cdb.core.Model.extend({defaults:{visible:!0,type:"Tiled"},isEqual:function(e){var t=this.toJSON(),n=e.toJSON(),r=["id","order"];_.each(r,function(e){delete t[e],delete n[e],t.options&&delete t.options[e],n.options&&delete n.options[e]});var i=t.type?t.type:t.options.type,s=n.type?n.type:n.options.type;if(i&&i===s){if(i==="Tiled"){var o=t.urlTemplate?t.urlTemplate:t.options.urlTemplate,u=n.urlTemplate?n.urlTemplate:n.options.urlTemplate;return o===u?!0:!1}if(i==="WMS"){var o=t.urlTemplate?t.urlTemplate:t.options.urlTemplate,u=n.urlTemplate?n.urlTemplate:n.options.urlTemplate,a=t.layers?t.layers:t.options.layers,f=n.layers?n.layers:n.options.layers;return o===u&&a===f?!0:!1}var l=t.base_type?t.base_type:t.options.base_type,c=n.base_type?n.base_type:n.options.base_type;return l?_.isEqual(t,n)?!0:!1:!0}return!1}}),cdb.geo.TileLayer=cdb.geo.MapLayer.extend({getTileLayer:function(){}}),cdb.geo.GMapsBaseLayer=cdb.geo.MapLayer.extend({OPTIONS:["roadmap","satellite","terrain","custom"],defaults:{type:"GMapsBase",base_type:"gray_roadmap",style:null}}),cdb.geo.WMSLayer=cdb.geo.MapLayer.extend({defaults:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1}}),cdb.geo.PlainLayer=cdb.geo.MapLayer.extend({defaults:{type:"Plain",base_type:"plain",className:"plain",color:"#FFFFFF",image:""}}),cdb.geo.TorqueLayer=cdb.geo.MapLayer.extend({defaults:{type:"torque",visible:!0}}),cdb.geo.CartoDBLayer=cdb.geo.MapLayer.extend({defaults:{attribution:"CartoDB",type:"CartoDB",active:!0,query:null,opacity:.99,interactivity:null,interaction:!0,debug:!1,tiler_domain:"cartodb.com",tiler_port:"80",tiler_protocol:"http",sql_api_domain:"cartodb.com",sql_api_port:"80",sql_api_protocol:"http",extra_params:{},cdn_url:null,maxZoom:28},activate:function(){this.set({active:!0,opacity:.99,visible:!0})},deactivate:function(){this.set({active:!1,opacity:0,visible:!1})},invalidate:function(){var e=this.get("extra_params")||e;e.cache_buster=(new Date).getTime(),this.set("extra_params",e),this.trigger("change",this)},toggle:function(){this.get("active")?this.deactivate():this.activate()}}),cdb.geo.CartoDBGroupLayer=cdb.geo.MapLayer.extend({defaults:{visible:!0,type:"layergroup"}}),cdb.geo.CartoDBNamedMapLayer=cdb.geo.MapLayer.extend({defaults:{visible:!0,type:"namedmap"}}),cdb.geo.Layers=Backbone.Collection.extend({model:cdb.geo.MapLayer,initialize:function(){this.comparator=function(e){return parseInt(e.get("order"),10)},this.bind("add",this._assignIndexes)},_assignIndexes:function(e,t,n){function r(e){var t=e.get("type");return i[t]||0}var i={torque:100},s=0;n&&n.at!==undefined&&(s=n.at),s===0&&(this.models[0].set({order:0}),++s);for(var o=s;o<this.size();++o){var u=this.models[o-1],a=u.get("order")-r(u);this.models[o].set({order:r(this.models[o])+a+1})}}}),cdb.geo.Map=cdb.core.Model.extend({defaults:{center:[0,0],zoom:3,minZoom:0,maxZoom:40,scrollwheel:!0,provider:"leaflet"},initialize:function(){this.layers=new cdb.geo.Layers,this.layers.bind("reset",function(){this.layers.size()>=1&&this._adjustZoomtoLayer(this.layers.models[0])},this),this.geometries=new cdb.geo.Geometries},setView:function(e,t){this.set({center:e,zoom:t},{silent:!0}),this.trigger("set_view")},setZoom:function(e){this.set({zoom:e})},enableScrollWheel:function(){this.set({scrollwheel:!0})},disableScrollWheel:function(){this.set({scrollwheel:!1})},getZoom:function(){return this.get("zoom")},setCenter:function(e){this.set({center:e})},setOptions:function(e){if(typeof e!="object"||e.length){if(this.options.debug)throw e+" options has to be an object";return}_.defaults(this.options,e)},getViewBounds:function(){return this.has("view_bounds_sw")&&this.has("view_bounds_ne")?[this.get("view_bounds_sw"),this.get("view_bounds_ne")]:null},getLayerAt:function(e){return this.layers.at(e)},getLayerByCid:function(e){return this.layers.getByCid(e)},_adjustZoomtoLayer:function(e){var t=e.get("maxZoom"),n=e.get("minZoom");_.isNumber(t)&&(this.get("zoom")>t?this.set({zoom:t,maxZoom:t}):this.set("maxZoom",t)),_.isNumber(n)&&(this.get("zoom")<n?this.set({minZoom:n,zoom:n}):this.set("minZoom",n))},addLayer:function(e,t){return this.layers.size()==0&&this._adjustZoomtoLayer(e),this.layers.add(e,t),this.trigger("layerAdded"),this.layers.length===1&&this.trigger("firstLayerAdded"),e.cid},removeLayer:function(e){this.layers.remove(e)},removeLayerByCid:function(e){var t=this.layers.getByCid(e);t?this.removeLayer(t):cdb.log.error("There's no layer with cid = "+e+".")},removeLayerAt:function(e){var t=this.layers.at(e);t?this.removeLayer(t):cdb.log.error("There's no layer in that position.")},clearLayers:function(){while(this.layers.length>0)this.removeLayer(this.layers.at(0))},getBaseLayer:function(){return this.layers.at(0)},isBaseLayerAdded:function(e){var t=this.getBaseLayer();return t&&e.isEqual(t)},getLayerTemplate:function(){var e=this.getBaseLayer();if(e&&e.get("options"))return e.get("options").urlTemplate},updateAttribution:function(e,t){var n=this.get("attribution")||[];e&&e.get("attribution")&&(n=_.without(n,e.get("attribution"))),t.get("attribution")&&(_.contains(n,t.get("attribution"))||n.push(t.get("attribution"))),this.set({attribution:n})},addGeometry:function(e){this.geometries.add(e)},removeGeometry:function(e){this.geometries.remove(e)},setBounds:function(e){this.attributes.view_bounds_sw=[e[0][0],e[0][1]],this.attributes.view_bounds_ne=[e[1][0],e[1][1]],this.trigger("change:view_bounds_ne",this)},fitBounds:function(e,t){var n=this.getBoundsZoom(e,t);if(n===null)return;var r=cdb.geo.Map.latlngToMercator(e[0],n),i=cdb.geo.Map.latlngToMercator(e[1],n),s=cdb.geo.Map.mercatorToLatLng({x:(r[0]+i[0])*.5,y:(r[1]+i[1])*.5},n);this.set({center:s,zoom:n})},getBoundsZoom:function(e,t){if(t.x===0||t.y===0)return null;var n=[t.x,t.y],r=this.get("minZoom")||0,i=this.get("maxZoom")||24,s=e[1],o=e[0],u=[],a,f,l=!0;do r++,a=cdb.geo.Map.latlngToMercator(s,r),f=cdb.geo.Map.latlngToMercator(o,r),u[0]=Math.abs(a[0]-f[0]),u[1]=Math.abs(f[1]-a[1]),l=u[0]<=n[0]||u[1]<=n[1];while(l&&r<=i);return l?null:r-1}},{latlngToMercator:function(e,t){var n=new L.LatLng(e[0],e[1]),r=L.CRS.EPSG3857.latLngToPoint(n,t);return[r.x,r.y]},mercatorToLatLng:function(e,t){var n=L.CRS.EPSG3857.pointToLatLng(e,t);return[n.lat,n.lng]}}),cdb.geo.MapView=cdb.core.View.extend({initialize:function(){if(this.options.map===undefined)throw"you should specify a map model";this.map=this.options.map,this.add_related_model(this.map),this.add_related_model(this.map.layers),this.autoSaveBounds=!1,this.layers={},this.geometries={},this.bind("clean",this._removeLayers,this)},render:function(){return this},addInfowindow:function(e){this.addOverlay(e)},addOverlay:function(e){e&&(this.$el.append(e.render().el),this.addView(e))},getInfoWindows:function(){var e=[];for(var t in this._subviews)this._subviews[t]instanceof cdb.geo.ui.Infowindow&&e.push(this._subviews[t]);return e},showBounds:function(e){throw"to be implemented"},_setModelProperty:function(e){this._unbindModel(),this.map.set(e);if(e.center!==undefined||e.zoom!==undefined){var t=this.getBounds();this.map.set({view_bounds_sw:t[0],view_bounds_ne:t[1]}),this.autoSaveBounds&&this._saveLocation()}this._bindModel()},_bindModel:function(){this._unbindModel(),this.map.bind("change:view_bounds_sw",this._changeBounds,this),this.map.bind("change:view_bounds_ne",this._changeBounds,this),this.map.bind("change:zoom",this._setZoom,this),this.map.bind("change:scrollwheel",this._setScrollWheel,this),this.map.bind("change:center",this._setCenter,this),this.map.bind("change:attribution",this._setAttribution,this)},_unbindModel:function(){this.map.unbind("change:view_bounds_sw",null,this),this.map.unbind("change:view_bounds_ne",null,this),this.map.unbind("change:zoom",null,this),this.map.unbind("change:scrollwheel",null,this),this.map.unbind("change:center",null,this),this.map.unbind("change:attribution",null,this)},_changeBounds:function(){var e=this.map.getViewBounds();e&&this.showBounds(e)},showBounds:function(e){this.map.fitBounds(e,this.getSize())},_setAttribution:function(e,t){this.setAttribution(e)},_addLayers:function(){var e=this;this._removeLayers(),this.map.layers.each(function(t){e._addLayer(t)})},_removeLayers:function(e){for(var t in this.layers){var n=this.layers[t];n.remove(),delete this.layers[t]}},_removeLayer:function(e){var t=this.layers[e.cid];t&&(t.remove(),delete this.layers[e.cid])},_swicthLayerView:function(e,t,n){this._removeLayer(e),this._addLayer(e,this.map.layers,n)},_removeGeometry:function(e){var t=this.geometries[e.cid];delete this.layers[layer.cid]},getLayerByCid:function(e){var t=this.layers[e];return t||cdb.log.debug("layer with cid "+e+" can't be get"),t},_setZoom:function(e,t){throw"to be implemented"},_setCenter:function(e,t){throw"to be implemented"},_addLayer:function(e,t,n){throw"to be implemented"},_addGeomToMap:function(e){throw"to be implemented"},_removeGeomFromMap:function(e){throw"to be implemented"},setAutoSaveBounds:function(){var e=this;this.autoSaveBounds=!0},_saveLocation:_.debounce(function(){this.map.save(null,{silent:!0})},1e3),_addGeometry:function(e){var t=this._addGeomToMap(e);this.geometries[e.cid]=t},_removeGeometry:function(e){var t=this.geometries[e.cid];this._removeGeomFromMap(t),delete this.geometries[e.cid]}},{_getClass:function(e){var t=cdb.geo.LeafletMapView;return e==="googlemaps"&&(typeof google!="undefined"&&typeof google.maps!="undefined"?t=cdb.geo.GoogleMapsMapView:cdb.log.error("you must include google maps library _before_ include cdb")),t},create:function(e,t){var n=cdb.geo.MapView._getClass(t.get("provider"));return new n({el:e,map:t})}}),cdb.geo.ui.Zoom=cdb.core.View.extend({className:"cartodb-zoom",events:{"click .zoom_in":"zoom_in","click .zoom_out":"zoom_out"},default_options:{timeout:0,msg:""},initialize:function(){this.map=this.model,_.defaults(this.options,this.default_options),this.template=this.options.template?this.options.template:cdb.templates.getTemplate("geo/zoom"),this.map.bind("change:zoom change:minZoom change:maxZoom",this._checkZoom,this)},render:function(){return this.$el.html(this.template(this.options)),this._checkZoom(),this},_checkZoom:function(){var e=this.map.get("zoom");this.$(".zoom_in")[e<this.map.get("maxZoom")?"removeClass":"addClass"]("disabled"),this.$(".zoom_out")[e>this.map.get("minZoom")?"removeClass":"addClass"]("disabled")},zoom_in:function(e){this.map.get("maxZoom")>this.map.getZoom()&&this.map.setZoom(this.map.getZoom()+1),e.preventDefault(),e.stopPropagation()},zoom_out:function(e){this.map.get("minZoom")<this.map.getZoom()&&this.map.setZoom(this.map.getZoom()-1),e.preventDefault(),e.stopPropagation()}}),cdb.geo.ui.ZoomInfo=cdb.core.View.extend({className:"cartodb-zoom-info",initialize:function(){this.model.bind("change:zoom",this.render,this)},render:function(){return this.$el.html(this.model.get("zoom")),this}}),cdb.geo.ui.Mobile=cdb.core.View.extend({className:"cartodb-mobile",events:{"click .toggle":"_toggle",dragstart:"_stopPropagation",mousedown:"_stopPropagation",touchstart:"_stopPropagation",MSPointerDown:"_stopPropagation",dblclick:"_stopPropagation",mousewheel:"_stopPropagation",DOMMouseScroll:"_stopPropagation",click:"_stopPropagation"},default_options:{timeout:0,msg:""},_stopPropagation:function(e){e.stopPropagation()},doOnOrientationChange:function(){switch(window.orientation){case-90:case 90:this.recalc("landscape");break;default:this.recalc("portrait")}},recalc:function(e){var t=$(".legends > div.cartodb-legend-stack").height();this.$el.hasClass("open")&&t<100&&!this.$el.hasClass("torque")?(this.$el.css("height",t),this.$el.find(".top-shadow").hide(),this.$el.find(".bottom-shadow").hide()):this.$el.hasClass("open")&&t<100&&this.$el.hasClass("legends")&&this.$el.hasClass("torque")&&(this.$el.css("height",t+$(".legends > div.torque").height()),this.$el.find(".top-shadow").hide(),this.$el.find(".bottom-shadow").hide())},initialize:function(){this.map=this.model,_.defaults(this.options,this.default_options),this.template=this.options.template?this.options.template:cdb.templates.getTemplate("geo/zoom"),window.addEventListener("orientationchange",_.bind(this.doOnOrientationChange,this))},_toggle:function(e){e.preventDefault(),e.stopPropagation(),this.isOpen?this.close():this.open()},open:function(){var e=this;this.$el.addClass("open"),this.isOpen=!0,this.$el.css("height","110"),this.recalc()},close:function(){var e=this;this.$el.removeClass("open"),this.isOpen=!1,this.$el.css("height","40"),this._fixTorque()},_fixTorque:function(){var e=this;setTimeout(function(){var t=e.$el.width()-e.$el.find(".toggle").width()-e.$el.find(".time").width();e.hasLegends&&(t-=40),e.hasLegends||(t-=e.$el.find(".controls").width()),e.$el.find(".slider-wrapper").css("width",t),e.$el.find(".slider-wrapper").show()},50)},render:function(){this.$el.html(this.template(this.options));var e=$(document).width()-40;this.$el.css({width:e}),this.options.torqueLayer&&(this.hasTorque=!0,this.slider=new cdb.geo.ui.TimeSlider({type:"time_slider",layer:this.options.torqueLayer,map:this.options.map,pos_margin:0,position:"none",width:"auto"}),this.slider.bind("time_clicked",function(){this.slider.toggleTime()},this),this.$el.find(".torque").append(this.slider.render().$el),this.$el.addClass("torque"),this.$el.find(".slider-wrapper").hide());if(this.options.legends){this.$el.find(".legends").append(this.options.legends.render().$el);var t=_.some(this.options.legends._models,function(e){return e.get("template")||e.get("type")!="none"&&e.get("items").length>0});t&&(this.$el.addClass("legends"),this.hasLegends=!0,this.$el.find(".controls").hide())}return this.hasTorque&&!this.hasLegends&&this.$el.find(".toggle").hide(),this.hasTorque&&this._fixTorque(),this}}),cdb.geo.ui.LegendItemModel=cdb.core.Model.extend({defaults:{name:"Untitled",visible:!0,value:""}}),cdb.geo.ui.LegendItems=Backbone.Collection.extend({model:cdb.geo.ui.LegendItemModel}),cdb.geo.ui.LegendItem=cdb.core.View.extend({tagName:"li",initialize:function(){_.bindAll(this,"render"),this.template=this.options.template?_.template(this.options.template):cdb.templates.getTemplate("geo/legend")},render:function(){var e;this.model.get("type")=="image"&&this.model.get("value")?e="url( "+this.model.get("value")+")":e=this.model.get("value");var t=_.extend(this.model.toJSON(),{value:e});return this.$el.html(this.template(t)),this.$el}}),cdb.geo.ui.Legend=cdb.core.View.extend({className:"cartodb-legend",events:{dragstart:"_stopPropagation",mousedown:"_stopPropagation",touchstart:"_stopPropagation",MSPointerDown:"_stopPropagation",dblclick:"_stopPropagation",mousewheel:"_stopPropagation",DOMMouseScroll:"_stopPropagation",dbclick:"_stopPropagation",click:"_stopPropagation"},initialize:function(){_.bindAll(this,"render","show","hide"),_.defaults(this.options,this.default_options),this.map=this.options.map,this._setupModel(),this._setupItems(),this._updateLegendType()},_stopPropagation:function(e){e.stopPropagation()},_setupModel:function(){this.model||(this.model=new cdb.geo.ui.LegendModel({type:this.options.type||cdb.geo.ui.LegendModel.prototype.defaults.type,title:this.options.title||cdb.geo.ui.LegendModel.prototype.defaults.title,show_title:this.options.show_title||cdb.geo.ui.LegendModel.prototype.defaults.show_title,template:this.options.template||cdb.geo.ui.LegendModel.prototype.defaults.template})),this.add_related_model(this.model),this.model.bind("change",this._updateLegendType,this)},_updateLegendType:function(){var e=this.model.get("type");this.legend_name=this._capitalize(e)+"Legend";if(e=="none"||e==null)this.legend_name=null,this.model.set({type:"none"},{silent:!0});else if(!cdb.geo.ui[this.legend_name]){this.legend_name=null,this.model.set({type:this.model.previous("type")},{silent:!0});return}this._refresh()},_refresh:function(){var e=this;this.view&&this.view.clean();var t=this.model.get("type"),n=this.model.get("title"),r=this.model.get("show_title"),i=this.model.get("template");t&&this.legend_name?(this.view=new cdb.geo.ui[this.legend_name]({model:this.model}),this.$el.removeClass(),this.$el.addClass(this.className+" "+this.model.get("type")),this.show()):(this.hide(),this.$el.removeClass(),this.$el.addClass(this.className+" none")),this.render()},_setupItems:function(){var e=this;this.items=this.model.items,this.options.data&&this.items.reset(this.options.data),this.items.bind("add remove change:value change:name",this.render,this)},show:function(e){var t=this.model.get("type");t&&t!="none"&&this.$el.show()},hide:function(e){this.model.get("type")&&this.$el.hide()},_capitalize:function(e){if(e&&_.isString(e))return e.charAt(0).toUpperCase()+e.slice(1)},render:function(){return this.view&&(this.model.get("template")?(this.$el.html(this.view.render().$el.html()),this.$el.removeClass(this.model.get("type")),this.$el.addClass("wrapper")):this.$el.html(this.view.render().$el.html())),this}}),cdb.geo.ui.DebugLegend=cdb.core.View.extend({}),cdb.geo.ui.BaseLegend=cdb.core.View.extend({_bindModel:function(){this.model.bind("change:template change:title change:show_title",this.render,this)},addTo:function(e){$(e).html(this.render().$el)},setTitle:function(e){this.model.set("title",e)},showTitle:function(){this.model.set("show_title",!0)},hideTitle:function(){this.model.set("show_title",!1)}}),cdb.geo.ui.NoneLegend=cdb.geo.ui.BaseLegend.extend({}),cdb.geo.ui.Legend.None=cdb.core.View.extend({}),cdb.geo.ui.ChoroplethLegend=cdb.geo.ui.BaseLegend.extend({className:"choropleth-legend",template:_.template('<% if (title && show_title) { %><div class="legend-title"><%= title %></div><% } %><ul><li class="min"><%= leftLabel %></li><li class="max"><%= rightLabel %></li><li class="graph count_<%= buckets_count %>"><div class="colors"><%= colors %></div></li></ul>'),initialize:function(){this.items=this.model.items},_generateColorList:function(){var e="";if(this.model.get("colors"))return _.map(this.model.get("colors"),function(e){return'<div class="quartile" style="background-color:'+e+'"></div>'}).join("");for(var t=2;t<this.items.length;t++){var n=this.items.at(t).get("value");e+='<div class="quartile" style="background-color:'+n+'"></div>'}return e},setLeftLabel:function(e){this.model.set("leftLabel",e)},setRightLabel:function(e){this.model.set("rightLabel",e)},setColors:function(e){this.model.set("colors",e)},render:function(){if(this.model.get("template")){var e=_.template(this.model.get("template"));this.$el.html(e(this.model.toJSON()))}else if(this.items.length>=2){this.leftLabel=this.items.at(0),this.rightLabel=this.items.at(1);var t=this.model.get("leftLabel")||this.leftLabel.get("value"),n=this.model.get("rightLabel")||this.rightLabel.get("value"),r=this._generateColorList(),i=_.extend(this.model.toJSON(),{leftLabel:t,rightLabel:n,colors:r,buckets_count:r.length});this.$el.html(this.template(i))}return this}}),cdb.geo.ui.DensityLegend=cdb.geo.ui.BaseLegend.extend({className:"density-legend",template:_.template('<% if (title && show_title) { %><div class="legend-title"><%= title %></div><% } %>\n<ul>\n<li class="min"><%= leftLabel %></li>\n<li class="max"><%= rightLabel %></li>\n<li class="graph count_<%= buckets_count %>">\n<div class="colors"><%= colors %></div>\n</li>\n</ul>'),initialize:function(){this.items=this.model.items},setLeftLabel:function(e){this.model.set("leftLabel",e)},setRightLabel:function(e){this.model.set("rightLabel",e)},setColors:function(e){this.model.set("colors",e)},_generateColorList:function(){var e="";if(this.model.get("colors"))return _.map(this.model.get("colors"),function(e){return'<div class="quartile" style="background-color:'+e+'"></div>'}).join("");for(var t=2;t<this.items.length;t++){var n=this.items.at(t).get("value");e+='<div class="quartile" style="background-color:'+n+'"></div>'}return e},render:function(){if(this.model.get("template")){var e=_.template(this.model.get("template"));this.$el.html(e(this.model.toJSON()))}else if(this.items.length>=2){this.leftLabel=this.items.at(0),this.rightLabel=this.items.at(1);var t=this.model.get("leftLabel")||this.leftLabel.get("value"),n=this.model.get("rightLabel")||this.rightLabel.get("value"),r=this._generateColorList(),i=_.extend(this.model.toJSON(),{leftLabel:t,rightLabel:n,colors:r,buckets_count:r.length});this.$el.html(this.template(i))}return this}}),cdb.geo.ui.Legend.Density=cdb.geo.ui.DensityLegend.extend({type:"density",className:"cartodb-legend density",initialize:function(){this.items=this.options.items,this.model=new cdb.geo.ui.LegendModel({type:this.type,title:this.options.title,show_title:this.options.title?!0:!1,leftLabel:this.options.left||this.options.leftLabel,rightLabel:this.options.right||this.options.rightLabel,colors:this.options.colors,buckets_count:this.options.colors?this.options.colors.length:0,items:this.options.items}),this._bindModel()},_bindModel:function(){this.model.bind("change:colors change:template change:title change:show_title change:colors change:leftLabel change:rightLabel",this.render,this)},_generateColorList:function(){return _.map(this.model.get("colors"),function(e){return'<div class="quartile" style="background-color:'+e+'"></div>'}).join("")},render:function(){var e=_.extend(this.model.toJSON(),{colors:this._generateColorList()});return this.$el.html(this.template(e)),this}}),cdb.geo.ui.IntensityLegend=cdb.geo.ui.BaseLegend.extend({className:"intensity-legend",template:_.template('<% if (title && show_title) { %><div class="legend-title"><%= title %></div><% } %>\n<ul>\n<li class="min"><%= leftLabel %></li>\n<li class="max"><%= rightLabel %></li>\n<li class="graph"></li>\n</ul>\n'),initialize:function(){this.items=this.model.items},_bindModel:function(){this.model.bind("change:template",this.render,this)},setColor:function(e){this.model.set("color",e)},setLeftLabel:function(e){this.model.set("leftLabel",e)},setRightLabel:function(e){this.model.set("rightLabel",e)},_hexToRGB:function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},_rgbToHex:function(e,t,n){function r(e){var t=e.toString(16);return t.length==1?"0"+t:t}return"#"+r(e)+r(t)+r(n)},_calculateMultiply:function(e,t){var n=this._hexToRGB(e);if(n){var r=n.r,i=n.g,s=n.b;for(var o=0;o<=t;o++)r=Math.round(r*n.r/255),i=Math.round(i*n.g/255),s=Math.round(s*n.b/255);return this._rgbToHex(r,i,s)}return"#ffffff"},_renderGraph:function(e){var t="";t+="background: <%= color %>;",t+="background: -moz-linear-gradient(left, <%= color %> 0%, <%= right %> 100%);",t+="background: -webkit-gradient(linear, left top, right top, color-stop(0%,<%= color %>), color-stop(100%,<%= right %>));",t+="background: -webkit-linear-gradient(left, <%= color %> 0%,<%= right %> 100%);",t+="background: -o-linear-gradient(left, <%= color %> 0%,<%= right %> 100%);",t+="background: -ms-linear-gradient(left, <%= color %> 0%,<%= right %> 100%)",t+="background: linear-gradient(to right, <%= color %> 0%,<%= right %> 100%);",t+="filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='<%= color %>', endColorstr='<%= right %>',GradientType=1 );",t+="background-image: -ms-linear-gradient(left, <%= color %> 0%,<%= right %> 100%)";var n=_.template(t),r=this._calculateMultiply(e,4);this.$el.find(".graph").attr("style",n({color:e,right:r}))},render:function(){if(this.model.get("template")){var e=_.template(this.model.get("template"));this.$el.html(e(this.model.toJSON()))}else if(this.items.length>=3){this.leftLabel=this.items.at(0),this.rightLabel=this.items.at(1);var t=this.model.get("color")||this.items.at(2).get("value"),n=this.model.get("leftLabel")||this.leftLabel.get("value"),r=this.model.get("rightLabel")||this.rightLabel.get("value"),i=_.extend(this.model.toJSON(),{color:t,leftLabel:n,rightLabel:r});this.$el.html(this.template(i)),this._renderGraph(t)}return this}}),cdb.geo.ui.CategoryLegend=cdb.geo.ui.BaseLegend.extend({className:"category-legend",template:_.template('<% if (title && show_title) { %><div class="legend-title"><%= title %></div><% } %>\n<ul></ul>\n'),initialize:function(){this.items=this.model.items},_bindModel:function(){this.model.bind("change:title change:show_title change:template",this.render,this)},_renderItems:function(){this.items.each(this._renderItem,this)},_renderItem:function(e){view=new cdb.geo.ui.LegendItem({model:e,className:e.get("value")&&e.get("value").indexOf("http")>=0||e.get("type")&&e.get("type")=="image"?"bkg":"",template:'<div class="bullet" style="background: <%= value %>"></div><%= name || ((name === false) ? "false": "null") %>'}),this.$el.find("ul").append(view.render())},render:function(){if(this.model.get("template")){var e=_.template(this.model.get("template"));this.$el.html(e(this.model.toJSON()))}else this.$el.html(this.template(this.model.toJSON())),this.items.length>0?this._renderItems():this.$el.html('<div class="warning">The category legend is empty</div>');return this}}),cdb.geo.ui.Legend.Category=cdb.geo.ui.CategoryLegend.extend({className:"cartodb-legend category",type:"category",initialize:function(){this.items=new cdb.geo.ui.LegendItems(this.options.data),this.model=new cdb.geo.ui.LegendModel({type:this.type,title:this.options.title,show_title:this.options.title?!0:!1}),this._bindModel()},render:function(){return this.$el.html(this.template(this.model.toJSON())),this._renderItems(),this}}),cdb.geo.ui.ColorLegend=cdb.geo.ui.BaseLegend.extend({className:"color-legend",type:"color",template:_.template('<% if (title && show_title) { %><div class="legend-title"><%= title %></div><% } %><ul></ul>'),initialize:function(){this.items=this.model.items},_renderItems:function(){this.items.each(this._renderItem,this)},_renderItem:function(e){view=new cdb.geo.ui.LegendItem({model:e,className:e.get("value")&&e.get("value").indexOf("http")>=0?"bkg":"",template:'<div class="bullet" style="background: <%= value %>"></div><%= name || ((name === false) ? "false": "null") %>'}),this.$el.find("ul").append(view.render())},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.items.length>0?this._renderItems():this.$el.html('<div class="warning">The color legend is empty</div>'),this}}),cdb.geo.ui.Legend.Color=cdb.geo.ui.Legend.Category.extend({}),cdb.geo.ui.StackedLegend=cdb.core.View.extend({events:{dragstart:"_stopPropagation",mousedown:"_stopPropagation",touchstart:"_stopPropagation",MSPointerDown:"_stopPropagation",dblclick:"_stopPropagation",mousewheel:"_stopPropagation",DOMMouseScroll:"_stopPropagation",dbclick:"_stopPropagation",click:"_stopPropagation"},className:"cartodb-legend-stack",initialize:function(){_.each(this.options.legends,this._setupBinding,this)},_stopPropagation:function(e){e.stopPropagation()},getLegendByIndex:function(e){if(!this._layerByIndex){this._layerByIndex={};var t=this.options.legends;for(var n=0;n<t.length;++n){var r=t[n];this._layerByIndex[r.options.index]=r}}return this._layerByIndex[e]},_setupBinding:function(e){e.model.bind("change:type",this._checkVisibility,this),this.add_related_model(e.model)},_checkVisibility:function(){var e=_.some(this.options.legends,function(e){return e.model.get("type")&&(e.model.get("type")!="none"||e.model.get("template"))},this);e?this.show():this.hide(),_.each(this.options.legends,function(e){var t=e.model.get("type");t&&t!="none"?e.show():e.hide()},this)},_renderItems:function(){_.each(this.options.legends,function(e){this.$el.append(e.render().$el)},this)},show:function(){this.$el.show()},hide:function(){this.$el.hide()},addTo:function(e){$(e).html(this.render().$el)},render:function(){return this._renderItems(),this._checkVisibility(),this}}),cdb.geo.ui.Legends=Backbone.Collection.extend({model:cdb.geo.ui.LegendModel}),cdb.geo.ui.Legend.Stacked=cdb.geo.ui.StackedLegend.extend({initialize:function(){if(this.options.legends){var e=_.map(this.options.legends,function(e){return e.model});this.legendItems=new cdb.geo.ui.Legends(e),this.legendItems.bind("add remove change",this.render,this)}else if(this.options.data){var e=_.map(this.options.data,function(e){return new cdb.geo.ui.LegendModel(e)});this.legendItems=new cdb.geo.ui.Legends(e),this.legendItems.bind("add remove change",this.render,this)}},_capitalize:function(e){if(e&&_.isString(e))return e.charAt(0).toUpperCase()+e.slice(1)},render:function(){return this.$el.empty(),this.legends=[],this.legendItems&&this.legendItems.length>0&&this.legendItems.each(this._renderLegend,this),this},_renderLegend:function(e){var t=e.get("type");t||(t="custom"),t=this._capitalize(t);var n=new cdb.geo.ui.Legend[t](e.attributes);this.legends.push(n),e.get("visible")!==!1&&this.$el.append(n.render().$el)},getLegendAt:function(e){return this.legends[e]},addLegend:function(e){var t=new cdb.geo.ui.LegendModel(e);this.legendItems.push(t)},removeLegendAt:function(e){var t=this.legendItems.at(e);this.legendItems.remove(t)}}),cdb.geo.ui.LegendModel=cdb.core.Model.extend({defaults:{type:null,show_title:!1,title:"",template:""},initialize:function(){this.items=new cdb.geo.ui.LegendItems(this.get("items")),this.items.bind("add remove reset change",function(){this.set({items:this.items.toJSON()})},this),this.bind("change:items",this._onUpdateItems,this),this.bind("change:title change:show_title",this._onUpdateTitle,this),this.bind("change:template",this._onUpdateTemplate,this)},_onUpdateTemplate:function(){this.template=this.get("template")},_onUpdateTitle:function(){this.title=this.get("title"),this.show_title=this.get("show_title")},_onUpdateItems:function(){var e=this.get("items");this.items.reset(e)}}),cdb.geo.ui.CustomLegend=cdb.geo.ui.BaseLegend.extend({className:"custom-legend",type:"custom",template:_.template('<% if (title && show_title) { %><div class="legend-title"><%= title %></div><% } %>\n<ul></ul>'),initialize:function(){this.items=this.model.items},setData:function(e){this.items=new cdb.geo.ui.LegendItems(e),this.model.items=this.items,this.model.set("items",e)},_renderItems:function(){this.items.each(this._renderItem,this)},_renderItem:function(e){view=new cdb.geo.ui.LegendItem({model:e,className:e.get("value")&&e.get("value").indexOf("http")>=0?"bkg":"",template:'<div class="bullet" style="background:<%= value %>"></div><%= name || "null" %>'}),this.$el.find("ul").append(view.render())},render:function(){if(this.model.get("template")){var e=_.template(this.model.get("template"));this.$el.html(e(this.model.toJSON()))}else this.$el.html(this.template(this.model.toJSON())),this.items.length>0?this._renderItems():this.$el.html('<div class="warning">The legend is empty</div>');return this}}),cdb.geo.ui.Legend.Custom=cdb.geo.ui.CustomLegend.extend({className:"cartodb-legend custom",type:"custom",initialize:function(){this.items=new cdb.geo.ui.LegendItems(this.options.data||this.options.items),this.model=new cdb.geo.ui.LegendModel({type:this.type,title:this.options.title,show_title:this.options.title?!0:!1,items:this.items.models}),this._bindModel()},_bindModel:function(){this.model.bind("change:items change:template change:title change:show_title",this.render,this)}}),cdb.geo.ui.BubbleLegend=cdb.geo.ui.BaseLegend.extend({className:"bubble-legend",template:_.template('<% if (title && show_title) { %><div class="legend-title"><%= title %></div><% } %><ul><li><%= min %></li><li class="graph"><div class="bubbles"></div></li><li><%= max %></li></ul>'),initialize:function(){this.items=this.model.items},_bindModel:function(){this.model.bind("change:template change:title change:show_title change:color change:min change:max",this.render,this)},setColor:function(e){this.model.set("color",e)},setMinValue:function(e){this.model.set("min",e)},setMaxValue:function(e){this.model.set("max",e)},_renderGraph:function(e){this.$el.find(".graph").css("background",e)},render:function(){if(this.model.get("template")){var e=_.template(this.model.get("template"));this.$el.html(e(this.model.toJSON())),this.$el.removeClass("bubble-legend")}else{var t=this.model.get("color")||(this.items.length>=3?this.items.at(2).get("value"):"");if(this.items.length>=3){var n=this.model.get("min")||this.items.at(0).get("value"),r=this.model.get("max")||this.items.at(1).get("value"),i=_.extend(this.model.toJSON(),{min:n,max:r});this.$el.html(this.template(i))}this._renderGraph(t)}return this}}),cdb.geo.ui.Legend.Bubble=cdb.geo.ui.BubbleLegend.extend({className:"cartodb-legend bubble",type:"bubble",initialize:function(){this.model=new cdb.geo.ui.LegendModel({type:this.type,title:this.options.title,min:this.options.min,max:this.options.max,color:this.options.color,show_title:this.options.title?!0:!1}),this.add_related_model(this.model),this._bindModel()},render:function(){return this.$el.html(this.template(this.model.toJSON())),this._renderGraph(this.model.get("color")),this}}),cdb.geo.ui.Legend.Choropleth=cdb.geo.ui.ChoroplethLegend.extend({type:"choropleth",className:"cartodb-legend choropleth",initialize:function(){this.items=this.options.items,this.model=new cdb.geo.ui.LegendModel({type:this.type,title:this.options.title,show_title:this.options.title?!0:!1,leftLabel:this.options.left||this.options.leftLabel,rightLabel:this.options.right||this.options.rightLabel,colors:this.options.colors,buckets_count:this.options.colors?this.options.colors.length:0}),this.add_related_model(this.model),this._bindModel()},_bindModel:function(){this.model.bind("change:template change:title change:show_title change:colors change:leftLabel change:rightLabel",this.render,this)},_generateColorList:function(){return _.map(this.model.get("colors"),function(e){return'<div class="quartile" style="background-color:'+e+'"></div>'}).join("")},render:function(){var e=_.extend(this.model.toJSON(),{colors:this._generateColorList()});return this.$el.html(this.template(e)),this}}),cdb.geo.ui.Legend.Intensity=cdb.geo.ui.IntensityLegend.extend({className:"cartodb-legend intensity",type:"intensity",initialize:function(){this.items=this.options.items,this.model=new cdb.geo.ui.LegendModel({type:this.type,title:this.options.title,show_title:this.options.title?!0:!1,color:this.options.color,leftLabel:this.options.left||this.options.leftLabel,rightLabel:this.options.right||this.options.rightLabel}),this.add_related_model(this.model),this._bindModel()},_bindModel:function(){this.model.bind("change:title change:show_title change:color change:leftLabel change:rightLabel",this.render,this)},render:function(){return this.$el.html(this.template(this.model.toJSON())),this._renderGraph(this.model.get("color")),this}}),cdb.geo.ui.SwitcherItemModel=Backbone.Model.extend({}),cdb.geo.ui.SwitcherItems=Backbone.Collection.extend({model:cdb.geo.ui.SwitcherItemModel}),cdb.geo.ui.SwitcherItem=cdb.core.View.extend({tagName:"li",events:{"click a":"select"},initialize:function(){_.bindAll(this,"render"),this.template=cdb.templates.getTemplate("templates/map/switcher/item"),this.parent=this.options.parent,this.model.on("change:selected",this.render)},select:function(e){e.preventDefault(),this.parent.toggle(this);var t=this.model.get("callback");t&&t()},render:function(){return this.model.get("selected")==1?this.$el.addClass("selected"):this.$el.removeClass("selected"),this.$el.html(this.template(this.model.toJSON())),this.$el}}),cdb.geo.ui.Switcher=cdb.core.View.extend({id:"switcher",default_options:{},initialize:function(){this.map=this.model,this.add_related_model(this.model),_.bindAll(this,"render","show","hide","toggle"),_.defaults(this.options,this.default_options),this.collection&&(this.model.collection=this.collection),this.template=this.options.template?this.options.template:cdb.templates.getTemplate("geo/switcher")},show:function(){this.$el.fadeIn(250)},hide:function(){this.$el.fadeOut(250)},toggle:function(e){this.collection&&this.collection.each(function(e){e.set("selected",!e.get("selected"))})},render:function(){var e=this;return this.model!=undefined&&this.$el.html(this.template(this.model.toJSON())),this.collection&&this.collection.each(function(t){var n=new cdb.geo.ui.SwitcherItem({parent:e,className:t.get("className"),model:t});e.$el.find("ul").append(n.render())}),this}}),cdb.geo.ui.InfowindowModel=Backbone.Model.extend({SYSTEM_COLUMNS:["the_geom","the_geom_webmercator","created_at","updated_at","cartodb_id","cartodb_georef_status"],defaults:{template_name:"infowindow_light",latlng:[0,0],offset:[28,0],autoPan:!0,template:"",content:"",visibility:!1,alternative_names:{},fields:null},clearFields:function(){this.set({fields:[]})},saveFields:function(e){e=e||"old_fields",this.set(e,_.clone(this.get("fields")))},fieldCount:function(){var e=this.get("fields");return e?e.length:0},restoreFields:function(e,t){t=t||"old_fields";var n=this.get(t);e&&(n=n.filter(function(t){return _.contains(e,t.name)})),n&&n.length&&this._setFields(n),this.unset(t)},_cloneFields:function(){return _(this.get("fields")).map(function(e){return _.clone(e)})},_setFields:function(e){e.sort(function(e,t){return e.position-t.position}),this.set({fields:e})},sortFields:function(){this.get("fields").sort(function(e,t){return e.position-t.position})},_addField:function(e,t){var n=$.Deferred();if(!this.containsField(e)){var r=this.get("fields");r?(t=t===undefined?r.length:t,r.push({name:e,title:!0,position:t})):(t=t===undefined?0:t,this.set("fields",[{name:e,title:!0,position:t}]))}return n.resolve(),n.promise()},addField:function(e,t){var n=this;return $.when(this._addField(e,t)).then(function(){n.sortFields(),n.trigger("change:fields"),n.trigger("add:fields")}),this},getFieldProperty:function(e,t){if(this.containsField(e)){var n=this.get("fields")||[],r=_.indexOf(_(n).pluck("name"),e);return n[r][t]}return null},setFieldProperty:function(e,t,n){if(this.containsField(e)){var r=this._cloneFields()||[],i=_.indexOf(_(r).pluck("name"),e);r[i][t]=n,this._setFields(r)}return this},getAlternativeName:function(e){return this.get("alternative_names")&&this.get("alternative_names")[e]},setAlternativeName:function(e,t){var n=this.get("alternative_names")||[];n[e]=t,this.set({alternative_names:n}),this.trigger("change:alternative_names")},getFieldPos:function(e){var t=this.getFieldProperty(e,"position");return t==undefined?Number.MAX_VALUE:t},containsAlternativeName:function(e){var t=this.get("alternative_names")||[];return t[e]},containsField:function(e){var t=this.get("fields")||[];return _.contains(_(t).pluck("name"),e)},removeField:function(e){if(this.containsField(e)){var t=this._cloneFields()||[],n=_.indexOf(_(t).pluck("name"),e);n>=0&&t.splice(n,1),this._setFields(t),this.trigger("remove:fields")}return this},updateContent:function(e){var t=this.get("fields"),n=[];for(var r=0;r<t.length;++r){var i=t[r],s=String(e[i.name]);e[i.name]!==undefined&&s!=""&&n.push({title:i.title?i.name:null,value:e[i.name],index:r?r:null})}n.length===0&&n.push({title:null,value:"No data available",index:r?r:null,type:"empty"}),this.set({content:{fields:n,data:e}})}}),cdb.geo.ui.Infowindow=cdb.core.View.extend({className:"cartodb-infowindow",spin_options:{lines:10,length:0,width:4,radius:6,corners:1,rotate:0,color:"rgba(0,0,0,0.5)",speed:1,trail:60,shadow:!1,hwaccel:!0,className:"spinner",zIndex:2e9,top:"auto",left:"auto",position:"absolute"},events:{"click .close":"_closeInfowindow","touchstart .close":"_closeInfowindow","MSPointerDown .close":"_closeInfowindow",dragstart:"_checkOrigin",mousedown:"_checkOrigin",touchstart:"_checkOrigin",MSPointerDown:"_checkOrigin",dblclick:"_stopPropagation",DOMMouseScroll:"_stopBubbling",MozMousePixelScroll:"_stopBubbling",mousewheel:"_stopBubbling",dbclick:"_stopPropagation",click:"_stopPropagation"},initialize:function(){var e=this;_.bindAll(this,"render","setLatLng","_setTemplate","_updatePosition","_update","toggle","show","hide"),this.mapView=this.options.mapView,this.options.template&&this.model.set("template",this.options.template),this.model.get("template")?this._compileTemplate():this._setTemplate(),this.model.bind("change:content",this.render,this),this.model.bind("change:template_name",this._setTemplate,this),this.model.bind("change:latlng",this._update,this),this.model.bind("change:visibility",this.toggle,this),this.model.bind("change:template",this._compileTemplate,this),this.model.bind("change:alternative_names",this.render,this),this.mapView.map.bind("change",this._updatePosition,this),this.mapView.bind("zoomstart",function(){e.hide(!0)}),this.mapView.bind("zoomend",function(){e.show(!0)}),this.add_related_model(this.mapView.map),this.minHeightToScroll=180,this.$el.hide()},render:function(){if(this.template){var e=this.$el.find(".cartodb-popup-content");e.length>0&&e.data()!=null&&e.data().jsp&&e.data().jsp.destroy();var t=_.map(this.model.attributes.content.fields,function(e){return _.clone(e)}),n=this.model.get("content")?this.model.get("content").data:{};if(this.model.get("template_name")){var r=_.clone(this.model.attributes.template_name);t=this._fieldsToString(t,r)}var i={};_.each(this.model.get("content").fields,function(e){i[e.title]=e.value});var s=_.extend({content:{fields:t,data:n}},i);this.$el.html(this.template(s));var o=this;setTimeout(function(){var e=o.$el.find(".cartodb-popup-content").outerHeight()+o.$el.find(".cartodb-popup-header").outerHeight();o.minHeightToScroll<=e&&o.$el.find(".cartodb-popup-content").jScrollPane({maintainPosition:!1,verticalDragMinHeight:20})},1),this._checkLoading(),this._loadCover(),this.isLoadingData()||(this.model.trigger("domready",this,this.$el),this.trigger("domready",this,this.$el))}return this},_getModelTemplate:function(){return this.model.get("template_name")},_setTemplate:function(){this.model.get("template_name")&&(this.template=cdb.templates.getTemplate(this._getModelTemplate()),this.render())},_compileTemplate:function(){var e=this.model.get("template")?this.model.get("template"):cdb.templates.getTemplate(this._getModelTemplate());typeof e!="function"?this.template=(new cdb.core.Template({template:e,type:this.model.get("template_type")||"mustache"})).asFunction():this.template=e,this.render()},_checkOrigin:function(e){var t=$(e.target).closest(".jspVerticalBar").length>0&&e.type!="touchstart";t||e.stopPropagation()},_fieldsToString:function(e,t){var n=[];if(e&&e.length>0){var r=this;n=_.map(e,function(e,n){return r._sanitizeField(e,t,e.index||n)})}return n},_sanitizeField:function(e,t,n){if(e.value==null||e.value==undefined)e.value="";var r=this.model.getAlternativeName(e.title);e.title&&r?e.title=r:e.title&&(e.title=e.title.replace(/_/g," "));var i=e.value.toString();return!e.type&&n==0&&e.value.length>35&&t&&t.search("_header_")!=-1&&(i=e.value.substr(0,32)+"..."),!e.type&&n==1&&e.value.length>35&&t&&t.search("_header_with_image")!=-1&&(i=e.value.substr(0,32)+"..."),this._isValidURL(e.value)&&(i="<a href='"+e.value+"' target='_blank'>"+i+"</a>"),n==0&&t.search("_header_with_image")!=-1&&(i=e.value),e.value=i,e},isLoadingData:function(){var e=this.model.get("content");return e.fields&&e.fields.length==1&&e.fields[0].type==="loading"},_checkLoading:function(){this.isLoadingData()?this._startSpinner():this._stopSpinner()},_stopSpinner:function(){this.spinner&&this.spinner.stop()},_startSpinner:function(e){this._stopSpinner();var e=this.$el.find(".loading");if(e){var t=this.model.get("template_name").search("dark")!=-1;t?this.spin_options.color="#FFF":this.spin_options.color="rgba(0,0,0,0.5)",this.spinner=(new Spinner(this.spin_options)).spin(),e.append(this.spinner.el)}},_containsCover:function(){return this.$el.find(".cartodb-popup.header").attr("data-cover")?!0:!1},_getCoverURL:function(){var e=this.model.get("content");return e&&e.fields&&e.fields.length>0?(e.fields[0].value||"").toString():!1},_loadCover:function(){if(!this._containsCover())return;var e=this,t=this.$(".cover"),n=this.$(".shadow"),r=this._getCoverURL();if(!this._isValidURL(r)){n.hide(),cdb.log.info("Header image url not valid");return}var i=document.getElementById("spinner"),s={lines:9,length:4,width:2,radius:4,corners:1,rotate:0,color:"#ccc",speed:1,trail:60,shadow:!0,hwaccel:!1,zIndex:2e9},o=(new Spinner(s)).spin(i),u=t.find("img");u.hide(function(){this.remove()}),u=$("<img />").attr("src",r),t.append(u),u.load(function(){o.stop();var e=u.width(),n=u.height(),r=t.width(),i=t.height(),s=n/e,a=i/r;if(e>r&&n>i)if(s<a)u.css({height:i});else{var f=n/(e/r);u.css({width:r,top:"50%",position:"absolute","margin-top":-1*parseInt(f,10)/2})}else{var f=n/(e/r);u.css({width:r,top:"50%",position:"absolute","margin-top":-1*parseInt(f,10)/2})}u.fadeIn(300)}).error(function(){o.stop()})},_isValidURL:function(e){if(e){var t=/^(http|ftp|https):\/\/[\w-]+(\.[\w-]+)+([\w.,@?^=%&amp;:\/~+#-|]*[\w@?^=%&amp;\/~+#-])?$/;return String(e).match(t)!=null?!0:!1}return!1},toggle:function(){this.model.get("visibility")?this.show():this.hide()},_stopBubbling:function(e){e.preventDefault(),e.stopPropagation()},_stopPropagation:function(e){e.stopPropagation()},setLoading:function(){return this.model.set({content:{fields:[{title:null,alternative_name:null,value:"Loading content...",index:null,type:"loading"}],data:{}}}),this},setError:function(){return this.model.set({content:{fields:[{title:null,alternative_name:null,value:"There has been an error...",index:null,type:"error"}],data:{}}}),this},setLatLng:function(e){return this.model.set("latlng",e),this},_closeInfowindow:function(e){e&&(e.preventDefault(),e.stopPropagation()),this.model.set("visibility",!1)},showInfowindow:function(){this.model.set("visibility",!0)},show:function(e){var t=this;this.model.get("visibility")&&(t.$el.css({left:-5e3}),t._update(e))},isHidden:function(){return!this.model.get("visibility")},hide:function(e){(e||!this.model.get("visibility"))&&this._animateOut()},_update:function(e){if(!this.isHidden()){var t=0;if(!e)var t=this.adjustPan();this._updatePosition(),this._animateIn(t)}},_animateIn:function(e){!$.browser.msie||$.browser.msie&&parseInt($.browser.version)>8?(this.$el.css({marginBottom:"-10px",display:"block",opacity:0}),this.$el.delay(e).animate({opacity:1,marginBottom:0},300)):this.$el.show()},_animateOut:function(){if(!$.browser.msie||$.browser.msie&&parseInt($.browser.version)>8){var e=this;this.$el.animate({marginBottom:"-10px",opacity:"0",display:"block"},180,function(){e.$el.css({display:"none"})})}else this.$el.hide()},_updatePosition:function(){if(this.isHidden())return;var e=this.model.get("offset");pos=this.mapView.latLonToPixel(this.model.get("latlng")),x=this.$el.position().left,y=this.$el.position().top,containerHeight=this.$el.outerHeight(!0),containerWidth=this.$el.width(),left=pos.x-e[0],size=this.mapView.getSize(),bottom=-1*(pos.y-e[1]-size.y),this.$el.css({bottom:bottom,left:left})},adjustPan:function(e){var t=this.model.get("offset");if(!this.model.get("autoPan")||this.isHidden())return;var n=this.$el.position().left,r=this.$el.position().top,i=this.$el.outerHeight(!0)+15,s=this.$el.width(),o=this.mapView.latLonToPixel(this.model.get("latlng")),u={x:0,y:0};size=this.mapView.getSize(),wait_callback=0,o.x-t[0]<0&&(u.x=o.x-t[0]-10),o.x-t[0]+s>size.x&&(u.x=o.x+s-size.x-t[0]+10),o.y-i<0&&(u.y=o.y-i-10),o.y-i>size.y&&(u.y=o.y+i-size.y);if(u.x||u.y)this.mapView.panBy(u),wait_callback=300;return wait_callback}}),cdb.geo.ui.Header=cdb.core.View.extend({className:"cartodb-header",initialize:function(){},render:function(){return this.$el.html(this.options.template(this.options)),this}}),cdb.geo.ui.Search=cdb.core.View.extend({className:"cartodb-searchbox",events:{"click input[type='text']":"_focus","submit form":"_submit",click:"_stopPropagation",dblclick:"_stopPropagation",mousedown:"_stopPropagation"},initialize:function(){},render:function(){return this.$el.html(this.options.template(this.options)),this},_stopPropagation:function(e){e.stopPropagation()},_focus:function(e){e.preventDefault(),$(e.target).focus()},_showLoader:function(){this.$("span.loader").show()},_hideLoader:function(){this.$("span.loader").hide()},_submit:function(e){e.preventDefault();var t=this,n=this.$("input.text").val();this._showLoader(),cdb.geo.geocoder.NOKIA.geocode(n,function(e){if(e.length>0){var n=!0;if(!e[0].boundingbox||e[0].boundingbox.south==e[0].boundingbox.north||e[0].boundingbox.east==e[0].boundingbox.west)n=!1;n&&e[0].boundingbox?t.model.setBounds([[parseFloat(e[0].boundingbox.south),parseFloat(e[0].boundingbox.west)],[parseFloat(e[0].boundingbox.north),parseFloat(e[0].boundingbox.east)]]):e[0].lat&&e[0].lon&&(t.model.setCenter([e[0].lat,e[0].lon]),t.model.setZoom(10))}t._hideLoader()})}}),cdb.geo.ui.LayerSelector=cdb.core.View.extend({className:"cartodb-layer-selector-box",events:{click:"_openDropdown",dblclick:"killEvent",mousedown:"killEvent"},initialize:function(){this.map=this.options.mapView.map,this.mapView=this.options.mapView,this.mapView.bind("click zoomstart drag",function(){this.dropdown&&this.dropdown.hide()},this),this.add_related_model(this.mapView),this.layers=[]},render:function(){return this.$el.html(this.options.template(this.options)),this.dropdown=new cdb.ui.common.Dropdown({className:"cartodb-dropdown border",template:this.options.dropdown_template,target:this.$el.find("a"),speedIn:300,speedOut:200,position:"position",tick:"right",vertical_position:"down",horizontal_position:"right",vertical_offset:7,horizontal_offset:13}),cdb.god&&cdb.god.bind("closeDialogs",this.dropdown.hide,this.dropdown),this.$el.append(this.dropdown.render().el),this._getLayers(),this._setCount(),this},_getLayers:function(){var e=this;this.layers=[],_.each(this.map.layers.models,function(t){if(t.get("type")=="layergroup"||t.get("type")==="namedmap"){var n=e.mapView.getLayerByCid(t.cid);for(var r=0;r<n.getLayerCount();++r){var i=n.getLayer(r),s=new cdb.core.Model(i);s.set("order",r),s.set("type","layergroup"),s.set("visible",!n.getSubLayer(r).get("hidden")),s.bind("change:visible",function(e){this.trigger("change:visible",e.get("visible"),e.get("order"),e)},e),e.options.layer_names?s.set("layer_name",e.options.layer_names[r]):s.set("layer_name",i.options.layer_name);var o=e._createLayer("LayerViewFromLayerGroup",{model:s,layerView:n,layerIndex:r});o.bind("switchChanged",e._setCount,e),e.layers.push(o)}}else if(t.get("type")==="CartoDB"||t.get("type")==="torque"){var o=e._createLayer("LayerView",{model:t});o.bind("switchChanged",e._setCount,e),e.layers.push(o),o.model.bind("change:visible",function(e){this.trigger("change:visible",e.get("visible"),e.get("order"),e)},e)}})},_createLayer:function(e,t){var n=new cdb.geo.ui[e](t);return this.$("ul").append(n.render().el),this.addView(n),n},_setCount:function(){var e=0;for(var t=0,n=this.layers.length;t<n;++t){var r=this.layers[t];r.model.get("visible")&&e++}this.$(".count").text(e),this.trigger("switchChanged",this)},_openDropdown:function(){this.dropdown.open()}}),cdb.geo.ui.LayerView=cdb.core.View.extend({tagName:"li",defaults:{template:'      <a class="layer" href="#/change-layer"><%= layer_name %></a>      <a href="#switch" class="right <%= visible ? "enabled" : "disabled" %> switch"><span class="handle"></span></a>    '},events:{click:"_onSwitchClick"},initialize:function(){this.model.has("visible")||this.model.set("visible",!1),this.model.bind("change:visible",this._onSwitchSelected,this),this.add_related_model(this.model),this._onSwitchSelected(),this.template=this.options.template?cdb.templates.getTemplate(this.options.template):_.template(this.defaults.template)},render:function(){var e=_.clone(this.model.attributes);return e.layer_name=e.layer_name||e.table_name,this.$el.append(this.template(e)),this},_onSwitchSelected:function(){var e=this.model.get("visible");this.$el.find(".switch").removeClass(e?"disabled":"enabled").addClass(e?"enabled":"disabled"),this.trigger("switchChanged")},_onSwitchClick:function(e){this.killEvent(e),this.model.set("visible",!this.model.get("visible"))}}),cdb.geo.ui.LayerViewFromLayerGroup=cdb.geo.ui.LayerView.extend({_onSwitchSelected:function(){cdb.geo.ui.LayerView.prototype._onSwitchSelected.call(this);var e=this.options.layerView.getSubLayer(this.options.layerIndex),t=this.model.get("visible");t?e.show():e.hide()}}),cdb.geo.ui.TilesLoader=cdb.core.View.extend({className:"cartodb-tiles-loader",default_options:{animationSpeed:500},initialize:function(){_.defaults(this.options,this.default_options),this.isVisible=0,this.template=this.options.template?this.options.template:cdb.templates.getTemplate("geo/tiles_loader")},render:function(){return this.$el.html($(this.template(this.options))),this},show:function(e){if(this.isVisible)return;!$.browser.msie||$.browser.msie&&$.browser.version.indexOf("9.")!=0?this.$el.fadeTo(this.options.animationSpeed,1):this.$el.show(),this.isVisible++},hide:function(e){this.isVisible--;if(this.isVisible>0)return;this.isVisible=0,!$.browser.msie||$.browser.msie&&$.browser.version.indexOf("9.")==0?this.$el.stop(!0).fadeTo(this.options.animationSpeed,0):this.$el.hide()},visible:function(){return this.isVisible>0}}),cdb.geo.ui.InfoBox=cdb.core.View.extend({className:"cartodb-infobox",defaults:{pos_margin:20,position:"bottom|right",width:200},initialize:function(){var e=this;_.defaults(this.options,this.defaults),this.options.layer&&this.enable(),this.template=cdb.core.Template.compile(this.options.template||this.defaultTemplate,"mustache")},enable:function(){this.options.layer&&this.options.layer.on("featureOver",function(e,t,n,r){this.render(r).show()},this).on("featureOut",function(){this.hide()},this)},disable:function(){this.options.layer&&this.options.layer.off(null,null,this)},setPosition:function(e){var t={};e.indexOf("top")!==-1?t.top=this.options.pos_margin:e.indexOf("bottom")!==-1&&(t.bottom=this.options.pos_margin),e.indexOf("left")!==-1?t.left=this.options.pos_margin:e.indexOf("right")!==-1&&(t.right=this.options.pos_margin),this.$el.css(t)},render:function(e){return this.$el.html(this.template(e)),this.options.width&&this.$el.css("width",this.options.width),this.options.position&&this.setPosition(this.options.position),this}}),cdb.geo.ui.Tooltip=cdb.geo.ui.InfoBox.extend({DEFAULT_OFFSET_TOP:30,defaultTemplate:"<p>{{text}}</p>",className:"cartodb-tooltip",initialize:function(){this.options.template=this.options.template||defaultTemplate,this.options.position="none",this.options.width=null,cdb.geo.ui.InfoBox.prototype.initialize.call(this)},enable:function(){this.options.layer&&this.options.layer.on("featureOver",function(e,t,n,r){this.show(n,r)},this).on("featureOut",function(){this.hide()},this)},show:function(e,t){this.render(t),this.elder("show"),this.$el.css({left:e.x-this.$el.width()/2,top:e.y-(this.options.offset_top||this.DEFAULT_OFFSET_TOP)})},render:function(e){return this.$el.html(this.template(e)),this}}),cdb.ui.common.FullScreen=cdb.core.View.extend({tagName:"div",className:"cartodb-fullscreen",events:{"click a":"_toggleFullScreen"},initialize:function(){_.bindAll(this,"render"),_.defaults(this.options,this.default_options),this.model=new cdb.core.Model({allowWheelOnFullscreen:!1}),this._addWheelEvent()},_addWheelEvent:function(){var e=this,t=this.options.mapView;$(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange",function(){!document.fullscreenElement&&!document.webkitFullscreenElement&&!document.mozFullScreenElement&&!document.msFullscreenElement&&e.model.get("allowWheelOnFullscreen")&&t.options.map.set("scrollwheel",!1),t.invalidateSize()})},_toggleFullScreen:function(e){e.stopPropagation(),e.preventDefault();var t=window.document,n=t.documentElement;this.options.doc&&(n=$(this.options.doc)[0]);var r=n.requestFullscreen||n.mozRequestFullScreen||n.webkitRequestFullScreen,i=t.exitFullscreen||t.mozCancelFullScreen||t.webkitExitFullscreen,s=this.options.mapView;!t.fullscreenElement&&!t.mozFullScreenElement&&!t.webkitFullscreenElement?(r.call(n),s&&this.model.get("allowWheelOnFullscreen")&&s.options.map.set("scrollwheel",!0)):i.call(t)},render:function(){var e=this.$el,t=_.extend(this.options);return e.html(this.options.template(t)),this}}),Map.BASE_URL="/api/v1/map",Map.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",LayerDefinition.layerDefFromSubLayers=function(e){if(!e||e.length===undefined)throw new Error("sublayers should be an array");var t={version:"1.0.0",stat_tag:"API",layers:[]};for(var n=0;n<e.length;++n)t.layers.push({type:"cartodb",options:e[n]});return t},Map.prototype={isCORSSupported:function(){return"withCredentials"in new XMLHttpRequest},isBtoaSupported:function(){return typeof window["btoa"]=="function"},getLayerCount:function(){return this.layers.length},_encodeBase64Native:function(e){return btoa(e)},getLayerIndexByNumber:function(e){var t={},n=0;for(var r=0;r<this.layers.length;++r){var i=this.layers[r];t[r]=n,i.options&&!i.options.hidden&&++n}return t[e]},getLayerNumberByIndex:function(e){var t=[];for(var n=0;n<this.layers.length;++n){var r=this.layers[n];r.options&&!r.options.hidden&&t.push(n)}return e>=t.length?-1:+t[e]},visibleLayers:function(){var e=[];for(var t=0;t<this.layers.length;++t){var n=this.layers[t];n.options.hidden||e.push(n)}return e},_encodeBase64:function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n,r,i,s,o,u,a,f,l=0,c=0,h="",p=[];if(!e)return e;do n=e.charCodeAt(l++),r=e.charCodeAt(l++),i=e.charCodeAt(l++),f=n<<16|r<<8|i,s=f>>18&63,o=f>>12&63,u=f>>6&63,a=f&63,p[c++]=t.charAt(s)+t.charAt(o)+t.charAt(u)+t.charAt(a);while(l<e.length);h=p.join("");var d=e.length%3;return(d?h.slice(0,d-3):h)+"===".slice(d||3)},_array2hex:function(e){var t=[];for(var n=0;n<e.length;++n)t.push(String.fromCharCode(e[n]+128));return this.options.btoa(t.join(""))},getLayerToken:function(e){function t(e,t){var r;while(r=n._layerTokenQueue.pop())r(e,t)}var n=this;clearTimeout(this._timeout),this._queue.push(t),this._layerTokenQueue.push(e),this._timeout=setTimeout(function(){n._getLayerToken(t)},4)},_requestFinished:function(){var e=this;this._waiting=!1,this.lastTimeUpdated=(new Date).getTime(),clearTimeout(this._refreshTimer),this._refreshTimer=setTimeout(function(){e.invalidate()},this.options.refreshTime||72e5);if(this._queue.length){var t=this._queue[this._queue.length-1];this._getLayerToken(t)}},_requestPOST:function(e,t){var n=this,r=this.options.ajax,i=cartodb.core.Profiler.metric("cartodb-js.layergroup.post.time").start();r({crossOrigin:!0,type:"POST",method:"POST",dataType:"json",contentType:"application/json",url:this._tilerHost()+this.endPoint+(e.length?"?"+e.join("&"):""),data:JSON.stringify(this.toJSON()),success:function(e){i.end(),0===n._queue.length&&t(e),n._requestFinished()},error:function(e){i.end(),cartodb.core.Profiler.metric("cartodb-js.layergroup.post.error").inc();var r={errors:["unknow error"]};e.status===0&&(r={errors:["connection error"]});try{r=JSON.parse(e.responseText)}catch(s){}0===n._queue.length&&t(null,r),n._requestFinished()}})},_getCompressor:function(e){var t=this;return this.options.compressor?this.options.compressor:(e=e||JSON.stringify(this.toJSON()),!this.options.force_compress&&e.length<this.options.MAX_GET_SIZE?function(e,t,n){n("config="+encodeURIComponent(e))}:function(e,n,r){e=JSON.stringify({config:e}),LZMA.compress(e,n,function(e){r("lzma="+encodeURIComponent(t._array2hex(e)))})})},_requestGET:function(e,t){var n=this,r=this.options.ajax,i=JSON.stringify(this.toJSON()),s=this._getCompressor(i),o=n.JSONPendPoint||n.endPoint;s(i,3,function(i){e.push(i);var s=cartodb.core.Profiler.metric("cartodb-js.layergroup.get.time").start();r({dataType:"jsonp",url:n._tilerHost()+o+"?"+e.join("&"),success:function(e){s.end(),0===n._queue.length&&(e.error?(cartodb.core.Profiler.metric("cartodb-js.layergroup.get.error").inc(),t(null,e.error)):t(e)),n._requestFinished()},error:function(e){s.end(),cartodb.core.Profiler.metric("cartodb-js.layergroup.get.error").inc();var r={errors:["unknow error"]};try{r=JSON.parse(xhr.responseText)}catch(i){}0===n._queue.length&&t(null,r),n._requestFinished()}})})},_getLayerToken:function(e){var t=this,n=[];e=e||function(){};if(this._waiting)return this;this._queue=[];if(!this.named_map&&this.visibleLayers().length===0){e(null);return}var r=this.options.extra_params||{},i=this.options.map_key||this.options.api_key||r.map_key||r.api_key;i&&n.push("map_key="+i),r.auth_token&&n.push("auth_token="+r.auth_token),this._waiting=!0;var s=null;return this._usePOST()?s=this._requestPOST:s=this._requestGET,s.call(this,n,e),this},_usePOST:function(){if(this.options.cors){if(this.options.force_cors)return!0;var e=JSON.stringify(this.toJSON());if(e<this.options.MAX_GET_SIZE)return!1}return!1},getLayer:function(e){return _.clone(this.layers[e])},invalidate:function(){this.layerToken=null,this.urls=null,this.onLayerDefinitionUpdated()},setLayer:function(e,t){if(e<this.getLayerCount()&&e>=0){if(t.options.hidden){var n=this.interactionEnabled[e];n&&(t.interaction=!0,this.setInteraction(e,!1))}else this.layers[e].interaction&&(this.setInteraction(e,!0),delete this.layers[e].interaction);this.layers[e]=_.clone(t)}return this.invalidate(),this},getTiles:function(e){var t=this;return t.layerToken?(e&&e(t._layerGroupTiles(t.layerToken,t.options.extra_params)),this):(this.getLayerToken(function(n,r){if(n){t.layerToken=n.layergroupid;if(n.cdn_url){var i=t.options.cdn_url=t.options.cdn_url||{};i.http=n.cdn_url.http||i.http,i.https=n.cdn_url.https||i.https}t.urls=t._layerGroupTiles(n.layergroupid,t.options.extra_params),e&&e(t.urls)}else{if(t.visibleLayers().length===0){e&&e({tiles:[Map.EMPTY_GIF],grids:[]});return}e&&e(null,r)}}),this)},isHttps:function(){return this.options.tiler_protocol==="https"},_layerGroupTiles:function(e,t){var n=this.options.subdomains||["0","1","2","3"];this.isHttps()&&(n=[null]);var r="/{z}/{x}/{y}",i=[],s=[],o=this._encodeParams(t,this.options.pngParams);for(var u=0;u<n.length;++u){var a=n[u],f=this._host(a)+Map.BASE_URL+"/"+e;s.push(f+r+".png"+(o?"?"+o:""));var l=this._encodeParams(t,this.options.gridParams);for(var c=0;c<this.layers.length;++c)i[c]=i[c]||[],i[c].push(f+"/"+c+r+".grid.json"+(l?"?"+l:""))}return{tiles:s,grids:i}},_cleanInteractivity:function(e){if(!e)return;typeof e=="string"&&(e=e.split(","));for(var t=0;t<e.length;++t)e[t]=e[t].replace(/ /g,"");return e},onLayerDefinitionUpdated:function(){},setSilent:function(e){this.silent=e},_definitionUpdated:function(){if(this.silent)return;this.invalidate()},_tileJSONfromTiles:function(e,t){return{tilejson:"2.0.0",scheme:"xyz",grids:t.grids[e],tiles:t.tiles,formatter:function(e,t){return t}}},getTileJSON:function(e,t){e=e==undefined?0:e,this.getTiles(function(n){if(!n){t(null);return}t&&t(this._tileJSONfromTiles(e,n))})},_encodeParams:function(e,t){if(!e)return"";var n=[];t=t||_.keys(e);for(var r in t){var i=t[r],s=e[i];if(s){var o=encodeURIComponent(s);o=o.replace(/%7Bx%7D/g,"{x}").replace(/%7By%7D/g,"{y}").replace(/%7Bz%7D/g,"{z}"),n.push(i+"="+o)}}return n.join("&")},_tilerHost:function(){var e=this.options;return e.tiler_protocol+"://"+(e.user_name?e.user_name+".":"")+e.tiler_domain+(e.tiler_port!=""?":"+e.tiler_port:"")},_host:function(e){var t=this.options;if(t.no_cdn)return this._tilerHost();var n=t.tiler_protocol+"://";e&&(n+=e+".");var r=t.cdn_url||cdb.CDB_HOST;if(!r.http&&!r.https)throw new Error("cdn_host should contain http and/or https entries");return n+=r[t.tiler_protocol]+"/"+t.user_name,n},getInfowindowData:function(e){var t,n=this.layers[e].infowindow;return!n&&this.options.layer_definition&&(t=this.options.layer_definition.layers[e])&&(n=t.infowindow),n&&n.fields&&n.fields.length>0?n:null},containInfowindow:function(){var e=this.options.layer_definition.layers;for(var t=0;t<e.length;++t){var n=e[t].infowindow;if(n&&n.fields&&n.fields.length>0)return!0}return!1},getSubLayer:function(e){var t=this.layers[e];return t.sub=t.sub||new SubLayer(this,e),t.sub},getSubLayerCount:function(){return this.getLayerCount()},getSubLayers:function(){var e=[];for(var t=0;t<this.getSubLayerCount();++t)e.push(this.getSubLayer(t));return e}},NamedMap.prototype=_.extend({},Map.prototype,{setAuthToken:function(e){if(!this.isHttps())throw new Error("https must be used when auth_token is set");return this.options.extra_params=this.options.extra_params||{},this.options.extra_params.auth_token=e,this.invalidate(),this},setParams:function(e,t){var n;arguments.length===2?(n={},n[e]=t):n=e;for(var r in n)n[r]===undefined||n[r]===null?delete this.named_map.params[r]:this.named_map.params[r]=n[r];return this.invalidate(),this},toJSON:function(){var e=this.named_map.params||{};for(var t=0;t<this.layers.length;++t){var n=this.layers[t];n.options.hidden?e["layer"+t]=0:delete e["layer"+t]}return e},containInfowindow:function(){var e=this.layers||[];for(var t=0;t<e.length;++t){var n=e[t].infowindow;if(n&&n.fields&&n.fields.length>0)return!0}return!1},_attributesUrl:function(e,t){var n=[this._tilerHost(),Map.BASE_URL.slice(1),this.layerToken,e,"attributes",t].join("/"),r=this.options.extra_params||{},i=r.auth_token;return i&&(n+="?auth_token="+i),n},fetchAttributes:function(e,t,n,r){var i=this.options.ajax,s=cartodb.core.Profiler.metric("cartodb-js.named_map.attributes.time").start();i({dataType:"jsonp",url:this._attributesUrl(e,t),success:function(e){s.end(),r(e)},error:function(e){s.end(),cartodb.core.Profiler.metric("cartodb-js.named_map.attributes.error").inc(),r(null)}})},setSQL:function(e){throw new Error("SQL is read-only in NamedMaps")},setCartoCSS:function(e){throw new Error("cartocss is read-only in NamedMaps")},setLayer:function(e,t){var n={sql:1,cartocss:1,interactivity:1};for(var r in t.options)if(r in n)throw delete t.options[r],new Error(r+" is read-only in NamedMaps");return Map.prototype.setLayer.call(this,e,t)},removeLayer:function(e){throw new Error("sublayers are read-only in Named Maps")},createSubLayer:function(e,t){throw new Error("sublayers are read-only in Named Maps")},addLayer:function(e,t){throw new Error("sublayers are read-only in Named Maps")},getLayerIndexByNumber:function(e){return+e}}),LayerDefinition.prototype=_.extend({},Map.prototype,{setLayerDefinition:function(e,t){t=t||{},this.version=e.version||"1.0.0",this.stat_tag=e.stat_tag,this.layers=_.clone(e.layers),t.silent||this._definitionUpdated()},toJSON:function(){var e={};e.version=this.version,this.stat_tag&&(e.stat_tag=this.stat_tag),e.layers=[];var t=this.visibleLayers();for(var n=0;n<t.length;++n){var r=t[n];e.layers.push({type:"cartodb",options:{sql:r.options.sql,cartocss:r.options.cartocss,cartocss_version:r.options.cartocss_version||"2.1.0",interactivity:this._cleanInteractivity(r.options.interactivity)}})}return e},removeLayer:function(e){return e<this.getLayerCount()&&e>=0&&(this.layers.splice(e,1),this.interactionEnabled.splice(e,1),this._reorderSubLayers(),this.invalidate()),this},_reorderSubLayers:function(){for(var e=0;e<this.layers.length;++e){var t=this.layers[e];t.sub&&t.sub._setPosition(e)}},addLayer:function(e,t){t=t===undefined?this.getLayerCount():t;if(t<=this.getLayerCount()&&t>=0){if(!e.sql||!e.cartocss)throw new Error("layer definition should contain at least a sql and a cartocss");this.layers.splice(t,0,{type:"cartodb",options:e}),this._definitionUpdated()}return this},setInteractivity:function(e,t){t===undefined&&(t=e,e=0);if(e>=this.getLayerCount()&&e<0)throw new Error("layer does not exist");typeof t=="string"&&(t=t.split(","));for(var n=0;n<t.length;++n)t[n]=t[n].replace(/ /g,"");return this.layers[e].options.interactivity=t,this._definitionUpdated(),this},setQuery:function(e,t){t===undefined&&(t=e,e=0),this.layers[e].options.sql=t,this._definitionUpdated()},getQuery:function(e){return e=e||0,this.layers[e].options.sql},setCartoCSS:function(e,t,n){n===undefined&&(n=t,t=e,e=0),n=n||cartodb.CARTOCSS_DEFAULT_VERSION,this.layers[e].options.cartocss=t,this.layers[e].options.cartocss_version=n,this._definitionUpdated()},createSubLayer:function(e,t){return this.addLayer(e),this.getSubLayer(this.getLayerCount()-1)},_getSqlApi:function(e){e=e||{};var t=e.sql_api_port,n=e.sql_api_domain+(t?":"+t:""),r=e.sql_api_protocol,i="v1";n.indexOf("cartodb.com")!==-1&&(n="cartodb.com",i="v2");var s=new cartodb.SQL({user:e.user_name,protocol:r,host:n,version:i});return s},fetchAttributes:function(e,t,n,r){var i=this.getLayer(e),s=this._getSqlApi(this.options);n=_.map(n,function(e){return'"'+e+'"'}).join(",");var o=cartodb.core.Profiler.metric("cartodb-js.layergroup.attributes.time").start();s.execute("select {{{ fields }}} from ({{{ sql }}}) as _cartodbjs_alias where cartodb_id = {{{ cartodb_id }}}",{fields:n,cartodb_id:t,sql:i.options.sql}).done(function(e){o.end();if(e.rows.length===0){r(null);return}r(e.rows[0])}).error(function(){o.end(),cartodb.core.Profiler.metric("cartodb-js.layergroup.attributes.error").inc(),r(null)})}}),SubLayer.prototype={remove:function(){this._check(),this._parent.removeLayer(this._position),this._unbindInteraction(),this._added=!1},show:function(){this.get("hidden")&&this.set({hidden:!1})},hide:function(){this.get("hidden")||this.set({hidden:!0})},setSQL:function(e){return this.set({sql:e})},setCartoCSS:function(e){return this.set({cartocss:e})},setInteractivity:function(e){return this.set({interactivity:e})},getSQL:function(){return this.get("sql")},getCartoCSS:function(){return this.get("cartocss")},setInteraction:function(e){this._parent.setInteraction(this._position,e)},get:function(e){this._check();var t=this._parent.getLayer(this._position);return t.options[e]},set:function(e){this._check();var t=this._parent.getLayer(this._position),n=t.options;for(var r in e)n[r]=e[r];return this._parent.setLayer(this._position,t),this},unset:function(e){var t=this._parent.getLayer(this._position);delete t.options[e],this._parent.setLayer(this._position,t)},_check:function(){if(!this._added)throw"sublayer was removed"},_unbindInteraction:function(){if(!this._parent.off)return;this._parent.off(null,null,this)},_bindInteraction:function(){if(!this._parent.on)return;var e=this,t=function(t,n){n=n||t,e._parent.on(t,function(){var t=Array.prototype.slice.call(arguments);parseInt(t[t.length-1],10)==e._position&&e.trigger.apply(e,[n].concat(t))},e)};t("featureOver"),t("featureOut"),t("featureClick"),t("layermouseover","mouseover"),t("layermouseout","mouseout")},_setPosition:function(e){this._position=e}},_.extend(SubLayer.prototype,Backbone.Events),CartoDBLayerCommon.prototype={show:function(){this.setOpacity(this.options.previous_opacity===undefined?.99:this.options.previous_opacity),delete this.options.previous_opacity,this.setInteraction(!0)},hide:function(){this.options.previous_opacity==undefined&&(this.options.previous_opacity=this.options.opacity),this.setOpacity(0),this.setInteraction(!1)},isVisible:function(){return this.visible},setInteraction:function(e,t){t==undefined&&(t=e,e=0);var n;this.interactionEnabled[e]=t;if(!t)n=this.interaction[e],n&&(n.remove(),this.interaction[e]=null);else if(this.urls){var r=this.getLayerIndexByNumber(+e),i=this._tileJSONfromTiles(r,this.urls);n=this.interaction[e],n&&n.remove();var s=this;this.interaction[e]=this.interactionClass().map(this.options.map).tilejson(i).on("on",function(t){t.layer=+e,s._manageOnEvents(s.options.map,t)}).on("off",function(t){t=t||{},t.layer=+e,s._manageOffEvents(s.options.map,t)})}return this},setOptions:function(e){if(typeof e!="object"||e.length)throw new Error(e+" options must be an object");_.extend(this.options,e);var e=this.options;this.options.query=this.options.query||"select * from "+this.options.table_name,this.options.query_wrapper&&(this.options.query=_.template(this.options.query_wrapper)({sql:this.options.query})),this.setSilent(!0),e.interaction&&this.setInteraction(e.interaction),e.opacity&&this.setOpacity(e.opacity),e.query&&this.setQuery(e.query.replace(/\{\{table_name\}\}/g,this.options.table_name)),e.tile_style&&this.setCartoCSS(e.tile_style.replace(new RegExp(e.table_name,"g"),"layer0")),e.cartocss&&this.setCartoCSS(e.cartocss),e.interactivity&&this.setInteractivity(e.interactivity),e.visible?this.show():this.hide(),this.setSilent(!1),this._definitionUpdated()},_getLayerDefinition:function(){var e={},t=this.options,n,r,i;n=t.query||"select * from "+t.table_name,t.query_wrapper&&(n=_.template(t.query_wrapper)({sql:n})),r=t.tile_style,i=t.cartocss_version||"2.1.0";for(var s in t.extra_params){var o=t.extra_params[s];e[s]=o.replace?o.replace(/\{\{table_name\}\}/g,t.table_name):o}return n=n.replace(/\{\{table_name\}\}/g,t.table_name),r=r.replace(/\{\{table_name\}\}/g,t.table_name),r=r.replace(new RegExp(t.table_name,"g"),"layer0"),{sql:n,cartocss:r,cartocss_version:i,params:e,interactivity:t.interactivity}},error:function(e){},tilesOk:function(){},_clearInteraction:function(){for(var e in this.interactionEnabled)this.interactionEnabled[e]&&this.setInteraction(e,!1)},_reloadInteraction:function(){for(var e in this.interactionEnabled)this.interactionEnabled[e]&&(this.setInteraction(e,!1),this.setInteraction(e,!0))},_checkTiles:function(){var e={z:4,x:6,y:6},t=this,n=new Image,r=this._tileJSON();getTiles(function(n){var r=n.tiles[0].replace(/\{z\}/g,e.z).replace(/\{x\}/g,e.x).replace(/\{y\}/g,e.y);this.options.ajax({method:"get",url:r,crossDomain:!0,success:function(){t.tilesOk(),clearTimeout(i)},error:function(e,n,r){clearTimeout(i),t.error(e.responseText&&JSON.parse(e.responseText))}})});var i=setTimeout(function(){clearTimeout(i),t.error("tile timeout")},3e4)}},cdb.geo.common={},cdb.geo.common.CartoDBLogo={isWadusAdded:function(e,t){var n=[],r=new RegExp("\\b"+t+"\\b"),i=e.getElementsByTagName("*");for(var s=0,o=i.length;s<o;s++)r.test(i[s].className)&&n.push(i[s]);return n.length>0},isRetinaBrowser:function(){return"devicePixelRatio"in window&&window.devicePixelRatio>1||"matchMedia"in window&&window.matchMedia("(min-resolution:144dpi)")&&window.matchMedia("(min-resolution:144dpi)").matches},addWadus:function(e,t,n){var r=this;setTimeout(function(){if(!r.isWadusAdded(n,"cartodb-logo")){var t=document.createElement("div"),i=r.isRetinaBrowser();t.setAttribute("class","cartodb-logo"),t.setAttribute("style","position:absolute; bottom:0; left:0; display:block; border:none; z-index:1000000;");var s=location.protocol.indexOf("https")===-1?"http":"https",o=cdb.config.get("cartodb_logo_link");t.innerHTML="<a href='"+o+"' target='_blank'><img width='71' height='29' src='"+s+"://cartodb.s3.amazonaws.com/static/new_logo"+(i?"@2x":"")+".png' style='position:absolute; bottom:"+(e.bottom||0)+"px; left:"+(e.left||0)+"px; display:block; width:71px!important; height:29px!important; border:none; outline:none;' alt='CartoDB' title='CartoDB' />",n.appendChild(t)}},t||0)}},function(){var e=function(e,t,n){this.leafletLayer=t,this.leafletMap=n,this.model=e,this.model.bind("change",this._modelUpdated,this),this.type=e.get("type")||e.get("kind"),this.type=this.type.toLowerCase()};_.extend(e.prototype,Backbone.Events),_.extend(e.prototype,{remove:function(){this.leafletMap.removeLayer(this.leafletLayer),this.model.unbind(null,null,this),this.unbind()},reload:function(){this.leafletLayer.redraw()}}),cdb.geo.LeafLetLayerView=e}(),function(){if(typeof L=="undefined")return;var e=L.Class.extend({includes:L.Mixin.Events,initialize:function(e,t){cdb.geo.LeafLetLayerView.call(this,e,this,t)},onAdd:function(){this.redraw()},onRemove:function(){var e=this.leafletMap.getContainer();e.style.background="none"},_modelUpdated:function(){this.redraw()},redraw:function(){var e=this.leafletMap.getContainer();e.style.backgroundColor=this.model.get("color")||"#FFF";if(this.model.get("image")){var t="transparent url("+this.model.get("image")+") repeat center center";e.style.background=t}}});_.extend(e.prototype,cdb.geo.LeafLetLayerView.prototype),cdb.geo.LeafLetPlainLayerView=e}(),function(){if(typeof L=="undefined")return;var e=L.TileLayer.extend({initialize:function(e,t){L.TileLayer.prototype.initialize.call(this,e.get("urlTemplate"),{tms:e.get("tms"),attribution:e.get("attribution"),minZoom:e.get("minZomm"),maxZoom:e.get("maxZoom"),subdomains:e.get("subdomains")||"abc",errorTileUrl:e.get("errorTileUrl"),opacity:e.get("opacity")}),cdb.geo.LeafLetLayerView.call(this,e,this,t)}});_.extend(e.prototype,cdb.geo.LeafLetLayerView.prototype,{_modelUpdated:function(){_.defaults(this.leafletLayer.options,_.clone(this.model.attributes)),this.leafletLayer.setUrl(this.model.get("urlTemplate"))}}),cdb.geo.LeafLetTiledLayerView=e}(),function(){if(typeof L=="undefined")return;var e=L.TileLayer.WMS.extend({initialize:function(e,t){L.TileLayer.WMS.prototype.initialize.call(this,e.get("urlTemplate"),{attribution:e.get("attribution"),layers:e.get("layers"),format:e.get("format"),transparent:e.get("transparent"),minZoom:e.get("minZomm"),maxZoom:e.get("maxZoom"),subdomains:e.get("subdomains")||"abc",errorTileUrl:e.get("errorTileUrl"),opacity:e.get("opacity")}),cdb.geo.LeafLetLayerView.call(this,e,this,t)}});_.extend(e.prototype,cdb.geo.LeafLetLayerView.prototype,{_modelUpdated:function(){_.defaults(this.leafletLayer.options,_.clone(this.model.attributes)),this.leafletLayer.setUrl(this.model.get("urlTemplate"))}}),cdb.geo.LeafLetWMSLayerView=e}(),function(){function e(e){var t=e.extend({includes:[cdb.geo.LeafLetLayerView.prototype,Backbone.Events],initialize:function(t,n){var r=this,i=[];t.attributes.attribution=cdb.config.get("cartodb_attributions");var s=_.clone(t.attributes);s.map=n;var o=s.featureOver,u=s.featureOut,a=s.featureClick;s.featureOver=function(e,t,n,s,u){i[u]||r.trigger("layermouseover",u),i[u]=1,_.any(i)&&r.trigger("mouseover"),o&&o.apply(this,arguments),r.featureOver&&r.featureOver.apply(r,arguments)},s.featureOut=function(e,t){i[t]&&r.trigger("layermouseout",t),i[t]=0,_.any(i)||r.trigger("mouseout"),u&&u.apply(this,arguments),r.featureOut&&r.featureOut.apply(r,arguments)},s.featureClick=_.debounce(function(){a&&a.apply(r,arguments),r.featureClick&&r.featureClick.apply(r,arguments)},10),e.prototype.initialize.call(this,s),cdb.geo.LeafLetLayerView.call(this,t,this,n)},featureOver:function(e,t,n,r,i){this.trigger("featureOver",e,[t.lat,t.lng],n,r,i)},featureOut:function(e,t){this.trigger("featureOut",e,t)},featureClick:function(e,t,n,r,i){this.trigger("featureClick",e,[t.lat,t.lng],n,r,i)},error:function(e){this.trigger("error",e?e.errors:"unknown error"),this.model.trigger("error",e?e.errors:"unknown error")},ok:function(e){this.model.trigger("tileOk")},onLayerDefinitionUpdated:function(){this.__update()}});return t}if(typeof L=="undefined")return;L.CartoDBGroupLayerBase=L.TileLayer.extend({interactionClass:wax.leaf.interaction,includes:[cdb.geo.LeafLetLayerView.prototype,CartoDBLayerCommon.prototype],options:{opacity:.99,attribution:"CartoDB",debug:!1,visible:!0,added:!1,tiler_domain:"cartodb.com",tiler_port:"80",tiler_protocol:"http",sql_api_domain:"cartodb.com",sql_api_port:"80",sql_api_protocol:"http",maxZoom:30,extra_params:{},cdn_url:null,subdomains:null},initialize:function(e){e=e||{},L.Util.setOptions(this,e);if(!e.layer_definition&&!e.sublayers)throw new Error("cartodb-leaflet needs at least the layer_definition or sublayer list");e.layer_definition||(this.options.layer_definition=LayerDefinition.layerDefFromSubLayers(e.sublayers)),LayerDefinition.call(this,this.options.layer_definition,this.options),this.fire=this.trigger,CartoDBLayerCommon.call(this),L.TileLayer.prototype.initialize.call(this),this.interaction=[],this.addProfiling()},addProfiling:function(){this.bind("tileloadstart",function(e){var t=this.tileStats||(this.tileStats={});t[e.tile.src]=cartodb.core.Profiler.metric("cartodb-js.tile.png.load.time").start()});var e=function(e){var t=this.tileStats&&this.tileStats[e.tile.src];t&&t.end()};this.bind("tileload",e),this.bind("tileerror",function(t){cartodb.core.Profiler.metric("cartodb-js.tile.png.error").inc(),e(t)})},getTileUrl:function(e){var t="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";this._adjustTilePoint(e);var n=[t];this.tilejson&&(n=this.tilejson.tiles);var r=(e.x+e.y)%n.length;return L.Util.template(n[r],L.Util.extend({z:this._getZoomForUrl(),x:e.x,y:e.y},this.options))},setOpacity:function(e){if(isNaN(e)||e>1||e<0)throw new Error(e+" is not a valid value");this.options.opacity=Math.min(e,.99),this.options.visible&&(L.TileLayer.prototype.setOpacity.call(this,this.options.opacity),this.fire("updated"))},onAdd:function(e){var t=this;this.options.map=e,this.options.cartodb_logo!=0&&cdb.geo.common.CartoDBLogo.addWadus({left:8,bottom:8},0,e._container),this.__update(function(){var n=L.stamp(t);if(!e._layers[n])return;L.TileLayer.prototype.onAdd.call(t,e),t.fire("added"),t.options.added=!0})},onRemove:function(e){this.options.added&&(this.options.added=!1,L.TileLayer.prototype.onRemove.call(this,e))},__update:function(e){var t=this;this.fire("updated"),this.fire("loading");var n=this.options.map;this.getTiles(function(n,r){n?(t.tilejson=n,t.setUrl(t.tilejson.tiles[0]),t._reloadInteraction(),t.ok&&t.ok(),e&&e()):(t.error&&t.error(r),e&&e())})},_checkLayer:function(){if(!this.options.added)throw new Error("the layer is not still added to the map")},setAttribution:function(e){this._checkLayer(),this.map.attributionControl.removeAttribution(this.options.attribution),this.options.attribution=e,this.map.attributionControl.addAttribution(this.options.attribution),this.options.attribution=this.options.attribution,this.tilejson.attribution=this.options.attribution,this.fire("updated")},_manageOnEvents:function(e,t){var n=this._findPos(e,t),r=e.layerPointToLatLng(n),i=t.e.type.toLowerCase(),s=e.layerPointToContainerPoint(n);switch(i){case"mousemove":if(this.options.featureOver)return this.options.featureOver(t.e,r,s,t.data,t.layer);break;case"click":case"touchend":case"mspointerup":this.options.featureClick&&this.options.featureClick(t.e,r,s,t.data,t.layer);break;default:}},_manageOffEvents:function(e,t){if(this.options.featureOut)return this.options.featureOut&&this.options.featureOut(t.e,t.layer)},_findPos:function(e,t){var n=0,r=0,i=e.getContainer();if(i.offsetParent){do n+=i.offsetLeft,r+=i.offsetTop;while(i=i.offsetParent);return e.containerPointToLayerPoint(new L.Point((t.e.clientX||t.e.changedTouches[0].clientX)-n,(t.e.clientY||t.e.changedTouches[0].clientY)-r))}return e.mouseEventToLayerPoint(t.e)}}),L.CartoDBGroupLayer=L.CartoDBGroupLayerBase.extend({includes:[LayerDefinition.prototype]}),L.NamedMap=L.CartoDBGroupLayerBase.extend({includes:[cdb.geo.LeafLetLayerView.prototype,NamedMap.prototype,CartoDBLayerCommon.prototype],initialize:function(e){e=e||{},L.Util.setOptions(this,e);if(!e.named_map&&!e.sublayers)throw new Error("cartodb-leaflet needs at least the named_map");NamedMap.call(this,this.options.named_map,this.options),this.fire=this.trigger,CartoDBLayerCommon.call(this),L.TileLayer.prototype.initialize.call(this),this.interaction=[],this.addProfiling()}}),cdb.geo.LeafLetCartoDBLayerGroupView=e(L.CartoDBGroupLayer),cdb.geo.LeafLetCartoDBNamedMapView=e(L.NamedMap)}(),function(){if(typeof L=="undefined")return;L.CartoDBLayer=L.CartoDBGroupLayer.extend({options:{query:"SELECT * FROM {{table_name}}",opacity:.99,attribution:"CartoDB",debug:!1,visible:!0,added:!1,extra_params:{},layer_definition_version:"1.0.0"},initialize:function(e){L.Util.setOptions(this,e);if(!e.table_name||!e.user_name||!e.tile_style)throw"cartodb-leaflet needs at least a CartoDB table name, user_name and tile_style";L.CartoDBGroupLayer.prototype.initialize.call(this,{layer_definition:{version:this.options.layer_definition_version,layers:[{type:"cartodb",options:this._getLayerDefinition(),infowindow:this.options.infowindow}]}}),this.setOptions(this.options)},setQuery:function(e,t){t===undefined&&(t=e,e=0),t=t||"select * from "+this.options.table_name,LayerDefinition.prototype.setQuery.call(this,e,t)},isVisible:function(){return this.visible},isAdded:function(){return this.options.added}});var e=L.CartoDBLayer.extend({initialize:function(e,t){var n=this;_.bindAll(this,"featureOut","featureOver","featureClick"),e.attributes.attribution=cdb.config.get("cartodb_attributions");var r=_.clone(e.attributes);r.map=t;var i=r.featureOver,s=r.featureOut,o=r.featureClick;r.featureOver=function(){i&&i.apply(this,arguments),n.featureOver&&n.featureOver.apply(this,arguments)},r.featureOut=function(){s&&s.apply(this,arguments),n.featureOut&&n.featureOut.apply(this,arguments)},r.featureClick=function(){o&&o.apply(this,arguments),n.featureClick&&n.featureClick.apply(r,arguments)},e.bind("change:visible",function(){n.model.get("visible")?n.show():n.hide()},this),L.CartoDBLayer.prototype.initialize.call(this,r),cdb.geo.LeafLetLayerView.call(this,e,this,t)},_modelUpdated:function(){var e=_.clone(this.model.attributes);this.leafletLayer.setOptions(e)},featureOver:function(e,t,n,r){this.trigger("featureOver",e,[t.lat,t.lng],n,r,0)},featureOut:function(e){this.trigger("featureOut",e,0)},featureClick:function(e,t,n,r){this.trigger("featureClick",e,[t.lat,t.lng],n,r,0)},reload:function(){this.model.invalidate()},error:function(e){this.trigger("error",e?e.error:"unknown error"),this.model.trigger("tileError",e?e.error:"unknown error")},tilesOk:function(e){this.model.trigger("tileOk")},includes:[cdb.geo.LeafLetLayerView.prototype,Backbone.Events]});cdb.geo.LeafLetLayerCartoDBView=e}(),function(){if(typeof L=="undefined")return;cdb.geo.LeafletMapView=cdb.geo.MapView.extend({initialize:function(){_.bindAll(this,"_addLayer","_removeLayer","_setZoom","_setCenter","_setView"),cdb.geo.MapView.prototype.initialize.call(this);var e=this,t=this.map.get("center"),n={zoomControl:!1,center:new L.LatLng(t[0],t[1]),zoom:this.map.get("zoom"),minZoom:this.map.get("minZoom"),maxZoom:this.map.get("maxZoom")};this.map.get("bounding_box_ne");if(!this.options.map_object)this.map_leaflet=new L.Map(this.el,n),this.map_leaflet.attributionControl.setPrefix(""),this.map.get("scrollwheel")==0&&this.map_leaflet.scrollWheelZoom.disable();else{this.map_leaflet=this.options.map_object,this.setElement(this.map_leaflet.getContainer());var r=e.map_leaflet.getCenter();e._setModelProperty({center:[r.lat,r.lng]}),e._setModelProperty({zoom:e.map_leaflet.getZoom()}),e.map.unset("view_bounds_sw",{silent:!0}),e.map.unset("view_bounds_ne",{silent:!0})}this.map.bind("set_view",this._setView,this),this.map.layers.bind("add",this._addLayer,this),this.map.layers.bind("remove",this._removeLayer,this),this.map.layers.bind("reset",this._addLayers,this),this.map.layers.bind("change:type",this._swicthLayerView,this),this.map.geometries.bind("add",this._addGeometry,this),this.map.geometries.bind("remove",this._removeGeometry,this),this._bindModel(),this._addLayers(),this.map_leaflet.on("layeradd",function(t){this.trigger("layeradd",t,e)},this),this.map_leaflet.on("zoomstart",function(){e.trigger("zoomstart")}),this.map_leaflet.on("click",function(t){e.trigger("click",t.originalEvent,[t.latlng.lat,t.latlng.lng])}),this.map_leaflet.on("dblclick",function(t){e.trigger("dblclick",t.originalEvent)}),this.map_leaflet.on("zoomend",function(){e._setModelProperty({zoom:e.map_leaflet.getZoom()}),e.trigger("zoomend")},this),this.map_leaflet.on("move",function(){var t=e.map_leaflet.getCenter();e._setModelProperty({center:[t.lat,t.lng]})}),this.map_leaflet.on("drag",function(){var t=e.map_leaflet.getCenter();e._setModelProperty({center:[t.lat,t.lng]}),e.trigger("drag")},this),this.map.bind("change:maxZoom",function(){L.Util.setOptions(e.map_leaflet,{maxZoom:e.map.get("maxZoom")})},this),this.map.bind("change:minZoom",function(){L.Util.setOptions(e.map_leaflet,{minZoom:e.map.get("minZoom")})},this),this.trigger("ready");var i=this.map.getViewBounds();i&&this.showBounds(i)},clean:function(){L.DomEvent.off(window,"resize",this.map_leaflet._onResize,this.map_leaflet);for(var e in this.layers){var t=this.layers[e];t.remove(),delete this.layers[e]}cdb.core.View.prototype.clean.call(this)},_setScrollWheel:function(e,t){t?this.map_leaflet.scrollWheelZoom.enable():this.map_leaflet.scrollWheelZoom.disable()},_setZoom:function(e,t){this._setView()},_setCenter:function(e,t){this._setView()},_setView:function(){this.map_leaflet.setView(this.map.get("center"),this.map.get("zoom")||0)},_addGeomToMap:function(e){var t=cdb.geo.LeafletMapView.createGeometry(e);return t.geom.addTo(this.map_leaflet),t},_removeGeomFromMap:function(e){this.map_leaflet.removeLayer(e.geom)},createLayer:function(e){return cdb.geo.LeafletMapView.createLayer(e,this.map_leaflet)},_addLayer:function(e,t,n){var r=this,i,s;s=cdb.geo.LeafletMapView.createLayer(e,this.map_leaflet);if(!s)return;var o=!n||n.index===undefined||n.index===_.size(this.layers);if(!o)for(var u in this.layers)this.map_leaflet.removeLayer(this.layers[u]);this.layers[e.cid]=s,o?(cdb.geo.LeafletMapView.addLayerToMap(s,r.map_leaflet),s.setZIndex&&s.setZIndex(e.get("order"))):this.map.layers.each(function(e){var t=r.layers[e.cid];t&&(cdb.geo.LeafletMapView.addLayerToMap(t,r.map_leaflet),t.setZIndex&&t.setZIndex(e.get("order")))});var a=e.get("attribution");if(a){var f=this.map.get("attribution")||[];_.contains(f,a)||f.push(a),this.map.set({attribution:f})}return(n==undefined||!n.silent)&&this.trigger("newLayerView",s,e,this),s},latLonToPixel:function(e){var t=this.map_leaflet.latLngToLayerPoint(new L.LatLng(e[0],e[1]));return this.map_leaflet.layerPointToContainerPoint(t)},getBounds:function(){var e=this.map_leaflet.getBounds(),t=e.getSouthWest(),n=e.getNorthEast();return[[t.lat,t.lng],[n.lat,n.lng]]},setAttribution:function(e){},getSize:function(){return this.map_leaflet.getSize()},panBy:function(e){this.map_leaflet.panBy(new L.Point(e.x,e.y))},setCursor:function(e){$(this.map_leaflet.getContainer()).css("cursor",e)},getNativeMap:function(){return this.map_leaflet},invalidateSize:function(){this.map_leaflet.invalidateSize({pan:!1}),this.map_leaflet.setView(this.map.get("center"),this.map.get("zoom")||0,{animate:!1})}},{layerTypeMap:{tiled:cdb.geo.LeafLetTiledLayerView,wms:cdb.geo.LeafLetWMSLayerView,cartodb:cdb.geo.LeafLetLayerCartoDBView,carto:cdb.geo.LeafLetLayerCartoDBView,plain:cdb.geo.LeafLetPlainLayerView,gmapsbase:cdb.geo.LeafLetPlainLayerView,layergroup:cdb.geo.LeafLetCartoDBLayerGroupView,namedmap:cdb.geo.LeafLetCartoDBNamedMapView,torque:function(e,t){return new cdb.geo.LeafLetTorqueLayer(e,t)}},createLayer:function(e,t){var n=null,r=this.layerTypeMap[e.get("type").toLowerCase()];if(r)try{n=new r(e,t)}catch(i){cdb.log.error("MAP: error creating layer"+e.get("type")+" "+i)}else cdb.log.error("MAP: "+e.get("type")+" can't be created");return n},addLayerToMap:function(e,t,n){t.addLayer(e.leafletLayer),n!==undefined&&v.setZIndex&&v.setZIndex(n)},createGeometry:function(e){return e.isPoint()?new cdb.geo.leaflet.PointView(e):new cdb.geo.leaflet.PathView(e)}}),L.Icon.Default.imagePath=function(){var e=document.getElementsByTagName("script"),t=/\/?cartodb[\-\._]?([\w\-\._]*)\.js\??/,n,r,i,s;for(n=0,r=e.length;n<r;n++){i=e[n].src,s=i.match(t);if(s){var o=i.split("/");return delete o[o.length-1],o.join("/")+"themes/css/images"}}}()}(),function(){if(typeof google=="undefined"||typeof google.maps=="undefined")return;var e=function(e,t,n){this.gmapsLayer=t,this.map=this.gmapsMap=n,this.model=e,this.model.bind("change",this._update,this),this.type=e.get("type")||e.get("kind"),this.type=this.type.toLowerCase()};_.extend(e.prototype,Backbone.Events),_.extend(e.prototype,{_searchLayerIndex:function(){var e=this,t=-1;return this.gmapsMap.overlayMapTypes.forEach(function(n,r){n==e&&(t=r)}),t},remove:function(){if(!this.isBase){var e=this,t=this._searchLayerIndex();t>=0?this.gmapsMap.overlayMapTypes.removeAt(t):this.gmapsLayer.setMap&&this.gmapsLayer.setMap(null),this.model.unbind(null,null,this),this.unbind()}},refreshView:function(){var e=this;if(this.isBase){var t="_baseLayer";this.gmapsMap.setMapTypeId(null),this.gmapsMap.mapTypes.set(t,this.gmapsLayer),this.gmapsMap.setMapTypeId(t)}else{var n=this._searchLayerIndex();n>=0&&this.gmapsMap.overlayMapTypes.setAt(n,this)}},reload:function(){this.refreshView()},_update:function(){this.refreshView()}}),cdb.geo.GMapsLayerView=e}(),function(){if(typeof google=="undefined"||typeof google.maps=="undefined")return;var e=function(e,t){cdb.geo.GMapsLayerView.call(this,e,null,t)};_.extend(e.prototype,cdb.geo.GMapsLayerView.prototype,{_update:function(){var e=this.model,t={roadmap:google.maps.MapTypeId.ROADMAP,gray_roadmap:google.maps.MapTypeId.ROADMAP,dark_roadmap:google.maps.MapTypeId.ROADMAP,hybrid:google.maps.MapTypeId.HYBRID,satellite:google.maps.MapTypeId.SATELLITE,terrain:google.maps.MapTypeId.TERRAIN};this.gmapsMap.setOptions({mapTypeId:t[e.get("base_type")]}),this.gmapsMap.setOptions({styles:e.get("style")||DEFAULT_MAP_STYLE})},remove:function(){}}),cdb.geo.GMapsBaseLayerView=e}(),function(){if(typeof google=="undefined"||typeof google.maps=="undefined")return;var e=function(e,t){this.color=e.get("color"),cdb.geo.GMapsLayerView.call(this,e,this,t)};_.extend(e.prototype,cdb.geo.GMapsLayerView.prototype,{_update:function(){this.color=this.model.get("color"),this.refreshView()},getTile:function(e,t,n){var r=document.createElement("div");return r.style.width=this.tileSize.x,r.style.height=this.tileSize.y,r["background-color"]=this.color,r},tileSize:new google.maps.Size(256,256),maxZoom:100,minZoom:0,name:"plain layer",alt:"plain layer"}),cdb.geo.GMapsPlainLayerView=e}(),function(){if(typeof google=="undefined"||typeof google.maps=="undefined")return;var e=function(e,t){cdb.geo.GMapsLayerView.call(this,e,this,t),this.tileSize=new google.maps.Size(256,256),this.opacity=1,this.isPng=!0,this.maxZoom=22,this.minZoom=0,this.name="cartodb tiled layer",google.maps.ImageMapType.call(this,this)};_.extend(e.prototype,cdb.geo.GMapsLayerView.prototype,google.maps.ImageMapType.prototype,{getTileUrl:function(e,t){var n=e.y,r=1<<t;if(n<0||n>=r)return null;var i=e.x;if(i<0||i>=r)i=(i%r+r)%r;this.model.get("tms")&&(n=r-n-1);var s=this.model.get("urlTemplate");return s.replace("{x}",i).replace("{y}",n).replace("{z}",t)}}),cdb.geo.GMapsTiledLayerView=e}(),function(){function e(){}function t(e){var t=function(t,n){var r=this,i=[];_.bindAll(this,"featureOut","featureOver","featureClick"),t.attributes.attribution=cdb.config.get("cartodb_attributions");var s=_.clone(t.attributes);s.map=n;var o=s.featureOver,u=s.featureOut,a=s.featureClick;s.featureOver=function(e,t,n,s,u){i[u]||r.trigger("layermouseover",u),i[u]=1,_.any(i)&&r.trigger("mouseover"),o&&o.apply(this,arguments),r.featureOver&&r.featureOver.apply(this,arguments)},s.featureOut=function(e,t){i[t]&&r.trigger("layermouseout",t),i[t]=0,_.any(i)||r.trigger("mouseout"),u&&u.apply(this,arguments),r.featureOut&&r.featureOut.apply(this,arguments)},s.featureClick=_.debounce(function(){a&&a.apply(this,arguments),r.featureClick&&r.featureClick.apply(s,arguments)},10),e.call(this,s),cdb.geo.GMapsLayerView.call(this,t,this,n)};return _.extend(t.prototype,cdb.geo.GMapsLayerView.prototype,e.prototype,{_update:function(){this.setOptions(this.model.attributes)},reload:function(){this.model.invalidate()},remove:function(){cdb.geo.GMapsLayerView.prototype.remove.call(this),this.clear()},featureOver:function(e,t,n,r,i){this.trigger("featureOver",e,[t.lat(),t.lng()],n,r,i)},featureOut:function(e,t){this.trigger("featureOut",e,t)},featureClick:function(e,t,n,r,i){this.trigger("featureClick",e,[t.lat(),t.lng()],n,r,i)},error:function(e){this.model&&(this.model.trigger("error",e?e.errors:"unknown error"),this.model.trigger("tileError",e?e.errors:"unknown error"))},ok:function(e){this.model.trigger("tileOk")},tilesOk:function(e){this.model.trigger("tileOk")},loading:function(){this.trigger("loading")},finishLoading:function(){this.trigger("load")}}),t}if(typeof google=="undefined"||typeof google.maps=="undefined")return;var n=function(e){this.setMap(e)};n.prototype=new google.maps.OverlayView,n.prototype.draw=function(){},n.prototype.latLngToPixel=function(e){var t=this.getProjection();return t?t.fromLatLngToContainerPixel(e):[0,0]},n.prototype.pixelToLatLng=function(e){var t=this.getProjection();return t?t.fromContainerPixelToLatLng(e):[0,0]};var r={opacity:.99,attribution:"CartoDB",debug:!1,visible:!0,added:!1,tiler_domain:"cartodb.com",tiler_port:"80",tiler_protocol:"http",sql_api_domain:"cartodb.com",sql_api_port:"80",sql_api_protocol:"http",extra_params:{},cdn_url:null,subdomains:null},i=function(e){this.options=_.defaults(e,r),this.tiles=0,this.tilejson=null,this.interaction=[];if(!e.named_map&&!e.sublayers)throw new Error("cartodb-gmaps needs at least the named_map");this.options.cartodb_logo!=0&&cdb.geo.common.CartoDBLogo.addWadus({left:74,bottom:8},2e3,this.options.map.getDiv()),wax.g.connector.call(this,e),_.extend(this.options,e),this.projector=new n(e.map),NamedMap.call(this,this.options.named_map,this.options),CartoDBLayerCommon.call(this),this.update()},s=function(e){this.options=_.defaults(e,r),this.tiles=0,this.tilejson=null,this.interaction=[];if(!e.layer_definition&&!e.sublayers)throw new Error("cartodb-leaflet needs at least the layer_definition or sublayer list");e.layer_definition||(e.layer_definition=LayerDefinition.layerDefFromSubLayers(e.sublayers)),this.options.cartodb_logo!=0&&cdb.geo.common.CartoDBLogo.addWadus({left:74,bottom:8},2e3,this.options.map.getDiv()),wax.g.connector.call(this,e),_.extend(this.options,e),this.projector=new n(e.map),LayerDefinition.call(this,e.layer_definition,this.options),CartoDBLayerCommon.call(this),this.update()};e.prototype.setOpacity=function(e){if(isNaN(e)||e>1||e<0)throw new Error(e+" is not a valid value, should be in [0, 1] range");this.opacity=this.options.opacity=e;for(var t in this.cache){var n=this.cache[t];n.style.opacity=e,n.style.filter="alpha(opacity="+e*100+");"}},e.prototype.setAttribution=function(){},e.prototype.getTile=function(e,t,n){var r="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",i=this;this.options.added=!0;if(this.tilejson==null){var s=t+"/"+e.x+"/"+e.y,o=this.cache[s]=new Image(256,256);return o.src=r,o.setAttribute("gTileKey",s),o.style.opacity=this.options.opacity,o}var u=wax.g.connector.prototype.getTile.call(this,e,t,n);this.tiles===0&&this.loading&&this.loading(),this.tiles++;var a=cartodb.core.Profiler.metric("cartodb-js.tile.png.load.time").start(),f=function(){a.end(),i.tiles--,i.tiles===0&&i.finishLoading&&i.finishLoading()};return u.onload=f,u.onerror=function(){cartodb.core.Profiler.metric("cartodb-js.tile.png.error").inc(),f()},u},e.prototype.onAdd=function(){},e.prototype.clear=function(){this._clearInteraction(),self.finishLoading&&self.finishLoading()},e.prototype.update=function(e){var t=this;this.loading&&this.loading(),this.getTiles(function(n,r){n?(t.tilejson=n,t.options.tiles=n.tiles,t.tiles=0,t.cache={},t._reloadInteraction(),t.refreshView(),t.ok&&t.ok(),e&&e()):t.error&&t.error(r)})},e.prototype.refreshView=function(){var e=this,t=this.options.map;t.overlayMapTypes.forEach(function(n,r){if(n==e){t.overlayMapTypes.setAt(r,e);return}})},e.prototype.onLayerDefinitionUpdated=function(){this.update()},e.prototype._checkLayer=function(){if(!this.options.added)throw new Error("the layer is not still added to the map")},e.prototype._findPos=function(e,t){var n,r;n=curtop=0;var i=e.getDiv();do n+=i.offsetLeft,curtop+=i.offsetTop;while(i=i.offsetParent);return new google.maps.Point((t.e.clientX||t.e.changedTouches[0].clientX)-n,(t.e.clientY||t.e.changedTouches[0].clientY)-curtop)},e.prototype._manageOffEvents=function(e,t){if(this.options.featureOut)return this.options.featureOut&&this.options.featureOut(t.e,t.layer)},e.prototype._manageOnEvents=function(e,t){var n=this._findPos(e,t),r=this.projector.pixelToLatLng(n),i=t.e.type.toLowerCase();switch(i){case"mousemove":if(this.options.featureOver)return this.options.featureOver(t.e,r,n,t.data,t.layer);break;case"click":case"touchend":case"mspointerup":this.options.featureClick&&this.options.featureClick(t.e,r,n,t.data,t.layer);break;default:}},s.Projector=n,s.prototype=new wax.g.connector,_.extend(s.prototype,LayerDefinition.prototype,e.prototype,CartoDBLayerCommon.prototype),s.prototype.interactionClass=wax.g.interaction,i.prototype=new wax.g.connector,_.extend(i.prototype,NamedMap.prototype,e.prototype,CartoDBLayerCommon.prototype),i.prototype.interactionClass=wax.g.interaction,cdb.geo.CartoDBLayerGroupGMaps=s,cdb.geo.CartoDBNamedMapGMaps=i,cdb.geo.GMapsCartoDBLayerGroupView=t(s),cdb.geo.GMapsCartoDBNamedMapView=t(i),cdb.geo.CartoDBNamedMapGMaps=i}(),function(){if(typeof google=="undefined"||typeof google.maps=="undefined")return;var e=function(e){this.setMap(e)};e.prototype=new google.maps.OverlayView,e.prototype.draw=function(){},e.prototype.latLngToPixel=function(e){var t=this.getProjection();return t?t.fromLatLngToContainerPixel(e):[0,0]},e.prototype.pixelToLatLng=function(e){var t=this.getProjection();return t?t.fromContainerPixelToLatLng(e):[0,0]};var t=function(e){var t={query:"SELECT * FROM {{table_name}}",opacity:.99,attribution:"CartoDB",opacity:1,debug:!1,visible:!0,added:!1,extra_params:{},layer_definition_version:"1.0.0"};this.options=_.defaults(e,t);if(!e.table_name||!e.user_name||!e.tile_style)throw"cartodb-gmaps needs at least a CartoDB table name, user_name and tile_style";this.options.layer_definition={version:this.options.layer_definition_version,layers:[{type:"cartodb",options:this._getLayerDefinition(),infowindow:this.options.infowindow}]},cdb.geo.CartoDBLayerGroupGMaps.call(this,this.options),this.setOptions(this.options)};_.extend(t.prototype,cdb.geo.CartoDBLayerGroupGMaps.prototype),t.prototype.setQuery=function(e,t){t===undefined&&(t=e,e=0),t=t||"select * from "+this.options.table_name,LayerDefinition.prototype.setQuery.call(this,e,t)},cdb.geo.CartoDBLayerGMaps=t;var n=function(e,t){var n=this;_.bindAll(this,"featureOut","featureOver","featureClick"),e.attributes.attribution=cdb.config.get("cartodb_attributions");var r=_.clone(e.attributes);r.map=t;var i=r.featureOver,s=r.featureOut,o=r.featureClick;r.featureOver=function(){i&&i.apply(this,arguments),n.featureOver&&n.featureOver.apply(this,arguments)},r.featureOut=function(){s&&s.apply(this,arguments),n.featureOut&&n.featureOut.apply(this,arguments)},r.featureClick=function(){o&&o.apply(this,arguments),n.featureClick&&n.featureClick.apply(r,arguments)},cdb.geo.CartoDBLayerGMaps.call(this,r),cdb.geo.GMapsLayerView.call(this,e,this,t)};cdb.geo.GMapsCartoDBLayerView=n,_.extend(n.prototype,cdb.geo.CartoDBLayerGMaps.prototype,cdb.geo.GMapsLayerView.prototype,{_update:function(){this.setOptions(this.model.attributes)},reload:function(){this.model.invalidate()},remove:function(){cdb.geo.GMapsLayerView.prototype.remove.call(this),this.clear()},featureOver:function(e,t,n,r){this.trigger("featureOver",e,[t.lat(),t.lng()],n,r,0)},featureOut:function(e){this.trigger("featureOut",e)},featureClick:function(e,t,n,r,i){this.trigger("featureClick",e,[t.lat(),t.lng()],n,r,0)},error:function(e){this.model&&(this.model.trigger("error",e?e.error:"unknown error"),this.model.trigger("tileError",e?e.error:"unknown error"))},tilesOk:function(e){this.model.trigger("tileOk")},loading:function(){this.trigger("loading")},finishLoading:function(){this.trigger("load")}})}();if(typeof google!="undefined"&&typeof google.maps!="undefined"){var DEFAULT_MAP_STYLE=[{stylers:[{saturation:-65},{gamma:1.52}]},{featureType:"administrative",stylers:[{saturation:-95},{gamma:2.26}]},{featureType:"water",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative.locality",stylers:[{visibility:"off"}]},{featureType:"road",stylers:[{visibility:"simplified"},{saturation:-99},{gamma:2.22}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.arterial",stylers:[{visibility:"off"}]},{featureType:"road.local",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi",stylers:[{saturation:-55}]}];cdb.geo.GoogleMapsMapView=cdb.geo.MapView.extend({layerTypeMap:{tiled:cdb.geo.GMapsTiledLayerView,cartodb:cdb.geo.GMapsCartoDBLayerView,carto:cdb.geo.GMapsCartoDBLayerView,plain:cdb.geo.GMapsPlainLayerView,gmapsbase:cdb.geo.GMapsBaseLayerView,layergroup:cdb.geo.GMapsCartoDBLayerGroupView,namedmap:cdb.geo.GMapsCartoDBNamedMapView,torque:function(e,t){return new cdb.geo.GMapsTorqueLayerView(e,t)},wms:cdb.geo.LeafLetWMSLayerView},initialize:function(){_.bindAll(this,"_ready"),this._isReady=!1;var e=this;cdb.geo.MapView.prototype.initialize.call(this);var t=this.map.getViewBounds();t&&this.showBounds(t);var n=this.map.get("center");if(!this.options.map_object)this.map_googlemaps=new google.maps.Map(this.el,{center:new google.maps.LatLng(n[0],n[1]),zoom:this.map.get("zoom"),minZoom:this.map.get("minZoom"),maxZoom:this.map.get("maxZoom"),disableDefaultUI:!0,scrollwheel:this.map.get("scrollwheel"),mapTypeControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP,backgroundColor:"white",tilt:0}),this.map.bind("change:maxZoom",function(){e.map_googlemaps.setOptions({maxZoom:e.map.get("maxZoom")})},this),this.map.bind("change:minZoom",function(){e.map_googlemaps.setOptions({minZoom:e.map.get("minZoom")})},this);else{this.map_googlemaps=this.options.map_object,this.setElement(this.map_googlemaps.getDiv());var r=e.map_googlemaps.getCenter();e._setModelProperty({center:[r.lat(),r.lng()]}),e._setModelProperty({zoom:e.map_googlemaps.getZoom()}),e.map.unset("view_bounds_sw",{silent:!0}),e.map.unset("view_bounds_ne",{silent:!0})}this.map.geometries.bind("add",this._addGeometry,this),this.map.geometries.bind("remove",this._removeGeometry,this),this._bindModel(),this._addLayers(),google.maps.event.addListener(this.map_googlemaps,"center_changed",function(){var t=e.map_googlemaps.getCenter();e._setModelProperty({center:[t.lat(),t.lng()]})}),google.maps.event.addListener(this.map_googlemaps,"zoom_changed",function(){e._setModelProperty({zoom:e.map_googlemaps.getZoom()})}),google.maps.event.addListener(this.map_googlemaps,"click",function(t){e.trigger("click",t,[t.latLng.lat(),t.latLng.lng()])}),google.maps.event.addListener(this.map_googlemaps,"dblclick",function(t){e.trigger("dblclick",t)}),this.map.layers.bind("add",this._addLayer,this),this.map.layers.bind("remove",this._removeLayer,this),this.map.layers.bind("reset",this._addLayers,this),this.map.layers.bind("change:type",this._swicthLayerView,this),this.projector=new cdb.geo.CartoDBLayerGroupGMaps.Projector(this.map_googlemaps),this.projector.draw=this._ready},_ready:function(){this.projector.draw=function(){},this.trigger("ready"),this._isReady=!0},_setScrollWheel:function(e,t){this.map_googlemaps.setOptions({scrollwheel:t})},_setZoom:function(e,t){t=t||0,this.map_googlemaps.setZoom(t)},_setCenter:function(e,t){var n=new google.maps.LatLng(t[0],t[1]);this.map_googlemaps.setCenter(n)},createLayer:function(e){var t,n=this.layerTypeMap[e.get("type").toLowerCase()];if(n)try{t=new n(e,this.map_googlemaps)}catch(r){cdb.log.error("MAP: error creating layer"+e.get("type")+" "+r)}else cdb.log.error("MAP: "+e.get("type")+" can't be created");return t},_addLayer:function(e,t,n){n=n||{};var r=this,i,s;s=this.createLayer(e);if(!s)return;this.layers[e.cid]=s;if(s){var o=_(this.layers).filter(function(e){return!!e.getTile}).length-1,u=_.keys(this.layers).length===1||n&&n.index===0;if(u&&!n.no_base_layer){var a=s.model;a.get("type")==="GMapsBase"?s._update():(s.isBase=!0,s._update())}else o-=1,o=Math.max(0,o),s.getTile?(s.gmapsLayer||cdb.log.error("gmaps layer can't be null"),r.map_googlemaps.overlayMapTypes.setAt(o,s.gmapsLayer)):s.gmapsLayer.setMap(r.map_googlemaps);(n===undefined||!n.silent)&&this.trigger("newLayerView",s,e,this)}else cdb.log.error("layer type not supported");var f=e.get("attribution");if(f){var l=this.map.get("attribution")||[];_.contains(l,f)||l.push(f),this.map.set({attribution:l})}return s},latLonToPixel:function(e){return this.projector.latLngToPixel(new google.maps.LatLng(e[0],e[1]))},getSize:function(){return{x:this.$el.width(),y:this.$el.height()}},panBy:function(e){var t=this.map.get("center"),n=this.latLonToPixel(t);e.x+=n.x,e.y+=n.y;var r=this.projector.pixelToLatLng(e);this.map.setCenter([r.lat(),r.lng()])},getBounds:function(){if(this._isReady){var e=this.map_googlemaps.getBounds(),t=e.getSouthWest(),n=e.getNorthEast();return[[t.lat(),t.lng()],[n.lat(),n.lng()]]}return[[0,0],[0,0]]},setAttribution:function(e){var t=document.getElementById("cartodb-gmaps-attribution"),n=e.get("attribution").join(", ");t&&t.parentNode.removeChild(t);var r=this.map_googlemaps.getDiv(),i=document.createElement("div");i.setAttribute("id","cartodb-gmaps-attribution"),i.setAttribute("class","gmaps"),r.appendChild(i),i.innerHTML=n},setCursor:function(e){this.map_googlemaps.setOptions({draggableCursor:e})},_addGeomToMap:function(e){var t=cdb.geo.GoogleMapsMapView.createGeometry(e);if(t.geom.length)for(var n=0;n<t.geom.length;++n)t.geom[n].setMap(this.map_googlemaps);else t.geom.setMap(this.map_googlemaps);return t},_removeGeomFromMap:function(e){if(e.geom.length)for(var t=0;t<e.geom.length;++t)e.geom[t].setMap(null);else e.geom.setMap(null)},getNativeMap:function(){return this.map_googlemaps},invalidateSize:function(){google.maps.event.trigger(this.map_googlemaps,"resize")}},{addLayerToMap:function(e,t,n){n=n||0,e||cdb.log.error("gmaps layer can't be null"),e.getTile?t.overlayMapTypes.setAt(n,e):e.setMap(t)},createGeometry:function(e){return e.isPoint()?new cdb.geo.gmaps.PointView(e):new cdb.geo.gmaps.PathView(e)}})}cdb.ui.common.Dialog=cdb.core.View.extend({tagName:"div",className:"dialog",events:{"click .ok":"_ok","click .cancel":"_cancel","click .close":"_cancel"},default_options:{title:"title",description:"",ok_title:"Ok",cancel_title:"Cancel",width:300,height:200,clean_on_hide:!1,enter_to_confirm:!1,template_name:"common/views/dialog_base",ok_button_classes:"button green",cancel_button_classes:"",modal_type:"",modal_class:"",include_footer:!0,additionalButtons:[]},initialize:function(){_.defaults(this.options,this.default_options),_.bindAll(this,"render","_keydown"),$(document).bind("keydown",this._keydown),this.bind("clean",this._reClean),this.template_base=this.options.template_base?_.template(this.options.template_base):cdb.templates.getTemplate(this.options.template_name)},render:function(){var e=this.$el;return e.html(this.template_base(this.options)),e.find(".modal").css({width:this.options.width}),this.render_content&&this.$(".content").append(this.render_content()),this.options.modal_class&&this.$el.addClass(this.options.modal_class),this},_keydown:function(e){e.keyCode===27?this._cancel():e.keyCode===13&&this.options.enter_to_confirm&&this._ok()},appendToBody:function(){return $("body").append(this.render().el),this},_ok:function(e){e&&e.preventDefault(),this.ok&&this.ok(this.result),this.hide()},_cancel:function(e){e&&(e.preventDefault(),e.stopPropagation()),this.cancel&&this.cancel(),this.hide()},hide:function(){this.$el.hide(),this.options.clean_on_hide&&this.clean()},open:function(){this.$el.show()},_reClean:function(){$(document).unbind("keydown",this._keydown)}}),cdb.ui.common.ShareDialog=cdb.ui.common.Dialog.extend({tagName:"div",className:"cartodb-share-dialog",events:{"click .ok":"_ok","click .cancel":"_cancel","click .close":"_cancel",click:"_stopPropagation",dblclick:"_stopPropagation",mousedown:"_stopPropagation"},default_options:{title:"",description:"",ok_title:"Ok",cancel_title:"Cancel",width:300,height:200,clean_on_hide:!1,enter_to_confirm:!1,template_name:"common/views/dialog_base",ok_button_classes:"button green",cancel_button_classes:"",modal_type:"",modal_class:"",include_footer:!0,additionalButtons:[]},initialize:function(){_.defaults(this.options,this.default_options),_.bindAll(this,"render","_keydown"),this.isOpen=!1;var e=this;this.options.target&&this.options.target.on("click",function(t){t.preventDefault(),t.stopPropagation(),e.open()}),$(document).bind("keydown",this._keydown),this.bind("clean",this._reClean)},_stopPropagation:function(e){e.stopPropagation()},open:function(){var e=this;this.$el.show(0,function(){e.isOpen=!0})},hide:function(){var e=this;this.$el.hide(0,function(){e.isOpen=!1}),this.options.clean_on_hide&&this.clean()},toggle:function(){this.isOpen?this.hide():this.open()},_truncateTitle:function(e,t){return e.substr(0,t-1)+(e.length>t?"…":"")},render:function(){var e=this.$el,t=this.options.title,n=this.options.description,r=this.options.share_url,i,s;this.$el.addClass(this.options.size);var o=t+": "+n,u;t&&n?u=this._truncateTitle(t+": "+n,112)+" %23map ":t?u=this._truncateTitle(t,112)+" %23map":n?u=this._truncateTitle(n,112)+" %23map":u="%23map",this.options.facebook_url?i=this.options.facebook_url:i="http://www.facebook.com/sharer.php?u="+r+"&text="+o,this.options.twitter_url?s=this.options.twitter_url:s="https://twitter.com/share?url="+r+"&text="+u;var a=_.extend(this.options,{facebook_url:i,twitter_url:s});return e.html(this.options.template(a)),e.find(".modal").css({width:this.options.width}),this.render_content&&this.$(".content").append(this.render_content()),this.options.modal_class&&this.$el.addClass(this.options.modal_class),this.options.disableLinks&&this.$el.find("a").attr("target",""),this}}),cdb.ui.common.Notification=cdb.core.View.extend({tagName:"div",className:"dialog",events:{"click .close":"hide"},default_options:{timeout:0,msg:"",hideMethod:"",duration:"normal"},initialize:function(){this.closeTimeout=-1,_.defaults(this.options,this.default_options),this.template=this.options.template?_.template(this.options.template):cdb.templates.getTemplate("common/notification"),this.$el.hide()},render:function(){var e=this.$el;return e.html(this.template(this.options)),this.render_content&&this.$(".content").append(this.render_content()),this},hide:function(e){var t=this;e&&e.preventDefault(),clearTimeout(this.closeTimeout),this.options.hideMethod!=""&&this.$el.is(":visible")?this.$el[this.options.hideMethod](this.options.duration,"swing",function(){t.$el.html(""),t.trigger("notificationDeleted"),t.remove()}):(this.$el.hide(),t.$el.html(""),t.trigger("notificationDeleted"),t.remove())},open:function(e,t){this.render(),this.$el.show(e,t),this.options.timeout&&(this.closeTimeout=setTimeout(_.bind(this.hide,this),this.options.timeout))}}),cdb.ui.common.Row=cdb.core.Model.extend({}),cdb.ui.common.TableData=Backbone.Collection.extend({model:cdb.ui.common.Row,fetched:!1,initialize:function(){var e=this;this.bind("reset",function(){e.fetched=!0})},getCell:function(e,t){var n=this.at(e);return n?n.get(t):null},isEmpty:function(){return this.length===0}}),cdb.ui.common.TableProperties=cdb.core.Model.extend({columnNames:function(){return _.map(this.get("schema"),function(e){return e[0]})},columnName:function(e){return this.columnNames()[e]}}),cdb.ui.common.RowView=cdb.core.View.extend({tagName:"tr",initialize:function(){this.model.bind("change",this.render,this),this.model.bind("destroy",this.clean,this),this.model.bind("remove",this.clean,this),this.model.bind("change",this.triggerChange,this),this.model.bind("sync",this.triggerSync,this),this.model.bind("error",this.triggerError,this),this.add_related_model(this.model),this.order=this.options.order},triggerChange:function(){this.trigger("changeRow")},triggerSync:function(){this.trigger("syncRow")},triggerError:function(){this.trigger("errorRow")},valueView:function(e,t){return t},render:function(){var e=this,t=this.model,n="",r=0,i;this.options.row_header?i='<td class="rowHeader" data-x="'+r+'">':i='<td class="EmptyRowHeader" data-x="'+r+'">';var s=e.valueView("","");s.html&&(s=s[0].outerHTML),i+=s,i+="</td>",r++,n+=i;var o=this.order||_.keys(t.attributes),u="",a=t.attributes;for(var f=0,l=o.length;f<l;++f){var c=o[f],h=a[c];if(h!==undefined){var i='<td id="cell_'+t.id+"_"+c+'" data-x="'+r+'">',s=e.valueView(c,h);s.html&&(s=s[0].outerHTML),i+=s,i+="</td>",r++,u+=i}}return n+=u,this.$el.html(n).attr("id","row_"+t.id),this},getCell:function(e){var t=e;return this.options.row_header&&++e,this.$("td:eq("+e+")")},getTableView:function(){return this.tableView}}),cdb.ui.common.Table=cdb.core.View.extend({tagName:"table",rowView:cdb.ui.common.RowView,events:{"click td":"_cellClick","dblclick td":"_cellDblClick"},default_options:{},initialize:function(){var e=this;_.defaults(this.options,this.default_options),this.dataModel=this.options.dataModel,this.rowViews=[],this.setDataSource(this.dataModel),this.model.bind("change",this.render,this),this.model.bind("change:dataSource",this.setDataSource,this),this.bind("clean",this.clear_rows,this),this.add_related_model(this.dataModel),this.add_related_model(this.model),this.model.bind("removing:row",function(){e.rowsBeingDeleted=e.rowsBeingDeleted?e.rowsBeingDeleted+1:1,e.rowDestroying()}),this.model.bind("remove:row",function(){e.rowsBeingDeleted>0&&(e.rowsBeingDeleted--,e.rowDestroyed(),e.dataModel.length==0&&e.emptyTable())})},headerView:function(e){return e[0]},setDataSource:function(e){this.dataModel&&this.dataModel.unbind(null,null,this),this.dataModel=e,this.dataModel.bind("reset",this._renderRows,this),this.dataModel.bind("error",this._renderRows,this),this.dataModel.bind("add",this.addRow,this)},_renderHeader:function(){var e=this,t=$("<thead>"),n=$("<tr>");return this.options.row_header?n.append($("<th>").append(e.headerView(["","header"]))):n.append($("<th>").append(e.headerView(["","header"]))),_(this.model.get("schema")).each(function(t){n.append($("<th>").append(e.headerView(t)))}),t.append(n),t},clear_rows:function(){this.$("tfoot").remove(),this.$("tr.noRows").remove();var e=null;while(e=this.rowViews.pop())e.unbind(null,null,this),e.clean();this.rowViews=[]},addRow:function(e,t,n){var r=this,i=new r.rowView({model:e,order:this.model.columnNames(),row_header:this.options.row_header});i.tableView=this,i.bind("clean",function(){var e=_.indexOf(r.rowViews,i);r.rowViews.splice(e,1);for(var t=e;t<r.rowViews.length;++t)r.rowViews[t].$el.attr("data-y",t)},this),i.bind("changeRow",this.rowChanged,this),i.bind("saved",this.rowSynched,this),i.bind("errorRow",this.rowFailed,this),i.bind("saving",this.rowSaving,this),this.retrigger("saving",i),i.render();if(n&&n.index!==undefined&&n.index!=r.rowViews.length){i.$el.insertBefore(r.rowViews[n.index].$el),r.rowViews.splice(n.index,0,i);for(var s=n.index;s<r.rowViews.length;++s)r.rowViews[s].$el.attr("data-y",s)}else i.$el.attr("data-y",r.rowViews.length),r.$el.append(i.el),r.rowViews.push(i);this.trigger("createRow")},rowChanged:function(){},rowSynched:function(){},rowFailed:function(){},rowSaving:function(){},rowDestroying:function(){},rowDestroyed:function(){},emptyTable:function(){},isEmptyTable:function(){return this.dataModel.length===0&&this.dataModel.fetched},_renderRows:function(){this.clear_rows();if(!this.isEmptyTable())if(this.dataModel.fetched){var e=this;this.dataModel.each(function(t){e.addRow(t)})}else this._renderLoading();else this._renderEmpty()},_renderLoading:function(){},_renderEmpty:function(){},addEmptyTableInfo:function(){},render:function(){var e=this;return e.$el.html(e._renderHeader()),e._renderRows(),this},getCell:function(e,t){return this.options.row_header&&++t,this.rowViews[t].getCell(e)},_cellClick:function(e,t){t=t||"cellClick",e.preventDefault();var n=$(e.currentTarget||e.target),r=parseInt(n.attr("data-x"),10),i=parseInt(n.parent().attr("data-y"),10);this.trigger(t,e,n,r,i)},_cellDblClick:function(e){this._cellClick(e,"cellDblClick")}}),cdb.ui.common.Dropdown=cdb.core.View.extend({tagName:"div",className:"dropdown",events:{"click ul li a":"_fireClick"},default_options:{width:160,speedIn:150,speedOut:300,vertical_position:"down",horizontal_position:"right",tick:"right",vertical_offset:0,horizontal_offset:0},initialize:function(){_.bindAll(this,"open","hide","_handleClick","_keydown"),_.defaults(this.options,this.default_options),this.options.template_base?this.template_base=cdb.templates.getTemplate(this.options.template_base):this.options.template&&(this.template_base=this.options.template),$(this.options.target).bind({click:this._handleClick}),$(document).bind("keydown",this._keydown),this.isOpen=!1},render:function(){var e=this.$el;return e.html(this.template_base(this.options)).css({width:this.options.width}),this},_handleClick:function(e){e&&(e.preventDefault(),e.stopPropagation()),this.isOpen?this.hide():this.open()},_keydown:function(e){e.keyCode===27&&this.hide()},hide:function(){this.isOpen=!1,this.$el.hide()},show:function(){this.$el.css({display:"block",opacity:1}),this.isOpen=!0},open:function(e,t){var n=t&&$(t)||this.options.target;this.options.target=n;var r=n[this.options.position||"offset"](),i=n.outerWidth(),s=n.outerHeight(),o=this.$el.outerWidth(),u=this.$el.outerHeight(),a=this;this.$el.css({top:r.top+parseInt(a.options.vertical_position=="up"?-u-10-a.options.vertical_offset:s+10-a.options.vertical_offset),left:r.left+parseInt(a.options.horizontal_position=="left"?a.options.horizontal_offset-15:i-o+15-a.options.horizontal_offset)}).addClass((this.options.vertical_position=="up"?"vertical_top":"vertical_bottom")+" "+(this.options.horizontal_position=="right"?"horizontal_right":"horizontal_left")+" "+"tick_"+this.options.tick),this.show(),this.isOpen=!0},_fireClick:function(e){this.trigger("optionClicked",e,this.el)}}),function(){var e={},t={_types:{},register:function(e,n){t._types[e]=n},create:function(e,n,r){var i=t._types[e];i||cdb.log.error("Overlay: "+e+" does not exist");var s=i(r,n);return s.type=e,s}};cdb.vis.Overlay=t;var n={_types:{},register:function(e,t){this._types[e]=t},create:function(e,t,n){if(!e)return cdb.log.error("creating a layer without type"),null;var r=this._types[e.toLowerCase()],i={};return i.type=e,_.extend(i,n,n.options),new r(t,i)},moduleForLayer:function(e){return e.toLowerCase()==="torque"?"torque":null},modulesForLayers:function(e){var t=_(e).map(function(e){return n.moduleForLayer(e.type||e.kind)});return _.compact(_.uniq(t))}};cdb.vis.Layers=n;var r=cdb.vis.Loader={queue:[],current:undefined,_script:null,head:null,loadScript:function(e){var t=document.createElement("script");return t.type="text/javascript",t.src=e,t.async=!0,r.head||(r.head=document.getElementsByTagName("head")[0]),setTimeout(function(){r.head.appendChild(t)},0),t},get:function(e,t){r._script?r.queue.push([e,t]):(r.current=t,r._script=r.loadScript(e+(~e.indexOf("?")?"&":"?")+"callback=vizjson"))},getPath:function(e){var t=document.getElementsByTagName("script"),n=/\/?cartodb[\-\._]?([\w\-\._]*)\.js\??/;for(i=0,len=t.length;i<len;i++){src=t[i].src,matches=src.match(n);if(matches){var r=src.split("/");return delete r[r.length-1],r.join("/")+e}}return null},loadModule:function(e){var t="cartodb.mod."+e+(cartodb.DEBUG?".uncompressed.js":".js"),n=this.getPath(t);n||cartodb.log.error("can't find cartodb.js file"),r.loadScript(n)}};window.vizjson=function(e){r.current&&r.current(e),r.head.removeChild(r._script),r._script=null;var t=r.queue.shift();t&&r.get(t[0],t[1])},cartodb.moduleLoad=function(e,t){cartodb[e]=t,cartodb.config.modules.add({name:t})};var s=cdb.core.View.extend({initialize:function(){_.bindAll(this,"loadingTiles","loadTiles","_onResize"),this.https=!1,this.overlays=[],this.moduleChecked=!1,this.layersLoading=0,this.options.mapView&&(this.mapView=this.options.mapView,this.map=this.mapView.map),window.addEventListener?window.addEventListener("orientationchange",_.bind(this.doOnOrientationChange,this)):window.attachEvent("orientationchange",this.doOnOrientationChange,this)},doOnOrientationChange:function(){this.setMapPosition()},checkModules:function(e){var t=n.modulesForLayers(e);return _.every(_.map(t,function(e){return cartodb[e]!==undefined}))},loadModules:function(e,t){function i(){s.checkModules(e)&&(cdb.config.unbind("moduleLoaded",i),t())}var s=this,o=n.modulesForLayers(e);for(var u=0;u<o.length;++u)r.loadModule(o[u]);cdb.config.bind("moduleLoaded",i),_.defer(i)},load:function(e,t){var n=this;if(typeof e=="string"){var r=e;return cdb.vis.Loader.get(r,function(e){e?n.load(e,t):n.throwError("error fetching viz.json file")}),this}if(!this.checkModules(e.layers))return this.moduleChecked?(n.throwError("modules couldn't be loaded"),this):(this.moduleChecked=!0,this.loadModules(e.layers,function(){n.load(e,t)}),this);window&&window.location.protocol&&window.location.protocol==="https:"&&(this.https=!0),e.https&&(this.https=e.https);var i=!0;t=t||{},this._applyOptions(e,t),this.cartodb_logo=t.cartodb_logo,i=t.scrollwheel,e.maxZoom||(e.maxZoom=20),e.minZoom||(e.minZoom=0);var s={title:e.title,description:e.description,maxZoom:e.maxZoom,minZoom:e.minZoom,scrollwheel:i,provider:e.map_provider};e.bounding_box_sw&&e.bounding_box_ne&&(s.bounding_box_sw=e.bounding_box_sw,s.bounding_box_ne=e.bounding_box_ne);if(e.bounds)s.view_bounds_sw=e.bounds[0],s.view_bounds_ne=e.bounds[1];else{var o=e.center;typeof o=="string"&&(o=$.parseJSON(o)),s.center=o||[0,0],s.zoom=e.zoom==undefined?4:e.zoom}var u=new cdb.geo.Map(s);this.map=u,this.updated_at=e.updated_at||(new Date).getTime();var a=this.$el.outerHeight();a===0&&(this.mapConfig=s,$(window).bind("resize",this._onResize));var f=$("<div>").css({position:"relative",width:"100%",height:"100%"});this.container=f;var l=$("<div>").addClass("cartodb-map-wrapper").css({position:"absolute",top:0,left:0,right:0,bottom:0,width:"100%"});f.append(l),this.$el.append(f);var c=new cdb.geo.MapView.create(l,u);this.mapView=c;for(var h in e.layers){var p=e.layers[h];this.loadLayer(p,t)}var d,v,m=/Android|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);t.shareable&&!m&&this.container.find(".cartodb-map-wrapper").append('<div class="cartodb-share" style="display: block;"><a href="#"></a></div>'),!m&&t.legends?this.addLegends(e.layers):(d=this.createLegendView(e.layers),this.legends=new cdb.geo.ui.StackedLegend({legends:d}));if(t.time_slider){var g=_(this.getLayers()).filter(function(e){return e.model.get("type")==="torque"});g.length&&(v=g[0],!m&&g.length&&this.addTimeSlider(v))}m&&this.addMobile(v);if(t.sublayer_options){var y=[],y=_.map(this.getLayers().slice(1),function(e){return e.getSubLayers?e.getSubLayers():e});y=_.flatten(y);for(h=0;h<Math.min(t.sublayer_options.length,y.length);++h){var b=t.sublayer_options[h],w=y[h],E=this.legends&&this.legends.getLegendByIndex(h);E&&E[b.visible?"show":"hide"]();if(w.model&&w.model.get("type")==="torque"){if(b.visible===!1){w.model.set("visible",!1);var S=this.getOverlay("time_slider");S&&S.hide()}}else b.visible===!1&&w.hide()}}for(var h in e.overlays)this.addOverlay(e.overlays[h]);var x=document.fullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled;return t.fullscreen&&x&&!m&&this.addFullScreen(),_.defer(function(){n.trigger("done",n,n.getLayers())}),this},addFullScreen:function(){this.addOverlay({type:"fullscreen"})},addMobile:function(e){this.addOverlay({type:"mobile",torqueLayer:e,legends:this.legends})},addTimeSlider:function(e){e&&this.addOverlay({type:"time_slider",layer:e})},addLegends:function(e){var t=this.createLegendView(e);this.legends=new cdb.geo.ui.StackedLegend({legends:t}),this.mapView.addOverlay(this.legends)},createLegendView:function(e){var t=[];for(var n=e.length-1;n>=0;--n){var r=e[n];if(r.legend){r.legend.data=r.legend.items;var i=r.legend;if(i.items&&i.items.length||i.template)r.legend.index=n,t.push(new cdb.geo.ui.Legend(r.legend))}r.options&&r.options.layer_definition?t=t.concat(this.createLegendView(r.options.layer_definition.layers)):r.options&&r.options.named_map&&r.options.named_map.layers&&(t=t.concat(this.createLegendView(r.options.named_map.layers)))}return t},addLegends:function(e){var t=this.createLegendView(e);this.legends=new cdb.geo.ui.StackedLegend({legends:t}),this.mapView.addOverlay(this.legends)},addOverlay:function(e){e.map=this.map;var n=t.create(e.type,this,e);return n&&(e.type=="loader"&&(this.loader=n),e.type=="header"?(this.addView(n),this.container.append(n.el)):this.mapView.addOverlay(n),this.overlays.push(n),n.bind("clean",function(){for(var e in this.overlays){var t=this.overlays[e];if(n.cid===t.cid){this.overlays.splice(e,1);return}}},this),e.type=="header"&&this.setMapPosition()),n},_applyOptions:function(e,t){function n(t){if(!e.overlays)return null;for(var n=0;n<e.overlays.length;++n)if(e.overlays[n].type===t)return e.overlays[n]}function r(t){if(!e.overlays)return;for(var n=0;n<e.overlays.length;++n)if(e.overlays[n].type===t){e.overlays.splice(n,1);return}}t=t||{},t=_.defaults(t,{search:!1,title:!1,description:!1,tiles_loader:!0,zoomControl:!0,loaderControl:!0,layer_selector:!1,searchControl:!1,infowindow:!0,legends:!0,time_slider:!0}),e.overlays=e.overlays||[],e.layers=e.layers||[],this.infowindow=t.infowindow,t.https&&(this.https=!0),(t.search||t.searchControl)&&e.overlays.push({type:"search"}),(t.title&&e.title||t.description&&e.description)&&e.overlays.unshift({type:"header",shareable:t.shareable?!0:!1,url:e.url}),t.shareable&&!i&&e.overlays.push({type:"share",url:e.url});var i=/Android|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);!i&&t.layer_selector&&e.overlays.push({type:"layer_selector"}),t.title||(e.title=null),t.description||(e.description=null),t.tiles_loader||r("loader"),t.zoomControl||r("zoom"),t.loaderControl||r("loader"),t.zoom!==undefined&&(e.zoom=parseFloat(t.zoom),e.bounds=null),t.center_lat!==undefined&&(e.center=[parseFloat(t.center_lat),parseFloat(t.center_lon)],e.bounds=null),t.center!==undefined&&(e.center=t.center,e.bounds=null),t.sw_lat!==undefined&&(e.bounds=[[parseFloat(t.sw_lat),parseFloat(t.sw_lon)],[parseFloat(t.ne_lat),parseFloat(t.ne_lon)]]);if(e.layers.length>1){var s=t.auth_token;for(var o=1;o<e.layers.length;++o){var u=e.layers[o].options;u.no_cdn=t.no_cdn,u.force_cors=t.force_cors,s&&(u.auth_token=s)}}},setMapPosition:function(){var e=this.$el.outerHeight();if(e!==0){var t=this.$(".cartodb-header:not(.cartodb-popup)").outerHeight();this.$el.find("div.cartodb-map-wrapper").css("top",t),this.mapView.invalidateSize()}},createLayer:function(e,t){var r=n.create(e.type||e.kind,this,e);return this.mapView.createLayer(r)},_getSqlApi:function(e){e=e||{};var t=e.sql_api_port,n=e.sql_api_domain+(t?":"+t:""),r=e.sql_api_protocol,i="v1";n.indexOf("cartodb.com")!==-1&&(r="http",n="cartodb.com",i="v2");var s=new cartodb.SQL({user:e.user_name,protocol:r,host:n,version:i});return s},addInfowindow:function(e){if(!e.containInfowindow||!e.containInfowindow())return;var n=this.mapView,r="featureClick",i=null;for(var s=0;s<e.getLayerCount();++s)if(e.getInfowindowData(s)){i||(i=t.create("infowindow",this,e.getInfowindowData(s),!0),n.addInfowindow(i));var o=e.getLayerNumberByIndex(s);e.setInteraction(o,!0)}if(!i)return;e.bind(r,function(t,n,r,s,o){var u=e.getInfowindowData(o);if(!u)return;var a=_.pluck(u.fields,"name"),f=s.cartodb_id;e.fetchAttributes(o,f,a,function(e){i.model.set({fields:u.fields,template:u.template,template_type:u.template_type,alternative_names:u.alternative_names}),e?(i.model.updateContent(e),i.adjustPan()):i.setError()}),i.setLatLng(n).setLoading().showInfowindow()});var u=[];e.bind("mouseover",function(){n.setCursor("pointer")}),e.bind("mouseout",function(e,t){n.setCursor("auto")}),e.infowindow=i.model},loadLayer:function(e,t){var r=this.map,i=this.mapView,s=r.addLayer(n.create(e.type||e.kind,this,e),t),o=i.getLayerByCid(s);if(!o){this.throwError("layer can't be created",r.layers.getByCid(s));return}o&&this.infowindow&&o.containInfowindow&&o.containInfowindow()&&this.addInfowindow(o);if(o){var u=this,a=function(){u.loadingTiles(t)},f=function(){u.loadTiles(t)};o.bind("loading",a),o.bind("load",f)}return o},loadingTiles:function(){this.loader&&(this.$el.find(".cartodb-fullscreen").hide(),this.loader.show()),this.layersLoading===0&&this.trigger("loading"),this.layersLoading++},loadTiles:function(){this.loader&&(this.loader.hide(),this.$el.find(".cartodb-fullscreen").fadeIn(150)),this.layersLoading--,this.layersLoading<=0&&(this.layersLoading=0,this.trigger("load"))},throwError:function(e,t){cdb.log.error(e);var n=this;_.defer(function(){n.trigger("error",e,t)})},error:function(e){return this.bind("error",e)},done:function(e){return this.bind("done",e)},getNativeMap:function(){return this.mapView.getNativeMap()},getLayers:function(){var e=this;return _.compact(this.map.layers.map(function(t){return e.mapView.getLayerByCid(t.cid)}))},getOverlays:function(){return this.overlays},getOverlay:function(e){return _(this.overlays).find(function(t){return t.type==e})},_onResize:function(){$(window).unbind("resize",this._onResize);var e=this;e.mapView.invalidateSize(),setTimeout(function(){e.setMapPosition();var t=e.mapConfig;t.view_bounds_sw?e.mapView.map.setBounds([t.view_bounds_sw,t.view_bounds_ne]):e.mapView.map.set({center:t.center,zoom:t.zoom})},150)}},{addInfowindow:function(e,t,n,r){var i=_.defaults(r||{},{infowindowTemplate:cdb.vis.INFOWINDOW_TEMPLATE.light,templateType:"mustache",triggerEvent:"featureClick",templateName:"light",extraFields:[],cursorInteraction:!0});if(!e)throw new Error("map is not valid");if(!t)throw new Error("layer is not valid");if(!n&&n.length===undefined)throw new Error("fields should be a list of strings");var s=[];n=n.concat(i.extraFields);for(var o=0;o<n.length;++o)s.push({name:n,order:o});var u=new cdb.geo.ui.InfowindowModel({fields:s,template_name:i.templateName}),a=new cdb.geo.ui.Infowindow({model:u,mapView:e.viz.mapView,template:(new cdb.core.Template({template:i.infowindowTemplate,type:i.templateType})).asFunction()});return e.viz.mapView.addInfowindow(a),t.setInteractivity(n),t.setInteraction(!0),t.bind(i.triggerEvent,function(e,t,n,r,i){var s=[];for(var o in r)s.push({title:o,value:r[o],index:0});a.model.set({content:{fields:s,data:r}}),a.setLatLng(t).showInfowindow(),a.adjustPan()},a),a.bind("clean",function(){t.unbind(i.triggerEvent,null,a)}),i.cursorInteraction&&cdb.vis.Vis.addCursorInteraction(e,t),a},addCursorInteraction:function(e,t){var n=e.viz.mapView;t.bind("mouseover",function(){n.setCursor("pointer")}),t.bind("mouseout",function(e,t){n.setCursor("auto")})},removeCursorInteraction:function(e,t){var n=e.viz.mapView;t.unbind(null,null,n)}});cdb.vis.INFOWINDOW_TEMPLATE={light:['<div class="cartodb-popup">','<a href="#close" class="cartodb-popup-close-button close">x</a>','<div class="cartodb-popup-content-wrapper">','<div class="cartodb-popup-content">',"{{#content.fields}}","{{#title}}<h4>{{title}}</h4>{{/title}}","{{#value}}",'<p {{#type}}class="{{ type }}"{{/type}}>{{{ value }}}</p>',"{{/value}}","{{^value}}",'<p class="empty">null</p>',"{{/value}}","{{/content.fields}}","</div>","</div>",'<div class="cartodb-popup-tip-container"></div>',"</div>"].join("")},cdb.vis.Vis=s}(),function(){cdb.vis.Overlay.register("mobile",function(e,t){var n=cdb.core.Template.compile(e.template||'    <div class="torque"></div>    <div class="top-shadow"></div>    <div class="bottom-shadow"></div>    <div class="legends"></div>    <a class="toggle" href="#"></a>    ',e.templateType||"mustache"),r=new cdb.geo.ui.Mobile({template:n,torqueLayer:e.torqueLayer,legends:e.legends,map:e.map});return r.render()}),cdb.vis.Overlay.register("zoom",function(e,t){if(!e.template){t.trigger("error","zoom template is empty");return}var n=new cdb.geo.ui.Zoom({model:e.map,template:cdb.core.Template.compile(e.template)});return n.render()}),cdb.vis.Overlay.register("loader",function(e){var t=new cdb.geo.ui.TilesLoader({template:cdb.core.Template.compile(e.template)});return t.render()}),cdb.vis.Overlay.register("time_slider",function(e,t){var n=new cdb.geo.ui.TimeSlider(e);return n.render()}),cdb.vis.Overlay.register("header",function(e,t){function n(e,t){return e.substr(0,t-1)+(e.length>t?"…":"")}var r=100;location.href?e.share_url=encodeURIComponent(location.href):e.share_url=e.url;var i=cdb.core.Template.compile(e.template||"      {{#title}}        <h1>          {{#url}}            <a href='#' onmousedown=\"window.open('{{url}}')\">{{title}}</a>          {{/url}}          {{^url}}            {{title}}          {{/url}}        </h1>      {{/title}}      {{#description}}<p>{{description}}</p>{{/description}}      {{#mobile_shareable}}        <div class='social'>          <a class='facebook' target='_blank'            href='http://www.facebook.com/sharer.php?u={{share_url}}&text=Map of {{title}}: {{description}}'>F</a>          <a class='twitter' href='https://twitter.com/share?url={{share_url}}&text={{twitter_title}}'           target='_blank'>T</a>        </div>      {{/mobile_shareable}}    ",e.templateType||"mustache"),s=e.map.get("title"),o=e.map.get("description"),u=s+": "+o,a;s&&o?a=n(s+": "+o,112)+" %23map ":s?a=n(s,112)+" %23map":o?a=n(o,112)+" %23map":a="%23map";var f=e.shareable=="false"||!e.shareable?null:e.shareable,l=f;l=l&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);var c=new cdb.geo.ui.Header({title:s,description:o,facebook_title:u,twitter_title:a,url:e.url,share_url:e.share_url,mobile_shareable:l,shareable:f&&!l,template:i});return c.render()}),cdb.vis.Overlay.register("infowindow",function(e,t){if(_.size(e.fields)==0)return null;var n=new cdb.geo.ui.InfowindowModel({template:e.template,alternative_names:e.alternative_names,fields:e.fields,template_name:e.template_name}),r=e.templateType||"mustache",i=new cdb.geo.ui.Infowindow({model:n,mapView:t.mapView,template:(new cdb.core.Template({template:e.template,type:r})).asFunction()});return i}),cdb.vis.Overlay.register("layer_selector",function(e,t){var n=cdb.core.Template.compile(e.template||'      <a href="#/change-visibility" class="layers">Visible layers<div class="count"></div></a>      ',e.templateType||"underscore"),r=cdb.core.Template.compile(e.template||'      <ul></ul><div class="tail"><span class="border"></span></div>      ',e.templateType||"underscore"),i=new cdb.geo.ui.LayerSelector({mapView:t.mapView,template:n,dropdown_template:r,layer_names:e.layer_names});return t.legends&&i.bind("change:visible",function(e,n,r){if(r.get("type")==="layergroup"){var i=t.legends&&t.legends.getLegendByIndex(n);i&&i[e?"show":"hide"]()}else if(r.get("type")==="torque"){var s=t.getOverlay("time_slider");s&&s[e?"show":"hide"]()}}),i.render()}),cdb.vis.Overlay.register("fullscreen",function(e,t){var n=cdb.core.Template.compile(e.template||'<a href="#"></a>',e.templateType||"mustache"),r=new cdb.ui.common.FullScreen({doc:"#map > div",mapView:t.mapView,template:n});return r.render()}),cdb.vis.Overlay.register("share",function(e,t){location.href?e.share_url=encodeURIComponent(location.href):e.share_url=e.url;var n=cdb.core.Template.compile(e.template||'      <div class="mamufas">        <div class="block modal {{modal_type}}">          <a href="#close" class="close">x</a>          <div class="head">            <h3>Share this map</h3>          </div>          <div class="content">            <div class="buttons">              <h4>Social</h4>              <ul>                <li><a class="facebook" target="_blank" href="{{ facebook_url }}">Share on Facebook</a></li>                <li><a class="twitter" href="{{ twitter_url }}" target="_blank">Share on Twitter</a></li>              </ul>            </div><div class="embed_code">             <h4>Embed this map</h4>             <textarea id="" name="" cols="30" rows="10">{{ code }}</textarea>           </div>          </div>        </div>      </div>    ',e.templateType||"mustache"),r=location.href;r=r.replace("public_map","embed_map");var i="<iframe width='100%' height='520' frameborder='0' src='"+r+"'></iframe>",s=new cdb.ui.common.ShareDialog({title:e.map.get("title"),description:e.map.get("description"),model:t.map,code:i,url:e.url,share_url:e.share_url,template:n,target:$(".cartodb-share a"),size:$(document).width()>400?"":"small",width:$(document).width()>400?430:216});return s.render()}),cdb.vis.Overlay.register("search",function(e,t){var n=cdb.core.Template.compile(e.template||'      <form>        <span class="loader"></span>        <input type="text" class="text" value="" />        <input type="submit" class="submit" value="" />      </form>    ',e.templateType||"mustache"),r=new cdb.geo.ui.Search({template:n,model:t.map});return r.render()}),cdb.vis.Overlay.register("tooltip",function(e,t){var n;if(!e.layer){var r=t.getLayers();r.length>1&&(n=r[1]),e.layer=n}if(!e.layer)throw new Error("layer is null");e.layer.setInteraction(!0);var i=new cdb.geo.ui.Tooltip(e);return i}),cdb.vis.Overlay.register("infobox",function(e,t){var n,r=t.getLayers();e.layer||(r.length>1&&(n=r[1]),e.layer=n);if(!e.layer)throw new Error("layer is null");e.layer.setInteraction(!0);var i=new cdb.geo.ui.InfoBox(e);return i})}(),function(){function e(e){for(var t in r)if(e.indexOf(t)!==-1)return e.replace(t,r[t]);return e}function t(e,t){t.infowindow&&t.infowindow.fields&&(t.interactivity?t.interactivity.indexOf("cartodb_id")===-1&&(t.interactivity=t.interactivity+",cartodb_id"):t.interactivity="cartodb_id"),e.https&&(t.tiler_protocol="https",t.tiler_port=443,t.sql_api_protocol="https",t.sql_api_port=443),t.cartodb_logo=e.cartodb_logo==undefined?t.cartodb_logo:e.cartodb_logo}var n=cdb.vis.Layers,r={"https://dnv9my2eseobd.cloudfront.net/":"http://a.tiles.mapbox.com/","https://maps.nlp.nokia.com/":"http://maps.nlp.nokia.com/","https://tile.stamen.com/":"http://tile.stamen.com/","https://{s}.maps.nlp.nokia.com/":"http://{s}.maps.nlp.nokia.com/"};n.register("tilejson",function(t,n){var r=n.tiles[0];return r=t.https?r:e(r),new cdb.geo.TileLayer({urlTemplate:r})}),n.register("tiled",function(t,n){var r=n.urlTemplate;return r=t.https?r:e(r),n.urlTemplate=r,new cdb.geo.TileLayer(n)}),n.register("wms",function(e,t){return new cdb.geo.WMSLayer(t)}),n.register("gmapsbase",function(e,t){return new cdb.geo.GMapsBaseLayer(t)}),n.register("plain",function(e,t){return new cdb.geo.PlainLayer(t)}),n.register("background",function(e,t){return new cdb.geo.PlainLayer(t)});var i=function(e,n){return t(e,n),n.sublayers?(n.type="layergroup",new cdb.geo.CartoDBGroupLayer(n)):new cdb.geo.CartoDBLayer(n)};n.register("cartodb",i),n.register("carto",i),n.register("layergroup",function(e,n){return t(e,n),new cdb.geo.CartoDBGroupLayer(n)}),n.register("namedmap",function(e,n){return t(e,n),new cdb.geo.CartoDBNamedMapLayer(n)}),n.register("torque",function(e,t){return e.https&&t.sql_api_domain&&t.sql_api_domain.indexOf("cartodb.com")!==-1&&(t.sql_api_protocol="https",t.sql_api_port=443,t.tiler_protocol="https",t.tiler_port=443),t.cartodb_logo=e.cartodb_logo==undefined?t.cartodb_logo:e.cartodb_logo,new cdb.geo.TorqueLayer(t)})}(),function(){function e(){}function t(e){var t=e.host||"cartodb.com",n=e.protocol||"https";return n+"://"+e.user+"."+t+"/api/v1/viz/"+e.table+"/viz.json"}function n(e,n){var r=null;if(e.layers!==undefined||(e.kind||e.type)!==undefined){_.defer(function(){n(e)});return}e.table!==undefined&&e.user!==undefined?r=t(e):e.indexOf&&e.indexOf("http")===0&&(r=e),r?cdb.vis.Loader.get(r,n):_.defer(function(){n(null)})}_.extend(e.prototype,Backbone.Events,{done:function(e){return this.bind("done",e)},error:function(e){return this.bind("error",e)}}),cdb._Promise=e;var r={};cartodb.createLayer=function(t,r,i,s){var o=new e,u,a;i=i||{};if(t===undefined)throw new TypeError("map should be provided");if(r===undefined)throw new TypeError("layer should be provided");var f=arguments,l=f[f.length-1];return _.isFunction(l)&&(s=l),o.addTo=function(e,t){return o.on("done",function(){a.addLayerToMap(u,e,t)}),o},n(r,function(e){function n(){u=l.createLayer(r,{no_base_layer:!0});if(!u)return o.trigger("error","layer not supported"),o;i.infowindow&&l.addInfowindow(u),i.legends&&l.addLegends([r]),i.time_slider&&u.model.get("type")==="torque"&&l.addTimeSlider(u),s&&s(u),o.trigger("done",u)}var r;if(!e){o.trigger("error");return}if(e.layers){e.layers.length<2&&o.trigger("error","visualization file does not contain layer info");var f=i.layerIndex===undefined?1:i.layerIndex;if(e.layers.length<=f){o.trigger("error","layerIndex out of bounds");return}r=e.layers[f]}else r=e;if(!r){o.trigger("error");return}i&&!_.isFunction(i)&&(r.options=r.options||{},_.extend(r.options,i)),i=_.defaults(i,{infowindow:!0,https:!1,legends:!0,time_slider:!0});if(typeof t.overlayMapTypes!="undefined")a=cdb.geo.GoogleMapsMapView;else{if(!(t instanceof L.Map||window.L&&t instanceof window.L.Map))return o.trigger("error","cartodb.js can't guess the map type"),o;a=cdb.geo.LeafletMapView}var l=t.viz;if(!l){var c=new a({map_object:t,map:new cdb.geo.Map});t.viz=l=new cdb.vis.Vis({mapView:c}),l.updated_at=e.updated_at,l.https=i.https}l.checkModules([r])?n():l.loadModules([r],function(){n()})}),o}}(),function(){function e(t){if(cartodb===this||window===this)return new e(t);if(!t.user)throw new Error("user should be provided");var n=new String(window.location.protocol);n=n.slice(0,n.length-1),n=="file"&&(n="https"),this.ajax=t.ajax||(typeof jQuery!="undefined"?jQuery.ajax:reqwest);if(!this.ajax)throw new Error("jQuery or reqwest should be loaded");this.options=_.defaults(t,{version:"v2",protocol:n,jsonp:typeof jQuery!="undefined"?!jQuery.support.cors:!1})}var t=this;t.cartodb=t.cartodb||{},e.prototype._host=function(){var e=this.options;if(e&&e.completeDomain)return e.completeDomain+"/api/"+e.version+"/sql";var t=e.host||"cartodb.com",n=e.protocol||"https";return n+"://"+e.user+"."+t+"/api/"+e.version+"/sql"},e.prototype.execute=function(e,t,n,r){var i=new cartodb._Promise;if(!e)throw new TypeError("sql should not be null");var s=arguments,o=s[s.length-1];_.isFunction(o)&&(r=o),n=_.defaults(n||{},this.options);var u={type:"get",dataType:"json",crossDomain:!0};n.jsonp&&(delete u.crossDomain,u.dataType="jsonp"),n.cache&&(u.cache=n.cache);var a="156543.03515625",f="ST_MakeEnvelope(-20037508.5,-20037508.5,20037508.5,20037508.5,3857)";e=e.replace("!bbox!",f).replace("!pixel_width!",a).replace("!pixel_height!",a);var l=Mustache.render(e,t),c="q="+encodeURIComponent(l),h=["format","dp","api_key"];n.extra_params&&(h=h.concat(n.extra_params));for(var p in h){var d=h[p],v=n[d];v&&(c+="&"+d+"="+v)}var m=n.type?n.type=="get":u.type=="get";u.url=this._host(),m?u.url+="?"+c:u.data=c;var g=n.success,y=n.error;return g&&delete n.success,y&&delete y.success,u.error=function(e){var t=e.responseText||e.response,n=t&&JSON.parse(t);i.trigger("error",n&&n.error,e),y&&y(e)},u.success=function(e,t,n){t==undefined&&(t=e.status,n=e,e=JSON.parse(e.response)),i.trigger("done",e,t,n),g&&g(e,t,n),r&&r(e)},delete n.jsonp,this.ajax(_.extend(u,n)),i},e.prototype.getBounds=function(e,t,n,r){var i=new cartodb._Promise,s=arguments,o=s[s.length-1];_.isFunction(o)&&(r=o);var u="SELECT ST_XMin(ST_Extent(the_geom)) as minx,       ST_YMin(ST_Extent(the_geom)) as miny,       ST_XMax(ST_Extent(the_geom)) as maxx,       ST_YMax(ST_Extent(the_geom)) as maxy from ({{{ sql }}}) as subq";return e=Mustache.render(e,t),this.execute(u,{sql:e},n).done(function(e){if(e.rows&&e.rows.length>0&&e.rows[0].maxx!=null){var t=e.rows[0],n=-85.0511,s=85.0511,o=-179,u=179,a=function(e,t,n){return e<t?t:e>n?n:e},f=a(t.maxx,o,u),l=a(t.minx,o,u),c=a(t.maxy,n,s),h=a(t.miny,n,s),p=[[c,f],[h,l]];i.trigger("done",p),r&&r(p)}}).error(function(e){i.trigger("error",e)}),i},e.prototype.table=function(e){function t(){t.fetch.apply(t,arguments)}var n=e,r,i=[],s,o,u,a=this;return t.fetch=function(e){e=e||{};var n=arguments,r=n[n.length-1];_.isFunction(r)&&(callback=r,n.length===1&&(e={})),a.execute(t.sql(),e,callback)},t.sql=function(){var e="select";return i.length?e+=" "+i.join(",")+" ":e+=" * ",e+="from "+n,r&&(e+=" where "+r),s&&(e+=" limit "+s),o&&(e+=" order by "+o),u&&(e+=" "+u),e},t.filter=function(e){return r=e,t},t.order_by=function(e){return o=e,t},t.asc=function(){return u="asc",t},t.desc=function(){return u="desc",t},t.columns=function(e){return i=e,t},t.limit=function(e){return s=e,t},t},t.cartodb.SQL=e}(),function(){cartodb.createVis=function(e,t,n,r){if(!e)throw new TypeError("a DOM element should be provided");var i=arguments,s=i[i.length-1];_.isFunction(s)&&(r=s),e=typeof e=="string"?document.getElementById(e):e;var o=new cartodb.vis.Vis({el:e});return t&&(o.load(t,n),r&&o.done(r)),o}}(),cdb.$=$,cdb.L=L,cdb.Mustache=Mustache,cdb.Backbone=Backbone,cdb._=_}();for(var i in __prev)__prev[i]&&(window[i]=__prev[i])}(),function(e){function r(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function i(e,t){for(var n=[];t>0;n[--t]=e);return n.join("")}var t=function(){return t.cache.hasOwnProperty(arguments[0])||(t.cache[arguments[0]]=t.parse(arguments[0])),t.format.call(null,t.cache[arguments[0]],arguments)};t.format=function(e,n){var s=1,o=e.length,u="",a,f=[],l,c,h,p,d,v;for(l=0;l<o;l++){u=r(e[l]);if(u==="string")f.push(e[l]);else if(u==="array"){h=e[l];if(h[2]){a=n[s];for(c=0;c<h[2].length;c++){if(!a.hasOwnProperty(h[2][c]))throw t('[sprintf] property "%s" does not exist',h[2][c]);a=a[h[2][c]]}}else h[1]?a=n[h[1]]:a=n[s++];if(/[^s]/.test(h[8])&&r(a)!="number")throw t("[sprintf] expecting number but found %s",r(a));switch(h[8]){case"b":a=a.toString(2);break;case"c":a=String.fromCharCode(a);break;case"d":a=parseInt(a,10);break;case"e":a=h[7]?a.toExponential(h[7]):a.toExponential();break;case"f":a=h[7]?parseFloat(a).toFixed(h[7]):parseFloat(a);break;case"o":a=a.toString(8);break;case"s":a=(a=String(a))&&h[7]?a.substring(0,h[7]):a;break;case"u":a>>>=0;break;case"x":a=a.toString(16);break;case"X":a=a.toString(16).toUpperCase()}a=/[def]/.test(h[8])&&h[3]&&a>=0?"+"+a:a,d=h[4]?h[4]=="0"?"0":h[4].charAt(1):" ",v=h[6]-String(a).length,p=h[6]?i(d,v):"",f.push(h[5]?a+p:p+a)}}return f.join("")},t.cache={},t.parse=function(e){var t=e,n=[],r=[],i=0;while(t){if((n=/^[^\x25]+/.exec(t))!==null)r.push(n[0]);else if((n=/^\x25{2}/.exec(t))!==null)r.push("%");else{if((n=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(t))===null)throw"[sprintf] huh?";if(n[2]){i|=1;var s=[],o=n[2],u=[];if((u=/^([a-z_][a-z_\d]*)/i.exec(o))===null)throw"[sprintf] huh?";s.push(u[1]);while((o=o.substring(u[0].length))!=="")if((u=/^\.([a-z_][a-z_\d]*)/i.exec(o))!==null)s.push(u[1]);else{if((u=/^\[(\d+)\]/.exec(o))===null)throw"[sprintf] huh?";s.push(u[1])}n[2]=s}else i|=2;if(i===3)throw"[sprintf] mixing positional and named placeholders is not (yet) supported";r.push(n)}t=t.substring(n[0].length)}return r};var n=function(e,n,r){return r=n.slice(0),r.splice(0,0,e),t.apply(null,r)};e.sprintf=t,e.vsprintf=n}(typeof exports!="undefined"?exports:window),define("sprintf",function(e){return function(){var t,n;return t||e.sprintf}}(this)),"use strict",define("models/status-map",["backbone"],function(e){var t=e.Model.extend({});return t}),"use strict",define("instances/status-map",["backbone","models/status-map"],function(e,t){var n=new t({product:"all",year:"all",context:"production_count",productText:"Production count"});return n}),define("text",["module"],function(e){"use strict";var t,n,r,i,s,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],u=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,a=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,f=typeof location!="undefined"&&location.href,l=f&&location.protocol&&location.protocol.replace(/\:/,""),c=f&&location.hostname,h=f&&(location.port||undefined),p={},d=e.config&&e.config()||{};t={version:"2.0.10",strip:function(e){if(e){e=e.replace(u,"");var t=e.match(a);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:d.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=o[t];try{e=new ActiveXObject(n)}catch(r){}if(e){o=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,d.isBuild&&(p[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}d.isBuild=i.isBuild;var s=t.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=n.toUrl(o),a=d.useXhr||t.useXhr;if(u.indexOf("empty:")===0){r();return}!f||a(u,l,c,h)?t.get(u,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([o],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(p.hasOwnProperty(n)){var s=t.jsEscape(p[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(d.env==="node"||!d.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node&&!process.versions["node-webkit"])n=require.nodeRequire("fs"),t.get=function(e,t,r){try{var i=n.readFileSync(e,"utf8");i.indexOf("﻿")===0&&(i=i.substring(1)),t(i)}catch(s){r(s)}};else if(d.env==="xhr"||!d.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);d.onXhr&&d.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r(o)):n(s.responseText),d.onXhrComplete&&d.onXhrComplete(s,e))},s.send(null)};else if(d.env==="rhino"||!d.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),r!==null&&n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(d.env==="xpconnect"||!d.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in r,t.get=function(e,t){var n,o,u,a={};s&&(e=e.replace(/\//g,"\\")),u=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(u,1,0,!1),o=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),o.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(n.available(),a),o.close(),n.close(),t(a.value)}catch(f){throw new Error((u&&u.path||"")+": "+f)}};return t}),define("text!views/../../styles/cartocss/base.css",[],function(){return"#country {\n  polygon-opacity: 1;\n  line-color: #FFF;\n  line-width: 1;\n  line-opacity: .5;\n  polygon-fill: #aaa;\n}\n"}),define("text!views/../../styles/cartocss/polygons.css",[],function(){return"#usage_production {\n  polygon-opacity: 1;\n  line-color: #FFF;\n  line-width: 1;\n  line-opacity: 0.5;\n  polygon-fill: #aaa;\n}\n\n#usage_production [%1$s > 100] {\n   polygon-fill: #B10026;\n}\n#usage_production [%1$s <= 100] {\n   polygon-fill: #B10026;\n}\n#usage_production [%1$s <= 85] {\n   polygon-fill: #E31A1C;\n}\n#usage_production [%1$s <= 70] {\n   polygon-fill: #FC4E2A;\n}\n#usage_production [%1$s <= 50] {\n   polygon-fill: #FD8D3C;\n}\n#usage_production [%1$s <= 35] {\n   polygon-fill: #FEB24C;\n}\n#usage_production [%1$s <= 20] {\n   polygon-fill: #FED976;\n}\n#usage_production [ %1$s <= 6] {\n   polygon-fill: #FFFFB2;\n}\n"}),define("text!views/../../queries/geom-all.pgsql",[],function(){return"WITH sub AS\n  (SELECT country_code,\n    sum(production_count::float) AS production_count,\n    sum(usage_count::float) AS usage_count\n  FROM usage_production\n  GROUP BY country_code)\nSELECT countries.cartodb_id,\n  countries.the_geom,\n  countries.the_geom_webmercator,\n  sub.country_code,\n  countries.name,\n  production_count,\n  usage_count,\n  country_coverage_challenges.count::float AS challenges\nFROM sub\nLEFT JOIN countries ON sub.country_code=countries.adm0_a3\nLEFT JOIN country_coverage_challenges ON country_coverage_challenges.country_code=countries.adm0_a3\n"}),define("text!views/../../queries/geom-product.pgsql",[],function(){return"WITH sub as (SELECT country_code, product, sum(production_count::float) as production_count, sum(usage_count::float) as usage_count FROM usage_production\nwhere product='%s' group by product, country_code )\nSELECT  countries.cartodb_id,countries.the_geom, countries.the_geom_webmercator,sub.country_code, countries.name,product, production_count, usage_count,country_coverage_challenges.count::float as challenges\nFROM sub\nleft join countries on sub.country_code=countries.adm0_a3\nleft join country_coverage_challenges on country_coverage_challenges.country_code=countries.adm0_a3\n"}),define("text!views/../../queries/geom-year.pgsql",[],function(){return"WITH sub AS\n  (SELECT country_code,\n    YEAR,\n    sum(production_count::float) AS production_count,\n    sum(usage_count::float) AS usage_count\n  FROM usage_production\n  WHERE YEAR='%s'\n  GROUP BY YEAR, country_code)\nSELECT countries.cartodb_id,\n  countries.the_geom,\n  countries.the_geom_webmercator,\n  sub.country_code,\n  countries.name,\n  YEAR,\n  production_count,\n  usage_count,\n  country_coverage_challenges.count::float AS challenges\nFROM sub\nLEFT JOIN countries ON sub.country_code=countries.adm0_a3\nLEFT JOIN country_coverage_challenges ON country_coverage_challenges.country_code=countries.adm0_a3\n"}),define("text!views/../../queries/geom-product-year.pgsql",[],function(){return" SELECT  countries.cartodb_id,countries.the_geom, countries.the_geom_webmercator,usage_production.country_code, countries.name,product,year, production_count, usage_count,country_coverage_challenges.count::float as challenges\nFROM usage_production\nleft join countries on usage_production.country_code=countries.adm0_a3\nleft join country_coverage_challenges on country_coverage_challenges.country_code=countries.adm0_a3\nwhere year='%s' and product='%s'\n"}),define("text!views/../../templates/infowindow.handlebars",[],function(){return'<div class="cartodb-popup">\n  <a href="#close" class="cartodb-popup-close-button close">x</a>\n  <div class="cartodb-popup-content-wrapper">\n    <div class="cartodb-popup-header">\n      <h3>{{content.data.name}}</h3>\n    </div>\n    <div class="cartodb-popup-content">\n      <h4>Production count</h4>\n      <p>{{#xif content.data.production_count}}{{content.data.production_count}}{{else}}-{{/xif}}</p>\n      <h4>Usage count</h4>\n      <p>{{#xif content.data.usage_count}}{{content.data.usage_count}}{{else}}-{{/xif}}</p>\n      <h4>Challenge count</h4>\n      <p>{{#xif content.data.challenges}}{{content.data.challenges}}{{else}}-{{/xif}}</p>\n    </div>\n  </div>\n  <div class="cartodb-popup-tip-container"></div>\n</div>\n'}),"use strict",define("views/map/vis",["underscore","backbone","cartodb","sprintf","instances/status-map","text!../../../styles/cartocss/base.css","text!../../../styles/cartocss/polygons.css","text!../../../queries/geom-all.pgsql","text!../../../queries/geom-product.pgsql","text!../../../queries/geom-year.pgsql","text!../../../queries/geom-product-year.pgsql","text!../../../templates/infowindow.handlebars"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h=t.View.extend({el:"#mapVisView",options:{map:{center:[20,-35],zoom:3},tiles:{url:"http://{s}.tile.osm.org/{z}/{x}/{y}.png"},cartodb:{user_name:sessionStorage.getItem("CARTODBUSER"),type:"cartodb",sublayers:[{cartocss:s,sql:"SELECT * FROM countries"}]}},template:c,initialize:function(){i.on("change:product change:year",this.setLayer,this),i.on("change:context",this.setCartoCSS,this),i.on("change:context",this.setLegend,this)},setMap:function(){return this.map||(this.map=L.map(this.el,this.options.map)),this.map},setTiles:function(){return this.map&&!this.tiles&&(this.tiles=L.tileLayer(this.options.tiles.url).addTo(this.map)),this.tiles},setLayer:function(){function s(e){throw e.responseText}function c(n){e.layer=n,e.map.addLayer(e.layer),e.setInfowindow(),t.Events.trigger("spinner:stop")}var e=this,n="";t.Events.trigger("spinner:start"),this.layer&&this.map.removeLayer(this.layer),this.legends||this.setLegend(),i.get("product")!=="all"&&i.get("year")!=="all"?n=r(l,i.get("year"),i.get("product")):i.get("product")!=="all"&&i.get("year")==="all"?n=r(a,i.get("product")):i.get("product")==="all"&&i.get("year")!=="all"?n=r(f,i.get("year")):n=u,this.options.cartodb.sublayers[1]={sql:n,cartocss:r(o,i.get("context")),interactivity:"cartodb_id, name, production_count, usage_count, challenges"},cartodb.createLayer(this.map,this.options.cartodb).on("done",c).on("error",s)},setInfowindow:function(){var e=this;this.infowindow&&this.infowindow.remove(),this.infowindow=cdb.vis.Vis.addInfowindow(e.map,e.layer.getSubLayer(1),this.options.cartodb.sublayers[1].interactivity,{infowindowTemplate:e.template,templateType:"handlebars"})},setLegend:function(){var e,t;e={title:i.get("productText"),left:"0",right:"100",colors:["#FFFFB2","#FED976","#FEB24C","#FD8D3C","#FC4E2A","#E31A1C","#B10026"]},t=new cdb.geo.ui.Legend.Choropleth(e),this.legends&&this.legends.$el.remove(),this.legends=new cdb.geo.ui.Legend.Stacked({legends:[t]}),this.$el.append(this.legends.render().el)},setCartoCSS:function(){this.layer.getSubLayer(1).setCartoCSS(r(o,i.get("context")))}});return h}),"use strict",define("models/product",["backbone"],function(e){var t=e.Model.extend({});return t}),define("text!collections/../../queries/products.pgsql",[],function(){return"SELECT\n  DISTINCT (product) AS name\nFROM future_production_costs\nORDER BY name ASC\n"}),define("text!collections/../../queries/products-map.pgsql",[],function(){return"SELECT\n  DISTINCT (product) AS name\nFROM usage_production\nWHERE product is not null AND product <> ''\nORDER BY product ASC\n"}),define("text!collections/../../queries/products-costs.pgsql",[],function(){return"WITH t AS(\n  SELECT\n    year AS age,product,\n    ARRAY[ avg(amount::float) OVER (PARTITION BY year),\n    amount::float ] AS data\n  FROM future_production_costs\n)\nSELECT\n  age,\n  data\nFROM t\nWHERE product = '%s'\n"}),define("text!collections/../../queries/products-rank.pgsql",[],function(){return"SELECT product as name, average_cost::float, enabler_spent::float ,staff_count::float, time_months::float FROM misc_production_enabler\nUNION ALL\nSELECT 'Average' as name, avg( average_cost::float), avg( enabler_spent::float) ,avg( staff_count::float), avg( time_months::float) FROM misc_production_enabler\n"}),define("text!collections/../../queries/products-constraints-all-products-and-cohort.pgsql",[],function(){return"SELECT _constraint as constraint,  avg(constraint_value) as average\nFROM historic_constraints where cohort='%s' group by _constraint\norder by _constraint asc\n"}),define("text!collections/../../queries/products-by-cohort.pgsql",[],function(){return"SELECT distinct(product) FROM historic_constraints where cohort='%s' order by product asc\n"}),define("text!collections/../../queries/products-constraints-by-product-and-cohort.pgsql",[],function(){return"WITH pro AS (\n  SELECT Distinct(_constraint) as constraint, product, avg(constraint_value) as value\n  FROM historic_constraints where product='%1$s' and cohort='%2$s' group by _constraint, product\n)\nSELECT pro.constraint, pro.product, avg(constraint_value) as average, pro.value\nFROM historic_constraints JOIN pro on pro.constraint=historic_constraints._constraint where cohort='%2$s'\ngroup by pro.constraint, pro.product, pro.value\norder by pro.constraint asc\n"}),define("text!collections/../../queries/products-constraints-future.pgsql",[],function(){return"  SELECT Distinct(_constraint) as constraint, avg(constraint_value) as average\n  FROM future_constraints where cohort='%s' group by _constraint\n  order by _constraint asc\n"}),define("text!collections/../../queries/products-consumer-vs-enabler.pgsql",[],function(){return"WITH cons AS (\n  SELECT _constraint AS constraint,\n  cohort AS historic_cohort,\n  avg(constraint_value) AS historic_average\n  FROM historic_constraints\n  WHERE _constraint<>'Lack of demand' AND (cohort='Consumer'\n  OR cohort='Enabler')\n  GROUP BY _constraint, cohort\n)\nSELECT cons.constraint, cohort,\navg(constraint_value) AS future_average,\nhistoric_average\nFROM future_constraints\nJOIN cons\nON cons.constraint = future_constraints._constraint\nAND cons.historic_cohort = future_constraints.cohort\nGROUP BY cons.historic_average,cons.constraint,\nfuture_constraints.cohort\nORDER BY cons.constraint\n"}),"use strict",define("collections/products",["backbone","sprintf","models/product","text!../../queries/products.pgsql","text!../../queries/products-map.pgsql","text!../../queries/products-costs.pgsql","text!../../queries/products-rank.pgsql","text!../../queries/products-constraints-all-products-and-cohort.pgsql","text!../../queries/products-by-cohort.pgsql","text!../../queries/products-constraints-by-product-and-cohort.pgsql","text!../../queries/products-constraints-future.pgsql","text!../../queries/products-consumer-vs-enabler.pgsql"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h=e.Collection.extend({model:n,url:function(){return t("http://%s.cartodb.com/api/v2/sql",sessionStorage.getItem("CARTODBUSER"))},initialize:function(){this.sql=new cartodb.SQL({user:sessionStorage.getItem("CARTODBUSER")})},parse:function(e){return e.rows},getData:function(e){function n(t){e&&typeof e=="function"&&e(undefined,t)}function i(t,n){e&&typeof e=="function"&&e(n)}var t;t={data:{q:r,format:"json"},success:n,error:i},this.fetch(t)},getForMap:function(e){function n(t){e&&typeof e=="function"&&e(undefined,t)}function r(t,n){e&&typeof e=="function"&&e(n)}var t;t={data:{q:i,format:"json"},success:n,error:r},this.fetch(t)},getDataByCohort:function(e,n){function r(e){n&&typeof n=="function"&&n(undefined,e)}function i(e,t){n&&typeof n=="function"&&n(t)}this.sql.execute(t(a,e)).on("done",r).on("error",i)},getCostsByProduct:function(e,n){function r(e){n&&typeof n=="function"&&n(undefined,e)}function i(e,t){n&&typeof n=="function"&&n(t)}this.sql.execute(t(s,e||"Environmental Democracy index")).on("done",r).on("error",i)},getRankedCosts:function(e){function n(t){e&&typeof e=="function"&&e(undefined,t)}function r(t,n){e&&typeof e=="function"&&e(n)}this.sql.execute(t(o)).on("done",n).on("error",r)},getConstraintsByAllProductsAndCohort:function(e,n){function r(e){n&&typeof n=="function"&&n(undefined,e)}function i(e,t){n&&typeof n=="function"&&n(t)}this.sql.execute(t(u,e||"Consumer")).on("done",r).on("error",i)},getConstraintsByProductAndCohort:function(e,n,r){function i(e){r&&typeof r=="function"&&r(undefined,e)}function s(e,t){r&&typeof r=="function"&&r(t)}this.sql.execute(t(f,e,n)).on("done",i).on("error",s)},getConstraintsFuture:function(e,n){function r(e){n&&typeof n=="function"&&n(undefined,e)}function i(e,t){n&&typeof n=="function"&&n(t)}this.sql.execute(t(l,e||"consumer")).on("done",r).on("error",i)},getConsumerVsEnabler:function(e){function n(t){e&&typeof e=="function"&&e(undefined,t)}function r(t,n){e&&typeof e=="function"&&e(n)}this.sql.execute(t(c)).on("done",n).on("error",r)}});return h}),"use strict",define("models/year",["backbone"],function(e){var t=e.Model.extend({});return t}),define("text!collections/../../queries/years.pgsql",[],function(){return"select distinct(year)\nfrom usage_production\nwhere year is not null and year <> ''\norder by year asc\n"}),"use strict",define("collections/years",["backbone","sprintf","models/year","text!../../queries/years.pgsql"],function(e,t,n,r){var i=e.Collection.extend({model:n,url:function(){return t("http://%s.cartodb.com/api/v2/sql",sessionStorage.getItem("CARTODBUSER"))},parse:function(e){return e.rows},getData:function(e){function n(t){e&&typeof e=="function"&&e(undefined,t)}function i(t,n){e&&typeof e=="function"&&e(n)}var t;t={data:{q:r,format:"json"},success:n,error:i},this.fetch(t)}});return i}),define("text!views/../../templates/map-toolbar.handlebars",[],function(){return'<ul>\n  <li class="item-selector" id="mapContextSelector">\n    <span class="current">\n      <span class="item-text" id="currentMapContext">Production count</span>\n      <span class="item-arrow"></span>\n    </span>\n    <ul class="item-selector-child">\n      <li><a href="#production_count" data-name="production_count">Production count</a></li>\n      <li><a href="#usage_count" data-name="usage_count">Usage count</a></li>\n      <li><a href="#challenges" data-name="challenges">Challenge count</a></li>\n    </ul>\n  </li>\n  <li class="item-selector" id="mapProductSelector">\n    <span class="current">\n      <span class="item-text" id="currentMapProduct">All products</span>\n      <span class="item-arrow"></span>\n    </span>\n    <ul class="item-selector-child">\n      <li><a href="#all" data-name="all">All products</a></li>\n      {{#each products}}\n        <li><a href="#{{name}}" data-name="{{name}}">{{name}}</a></li>\n      {{/each}}\n    </ul>\n  </li>\n  <li class="item-selector" id="mapYearSelector">\n    <span class="current">\n      <span class="item-text" id="currentMapYear">All years</span>\n      <span class="item-arrow"></span>\n    </span>\n    <ul class="item-selector-child">\n      <li><a href="#all" data-name="all">All years</a></li>\n      {{#each years}}\n        <li><a href="#{{year}}" data-name="{{year}}">{{year}}</a></li>\n      {{/each}}\n    </ul>\n  </li>\n</ul>\n'}),"use strict",define("views/map/toolbar",["backbone","handlebars","instances/status-map","collections/products","collections/years","text!../../../templates/map-toolbar.handlebars"],function(e,t,n,r,i,s){var o=e.View.extend({el:"#mapToolbarView",events:{"click #mapProductSelector a":"setProduct","click #mapYearSelector a":"setYear","click #mapContextSelector a":"setContext"},template:t.compile(s),initialize:function(){var e=this;this.products=new r,this.years=new i,this.products.getForMap(function(t){if(t)throw t.responseText;e.years.getData(function(t){if(t)throw t.responseText;e.render()})})},render:function(){this.$el.html(this.template({products:this.products.toJSON(),years:this.years.toJSON()})),this.$mapProductSelector=$("#mapProductSelector"),this.$mapYearSelector=$("#mapYearSelector")},setProduct:function(e){var t=$(e.currentTarget);this.$el.find("#currentMapProduct").text(t.text()),n.set("product",t.data("name")),n.set("productText",t.text()),this.$mapProductSelector.removeClass("is-disabled"),this.$mapYearSelector.removeClass("is-disabled"),e.preventDefault()},setYear:function(e){var t=$(e.currentTarget);this.$el.find("#currentMapYear").text(t.text()),n.set("productText",t.text()),n.set("year",t.data("name")),this.$mapProductSelector.removeClass("is-disabled"),this.$mapYearSelector.removeClass("is-disabled"),e.preventDefault()},setContext:function(e){var t=$(e.currentTarget);this.$el.find("#currentMapContext").text(t.text()),n.set("productText",t.text()),n.set("context",t.data("name")),t.data("name")==="challenges"?(n.set("product","all"),n.set("year","all"),this.$mapProductSelector.addClass("is-disabled").find(".item-text").text("All products"),this.$mapYearSelector.addClass("is-disabled").find(".item-text").text("All years")):(this.$mapProductSelector.removeClass("is-disabled"),this.$mapYearSelector.removeClass("is-disabled")),e.preventDefault()}});return o}),"use strict",define("views/map",["backbone","views/map/vis","views/map/toolbar","instances/status-map"],function(e,t,n,r){var i=e.View.extend({el:"#mapView",initialize:function(){this.toolbarView=new n,this.visView=new t},show:function(){this.$el.removeClass("is-hidden"),r.set({product:"all",year:"all",context:"production_count",productText:"Production count"}),$("#currentMapContext").text("Production count"),$("#currentMapProduct").text("All products"),$("#currentMapYear").text("All years"),this.visView.setMap(),this.visView.setLayer()},hide:function(){this.$el.addClass("is-hidden")}});return i}),define("text!views/../../templates/misc-toolbar.handlebars",[],function(){return'<ul>\n  <li class="item-selector">\n    <span class="current">\n      <span class="item-color"></span>\n      <span class="item-text" id="currentText">Select a product</span>\n      <span class="item-arrow"></span>\n    </span>\n    <ul class="item-selector-child">\n      {{#each products}}\n        <li><a href="#{{name}}" data-name="{{name}}">{{name}}</a></li>\n      {{/each}}\n    </ul>\n  </li>\n  <li class="item-fix">\n    <span class="item-color"></span>\n    <span class="item-text">Average</span>\n  </li>\n</ul>\n'}),"use strict",define("views/misc/toolbar",["backbone","handlebars","collections/products","text!../../../templates/misc-toolbar.handlebars"],function(e,t,n,r){var i=e.View.extend({el:"#miscToolbarView",events:{"click .item-selector-child a":"setProduct"},template:t.compile(r),initialize:function(){var e=this;this.products=new n,this.products.getData(function(){e.render()})},render:function(){this.$el.html(this.template({products:this.products.toJSON()}))},setProduct:function(t){var n=$(t.currentTarget);this.$el.find("#currentText").text(n.data("name")),e.Events.trigger("change:product",n.data("name")),t.preventDefault()}});return i}),function(){function Tt(e,t){var n;e||(e={});for(n in t)e[n]=t[n];return e}function Nt(){var e,t=arguments,n,r={},i=function(e,t){var n,r;typeof e!="object"&&(e={});for(r in t)t.hasOwnProperty(r)&&(n=t[r],n&&typeof n=="object"&&Object.prototype.toString.call(n)!=="[object Array]"&&r!=="renderTo"&&typeof n.nodeType!="number"?e[r]=i(e[r]||{},n):e[r]=t[r]);return e};t[0]===!0&&(r=t[1],t=Array.prototype.slice.call(t,2)),n=t.length;for(e=0;e<n;e++)r=i(r,t[e]);return r}function Ct(){var e=0,t=arguments,n=t.length,r={};for(;e<n;e++)r[t[e++]]=t[e];return r}function kt(e,t){return parseInt(e,t||10)}function Lt(e){return typeof e=="string"}function At(e){return typeof e=="object"}function Ot(e){return Object.prototype.toString.call(e)==="[object Array]"}function Mt(e){return typeof e=="number"}function _t(e){return r.log(e)/r.LN10}function Dt(e){return r.pow(10,e)}function Pt(e,t){var n=e.length;while(n--)if(e[n]===t){e.splice(n,1);break}}function Ht(t){return t!==e&&t!==null}function Bt(e,t,n){var r,i="setAttribute",s;if(Lt(t))Ht(n)?e[i](t,n):e&&e.getAttribute&&(s=e.getAttribute(t));else if(Ht(t)&&At(t))for(r in t)e[i](r,t[r]);return s}function jt(e){return Ot(e)?e:[e]}function Ft(){var e=arguments,t,n,r=e.length;for(t=0;t<r;t++){n=e[t];if(typeof n!="undefined"&&n!==null)return n}}function It(t,n){m&&!S&&n&&n.opacity!==e&&(n.filter="alpha(opacity="+n.opacity*100+")"),Tt(t.style,n)}function qt(e,n,r,i,s){var o=t.createElement(e);return n&&Tt(o,n),s&&It(o,{padding:0,border:V,margin:0}),r&&It(o,r),i&&i.appendChild(o),o}function Rt(e,t){var n=function(){};return n.prototype=new e,Tt(n.prototype,t),n}function Ut(e,t,n,r){var i=O.lang,s=+e||0,o=t===-1?(s.toString().split(".")[1]||"").length:isNaN(t=f(t))?2:t,u=n===undefined?i.decimalPoint:n,a=r===undefined?i.thousandsSep:r,l=s<0?"-":"",c=String(kt(s=f(s).toFixed(o))),h=c.length>3?c.length%3:0;return l+(h?c.substr(0,h)+a:"")+c.substr(h).replace(/(\d{3})(?=\d)/g,"$1"+a)+(o?u+f(s-c).toFixed(o).slice(2):"")}function zt(e,t){return(new Array((t||2)+1-String(e).length)).join(0)+e}function Wt(e,t,n){var r=e[t];e[t]=function(){var e=Array.prototype.slice.call(arguments);return e.unshift(r),n.apply(this,e)}}function Xt(e,t){var n=/f$/,r=/\.([0-9])/,i=O.lang,s;return n.test(e)?(s=e.match(r),s=s?s[1]:-1,t=Ut(t,s,i.decimalPoint,e.indexOf(",")>-1?i.thousandsSep:"")):t=M(e,t),t}function Vt(e,t){var n="{",r=!1,i,s,o,u,a,f=[],l,c;while((c=e.indexOf(n))!==-1){i=e.slice(0,c);if(r){s=i.split(":"),o=s.shift().split("."),a=o.length,l=t;for(u=0;u<a;u++)l=l[o[u]];s.length&&(l=Xt(s.join(":"),l)),f.push(l)}else f.push(i);e=e.slice(c+1),r=!r,n=r?"}":"{"}return f.push(e),f.join("")}function $t(e){return r.pow(10,s(r.log(e)/r.LN10))}function Jt(e,t,n,r){var i,s;n=Ft(n,1),i=e/n,t||(t=[1,2,2.5,5,10],r&&r.allowDecimals===!1&&(n===1?t=[1,2,5,10]:n<=.1&&(t=[1/n])));for(s=0;s<t.length;s++){e=t[s];if(i<=(t[s]+(t[s+1]||t[s]))/2)break}return e*=n,e}function Kt(){this.color=0,this.symbol=0}function Qt(e,t){var n=e.length,r,i;for(i=0;i<n;i++)e[i].ss_i=i;e.sort(function(e,n){return r=t(e,n),r===0?e.ss_i-n.ss_i:r});for(i=0;i<n;i++)delete e[i].ss_i}function Gt(e){var t=e.length,n=e[0];while(t--)e[t]<n&&(n=e[t]);return n}function Yt(e){var t=e.length,n=e[0];while(t--)e[t]>n&&(n=e[t]);return n}function Zt(e,t){var n;for(n in e)e[n]&&e[n]!==t&&e[n].destroy&&e[n].destroy(),delete e[n]}function en(e){A||(A=qt(I)),e&&A.appendChild(e),A.innerHTML=""}function tn(e,t){var r="Highcharts error #"+e+": www.highcharts.com/errors/"+e;if(t)throw r;n.console&&console.log(r)}function nn(e){return parseFloat(e.toPrecision(14))}function rn(e,t){_=Ft(e,t.animation)}function xn(){var e=O.global.useUTC,t=e?"getUTC":"get",n=e?"setUTC":"set";lt=(e&&O.global.timezoneOffset||0)*6e4,ft=e?Date.UTC:function(e,t,n,r,i,s){return(new Date(e,t,Ft(n,1),Ft(r,0),Ft(i,0),Ft(s,0))).getTime()},ct=t+"Minutes",ht=t+"Hours",pt=t+"Day",dt=t+"Date",vt=t+"Month",mt=t+"FullYear",gt=n+"Minutes",yt=n+"Hours",bt=n+"Date",wt=n+"Month",Et=n+"FullYear"}function Tn(e){return O=Nt(!0,O,e),xn(),O}function Nn(){return O}function On(){}function jn(e,t,n,r){this.axis=e,this.pos=t,this.type=n||"",this.isNew=!0,!n&&!r&&this.addLabel()}function Fn(){this.init.apply(this,arguments)}function Jn(){this.init.apply(this,arguments)}function Yn(e,t,n,r,i,s){var o=e.chart.inverted;this.axis=e,this.isNegative=n,this.options=t,this.x=r,this.total=null,this.points={},this.stack=i,this.percent=s==="percent",this.alignOptions={align:t.align||(o?n?"left":"right":"center"),verticalAlign:t.verticalAlign||(o?"middle":n?"bottom":"top"),y:Ft(t.y,o?4:n?14:-6),x:Ft(t.x,o?n?-6:6:0)},this.textAlign=t.textAlign||(o?n?"right":"left":"center")}var e,t=document,n=window,r=Math,i=r.round,s=r.floor,o=r.ceil,u=r.max,a=r.min,f=r.abs,l=r.cos,c=r.sin,h=r.PI,p=h*2/360,d=navigator.userAgent,v=n.opera,m=/msie/i.test(d)&&!v,g=t.documentMode===8,y=/AppleWebKit/.test(d),b=/Firefox/.test(d),w=/(Mobile|Android|Windows Phone)/.test(d),E="http://www.w3.org/2000/svg",S=!!t.createElementNS&&!!t.createElementNS(E,"svg").createSVGRect,x=b&&parseInt(d.split("Firefox/")[1],10)<4,T=!S&&!m&&!!t.createElement("canvas").getContext,N,C,k={},L=0,A,O,M,_,D,P,H=function(){},B=[],j="Highcharts",F="3.0.10",I="div",q="absolute",R="relative",U="hidden",z="highcharts-",W="visible",X="px",V="none",$="M",J="L",K=/^[0-9]+$/,Q="",G="hover",Y="select",Z="millisecond",et="second",tt="minute",nt="hour",rt="day",it="week",st="month",ot="year",ut,at="stroke-width",ft,lt,ct,ht,pt,dt,vt,mt,gt,yt,bt,wt,Et,St={},xt=n.Highcharts=n.Highcharts?tn(16,!0):{};M=function(e,t,n){if(!Ht(t)||isNaN(t))return"Invalid date";e=Ft(e,"%Y-%m-%d %H:%M:%S");var r=new Date(t-lt),s,o=r[ht](),u=r[pt](),a=r[dt](),f=r[vt](),l=r[mt](),c=O.lang,h=c.weekdays,p=Tt({a:h[u].substr(0,3),A:h[u],d:zt(a),e:a,b:c.shortMonths[f],B:c.months[f],m:zt(f+1),y:l.toString().substr(2,2),Y:l,H:zt(o),I:zt(o%12||12),l:o%12||12,M:zt(r[ct]()),p:o<12?"AM":"PM",P:o<12?"am":"pm",S:zt(r.getSeconds()),L:zt(i(t%1e3),3)},xt.dateFormats);for(s in p)while(e.indexOf("%"+s)!==-1)e=e.replace("%"+s,typeof p[s]=="function"?p[s](t):p[s]);return n?e.substr(0,1).toUpperCase()+e.substr(1):e},Kt.prototype={wrapColor:function(e){this.color>=e&&(this.color=0)},wrapSymbol:function(e){this.symbol>=e&&(this.symbol=0)}},P=Ct(Z,1,et,1e3,tt,6e4,nt,36e5,rt,864e5,it,6048e5,st,26784e5,ot,31556952e3),D={init:function(e,t,n){t=t||"";var r=e.shift,i=t.indexOf("C")>-1,s=i?7:3,o,u,a,f=t.split(" "),l=[].concat(n),c,h,p=function(e){a=e.length;while(a--)e[a]===$&&e.splice(a+1,0,e[a+1],e[a+2],e[a+1],e[a+2])};i&&(p(f),p(l)),e.isArea&&(c=f.splice(f.length-6,6),h=l.splice(l.length-6,6));if(r<=l.length/s&&f.length===l.length)while(r--)l=[].concat(l).splice(0,s).concat(l);e.shift=0;if(f.length){o=l.length;while(f.length<o)u=[].concat(f).splice(f.length-s,s),i&&(u[s-6]=u[s-2],u[s-5]=u[s-1]),f=f.concat(u)}return c&&(f=f.concat(c),l=l.concat(h)),[f,l]},step:function(e,t,n,r){var i=[],s=e.length,o;if(n===1)i=r;else if(s===t.length&&n<1)while(s--)o=parseFloat(e[s]),i[s]=isNaN(o)?e[s]:n*parseFloat(t[s]-o)+o;else i=t;return i}},function(r){n.HighchartsAdapter=n.HighchartsAdapter||r&&{init:function(t){var n=r.fx,i=n.step,s,o=r.Tween,u=o&&o.propHooks,a=r.cssHooks.opacity;r.extend(r.easing,{easeOutQuad:function(e,t,n,r,i){return-r*(t/=i)*(t-2)+n}}),r.each(["cur","_default","width","height","opacity"],function(t,r){var s=i,a;r==="cur"?s=n.prototype:r==="_default"&&o&&(s=u[r],r="set"),a=s[r],a&&(s[r]=function(n){var i;n=t?n:this;if(n.prop==="align")return;return i=n.elem,i.attr?i.attr(n.prop,r==="cur"?e:n.now):a.apply(this,arguments)})}),Wt(a,"get",function(e,t,n){return t.attr?t.opacity||0:e.call(this,t,n)}),s=function(e){var n=e.elem,r;e.started||(r=t.init(n,n.d,n.toD),e.start=r[0],e.end=r[1],e.started=!0),n.attr("d",t.step(e.start,e.end,e.pos,n.toD))},o?u.d={set:s}:i.d=s,this.each=Array.prototype.forEach?function(e,t){return Array.prototype.forEach.call(e,t)}:function(e,t){var n=0,r=e.length;for(;n<r;n++)if(t.call(e[n],e[n],n,e)===!1)return n},r.fn.highcharts=function(){var t="Chart",n=arguments,r,i,s;return Lt(n[0])&&(t=n[0],n=Array.prototype.slice.call(n,1)),r=n[0],r!==e&&(r.chart=r.chart||{},r.chart.renderTo=this[0],s=new xt[t](r,n[1]),i=this),r===e&&(i=B[Bt(this[0],"data-highcharts-chart")]),i}},getScript:r.getScript,inArray:r.inArray,adapterRun:function(e,t){return r(e)[t]()},grep:r.grep,map:function(e,t){var n=[],r=0,i=e.length;for(;r<i;r++)n[r]=t.call(e[r],e[r],r,e);return n},offset:function(e){return r(e).offset()},addEvent:function(e,t,n){r(e).bind(t,n)},removeEvent:function(e,n,i){var s=t.removeEventListener?"removeEventListener":"detachEvent";t[s]&&e&&!e[s]&&(e[s]=function(){}),r(e).unbind(n,i)},fireEvent:function(e,t,n,i){var s=r.Event(t),o="detached"+t,u;!m&&n&&(delete n.layerX,delete n.layerY),Tt(s,n),e[t]&&(e[o]=e[t],e[t]=null),r.each(["preventDefault","stopPropagation"],function(e,t){var n=s[t];s[t]=function(){try{n.call(s)}catch(e){t==="preventDefault"&&(u=!0)}}}),r(e).trigger(s),e[o]&&(e[t]=e[o],e[o]=null),i&&!s.isDefaultPrevented()&&!u&&i(s)},washMouseEvent:function(t){var n=t.originalEvent||t;return n.pageX===e&&(n.pageX=t.pageX,n.pageY=t.pageY),n},animate:function(t,n,i){var s=r(t);t.style||(t.style={}),n.d&&(t.toD=n.d,n.d=1),s.stop(),n.opacity!==e&&t.attr&&(n.opacity+="px"),s.animate(n,i)},stop:function(e){r(e).stop()}}}(n.jQuery);var sn=n.HighchartsAdapter,on=sn||{};sn&&sn.init.call(sn,D);var un=on.adapterRun,an=on.getScript,fn=on.inArray,ln=on.each,cn=on.grep,hn=on.offset,pn=on.map,dn=on.addEvent,vn=on.removeEvent,mn=on.fireEvent,gn=on.washMouseEvent,yn=on.animate,bn=on.stop,wn={enabled:!0,x:0,y:15,style:{color:"#666",cursor:"default",fontSize:"11px"}};O={colors:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"],symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],decimalPoint:".",numericSymbols:["k","M","G","T","P","E"],resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:","},global:{useUTC:!0,canvasToolsURL:"http://code.highcharts.com/3.0.10/modules/canvas-tools.js",VMLRadialGradientURL:"http://code.highcharts.com/3.0.10/gfx/vml-radial-gradient.png"},chart:{borderColor:"#4572A7",borderRadius:5,defaultSeriesType:"line",ignoreHiddenSeries:!0,spacing:[10,10,15,10],backgroundColor:"#FFFFFF",plotBorderColor:"#C0C0C0",resetZoomButton:{theme:{zIndex:20},position:{align:"right",x:-10,y:10}}},title:{text:"Chart title",align:"center",margin:15,style:{color:"#274b6d",fontSize:"16px"}},subtitle:{text:"",align:"center",style:{color:"#4d759e"}},plotOptions:{line:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1e3},events:{},lineWidth:2,marker:{enabled:!0,lineWidth:0,radius:4,lineColor:"#FFFFFF",states:{hover:{enabled:!0},select:{fillColor:"#FFFFFF",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:Nt(wn,{align:"center",enabled:!1,formatter:function(){return this.y===null?"":Ut(this.y,-1)},verticalAlign:"bottom",y:0}),cropThreshold:300,pointRange:0,states:{hover:{marker:{}},select:{marker:{}}},stickyTracking:!0,turboThreshold:1e3}},labels:{style:{position:q,color:"#3E576F"}},legend:{enabled:!0,align:"center",layout:"horizontal",labelFormatter:function(){return this.name},borderWidth:1,borderColor:"#909090",borderRadius:5,navigation:{activeColor:"#274b6d",inactiveColor:"#CCC"},shadow:!1,itemStyle:{color:"#274b6d",fontSize:"12px"},itemHoverStyle:{color:"#000"},itemHiddenStyle:{color:"#CCC"},itemCheckboxStyle:{position:q,width:"13px",height:"13px"},symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:R,top:"1em"},style:{position:q,backgroundColor:"white",opacity:.5,textAlign:"center"}},tooltip:{enabled:!0,animation:S,backgroundColor:"rgba(255, 255, 255, .85)",borderWidth:1,borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %b %e, %H:%M:%S.%L",second:"%A, %b %e, %H:%M:%S",minute:"%A, %b %e, %H:%M",hour:"%A, %b %e, %H:%M",day:"%A, %b %e, %Y",week:"Week from %A, %b %e, %Y",month:"%B %Y",year:"%Y"},headerFormat:'<span style="font-size: 10px">{point.key}</span><br/>',pointFormat:'<span style="color:{series.color}">{series.name}</span>: <b>{point.y}</b><br/>',shadow:!0,snap:w?25:10,style:{color:"#333333",cursor:"default",fontSize:"12px",padding:"8px",whiteSpace:"nowrap"}},credits:{enabled:!0,text:"Highcharts.com",href:"http://www.highcharts.com",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#909090",fontSize:"9px"}}};var En=O.plotOptions,Sn=En.line;xn();var Cn=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/,kn=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,Ln=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/,An=function(e){function i(e){e&&e.stops?r=pn(e.stops,function(e){return An(e[1])}):(n=Cn.exec(e),n?t=[kt(n[1]),kt(n[2]),kt(n[3]),parseFloat(n[4],10)]:(n=kn.exec(e),n?t=[kt(n[1],16),kt(n[2],16),kt(n[3],16),1]:(n=Ln.exec(e),n&&(t=[kt(n[1]),kt(n[2]),kt(n[3]),1]))))}function s(n){var i;return r?(i=Nt(e),i.stops=[].concat(i.stops),ln(r,function(e,t){i.stops[t]=[i.stops[t][0],e.get(n)]})):t&&!isNaN(t[0])?n==="rgb"?i="rgb("+t[0]+","+t[1]+","+t[2]+")":n==="a"?i=t[3]:i="rgba("+t.join(",")+")":i=e,i}function o(e){if(r)ln(r,function(t){t.brighten(e)});else if(Mt(e)&&e!==0){var n;for(n=0;n<3;n++)t[n]+=kt(e*255),t[n]<0&&(t[n]=0),t[n]>255&&(t[n]=255)}return this}function u(e){return t[3]=e,this}var t=[],n,r;return i(e),{get:s,brighten:o,rgba:t,setOpacity:u}};On.prototype={init:function(e,n){var r=this;r.element=n==="span"?qt(n):t.createElementNS(E,n),r.renderer=e,r.attrSetters={}},opacity:1,animate:function(e,t,n){var r=Ft(t,_,!0);bn(this),r?(r=Nt(r,{}),n&&(r.complete=n),yn(this,e,r)):(this.attr(e),n&&n())},attr:function(n,r){var i=this,s,o,a,f,l,c=i.element,h=c.nodeName.toLowerCase(),p=i.renderer,d,v,m=i.attrSetters,g=i.shadows,y,b,w=i;Lt(n)&&Ht(r)&&(s=n,n={},n[s]=r);if(Lt(n))s=n,h==="circle"?s={x:"cx",y:"cy"}[s]||s:s==="strokeWidth"&&(s="stroke-width"),w=Bt(c,s)||i[s]||0,s!=="d"&&s!=="visibility"&&s!=="fill"&&(w=parseFloat(w));else{for(s in n){d=!1,o=n[s],a=m[s]&&m[s].call(i,o,s);if(a!==!1){a!==e&&(o=a);if(s==="d")o&&o.join&&(o=o.join(" ")),/(NaN| {2}|^$)/.test(o)&&(o="M 0 0");else if(s==="x"&&h==="text")for(f=0;f<c.childNodes.length;f++)l=c.childNodes[f],Bt(l,"x")===Bt(c,"x")&&Bt(l,"x",o);else if(!i.rotation||s!=="x"&&s!=="y")if(s==="fill")o=p.color(o,c,s);else if(h!=="circle"||s!=="x"&&s!=="y")if(h==="rect"&&s==="r")Bt(c,{rx:o,ry:o}),d=!0;else if(s==="translateX"||s==="translateY"||s==="rotation"||s==="verticalAlign"||s==="scaleX"||s==="scaleY")b=!0,d=!0;else if(s==="stroke")o=p.color(o,c,s);else if(s==="dashstyle"){s="stroke-dasharray",o=o&&o.toLowerCase();if(o==="solid")o=V;else if(o){o=o.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(","),f=o.length;while(f--)o[f]=kt(o[f])*Ft(n["stroke-width"],i["stroke-width"]);o=o.join(",")}}else s==="width"?o=kt(o):s==="align"?(s="text-anchor",o={left:"start",center:"middle",right:"end"}[o]):s==="title"&&(v=c.getElementsByTagName("title")[0],v||(v=t.createElementNS(E,"title"),c.appendChild(v)),v.textContent=o);else s={x:"cx",y:"cy"}[s]||s;else b=!0;s==="strokeWidth"&&(s="stroke-width");if(s==="stroke-width"||s==="stroke")i[s]=o,i.stroke&&i["stroke-width"]?(Bt(c,"stroke",i.stroke),Bt(c,"stroke-width",i["stroke-width"]),i.hasStroke=!0):s==="stroke-width"&&o===0&&i.hasStroke&&(c.removeAttribute("stroke"),i.hasStroke=!1),d=!0;i.symbolName&&/^(x|y|width|height|r|start|end|innerR|anchorX|anchorY)/.test(s)&&(y||(i.symbolAttr(n),y=!0),d=!0);if(g&&/^(width|height|visibility|x|y|d|transform|cx|cy|r)$/.test(s)){f=g.length;while(f--)Bt(g[f],s,s==="height"?u(o-(g[f].cutHeight||0),0):o)}(s==="width"||s==="height")&&h==="rect"&&o<0&&(o=0),i[s]=o,s==="text"?o!==i.textStr&&(delete i.bBox,i.textStr=o,i.added&&p.buildText(i)):d||o!==undefined&&c.setAttribute(s,o)}}b&&i.updateTransform()}return w},addClass:function(e){var t=this.element,n=Bt(t,"class")||"";return n.indexOf(e)===-1&&Bt(t,"class",n+" "+e),this},symbolAttr:function(e){var t=this;ln(["x","y","r","start","end","width","height","innerR","anchorX","anchorY"],function(n){t[n]=Ft(e[n],t[n])}),t.attr({d:t.renderer.symbols[t.symbolName](t.x,t.y,t.width,t.height,t)})},clip:function(e){return this.attr("clip-path",e?"url("+this.renderer.url+"#"+e.id+")":V)},crisp:function(e){var t=this,n,r={},o,u=e.strokeWidth||t.strokeWidth||t.attr&&t.attr("stroke-width")||0;o=i(u)%2/2,e.x=s(e.x||t.x||0)+o,e.y=s(e.y||t.y||0)+o,e.width=s((e.width||t.width||0)-2*o),e.height=s((e.height||t.height||0)-2*o),e.strokeWidth=u;for(n in e)t[n]!==e[n]&&(t[n]=r[n]=e[n]);return r},css:function(e){var t=this,n=t.styles,r={},i=t.element,s,o,u="",a,f=!n;e&&e.color&&(e.fill=e.color);if(n)for(o in e)e[o]!==n[o]&&(r[o]=e[o],f=!0);if(f){s=t.textWidth=e&&e.width&&i.nodeName.toLowerCase()==="text"&&kt(e.width),n&&(e=Tt(n,r)),t.styles=e,s&&(T||!S&&t.renderer.forExport)&&delete e.width;if(m&&!S)It(t.element,e);else{a=function(e,t){return"-"+t.toLowerCase()};for(o in e)u+=o.replace(/([A-Z])/g,a)+":"+e[o]+";";Bt(i,"style",u)}s&&t.added&&t.renderer.buildText(t)}return t},on:function(e,t){var n=this,r=n.element;return C&&e==="click"?(r.ontouchstart=function(e){n.touchEventFired=Date.now(),e.preventDefault(),t.call(r,e)},r.onclick=function(e){(d.indexOf("Android")===-1||Date.now()-(n.touchEventFired||0)>1100)&&t.call(r,e)}):r["on"+e]=t,this},setRadialReference:function(e){return this.element.radialReference=e,this},translate:function(e,t){return this.attr({translateX:e,translateY:t})},invert:function(){var e=this;return e.inverted=!0,e.updateTransform(),e},updateTransform:function(){var e=this,t=e.translateX||0,n=e.translateY||0,r=e.scaleX,i=e.scaleY,s=e.inverted,o=e.rotation,u;s&&(t+=e.attr("width"),n+=e.attr("height")),u=["translate("+t+","+n+")"],s?u.push("rotate(90) scale(-1,1)"):o&&u.push("rotate("+o+" "+(e.x||0)+" "+(e.y||0)+")"),(Ht(r)||Ht(i))&&u.push("scale("+Ft(r,1)+" "+Ft(i,1)+")"),u.length&&Bt(e.element,"transform",u.join(" "))},toFront:function(){var e=this.element;return e.parentNode.appendChild(e),this},align:function(e,t,n){var r,s,o,u,a={},f,l=this.renderer,c=l.alignedObjects;if(e){this.alignOptions=e,this.alignByTranslate=t;if(!n||Lt(n))this.alignTo=f=n||"renderer",Pt(c,this),c.push(this),n=null}else e=this.alignOptions,t=this.alignByTranslate,f=this.alignTo;n=Ft(n,l[f],l),r=e.align,s=e.verticalAlign,o=(n.x||0)+(e.x||0),u=(n.y||0)+(e.y||0);if(r==="right"||r==="center")o+=(n.width-(e.width||0))/{right:1,center:2}[r];a[t?"translateX":"x"]=i(o);if(s==="bottom"||s==="middle")u+=(n.height-(e.height||0))/({bottom:1,middle:2}[s]||1);return a[t?"translateY":"y"]=i(u),this[this.placed?"animate":"attr"](a),this.placed=!0,this.alignAttr=a,this},getBBox:function(){var e=this,t=e.bBox,n=e.renderer,r,i,s=e.rotation,o=e.element,u=e.styles,a=s*p,h=e.textStr,d;if(h===""||K.test(h))d=h.toString().length+(u?"|"+u.fontSize+"|"+u.fontFamily:""),t=n.cache[d];if(!t){if(o.namespaceURI===E||n.forExport){try{t=o.getBBox?Tt({},o.getBBox()):{width:o.offsetWidth,height:o.offsetHeight}}catch(v){}if(!t||t.width<0)t={width:0,height:0}}else t=e.htmlGetBBox();n.isSVG&&(r=t.width,i=t.height,m&&u&&u.fontSize==="11px"&&i.toPrecision(3)==="16.9"&&(t.height=i=14),s&&(t.width=f(i*c(a))+f(r*l(a)),t.height=f(i*l(a))+f(r*c(a)))),e.bBox=t,d&&(n.cache[d]=t)}return t},show:function(e){return this.attr({visibility:e?"inherit":W})},hide:function(){return this.attr({visibility:U})},fadeOut:function(e){var t=this;t.animate({opacity:0},{duration:e||150,complete:function(){t.hide()}})},add:function(e){var t=this.renderer,n=e||t,r=n.element||t.box,i,s=this.element,o=this.zIndex,u,a,f,l;e&&(this.parentGroup=e),this.parentInverted=e&&e.inverted,this.textStr!==undefined&&t.buildText(this),o&&(n.handleZ=!0,o=kt(o));if(n.handleZ){i=r.childNodes;for(f=0;f<i.length;f++){u=i[f],a=Bt(u,"zIndex");if(u!==s&&(kt(a)>o||!Ht(o)&&Ht(a))){r.insertBefore(s,u),l=!0;break}}}return l||r.appendChild(s),this.added=!0,this.onAdd&&this.onAdd(),this},safeRemoveChild:function(e){var t=e.parentNode;t&&t.removeChild(e)},destroy:function(){var e=this,t=e.element||{},n=e.shadows,r=e.renderer.isSVG&&t.nodeName==="SPAN"&&e.parentGroup,i,s,o;t.onclick=t.onmouseout=t.onmouseover=t.onmousemove=t.point=null,bn(e),e.clipPath&&(e.clipPath=e.clipPath.destroy());if(e.stops){for(o=0;o<e.stops.length;o++)e.stops[o]=e.stops[o].destroy();e.stops=null}e.safeRemoveChild(t),n&&ln(n,function(t){e.safeRemoveChild(t)});while(r&&r.div.childNodes.length===0)i=r.parentGroup,e.safeRemoveChild(r.div),delete r.div,r=i;e.alignTo&&Pt(e.renderer.alignedObjects,e);for(s in e)delete e[s];return null},shadow:function(e,t,n){var r=[],i,s,o=this.element,a,f,l,c;if(e){f=Ft(e.width,3),l=(e.opacity||.15)/f,c=this.parentInverted?"(-1,-1)":"("+Ft(e.offsetX,1)+", "+Ft(e.offsetY,1)+")";for(i=1;i<=f;i++)s=o.cloneNode(0),a=f*2+1-2*i,Bt(s,{isShadow:"true",stroke:e.color||"black","stroke-opacity":l*i,"stroke-width":a,transform:"translate"+c,fill:V}),n&&(Bt(s,"height",u(Bt(s,"height")-a,0)),s.cutHeight=a),t?t.element.appendChild(s):o.parentNode.insertBefore(s,o),r.push(s);this.shadows=r}return this}};var Mn=function(){this.init.apply(this,arguments)};Mn.prototype={Element:On,init:function(e,r,i,s,u){var a=this,f=location,l,c,h;l=a.createElement("svg").attr({version:"1.1"}).css(this.getStyle(s)),c=l.element,e.appendChild(c),e.innerHTML.indexOf("xmlns")===-1&&Bt(c,"xmlns",E),a.isSVG=!0,a.box=c,a.boxWrapper=l,a.alignedObjects=[],a.url=(b||y)&&t.getElementsByTagName("base").length?f.href.replace(/#.*?$/,"").replace(/([\('\)])/g,"\\$1").replace(/ /g,"%20"):"",h=this.createElement("desc").add(),a.defs=this.createElement("defs").add(),a.forExport=u,a.gradients={},a.cache={},a.setSize(r,i,!1);var p,d;b&&e.getBoundingClientRect&&(a.subPixelFix=p=function(){It(e,{left:0,top:0}),d=e.getBoundingClientRect(),It(e,{left:o(d.left)-d.left+X,top:o(d.top)-d.top+X})},p(),dn(n,"resize",p))},getStyle:function(e){return this.style=Tt({fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Verdana, Arial, Helvetica, sans-serif',fontSize:"12px"},e)},isHidden:function(){return!this.boxWrapper.getBBox().width},destroy:function(){var e=this,t=e.defs;return e.box=null,e.boxWrapper=e.boxWrapper.destroy(),Zt(e.gradients||{}),e.gradients=null,t&&(e.defs=t.destroy()),e.subPixelFix&&vn(n,"resize",e.subPixelFix),e.alignedObjects=null,null},createElement:function(e){var t=new this.Element;return t.init(this,e),t},draw:function(){},buildText:function(e){var n=e.element,r=this,i=r.forExport,s=Ft(e.textStr,"").toString().replace(/<(b|strong)>/g,'<span style="font-weight:bold">').replace(/<(i|em)>/g,'<span style="font-style:italic">').replace(/<a/g,"<span").replace(/<\/(b|strong|i|em|a)>/g,"</span>").split(/<br.*?>/g),o=n.childNodes,u=/<.*style="([^"]+)".*>/,a=/<.*href="(http[^"]+)".*>/,f=Bt(n,"x"),l=e.styles,c=e.textWidth,h=l&&l.lineHeight,p=o.length,d=function(e){return h?kt(h):r.fontMetrics(/(px|em)$/.test(e&&e.style.fontSize)?e.style.fontSize:l.fontSize||11).h};while(p--)n.removeChild(o[p]);c&&!e.added&&this.box.appendChild(n),s[s.length-1]===""&&s.pop(),ln(s,function(s,o){var h,p=0;s=s.replace(/<span/g,"|||<span").replace(/<\/span>/g,"</span>|||"),h=s.split("|||"),ln(h,function(s){if(s!==""||h.length===1){var v={},m=t.createElementNS(E,"tspan"),g;u.test(s)&&(g=s.match(u)[1].replace(/(;| |^)color([ :])/,"$1fill$2"),Bt(m,"style",g)),a.test(s)&&!i&&(Bt(m,"onclick",'location.href="'+s.match(a)[1]+'"'),It(m,{cursor:"pointer"})),s=(s.replace(/<(.|\n)*?>/g,"")||" ").replace(/&lt;/g,"<").replace(/&gt;/g,">");if(s!==" "){m.appendChild(t.createTextNode(s)),p?v.dx=0:v.x=f,Bt(m,v),!p&&o&&(!S&&i&&It(m,{display:"block"}),Bt(m,"dy",d(m),y&&m.offsetHeight)),n.appendChild(m),p++;if(c){var b=s.replace(/([^\^])-/g,"$1- ").split(" "),w=b.length>1&&l.whiteSpace!=="nowrap",x,T,N=e._clipHeight,C=[],k=d(),L=1,A;while(w&&(b.length||C.length))delete e.bBox,A=e.getBBox(),T=A.width,!S&&r.forExport&&(T=r.measureSpanWidth(m.firstChild.data,e.styles)),x=T>c,!x||b.length===1?(b=C,C=[],b.length&&(L++,N&&L*k>N?(b=["..."],e.attr("title",e.textStr)):(m=t.createElementNS(E,"tspan"),Bt(m,{dy:k,x:f}),g&&Bt(m,"style",g),n.appendChild(m),T>c&&(c=T)))):(m.removeChild(m.firstChild),C.unshift(b.pop())),b.length&&m.appendChild(t.createTextNode(b.join(" ").replace(/- /g,"-")))}}}})})},button:function(e,t,n,r,i,s,o,u,a){var f=this.label(e,t,n,a,null,null,null,null,"button"),l=0,c,h,p,d,v,g,y="style",b={x1:0,y1:0,x2:0,y2:1};return i=Nt({"stroke-width":1,stroke:"#CCCCCC",fill:{linearGradient:b,stops:[[0,"#FEFEFE"],[1,"#F6F6F6"]]},r:2,padding:5,style:{color:"black"}},i),p=i[y],delete i[y],s=Nt(i,{stroke:"#68A",fill:{linearGradient:b,stops:[[0,"#FFF"],[1,"#ACF"]]}},s),d=s[y],delete s[y],o=Nt(i,{stroke:"#68A",fill:{linearGradient:b,stops:[[0,"#9BD"],[1,"#CDF"]]}},o),v=o[y],delete o[y],u=Nt(i,{style:{color:"#CCC"}},u),g=u[y],delete u[y],dn(f.element,m?"mouseover":"mouseenter",function(){l!==3&&f.attr(s).css(d)}),dn(f.element,m?"mouseout":"mouseleave",function(){l!==3&&(c=[i,s,o][l],h=[p,d,v][l],f.attr(c).css(h))}),f.setState=function(e){f.state=l=e,e?e===2?f.attr(o).css(v):e===3&&f.attr(u).css(g):f.attr(i).css(p)},f.on("click",function(){l!==3&&r.call(f)}).attr(i).css(Tt({cursor:"default"},p))},crispLine:function(e,t){return e[1]===e[4]&&(e[1]=e[4]=i(e[1])-t%2/2),e[2]===e[5]&&(e[2]=e[5]=i(e[2])+t%2/2),e},path:function(e){var t={fill:V};return Ot(e)?t.d=e:At(e)&&Tt(t,e),this.createElement("path").attr(t)},circle:function(e,t,n){var r=At(e)?e:{x:e,y:t,r:n};return this.createElement("circle").attr(r)},arc:function(e,t,n,r,i,s){var o;return At(e)&&(t=e.y,n=e.r,r=e.innerR,i=e.start,s=e.end,e=e.x),o=this.symbol("arc",e||0,t||0,n||0,n||0,{innerR:r||0,start:i||0,end:s||0}),o.r=n,o},rect:function(t,n,r,i,s,o){s=At(t)?t.r:s;var a=this.createElement("rect"),f=At(t)?t:t===e?{}:{x:t,y:n,width:u(r,0),height:u(i,0)};return o!==e&&(f.strokeWidth=o,f=a.crisp(f)),s&&(f.r=s),a.attr(f)},setSize:function(e,t,n){var r=this,i=r.alignedObjects,s=i.length;r.width=e,r.height=t,r.boxWrapper[Ft(n,!0)?"animate":"attr"]({width:e,height:t});while(s--)i[s].align()},g:function(e){var t=this.createElement("g");return Ht(e)?t.attr({"class":z+e}):t},image:function(e,t,n,r,i){var s={preserveAspectRatio:V},o;return arguments.length>1&&Tt(s,{x:t,y:n,width:r,height:i}),o=this.createElement("image").attr(s),o.element.setAttributeNS?o.element.setAttributeNS("http://www.w3.org/1999/xlink","href",e):o.element.setAttribute("hc-svg-href",e),o},symbol:function(e,t,n,r,s,o){var u,a=this.symbols[e],f=a&&a(i(t),i(n),r,s,o),l,c=/^url\((.*?)\)$/,h,p,d;return f?(u=this.path(f),Tt(u,{symbolName:e,x:t,y:n,width:r,height:s}),o&&Tt(u,o)):c.test(e)&&(d=function(e,t){e.element&&(e.attr({width:t[0],height:t[1]}),e.alignByTranslate||e.translate(i((r-t[0])/2),i((s-t[1])/2)))},h=e.match(c)[1],p=k[h],u=this.image(h).attr({x:t,y:n}),u.isImg=!0,p?d(u,p):(u.attr({width:0,height:0}),l=qt("img",{onload:function(){d(u,k[h]=[this.width,this.height])},src:h}))),u},symbols:{circle:function(e,t,n,r){var i=.166*n;return[$,e+n/2,t,"C",e+n+i,t,e+n+i,t+r,e+n/2,t+r,"C",e-i,t+r,e-i,t,e+n/2,t,"Z"]},square:function(e,t,n,r){return[$,e,t,J,e+n,t,e+n,t+r,e,t+r,"Z"]},triangle:function(e,t,n,r){return[$,e+n/2,t,J,e+n,t+r,e,t+r,"Z"]},"triangle-down":function(e,t,n,r){return[$,e,t,J,e+n,t,e+n/2,t+r,"Z"]},diamond:function(e,t,n,r){return[$,e+n/2,t,J,e+n,t+r/2,e+n/2,t+r,e,t+r/2,"Z"]},arc:function(e,t,n,r,i){var s=i.start,o=i.r||n||r,u=i.end-.001,a=i.innerR,f=i.open,p=l(s),d=c(s),v=l(u),m=c(u),g=i.end-s<h?0:1;return[$,e+o*p,t+o*d,"A",o,o,0,g,1,e+o*v,t+o*m,f?$:J,e+a*v,t+a*m,"A",a,a,0,g,0,e+a*p,t+a*d,f?"":"Z"]}},clipRect:function(e,t,n,r){var i,s=z+L++,o=this.createElement("clipPath").attr({id:s}).add(this.defs);return i=this.rect(e,t,n,r,0).add(o),i.id=s,i.clipPath=o,i},color:function(e,t,n){var r=this,i,s=/^rgba/,o,u,a,f,l,c,h,p,d,v,m=[];e&&e.linearGradient?o="linearGradient":e&&e.radialGradient&&(o="radialGradient");if(o){u=e[o],a=r.gradients,l=e.stops,p=t.radialReference,Ot(u)&&(e[o]=u={x1:u[0],y1:u[1],x2:u[2],y2:u[3],gradientUnits:"userSpaceOnUse"}),o==="radialGradient"&&p&&!Ht(u.gradientUnits)&&(u=Nt(u,{cx:p[0]-p[2]/2+u.cx*p[2],cy:p[1]-p[2]/2+u.cy*p[2],r:u.r*p[2],gradientUnits:"userSpaceOnUse"}));for(d in u)d!=="id"&&m.push(d,u[d]);for(d in l)m.push(l[d]);return m=m.join(","),a[m]?v=a[m].id:(u.id=v=z+L++,a[m]=f=r.createElement(o).attr(u).add(r.defs),f.stops=[],ln(l,function(e){var t;s.test(e[1])?(i=An(e[1]),c=i.get("rgb"),h=i.get("a")):(c=e[1],h=1),t=r.createElement("stop").attr({offset:e[0],"stop-color":c,"stop-opacity":h}).add(f),f.stops.push(t)})),"url("+r.url+"#"+v+")"}return s.test(e)?(i=An(e),Bt(t,n+"-opacity",i.get("a")),i.get("rgb")):(t.removeAttribute(n+"-opacity"),e)},text:function(e,t,n,r){var s=this,o=T||!S&&s.forExport,u;return r&&!s.forExport?s.html(e,t,n):(t=i(Ft(t,0)),n=i(Ft(n,0)),u=s.createElement("text").attr({x:t,y:n,text:e}),o&&u.css({position:q}),u.x=t,u.y=n,u)},fontMetrics:function(e){e=e||this.style.fontSize,e=/px/.test(e)?kt(e):/em/.test(e)?parseFloat(e)*12:12;var t=e<24?e+4:i(e*1.2),n=i(t*.8);return{h:t,b:n}},label:function(t,n,r,s,o,u,a,f,l){function L(){var e,t,n=p.element.style;v=(b===undefined||w===undefined||h.styles.textAlign)&&p.textStr&&p.getBBox(),h.width=(b||v.width||0)+2*g+y,h.height=(w||v.height||0)+2*g,N=g+c.fontMetrics(n&&n.fontSize).b,k&&(d||(e=i(-m*g),t=f?-N:0,h.box=d=s?c.symbol(s,e,t,h.width,h.height,T):c.rect(e,t,h.width,h.height,0,T[at]),d.attr("fill",V).add(h)),d.isImg||d.attr(Nt({width:h.width,height:h.height},T)),T=null)}function A(){var e=h.styles,t=e&&e.textAlign,n=y+g*(1-m),r;r=f?0:N,Ht(b)&&v&&(t==="center"||t==="right")&&(n+={center:.5,right:1}[t]*(b-v.width)),(n!==p.x||r!==p.y)&&p.attr({x:n,y:r}),p.x=n,p.y=r}function O(e,t){d?d.attr(e,t):T[e]=t}var c=this,h=c.g(l),p=c.text("",0,0,a).attr({zIndex:1}),d,v,m=0,g=3,y=0,b,w,E,S,x=0,T={},N,C=h.attrSetters,k;h.onAdd=function(){p.add(h),h.attr({text:t,x:n,y:r}),d&&Ht(o)&&h.attr({anchorX:o,anchorY:u})},C.width=function(e){return b=e,!1},C.height=function(e){return w=e,!1},C.padding=function(e){return Ht(e)&&e!==g&&(g=e,A()),!1},C.paddingLeft=function(e){return Ht(e)&&e!==y&&(y=e,A()),!1},C.align=function(e){return m={left:0,center:.5,right:1}[e],!1},C.text=function(e,t){return p.attr(t,e),L(),A(),!1},C[at]=function(e,t){return e&&(k=!0),x=e%2/2,O(t,e),!1},C.stroke=C.fill=C.r=function(e,t){return t==="fill"&&e&&(k=!0),O(t,e),!1},C.anchorX=function(e,t){return o=e,O(t,e+x-E),!1},C.anchorY=function(e,t){return u=e,O(t,e-S),!1},C.x=function(e){return h.x=e,e-=m*((b||v.width)+g),E=i(e),h.attr("translateX",E),!1},C.y=function(e){return S=h.y=i(e),h.attr("translateY",S),!1};var M=h.css;return Tt(h,{css:function(t){if(t){var n={};t=Nt(t),ln(["fontSize","fontWeight","fontFamily","color","lineHeight","width","textDecoration","textShadow"],function(r){t[r]!==e&&(n[r]=t[r],delete t[r])}),p.css(n)}return M.call(h,t)},getBBox:function(){return{width:v.width+2*g,height:v.height+2*g,x:v.x-g,y:v.y-g}},shadow:function(e){return d&&d.shadow(e),h},destroy:function(){vn(h.element,"mouseenter"),vn(h.element,"mouseleave"),p&&(p=p.destroy()),d&&(d=d.destroy()),On.prototype.destroy.call(h),h=c=L=A=O=null}})}},N=Mn,Tt(On.prototype,{htmlCss:function(e){var t=this,n=t.element,r=e&&n.tagName==="SPAN"&&e.width;return r&&(delete e.width,t.textWidth=r,t.updateTransform()),t.styles=Tt(t.styles,e),It(t.element,e),t},htmlGetBBox:function(){var e=this,t=e.element,n=e.bBox;return n||(t.nodeName==="text"&&(t.style.position=q),n=e.bBox={x:t.offsetLeft,y:t.offsetTop,width:t.offsetWidth,height:t.offsetHeight}),n},htmlUpdateTransform:function(){if(!this.added){this.alignOnAdd=!0;return}var e=this,t=e.renderer,n=e.element,r=e.translateX||0,i=e.translateY||0,s=e.x||0,o=e.y||0,u=e.textAlign||"left",a={left:0,center:.5,right:1}[u],f=e.shadows;It(n,{marginLeft:r,marginTop:i}),f&&ln(f,function(e){It(e,{marginLeft:r+1,marginTop:i+1})}),e.inverted&&ln(n.childNodes,function(e){t.invertChild(e,n)});if(n.tagName==="SPAN"){var l,c=e.rotation,h,p=kt(e.textWidth),d=[c,u,n.innerHTML,e.textWidth].join(",");d!==e.cTT&&(h=t.fontMetrics(n.style.fontSize).b,Ht(c)&&e.setSpanRotation(c,a,h),l=Ft(e.elemWidth,n.offsetWidth),l>p&&/[ \-]/.test(n.textContent||n.innerText)&&(It(n,{width:p+X,display:"block",whiteSpace:"normal"}),l=p),e.getSpanCorrection(l,h,a,c,u)),It(n,{left:s+(e.xCorr||0)+X,top:o+(e.yCorr||0)+X}),y&&(h=n.offsetHeight),e.cTT=d}},setSpanRotation:function(e,t,n){var r={},i=m?"-ms-transform":y?"-webkit-transform":b?"MozTransform":v?"-o-transform":"";r[i]=r.transform="rotate("+e+"deg)",r[i+(b?"Origin":"-origin")]=r.transformOrigin=t*100+"% "+n+"px",It(this.element,r)},getSpanCorrection:function(e,t,n){this.xCorr=-e*n,this.yCorr=-t}}),Tt(Mn.prototype,{html:function(e,t,n){var r=this.createElement("span"),s=r.attrSetters,o=r.element,u=r.renderer;return s.text=function(e){return e!==o.innerHTML&&delete this.bBox,o.innerHTML=this.textStr=e,!1},s.x=s.y=s.align=s.rotation=function(e,t){return t==="align"&&(t="textAlign"),r[t]=e,r.htmlUpdateTransform(),!1},r.attr({text:e,x:i(t),y:i(n)}).css({position:q,whiteSpace:"nowrap",fontFamily:this.style.fontFamily,fontSize:this.style.fontSize}),r.css=r.htmlCss,u.isSVG&&(r.add=function(e){var t,n=u.box.parentNode,i,s=[];this.parentGroup=e;if(e){t=e.div;if(!t){i=e;while(i)s.push(i),i=i.parentGroup;ln(s.reverse(),function(e){var r;t=e.div=e.div||qt(I,{className:Bt(e.element,"class")},{position:q,left:(e.translateX||0)+X,top:(e.translateY||0)+X},t||n),r=t.style,Tt(e.attrSetters,{translateX:function(e){r.left=e+X},translateY:function(e){r.top=e+X},visibility:function(e,t){r[t]=e}})})}}else t=n;return t.appendChild(o),r.added=!0,r.alignOnAdd&&r.htmlUpdateTransform(),r}),r}});var _n,Dn;if(!S&&!T){xt.VMLElement=Dn={init:function(e,t){var n=this,r=["<",t,' filled="f" stroked="f"'],i=["position: ",q,";"],s=t===I;(t==="shape"||s)&&i.push("left:0;top:0;width:1px;height:1px;"),i.push("visibility: ",s?U:W),r.push(' style="',i.join(""),'"/>'),t&&(r=s||t==="span"||t==="img"?r.join(""):e.prepVML(r),n.element=qt(r)),n.renderer=e,n.attrSetters={}},add:function(e){var t=this,n=t.renderer,r=t.element,i=n.box,s=e&&e.inverted,o=e?e.element||e:i;return s&&n.invertChild(r,o),o.appendChild(r),t.added=!0,t.alignOnAdd&&!t.deferUpdateTransform&&t.updateTransform(),t.onAdd&&t.onAdd(),t},updateTransform:On.prototype.htmlUpdateTransform,setSpanRotation:function(){var e=this.rotation,t=l(e*p),n=c(e*p);It(this.element,{filter:e?["progid:DXImageTransform.Microsoft.Matrix(M11=",t,", M12=",-n,", M21=",n,", M22=",t,", sizingMethod='auto expand')"].join(""):V})},getSpanCorrection:function(e,t,n,r,i){var s=r?l(r*p):1,o=r?c(r*p):0,u=Ft(this.elemHeight,this.element.offsetHeight),a,f=i&&i!=="left";this.xCorr=s<0&&-e,this.yCorr=o<0&&-u,a=s*o<0,this.xCorr+=o*t*(a?1-n:n),this.yCorr-=s*t*(r?a?n:1-n:1),f&&(this.xCorr-=e*n*(s<0?-1:1),r&&(this.yCorr-=u*n*(o<0?-1:1)),It(this.element,{textAlign:i}))},pathToVML:function(e){var t=e.length,n=[];while(t--)Mt(e[t])?n[t]=i(e[t]*10)-5:e[t]==="Z"?n[t]="x":(n[t]=e[t],e.isArc&&(e[t]==="wa"||e[t]==="at")&&(n[t+5]===n[t+7]&&(n[t+7]+=e[t+7]>e[t+5]?1:-1),n[t+6]===n[t+8]&&(n[t+8]+=e[t+8]>e[t+6]?1:-1)));return n.join(" ")||"x"},attr:function(t,n){var r=this,s,o,a,f,h=r.element||{},d=h.style,v=h.nodeName,m=r.renderer,y=r.symbolName,b,w=r.shadows,E,S=r.attrSetters,x=r;Lt(t)&&Ht(n)&&(s=t,t={},t[s]=n);if(Lt(t))s=t,s==="strokeWidth"||s==="stroke-width"?x=r.strokeweight:x=r[s];else for(s in t){o=t[s],E=!1,f=S[s]&&S[s].call(r,o,s);if(f!==!1&&o!==null){f!==e&&(o=f);if(y&&/^(x|y|r|start|end|width|height|innerR|anchorX|anchorY)/.test(s))b||(r.symbolAttr(t),b=!0),E=!0;else if(s==="d"){o=o||[],r.d=o.join(" "),h.path=o=r.pathToVML(o);if(w){a=w.length;while(a--)w[a].path=w[a].cutOff?this.cutOffPath(o,w[a].cutOff):o}E=!0}else if(s==="visibility"){o==="inherit"&&(o=W);if(w){a=w.length;while(a--)w[a].style[s]=o}v==="DIV"&&(o=o===U?"-999em":0,g||(d[s]=o?W:U),s="top"),d[s]=o,E=!0}else if(s==="zIndex")o&&(d[s]=o),E=!0;else if(fn(s,["x","y","width","height"])!==-1)r[s]=o,s==="x"||s==="y"?s={x:"left",y:"top"}[s]:o=u(0,o),r.updateClipping?(r[s]=o,r.updateClipping()):d[s]=o,E=!0;else if(s==="class"&&v==="DIV")h.className=o;else if(s==="stroke")o=m.color(o,h,s),s="strokecolor";else if(s==="stroke-width"||s==="strokeWidth")h.stroked=o?!0:!1,s="strokeweight",r[s]=o,Mt(o)&&(o+=X);else if(s==="dashstyle"){var T=h.getElementsByTagName("stroke")[0]||qt(m.prepVML(["<stroke/>"]),null,null,h);T[s]=o||"solid",r.dashstyle=o,E=!0}else if(s==="fill")v==="SPAN"?d.color=o:v!=="IMG"&&(h.filled=o!==V?!0:!1,o=m.color(o,h,s,r),s="fillcolor");else if(s==="opacity")E=!0;else if(v==="shape"&&s==="rotation")r[s]=h.style[s]=o,h.style.left=-i(c(o*p)+1)+X,h.style.top=i(l(o*p))+X;else if(s==="translateX"||s==="translateY"||s==="rotation")r[s]=o,r.updateTransform(),E=!0;E||(g?h[s]=o:Bt(h,s,o))}}return x},clip:function(e){var t=this,n,r;return e?(n=e.members,Pt(n,t),n.push(t),t.destroyClip=function(){Pt(n,t)},r=e.getCSS(t)):(t.destroyClip&&t.destroyClip(),r={clip:g?"inherit":"rect(auto)"}),t.css(r)},css:On.prototype.htmlCss,safeRemoveChild:function(e){e.parentNode&&en(e)},destroy:function(){return this.destroyClip&&this.destroyClip(),On.prototype.destroy.apply(this)},on:function(e,t){return this.element["on"+e]=function(){var e=n.event;e.target=e.srcElement,t(e)},this},cutOffPath:function(e,t){var n;e=e.split(/[ ,]/),n=e.length;if(n===9||n===11)e[n-4]=e[n-2]=kt(e[n-2])-10*t;return e.join(" ")},shadow:function(e,t,n){var r=[],i,s=this.element,o=this.renderer,u,a=s.style,f,l=s.path,c,h,p,d;l&&typeof l.value!="string"&&(l="x"),h=l;if(e){p=Ft(e.width,3),d=(e.opacity||.15)/p;for(i=1;i<=3;i++)c=p*2+1-2*i,n&&(h=this.cutOffPath(l.value,c+.5)),f=['<shape isShadow="true" strokeweight="',c,'" filled="false" path="',h,'" coordsize="10 10" style="',s.style.cssText,'" />'],u=qt(o.prepVML(f),null,{left:kt(a.left)+Ft(e.offsetX,1),top:kt(a.top)+Ft(e.offsetY,1)}),n&&(u.cutOff=c+1),f=['<stroke color="',e.color||"black",'" opacity="',d*i,'"/>'],qt(o.prepVML(f),null,null,u),t?t.element.appendChild(u):s.parentNode.insertBefore(u,s),r.push(u);this.shadows=r}return this}},Dn=Rt(On,Dn);var Pn={Element:Dn,isIE8:d.indexOf("MSIE 8.0")>-1,init:function(e,n,r,i){var s=this,o,u,a;s.alignedObjects=[],o=s.createElement(I).css(Tt(this.getStyle(i),{position:R})),u=o.element,e.appendChild(o.element),s.isVML=!0,s.box=u,s.boxWrapper=o,s.cache={},s.setSize(n,r,!1);if(!t.namespaces.hcv){t.namespaces.add("hcv","urn:schemas-microsoft-com:vml"),a="hcv\\:fill, hcv\\:path, hcv\\:shape, hcv\\:stroke{ behavior:url(#default#VML); display: inline-block; } ";try{t.createStyleSheet().cssText=a}catch(f){t.styleSheets[0].cssText+=a}}},isHidden:function(){return!this.box.offsetWidth},clipRect:function(e,t,n,r){var s=this.createElement(),o=At(e);return Tt(s,{members:[],left:(o?e.x:e)+1,top:(o?e.y:t)+1,width:(o?e.width:n)-1,height:(o?e.height:r)-1,getCSS:function(e){var t=e.element,n=t.nodeName,r=n==="shape",s=e.inverted,o=this,u=o.top-(r?t.offsetTop:0),a=o.left,f=a+o.width,l=u+o.height,c={clip:"rect("+i(s?a:u)+"px,"+i(s?l:f)+"px,"+i(s?f:l)+"px,"+i(s?u:a)+"px)"};return!s&&g&&n==="DIV"&&Tt(c,{width:f+X,height:l+X}),c},updateClipping:function(){ln(s.members,function(e){e.css(s.getCSS(e))})}})},color:function(e,t,n,i){var s=this,o,u=/^rgba/,a,f,l=V;e&&e.linearGradient?f="gradient":e&&e.radialGradient&&(f="pattern");if(f){var c,p,d=e.linearGradient||e.radialGradient,v,m,g,y,b,w,E,S,x="",T=e.stops,N,C,k=[],L=function(){a=['<fill colors="'+k.join(",")+'" opacity="',w,'" o:opacity2="',b,'" type="',f,'" ',x,'focus="100%" method="any" />'],qt(s.prepVML(a),null,null,t)};N=T[0],C=T[T.length-1],N[0]>0&&T.unshift([0,N[1]]),C[0]<1&&T.push([1,C[1]]),ln(T,function(e,t){u.test(e[1])?(o=An(e[1]),c=o.get("rgb"),p=o.get("a")):(c=e[1],p=1),k.push(e[0]*100+"% "+c),t?(w=p,E=c):(b=p,S=c)});if(n==="fill")if(f==="gradient")v=d.x1||d[0]||0,m=d.y1||d[1]||0,g=d.x2||d[2]||0,y=d.y2||d[3]||0,x='angle="'+(90-r.atan((y-m)/(g-v))*180/h)+'"',L();else{var A=d.r,M=A*2,_=A*2,D=d.cx,P=d.cy,H=t.radialReference,B,j=function(){H&&(B=i.getBBox(),D+=(H[0]-B.x)/B.width-.5,P+=(H[1]-B.y)/B.height-.5,M*=H[2]/B.width,_*=H[2]/B.height),x='src="'+O.global.VMLRadialGradientURL+'" '+'size="'+M+","+_+'" '+'origin="0.5,0.5" '+'position="'+D+","+P+'" '+'color2="'+S+'" ',L()};i.added?j():i.onAdd=j,l=E}else l=c}else if(u.test(e)&&t.tagName!=="IMG")o=An(e),a=["<",n,' opacity="',o.get("a"),'"/>'],qt(this.prepVML(a),null,null,t),l=o.get("rgb");else{var F=t.getElementsByTagName(n);F.length&&(F[0].opacity=1,F[0].type="solid"),l=e}return l},prepVML:function(e){var t="display:inline-block;behavior:url(#default#VML);",n=this.isIE8;return e=e.join(""),n?(e=e.replace("/>",' xmlns="urn:schemas-microsoft-com:vml" />'),e.indexOf('style="')===-1?e=e.replace("/>",' style="'+t+'" />'):e=e.replace('style="','style="'+t)):e=e.replace("<","<hcv:"),e},text:Mn.prototype.html,path:function(e){var t={coordsize:"10 10"};return Ot(e)?t.d=e:At(e)&&Tt(t,e),this.createElement("shape").attr(t)},circle:function(e,t,n){var r=this.symbol("circle");return At(e)&&(n=e.r,t=e.y,e=e.x),r.isCircle=!0,r.r=n,r.attr({x:e,y:t})},g:function(e){var t,n;return e&&(n={className:z+e,"class":z+e}),t=this.createElement(I).attr(n),t},image:function(e,t,n,r,i){var s=this.createElement("img").attr({src:e});return arguments.length>1&&s.attr({x:t,y:n,width:r,height:i}),s},createElement:function(e){return e==="rect"?this.symbol(e):Mn.prototype.createElement.call(this,e)},invertChild:function(e,t){var n=this,r=t.style,i=e.tagName==="IMG"&&e.style;It(e,{flip:"x",left:kt(r.width)-(i?kt(i.top):1),top:kt(r.height)-(i?kt(i.left):1),rotation:-90}),ln(e.childNodes,function(t){n.invertChild(t,e)})},symbols:{arc:function(e,t,n,r,i){var s=i.start,o=i.end,u=i.r||n||r,a=i.innerR,f=l(s),h=c(s),p=l(o),d=c(o),v;return o-s===0?["x"]:(v=["wa",e-u,t-u,e+u,t+u,e+u*f,t+u*h,e+u*p,t+u*d],i.open&&!a&&v.push("e",$,e,t),v.push("at",e-a,t-a,e+a,t+a,e+a*p,t+a*d,e+a*f,t+a*h,"x","e"),v.isArc=!0,v)},circle:function(e,t,n,r,i){return i&&(n=r=2*i.r),i&&i.isCircle&&(e-=n/2,t-=r/2),["wa",e,t,e+n,t+r,e+n,t+r/2,e+n,t+r/2,"e"]},rect:function(e,t,n,r,i){var s=e+n,o=t+r,u,f;return!Ht(i)||!i.r?u=Mn.prototype.symbols.square.apply(0,arguments):(f=a(i.r,n,r),u=[$,e+f,t,J,s-f,t,"wa",s-2*f,t,s,t+2*f,s-f,t,s,t+f,J,s,o-f,"wa",s-2*f,o-2*f,s,o,s,o-f,s-f,o,J,e+f,o,"wa",e,o-2*f,e+2*f,o,e+f,o,e,o-f,J,e,t+f,"wa",e,t,e+2*f,t+2*f,e,t+f,e+f,t,"x","e"]),u}}};xt.VMLRenderer=_n=function(){this.init.apply(this,arguments)},_n.prototype=Nt(Mn.prototype,Pn),N=_n}Mn.prototype.measureSpanWidth=function(e,n){var r=t.createElement("span"),i,s=t.createTextNode(e);return r.appendChild(s),It(r,n),this.box.appendChild(r),i=r.offsetWidth,en(r),i};var Hn,Bn;T&&(xt.CanVGRenderer=Hn=function(){E="http://www.w3.org/1999/xhtml"},Hn.prototype.symbols={},Bn=function(){function t(){var t=e.length,n;for(n=0;n<t;n++)e[n]();e=[]}var e=[];return{push:function(n,r){e.length===0&&an(r,t),e.push(n)}}}(),N=Hn),jn.prototype={addLabel:function(){var e=this,t=e.axis,n=t.options,r=t.chart,s=t.horiz,o=t.categories,a=t.names,f=e.pos,l=n.labels,c,h=t.tickPositions,p=s&&o&&!l.step&&!l.staggerLines&&!l.rotation&&r.plotWidth/h.length||!s&&(r.margin[3]||r.chartWidth*.33),d=f===h[0],v=f===h[h.length-1],m,g,y=o?Ft(o[f],a[f],f):f,b=e.label,w=h.info,E;t.isDatetimeAxis&&w&&(E=n.dateTimeLabelFormats[w.higherRanks[f]||w.unitName]),e.isFirst=d,e.isLast=v,c=t.labelFormatter.call({axis:t,chart:r,isFirst:d,isLast:v,dateTimeLabelFormat:E,value:t.isLog?nn(Dt(y)):y}),m=p&&{width:u(1,i(p-2*(l.padding||10)))+X},m=Tt(m,l.style),Ht(b)?b&&b.attr({text:c}).css(m):(g={align:t.labelAlign},Mt(l.rotation)&&(g.rotation=l.rotation),p&&l.ellipsis&&(g._clipHeight=t.len/h.length),e.label=Ht(c)&&l.enabled?r.renderer.text(c,0,0,l.useHTML).attr(g).css(m).add(t.labelGroup):null)},getLabelSize:function(){var e=this.label,t=this.axis;return e?e.getBBox()[t.horiz?"height":"width"]:0},getLabelSides:function(){var e=this.label.getBBox(),t=this.axis,n=t.horiz,r=t.options,i=r.labels,s=n?e.width:e.height,o=n?i.x-s*{left:0,center:.5,right:1}[t.labelAlign]:0,u=n?s+o:s;return[o,u]},handleOverflow:function(t,n){var r=!0,i=this.axis,s=this.isFirst,o=this.isLast,u=i.horiz,a=u?n.x:n.y,f=i.reversed,l=i.tickPositions,c=this.getLabelSides(),h=c[0],p=c[1],d,v,m,g,y=this.label.line||0,b=i.labelEdge,w=i.justifyLabels&&(s||o),E;b[y]===e||a+h>b[y]?b[y]=a+p:w||(r=!1);if(w){E=i.justifyToPlot,d=E?i.pos:0,v=E?d+i.len:i.chart.chartWidth;do t+=s?1:-1,m=i.ticks[l[t]];while(l[t]&&(!m||m.label.line!==y));g=m&&m.label.xy&&m.label.xy.x+m.getLabelSides()[s?0:1],s&&!f||o&&f?a+h<d&&(a=d-h,m&&a+p>g&&(r=!1)):a+p>v&&(a=v-p,m&&a+h<g&&(r=!1)),n.x=a}return r},getPosition:function(e,t,n,r){var i=this.axis,s=i.chart,o=r&&s.oldChartHeight||s.chartHeight;return{x:e?i.translate(t+n,null,null,r)+i.transB:i.left+i.offset+(i.opposite?(r&&s.oldChartWidth||s.chartWidth)-i.right-i.left:0),y:e?o-i.bottom+i.offset-(i.opposite?i.height:0):o-i.translate(t+n,null,null,r)-i.transB}},getLabelPosition:function(e,t,n,r,i,s,o,u){var a=this.axis,f=a.transA,c=a.reversed,h=a.staggerLines,d=a.chart.renderer.fontMetrics(i.style.fontSize).b,v=i.rotation;return e=e+i.x-(s&&r?s*f*(c?-1:1):0),t=t+i.y-(s&&!r?s*f*(c?1:-1):0),v&&a.side===2&&(t-=d-d*l(v*p)),!Ht(i.y)&&!v&&(t+=d-n.getBBox().height/2),h&&(n.line=o/(u||1)%h,t+=n.line*(a.labelOffset/h)),{x:e,y:t}},getMarkPath:function(e,t,n,r,i,s){return s.crispLine([$,e,t,J,e+(i?0:-n),t+(i?n:0)],r)},render:function(t,n,r){var i=this,s=i.axis,o=s.options,u=s.chart,a=u.renderer,f=s.horiz,l=i.type,c=i.label,h=i.pos,p=o.labels,d=i.gridLine,v=l?l+"Grid":"grid",m=l?l+"Tick":"tick",g=o[v+"LineWidth"],y=o[v+"LineColor"],b=o[v+"LineDashStyle"],w=o[m+"Length"],E=o[m+"Width"]||0,S=o[m+"Color"],x=o[m+"Position"],T,N=i.mark,C,k=p.step,L,A=!0,O=s.tickmarkOffset,M=i.getPosition(f,h,O,n),_=M.x,D=M.y,P=f&&_===s.pos+s.len||!f&&D===s.pos?-1:1;this.isActive=!0,g&&(T=s.getPlotLinePath(h+O,g*P,n,!0),d===e&&(L={stroke:y,"stroke-width":g},b&&(L.dashstyle=b),l||(L.zIndex=1),n&&(L.opacity=0),i.gridLine=d=g?a.path(T).attr(L).add(s.gridGroup):null),!n&&d&&T&&d[i.isNew?"attr":"animate"]({d:T,opacity:r})),E&&w&&(x==="inside"&&(w=-w),s.opposite&&(w=-w),C=i.getMarkPath(_,D,w,E*P,f,a),N?N.animate({d:C,opacity:r}):i.mark=a.path(C).attr({stroke:S,"stroke-width":E,opacity:r}).add(s.axisGroup)),c&&!isNaN(_)&&(c.xy=M=i.getLabelPosition(_,D,c,f,p,O,t,k),i.isFirst&&!i.isLast&&!Ft(o.showFirstLabel,1)||i.isLast&&!i.isFirst&&!Ft(o.showLastLabel,1)?A=!1:!s.isRadial&&!p.step&&!p.rotation&&!n&&r!==0&&(A=i.handleOverflow(t,M)),k&&t%k&&(A=!1),A&&!isNaN(M.y)?(M.opacity=r,c[i.isNew?"attr":"animate"](M),i.isNew=!1):c.attr("y",-9999))},destroy:function(){Zt(this,this.axis)}},xt.PlotLineOrBand=function(e,t){this.axis=e,t&&(this.options=t,this.id=t.id)},xt.PlotLineOrBand.prototype={render:function(){var e=this,t=e.axis,n=t.horiz,r=(t.pointRange||0)/2,i=e.options,s=i.label,o=e.label,f=i.width,l=i.to,c=i.from,h=Ht(c)&&Ht(l),p=i.value,d=i.dashStyle,v=e.svgElem,m=[],g,y,b,w,E,S,x=i.color,T=i.zIndex,N=i.events,C,k=t.chart.renderer;t.isLog&&(c=_t(c),l=_t(l),p=_t(p));if(f)m=t.getPlotLinePath(p,f),C={stroke:x,"stroke-width":f},d&&(C.dashstyle=d);else{if(!h)return;c=u(c,t.min-r),l=a(l,t.max+r),m=t.getPlotBandPath(c,l,i),C={fill:x},i.borderWidth&&(C.stroke=i.borderColor,C["stroke-width"]=i.borderWidth)}Ht(T)&&(C.zIndex=T);if(v)m?v.animate({d:m},null,v.onGetPath):(v.hide(),v.onGetPath=function(){v.show()},o&&(e.label=o=o.destroy()));else if(m&&m.length){e.svgElem=v=k.path(m).attr(C).add();if(N){g=function(t){v.on(t,function(n){N[t].apply(e,[n])})};for(y in N)g(y)}}return s&&Ht(s.text)&&m&&m.length&&t.width>0&&t.height>0?(s=Nt({align:n&&h&&"center",x:n?!h&&4:10,verticalAlign:!n&&h&&"middle",y:n?h?16:10:h?6:-4,rotation:n&&!h&&90},s),o||(e.label=o=k.text(s.text,0,0,s.useHTML).attr({align:s.textAlign||s.align,rotation:s.rotation,zIndex:T}).css(s.style).add()),b=[m[1],m[4],Ft(m[6],m[1])],w=[m[2],m[5],Ft(m[7],m[2])],E=Gt(b),S=Gt(w),o.align(s,!1,{x:E,y:S,width:Yt(b)-E,height:Yt(w)-S}),o.show()):o&&o.hide(),e},destroy:function(){Pt(this.axis.plotLinesAndBands,this),delete this.axis,Zt(this)}},ut={getPlotBandPath:function(e,t){var n=this.getPlotLinePath(t),r=this.getPlotLinePath(e);return r&&n?r.push(n[4],n[5],n[1],n[2]):r=null,r},addPlotBand:function(e){this.addPlotBandOrLine(e,"plotBands")},addPlotLine:function(e){this.addPlotBandOrLine(e,"plotLines")},addPlotBandOrLine:function(e,t){var n=(new xt.PlotLineOrBand(this,e)).render(),r=this.userOptions;return n&&(t&&(r[t]=r[t]||[],r[t].push(e)),this.plotLinesAndBands.push(n)),n},removePlotBandOrLine:function(e){var t=this.plotLinesAndBands,n=this.options,r=this.userOptions,i=t.length;while(i--)t[i].id===e&&t[i].destroy();ln([n.plotLines||[],r.plotLines||[],n.plotBands||[],r.plotBands||[]],function(t){i=t.length;while(i--)t[i].id===e&&Pt(t,t[i])})}},Fn.prototype={defaultOptions:{dateTimeLabelFormats:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e. %b",week:"%e. %b",month:"%b '%y",year:"%Y"},endOnTick:!1,gridLineColor:"#C0C0C0",labels:wn,lineColor:"#C0D0E0",lineWidth:1,minPadding:.01,maxPadding:.01,minorGridLineColor:"#E0E0E0",minorGridLineWidth:1,minorTickColor:"#A0A0A0",minorTickLength:2,minorTickPosition:"outside",startOfWeek:1,startOnTick:!1,tickColor:"#C0D0E0",tickLength:5,tickmarkPlacement:"between",tickPixelInterval:100,tickPosition:"outside",tickWidth:1,title:{align:"middle",style:{color:"#4d759e",fontWeight:"bold"}},type:"linear"},defaultYAxisOptions:{endOnTick:!0,gridLineWidth:1,tickPixelInterval:72,showLastLabel:!0,labels:{x:-8,y:3},lineWidth:0,maxPadding:.05,minPadding:.05,startOnTick:!0,tickWidth:0,title:{rotation:270,text:"Values"},stackLabels:{enabled:!1,formatter:function(){return Ut(this.total,-1)},style:wn.style}},defaultLeftAxisOptions:{labels:{x:-8,y:null},title:{rotation:270}},defaultRightAxisOptions:{labels:{x:8,y:null},title:{rotation:90}},defaultBottomAxisOptions:{labels:{x:0,y:14},title:{rotation:0}},defaultTopAxisOptions:{labels:{x:0,y:-5},title:{rotation:0}},init:function(t,n){var r=n.isX,i=this;i.horiz=t.inverted?!r:r,i.isXAxis=r,i.coll=r?"xAxis":"yAxis",i.opposite=n.opposite,i.side=n.side||(i.horiz?i.opposite?0:2:i.opposite?1:3),i.setOptions(n);var s=this.options,o=s.type,u=o==="datetime";i.labelFormatter=s.labels.formatter||i.defaultLabelFormatter,i.userOptions=n,i.minPixelPadding=0,i.chart=t,i.reversed=s.reversed,i.zoomEnabled=s.zoomEnabled!==!1,i.categories=s.categories||o==="category",i.names=[],i.isLog=o==="logarithmic",i.isDatetimeAxis=u,i.isLinked=Ht(s.linkedTo),i.tickmarkOffset=i.categories&&s.tickmarkPlacement==="between"?.5:0,i.ticks={},i.labelEdge=[],i.minorTicks={},i.plotLinesAndBands=[],i.alternateBands={},i.len=0,i.minRange=i.userMinRange=s.minRange||s.maxZoom,i.range=s.range,i.offset=s.offset||0,i.stacks={},i.oldStacks={},i.max=null,i.min=null,i.crosshair=Ft(s.crosshair,jt(t.options.tooltip.crosshairs)[r?0:1],!1);var a,f=i.options.events;fn(i,t.axes)===-1&&(r&&!this.isColorAxis?t.axes.splice(t.xAxis.length,0,i):t.axes.push(i),t[i.coll].push(i)),i.series=i.series||[],t.inverted&&r&&i.reversed===e&&(i.reversed=!0),i.removePlotBand=i.removePlotBandOrLine,i.removePlotLine=i.removePlotBandOrLine;for(a in f)dn(i,a,f[a]);i.isLog&&(i.val2lin=_t,i.lin2val=Dt)},setOptions:function(e){this.options=Nt(this.defaultOptions,this.isXAxis?{}:this.defaultYAxisOptions,[this.defaultTopAxisOptions,this.defaultRightAxisOptions,this.defaultBottomAxisOptions,this.defaultLeftAxisOptions][this.side],Nt(O[this.coll],e))},defaultLabelFormatter:function(){var t=this.axis,n=this.value,r=t.categories,i=this.dateTimeLabelFormat,s=O.lang.numericSymbols,o=s&&s.length,u,a,f=t.options.labels.format,l=t.isLog?n:t.tickInterval;if(f)a=Vt(f,this);else if(r)a=n;else if(i)a=M(i,n);else if(o&&l>=1e3)while(o--&&a===e)u=Math.pow(1e3,o+1),l>=u&&s[o]!==null&&(a=Ut(n/u,-1)+s[o]);return a===e&&(n>=1e4?a=Ut(n,0):a=Ut(n,-1,e,"")),a},getSeriesExtremes:function(){var e=this,t=e.chart;e.hasVisibleSeries=!1,e.dataMin=e.dataMax=null,e.buildStacks&&e.buildStacks(),ln(e.series,function(n){if(n.visible||!t.options.chart.ignoreHiddenSeries){var r=n.options,i,s=r.threshold,o,f;e.hasVisibleSeries=!0,e.isLog&&s<=0&&(s=null),e.isXAxis?(i=n.xData,i.length&&(e.dataMin=a(Ft(e.dataMin,i[0]),Gt(i)),e.dataMax=u(Ft(e.dataMax,i[0]),Yt(i)))):(n.getExtremes(),f=n.dataMax,o=n.dataMin,Ht(o)&&Ht(f)&&(e.dataMin=a(Ft(e.dataMin,o),o),e.dataMax=u(Ft(e.dataMax,f),f)),Ht(s)&&(e.dataMin>=s?(e.dataMin=s,e.ignoreMinPadding=!0):e.dataMax<s&&(e.dataMax=s,e.ignoreMaxPadding=!0)))}})},translate:function(e,t,n,r,i,s){var o=this,u=1,a=0,f=r?o.oldTransA:o.transA,l=r?o.oldMin:o.min,c,h=o.minPixelPadding,p=(o.options.ordinal||o.isLog&&i)&&o.lin2val;return f||(f=o.transA),n&&(u*=-1,a=o.len),o.reversed&&(u*=-1,a-=u*(o.sector||o.len)),t?(e=e*u+a,e-=h,c=e/f+l,p&&(c=o.lin2val(c))):(p&&(e=o.val2lin(e)),s==="between"&&(s=.5),c=u*(e-l)*f+a+u*h+(Mt(s)?f*s*o.pointRange:0)),c},toPixels:function(e,t){return this.translate(e,!1,!this.horiz,null,!0)+(t?0:this.pos)},toValue:function(e,t){return this.translate(e-(t?0:this.pos),!0,!this.horiz,null,!0)},getPlotLinePath:function(e,t,n,r,s){var o=this,u=o.chart,a=o.left,f=o.top,l,c,h,p,d=n&&u.oldChartHeight||u.chartHeight,v=n&&u.oldChartWidth||u.chartWidth,m,g=o.transB;s=Ft(s,o.translate(e,null,null,n)),l=h=i(s+g),c=p=i(d-s-g);if(isNaN(s))m=!0;else if(o.horiz){c=f,p=d-o.bottom;if(l<a||l>a+o.width)m=!0}else{l=a,h=v-o.right;if(c<f||c>f+o.height)m=!0}return m&&!r?null:u.renderer.crispLine([$,l,c,J,h,p],t||1)},getLinearTickPositions:function(e,t,n){var r,i,u=nn(s(t/e)*e),a=nn(o(n/e)*e),f=[];r=u;while(r<=a){f.push(r),r=nn(r+e);if(r===i)break;i=r}return f},getMinorTickPositions:function(){var e=this,t=e.options,n=e.tickPositions,r=e.minorTickInterval,i=[],s,o,u;if(e.isLog){u=n.length;for(o=1;o<u;o++)i=i.concat(e.getLogTickPositions(r,n[o-1],n[o],!0))}else if(e.isDatetimeAxis&&t.minorTickInterval==="auto")i=i.concat(e.getTimeTicks(e.normalizeTimeTickInterval(r),e.min,e.max,t.startOfWeek)),i[0]<e.min&&i.shift();else for(s=e.min+(n[0]-e.min)%r;s<=e.max;s+=r)i.push(s);return i},adjustForMinRange:function(){var t=this,n=t.options,r=t.min,i=t.max,s,o=t.dataMax-t.dataMin>=t.minRange,u,f,l,c,h,p,d;t.isXAxis&&t.minRange===e&&!t.isLog&&(Ht(n.min)||Ht(n.max)?t.minRange=null:(ln(t.series,function(t){c=t.xData,h=t.xIncrement?1:c.length-1;for(f=h;f>0;f--){l=c[f]-c[f-1];if(u===e||l<u)u=l}}),t.minRange=a(u*5,t.dataMax-t.dataMin)));if(i-r<t.minRange){var v=t.minRange;s=(v-i+r)/2,p=[r-s,Ft(n.min,r-s)],o&&(p[2]=t.dataMin),r=Yt(p),d=[r+v,Ft(n.max,r+v)],o&&(d[2]=t.dataMax),i=Gt(d),i-r<v&&(p[0]=i-v,p[1]=Ft(n.min,i-v),r=Yt(p))}t.min=r,t.max=i},setAxisTranslation:function(e){var t=this,n=t.max-t.min,r=t.axisPointRange||0,i,s=0,o=0,f=t.linkedParent,l,c=!!t.categories,h=t.transA;if(t.isXAxis||c||r)f?(s=f.minPointOffset,o=f.pointRangePadding):ln(t.series,function(e){var f=u(t.isXAxis?e.pointRange:t.axisPointRange||0,+c),l=e.options.pointPlacement,h=e.closestPointRange;f>n&&(f=0),r=u(r,f),s=u(s,Lt(l)?0:f/2),o=u(o,l==="on"?0:f),!e.noSharedTooltip&&Ht(h)&&(i=Ht(i)?a(i,h):h)}),l=t.ordinalSlope&&i?t.ordinalSlope/i:1,t.minPointOffset=s*=l,t.pointRangePadding=o*=l,t.pointRange=a(r,n),t.closestPointRange=i;e&&(t.oldTransA=h),t.translationSlope=t.transA=h=t.len/(n+o||1),t.transB=t.horiz?t.left:t.bottom,t.minPixelPadding=h*s},setTickPositions:function(e){var t=this,n=t.chart,r=t.options,i=t.isLog,s=t.isDatetimeAxis,o=t.isXAxis,l=t.isLinked,c=t.options.tickPositioner,h=r.maxPadding,p=r.minPadding,d,v,m=r.tickInterval,g=r.minTickInterval,y=r.tickPixelInterval,b,w,E=t.categories;l?(t.linkedParent=n[t.coll][r.linkedTo],v=t.linkedParent.getExtremes(),t.min=Ft(v.min,v.dataMin),t.max=Ft(v.max,v.dataMax),r.type!==t.linkedParent.options.type&&tn(11,1)):(t.min=Ft(t.userMin,r.min,t.dataMin),t.max=Ft(t.userMax,r.max,t.dataMax)),i&&(!e&&a(t.min,Ft(t.dataMin,t.min))<=0&&tn(10,1),t.min=nn(_t(t.min)),t.max=nn(_t(t.max))),t.range&&Ht(t.max)&&(t.userMin=t.min=u(t.min,t.max-t.range),t.userMax=t.max,t.range=null),t.beforePadding&&t.beforePadding(),t.adjustForMinRange(),!E&&!t.axisPointRange&&!t.usePercentage&&!l&&Ht(t.min)&&Ht(t.max)&&(d=t.max-t.min,d&&(!Ht(r.min)&&!Ht(t.userMin)&&p&&(t.dataMin<0||!t.ignoreMinPadding)&&(t.min-=d*p),!Ht(r.max)&&!Ht(t.userMax)&&h&&(t.dataMax>0||!t.ignoreMaxPadding)&&(t.max+=d*h))),t.min===t.max||t.min===undefined||t.max===undefined?t.tickInterval=1:l&&!m&&y===t.linkedParent.options.tickPixelInterval?t.tickInterval=t.linkedParent.tickInterval:(t.tickInterval=Ft(m,E?1:(t.max-t.min)*y/u(t.len,y)),!Ht(m)&&t.len<y&&!this.isRadial&&!this.isLog&&!E&&r.startOnTick&&r.endOnTick&&(w=!0,t.tickInterval/=4)),o&&!e&&ln(t.series,function(e){e.processData(t.min!==t.oldMin||t.max!==t.oldMax)}),t.setAxisTranslation(!0),t.beforeSetTickPositions&&t.beforeSetTickPositions(),t.postProcessTickInterval&&(t.tickInterval=t.postProcessTickInterval(t.tickInterval)),t.pointRange&&(t.tickInterval=u(t.pointRange,t.tickInterval)),!m&&t.tickInterval<g&&(t.tickInterval=g),!s&&!i&&(m||(t.tickInterval=Jt(t.tickInterval,null,$t(t.tickInterval),r))),t.minorTickInterval=r.minorTickInterval==="auto"&&t.tickInterval?t.tickInterval/5:r.minorTickInterval,t.tickPositions=b=r.tickPositions?[].concat(r.tickPositions):c&&c.apply(t,[t.min,t.max]),b||(!t.ordinalPositions&&(t.max-t.min)/t.tickInterval>u(2*t.len,200)&&tn(19,!0),s?b=t.getTimeTicks(t.normalizeTimeTickInterval(t.tickInterval,r.units),t.min,t.max,r.startOfWeek,t.ordinalPositions,t.closestPointRange,!0):i?b=t.getLogTickPositions(t.tickInterval,t.min,t.max):b=t.getLinearTickPositions(t.tickInterval,t.min,t.max),w&&b.splice(1,b.length-2),t.tickPositions=b);if(!l){var S=b[0],x=b[b.length-1],T=t.minPointOffset||0,N;r.startOnTick?t.min=S:t.min-T>S&&b.shift(),r.endOnTick?t.max=x:t.max+T<x&&b.pop(),b.length===1&&(N=f(t.max||1)*.001,t.min-=N,t.max+=N)}},setMaxTicks:function(){var e=this.chart,t=e.maxTicks||{},n=this.tickPositions,r=this._maxTicksKey=[this.coll,this.pos,this.len].join("-");!this.isLinked&&!this.isDatetimeAxis&&n&&n.length>(t[r]||0)&&this.options.alignTicks!==!1&&(t[r]=n.length),e.maxTicks=t},adjustTickAmount:function(){var t=this,n=t.chart,r=t._maxTicksKey,i=t.tickPositions,s=n.maxTicks;if(s&&s[r]&&!t.isDatetimeAxis&&!t.categories&&!t.isLinked&&t.options.alignTicks!==!1&&this.min!==e){var o=t.tickAmount,u=i.length,a;t.tickAmount=a=s[r];if(u<a){while(i.length<a)i.push(nn(i[i.length-1]+t.tickInterval));t.transA*=(u-1)/(a-1),t.max=i[i.length-1]}Ht(o)&&a!==o&&(t.isDirty=!0)}},setScale:function(){var e=this,t=e.stacks,n,r,i,s;e.oldMin=e.min,e.oldMax=e.max,e.oldAxisLength=e.len,e.setAxisSize(),s=e.len!==e.oldAxisLength,ln(e.series,function(e){if(e.isDirtyData||e.isDirty||e.xAxis.isDirty)i=!0});if(s||i||e.isLinked||e.forceRedraw||e.userMin!==e.oldUserMin||e.userMax!==e.oldUserMax){if(!e.isXAxis)for(n in t)for(r in t[n])t[n][r].total=null,t[n][r].cum=0;e.forceRedraw=!1,e.getSeriesExtremes(),e.setTickPositions(),e.oldUserMin=e.userMin,e.oldUserMax=e.userMax,e.isDirty||(e.isDirty=s||e.min!==e.oldMin||e.max!==e.oldMax)}else if(!e.isXAxis){e.oldStacks&&(t=e.stacks=e.oldStacks);for(n in t)for(r in t[n])t[n][r].cum=t[n][r].total}e.setMaxTicks()},setExtremes:function(e,t,n,r,i){var s=this,o=s.chart;n=Ft(n,!0),i=Tt(i,{min:e,max:t}),mn(s,"setExtremes",i,function(){s.userMin=e,s.userMax=t,s.eventArgs=i,s.isDirtyExtremes=!0,n&&o.redraw(r)})},zoom:function(t,n){var r=this.dataMin,i=this.dataMax,s=this.options;return this.allowZoomOutside||(Ht(r)&&t<=a(r,Ft(s.min,r))&&(t=e),Ht(i)&&n>=u(i,Ft(s.max,i))&&(n=e)),this.displayBtn=t!==e||n!==e,this.setExtremes(t,n,!1,e,{trigger:"zoom"}),!0},setAxisSize:function(){var e=this.chart,t=this.options,n=t.offsetLeft||0,r=t.offsetRight||0,i=this.horiz,s,o,a,f;this.left=f=Ft(t.left,e.plotLeft+n),this.top=a=Ft(t.top,e.plotTop),this.width=s=Ft(t.width,e.plotWidth-n+r),this.height=o=Ft(t.height,e.plotHeight),this.bottom=e.chartHeight-o-a,this.right=e.chartWidth-s-f,this.len=u(i?s:o,0),this.pos=i?f:a},getExtremes:function(){var e=this,t=e.isLog;return{min:t?nn(Dt(e.min)):e.min,max:t?nn(Dt(e.max)):e.max,dataMin:e.dataMin,dataMax:e.dataMax,userMin:e.userMin,userMax:e.userMax}},getThreshold:function(e){var t=this,n=t.isLog,r=n?Dt(t.min):t.min,i=n?Dt(t.max):t.max;return r>e||e===null?e=r:i<e&&(e=i),t.translate(e,0,1,0,1)},autoLabelAlign:function(e){var t,n=(Ft(e,0)-this.side*90+720)%360;return n>15&&n<165?t="right":n>195&&n<345?t="left":t="center",t},getOffset:function(){var t=this,n=t.chart,r=n.renderer,i=t.options,o=t.tickPositions,a=t.ticks,f=t.horiz,l=t.side,c=n.inverted?[1,0,3,2][l]:l,h,p,d=0,v,m=0,g=i.title,y=i.labels,b=0,w=n.axisOffset,E=n.clipOffset,S=[-1,1,1,-1][l],x,T,N=1,C=Ft(y.maxStaggerLines,5),k,L,A,O,M,_,D,P;t.hasData=h=t.hasVisibleSeries||Ht(t.min)&&Ht(t.max)&&!!o,t.showAxis=p=h||Ft(i.showEmpty,!0),t.staggerLines=t.horiz&&y.staggerLines,t.axisGroup||(t.gridGroup=r.g("grid").attr({zIndex:i.gridZIndex||1}).add(),t.axisGroup=r.g("axis").attr({zIndex:i.zIndex||2}).add(),t.labelGroup=r.g("axis-labels").attr({zIndex:y.zIndex||7}).addClass(z+t.coll.toLowerCase()+"-labels").add());if(h||t.isLinked){t.labelAlign=Ft(y.align||t.autoLabelAlign(y.rotation)),ln(o,function(e){a[e]?a[e].addLabel():a[e]=new jn(t,e)});if(t.horiz&&!t.staggerLines&&C&&!y.rotation){k=t.reversed?[].concat(o).reverse():o;while(N<C){L=[],A=!1;for(T=0;T<k.length;T++)O=k[T],M=a[O].label&&a[O].label.getBBox(),D=M?M.width:0,P=T%N,D&&(_=t.translate(O),L[P]!==e&&_<L[P]&&(A=!0),L[P]=_+D);if(!A)break;N++}N>1&&(t.staggerLines=N)}ln(o,function(e){if(l===0||l===2||{1:"left",3:"right"}[l]===t.labelAlign)b=u(a[e].getLabelSize(),b)}),t.staggerLines&&(b*=t.staggerLines,t.labelOffset=b)}else for(x in a)a[x].destroy(),delete a[x];g&&g.text&&g.enabled!==!1&&(t.axisTitle||(t.axisTitle=r.text(g.text,0,0,g.useHTML).attr({zIndex:7,rotation:g.rotation||0,align:g.textAlign||{low:"left",middle:"center",high:"right"}[g.align]}).addClass(z+this.coll.toLowerCase()+"-title").css(g.style).add(t.axisGroup),t.axisTitle.isNew=!0),p&&(d=t.axisTitle.getBBox()[f?"height":"width"],m=Ft(g.margin,f?5:10),v=g.offset),t.axisTitle[p?"show":"hide"]()),t.offset=S*Ft(i.offset,w[l]),t.axisTitleMargin=Ft(v,b+m+(l!==2&&b&&S*i.labels[f?"y":"x"])),w[l]=u(w[l],t.axisTitleMargin+d+S*t.offset),E[c]=u(E[c],s(i.lineWidth/2)*2)},getLinePath:function(e){var t=this.chart,n=this.opposite,r=this.offset,i=this.horiz,s=this.left+(n?this.width:0)+r,o=t.chartHeight-this.bottom-(n?this.height:0)+r;return n&&(e*=-1),t.renderer.crispLine([$,i?this.left:s,i?o:this.top,J,i?t.chartWidth-this.right:s,i?o:t.chartHeight-this.bottom],e)},getTitlePosition:function(){var e=this.horiz,t=this.left,n=this.top,r=this.len,i=this.options.title,s=e?t:n,o=this.opposite,u=this.offset,a=kt(i.style.fontSize||12),f={low:s+(e?0:r),middle:s+r/2,high:s+(e?r:0)}[i.align],l=(e?n+this.height:t)+(e?1:-1)*(o?-1:1)*this.axisTitleMargin+(this.side===2?a:0);return{x:e?f:l+(o?this.width:0)+u+(i.x||0),y:e?l-(o?this.height:0)+u:f+(i.y||0)}},render:function(){var t=this,n=t.horiz,r=t.reversed,i=t.chart,s=i.renderer,o=t.options,u=t.isLog,a=t.isLinked,f=t.tickPositions,l,c=t.axisTitle,h=t.ticks,p=t.minorTicks,d=t.alternateBands,v=o.stackLabels,m=o.alternateGridColor,g=t.tickmarkOffset,y=o.lineWidth,b,w=i.hasRendered,E=w&&Ht(t.oldMin)&&!isNaN(t.oldMin),S=t.hasData,x=t.showAxis,T,N=o.labels.overflow,C=t.justifyLabels=n&&N!==!1,k;t.labelEdge.length=0,t.justifyToPlot=N==="justify",ln([h,p,d],function(e){var t;for(t in e)e[t].isActive=!1});if(S||a)t.minorTickInterval&&!t.categories&&ln(t.getMinorTickPositions(),function(e){p[e]||(p[e]=new jn(t,e,"minor")),E&&p[e].isNew&&p[e].render(null,!0),p[e].render(null,!1,1)}),f.length&&(l=f.slice(),(n&&r||!n&&!r)&&l.reverse(),C&&(l=l.slice(1).concat([l[0]])),ln(l,function(e,n){C&&(n=n===l.length-1?0:n+1);if(!a||e>=t.min&&e<=t.max)h[e]||(h[e]=new jn(t,e)),E&&h[e].isNew&&h[e].render(n,!0,.1),h[e].render(n,!1,1)}),g&&t.min===0&&(h[-1]||(h[-1]=new jn(t,-1,null,!0)),h[-1].render(-1))),m&&ln(f,function(n,r){r%2===0&&n<t.max&&(d[n]||(d[n]=new xt.PlotLineOrBand(t)),T=n+g,k=f[r+1]!==e?f[r+1]+g:t.max,d[n].options={from:u?Dt(T):T,to:u?Dt(k):k,color:m},d[n].render(),d[n].isActive=!0)}),t._addedPlotLB||(ln((o.plotLines||[]).concat(o.plotBands||[]),function(e){t.addPlotBandOrLine(e)}),t._addedPlotLB=!0);ln([h,p,d],function(e){var t,n,r=[],s=_?_.duration||500:0,o=function(){n=r.length;while(n--)e[r[n]]&&!e[r[n]].isActive&&(e[r[n]].destroy(),delete e[r[n]])};for(t in e)e[t].isActive||(e[t].render(t,!1,0),e[t].isActive=!1,r.push(t));e===d||!i.hasRendered||!s?o():s&&setTimeout(o,s)}),y&&(b=t.getLinePath(y),t.axisLine?t.axisLine.animate({d:b}):t.axisLine=s.path(b).attr({stroke:o.lineColor,"stroke-width":y,zIndex:7}).add(t.axisGroup),t.axisLine[x?"show":"hide"]()),c&&x&&(c[c.isNew?"attr":"animate"](t.getTitlePosition()),c.isNew=!1),v&&v.enabled&&t.renderStackTotals(),t.isDirty=!1},redraw:function(){var e=this,t=e.chart,n=t.pointer;n&&n.reset(!0),e.render(),ln(e.plotLinesAndBands,function(e){e.render()}),ln(e.series,function(e){e.isDirty=!0})},destroy:function(e){var t=this,n=t.stacks,r,i=t.plotLinesAndBands,s;e||vn(t);for(r in n)Zt(n[r]),n[r]=null;ln([t.ticks,t.minorTicks,t.alternateBands],function(e){Zt(e)}),s=i.length;while(s--)i[s].destroy();ln(["stackTotalGroup","axisLine","axisTitle","axisGroup","cross","gridGroup","labelGroup"],function(e){t[e]&&(t[e]=t[e].destroy())}),this.cross&&this.cross.destroy()},drawCrosshair:function(e,t){if(!this.crosshair)return;if((Ht(t)||!Ft(this.crosshair.snap,!0))===!1){this.hideCrosshair();return}var n,r=this.crosshair,i=r.animation,s;Ft(r.snap,!0)?Ht(t)&&(s=this.chart.inverted!=this.horiz?t.plotX:this.len-t.plotY):s=this.horiz?e.chartX-this.pos:this.len-e.chartY+this.pos,this.isRadial?n=this.getPlotLinePath(this.isXAxis?t.x:Ft(t.stackY,t.y)):n=this.getPlotLinePath(null,null,null,null,s);if(n===null){this.hideCrosshair();return}if(this.cross)this.cross.attr({visibility:W})[i?"animate":"attr"]({d:n},i);else{var o={"stroke-width":r.width||1,stroke:r.color||"#C0C0C0",zIndex:r.zIndex||2};r.dashStyle&&(o.dashstyle=r.dashStyle),this.cross=this.chart.renderer.path(n).attr(o).add()}},hideCrosshair:function(){this.cross&&this.cross.hide()}},Tt(Fn.prototype,ut),Fn.prototype.getTimeTicks=function(e,t,n,r){var i=[],o,u={},a=O.global.useUTC,f,l=new Date(t-lt),c=e.unitRange,h=e.count;if(Ht(t)){c>=P[et]&&(l.setMilliseconds(0),l.setSeconds(c>=P[tt]?0:h*s(l.getSeconds()/h))),c>=P[tt]&&l[gt](c>=P[nt]?0:h*s(l[ct]()/h)),c>=P[nt]&&l[yt](c>=P[rt]?0:h*s(l[ht]()/h)),c>=P[rt]&&l[bt](c>=P[st]?1:h*s(l[dt]()/h)),c>=P[st]&&(l[wt](c>=P[ot]?0:h*s(l[vt]()/h)),f=l[mt]()),c>=P[ot]&&(f-=f%h,l[Et](f)),c===P[it]&&l[bt](l[dt]()-l[pt]()+Ft(r,1)),o=1,lt&&(l=new Date(l.getTime()+lt)),f=l[mt]();var p=l.getTime(),d=l[vt](),v=l[dt](),m=a?lt:(864e5+l.getTimezoneOffset()*60*1e3)%864e5;while(p<n)i.push(p),c===P[ot]?p=ft(f+o*h,0):c===P[st]?p=ft(f,d+o*h):!!a||c!==P[rt]&&c!==P[it]?p+=c*h:p=ft(f,d,v+o*h*(c===P[rt]?1:7)),o++;i.push(p),ln(cn(i,function(e){return c<=P[nt]&&e%P[rt]===m}),function(e){u[e]=rt})}return i.info=Tt(e,{higherRanks:u,totalRange:c*h}),i},Fn.prototype.normalizeTimeTickInterval=function(e,t){var n=t||[[Z,[1,2,5,10,20,25,50,100,200,500]],[et,[1,2,5,10,15,30]],[tt,[1,2,5,10,15,30]],[nt,[1,2,3,4,6,8,12]],[rt,[1,2]],[it,[1,2]],[st,[1,2,3,4,6]],[ot,null]],r=n[n.length-1],i=P[r[0]],s=r[1],o,a;for(a=0;a<n.length;a++){r=n[a],i=P[r[0]],s=r[1];if(n[a+1]){var f=(i*s[s.length-1]+P[n[a+1][0]])/2;if(e<=f)break}}return i===P[ot]&&e<5*i&&(s=[1,2,5]),o=Jt(e/i,s,r[0]===ot?u($t(e/i),1):1),{unitRange:i,count:o,unitName:r[0]}},Fn.prototype.getLogTickPositions=function(e,t,n,r){var o=this,u=o.options,a=o.len,f=[];r||(o._minorAutoInterval=null);if(e>=.5)e=i(e),f=o.getLinearTickPositions(e,t,n);else if(e>=.08){var l=s(t),c,h,p,d,v,m,g;e>.3?c=[1,2,4]:e>.15?c=[1,2,4,6,8]:c=[1,2,3,4,5,6,7,8,9];for(h=l;h<n+1&&!g;h++){d=c.length;for(p=0;p<d&&!g;p++)v=_t(Dt(h)*c[p]),v>t&&(!r||m<=n)&&f.push(m),m>n&&(g=!0),m=v}}else{var y=Dt(t),b=Dt(n),w=u[r?"minorTickInterval":"tickInterval"],E=w==="auto"?null:w,S=u.tickPixelInterval/(r?5:1),x=r?a/o.tickPositions.length:a;e=Ft(E,o._minorAutoInterval,(b-y)*S/(x||1)),e=Jt(e,null,$t(e)),f=pn(o.getLinearTickPositions(e,y,b),_t),r||(o._minorAutoInterval=e/5)}return r||(o.tickInterval=e),f};var In=xt.Tooltip=function(){this.init.apply(this,arguments)};In.prototype={init:function(e,t){var n=t.borderWidth,r=t.style,i=kt(r.padding);this.chart=e,this.options=t,this.crosshairs=[],this.now={x:0,y:0},this.isHidden=!0,this.label=e.renderer.label("",0,0,t.shape,null,null,t.useHTML,null,"tooltip").attr({padding:i,fill:t.backgroundColor,"stroke-width":n,r:t.borderRadius,zIndex:8}).css(r).css({padding:0}).add().attr({y:-9999}),T||this.label.shadow(t.shadow),this.shared=t.shared},destroy:function(){this.label&&(this.label=this.label.destroy()),clearTimeout(this.hideTimer),clearTimeout(this.tooltipTimeout)},move:function(e,t,n,r){var i=this,s=i.now,o=i.options.animation!==!1&&!i.isHidden;Tt(s,{x:o?(2*s.x+e)/3:e,y:o?(s.y+t)/2:t,anchorX:o?(2*s.anchorX+n)/3:n,anchorY:o?(s.anchorY+r)/2:r}),i.label.attr(s),o&&(f(e-s.x)>1||f(t-s.y)>1)&&(clearTimeout(this.tooltipTimeout),this.tooltipTimeout=setTimeout(function(){i&&i.move(e,t,n,r)},32))},hide:function(){var e=this,t;clearTimeout(this.hideTimer),this.isHidden||(t=this.chart.hoverPoints,this.hideTimer=setTimeout(function(){e.label.fadeOut(),e.isHidden=!0},Ft(this.options.hideDelay,500)),t&&ln(t,function(e){e.setState()}),this.chart.hoverPoints=null)},getAnchor:function(t,n){var r,s=this.chart,o=s.inverted,u=s.plotTop,a=0,f=0,l;return t=jt(t),r=t[0].tooltipPos,this.followPointer&&n&&(n.chartX===e&&(n=s.pointer.normalize(n)),r=[n.chartX-s.plotLeft,n.chartY-u]),r||(ln(t,function(e){l=e.series.yAxis,a+=e.plotX,f+=(e.plotLow?(e.plotLow+e.plotHigh)/2:e.plotY)+(!o&&l?l.top-u:0)}),a/=t.length,f/=t.length,r=[o?s.plotWidth-f:a,this.shared&&!o&&t.length>1&&n?n.chartY-u:o?s.plotHeight-a:f]),pn(r,i)},getPosition:function(e,t,n){var r=this.chart,i=r.plotLeft,s=r.plotTop,o=r.plotWidth,a=r.plotHeight,f=Ft(this.options.distance,12),l=isNaN(n.plotX)?0:n.plotX,c=n.plotY,h=l+i+(r.inverted?f:-e-f),p=c-t+s+15,d;return h<7&&(h=i+u(l,0)+f),h+e>i+o&&(h-=h+e-(i+o),p=c-t+s-f,d=!0),p<s+5&&(p=s+5,d&&c>=p&&c<=p+t&&(p=c+s+f)),p+t>s+a&&(p=u(s,s+a-t-f)),{x:h,y:p}},defaultFormatter:function(e){var t=this.points||jt(this),n=t[0].series,r;return r=[e.tooltipHeaderFormatter(t[0])],ln(t,function(e){n=e.series,r.push(n.tooltipFormatter&&n.tooltipFormatter(e)||e.point.tooltipFormatter(n.tooltipOptions.pointFormat))}),r.push(e.options.footerFormat||""),r.join("")},refresh:function(e,t){var n=this,r=n.chart,i=n.label,s=n.options,o,u,a,f={},l,c=[],h=s.formatter||n.defaultFormatter,p=r.hoverPoints,d,v=n.shared,m;clearTimeout(this.hideTimer),n.followPointer=jt(e)[0].series.tooltipOptions.followPointer,a=n.getAnchor(e,t),o=a[0],u=a[1],v&&(!e.series||!e.series.noSharedTooltip)?(r.hoverPoints=e,p&&ln(p,function(e){e.setState()}),ln(e,function(e){e.setState(G),c.push(e.getLabelConfig())}),f={x:e[0].category,y:e[0].y},f.points=c,e=e[0]):f=e.getLabelConfig(),l=h.call(f,n),m=e.series,l===!1?this.hide():(n.isHidden&&(bn(i),i.attr("opacity",1).show()),i.attr({text:l}),d=s.borderColor||e.color||m.color||"#606060",i.attr({stroke:d}),n.updatePosition({plotX:o,plotY:u}),this.isHidden=!1),mn(r,"tooltipRefresh",{text:l,x:o+r.plotLeft,y:u+r.plotTop,borderColor:d})},updatePosition:function(e){var t=this.chart,n=this.label,r=(this.options.positioner||this.getPosition).call(this,n.width,n.height,e);this.move(i(r.x),i(r.y),e.plotX+t.plotLeft,e.plotY+t.plotTop)},tooltipHeaderFormatter:function(e){var t=e.series,n=t.tooltipOptions,r=n.dateTimeLabelFormats,i=n.xDateFormat,s=t.xAxis,o=s&&s.options.type==="datetime"&&Mt(e.key),u=n.headerFormat,a=s&&s.closestPointRange,f;if(o&&!i){if(a){for(f in P)if(P[f]>=a||P[f]<=P[rt]&&e.key%P[f]>0){i=r[f];break}}else i=r.day;i=i||r.year}return o&&i&&(u=u.replace("{point.key}","{point.key:"+i+"}")),Vt(u,{point:e,series:t})}};var qn;C=t.documentElement.ontouchstart!==e;var Rn=xt.Pointer=function(e,t){this.init(e,t)};Rn.prototype={init:function(e,t){var n=t.chart,r=n.events,i=T?"":n.zoomType,s=e.inverted,o,u;this.options=t,this.chart=e,this.zoomX=o=/x/.test(i),this.zoomY=u=/y/.test(i),this.zoomHor=o&&!s||u&&s,this.zoomVert=u&&!s||o&&s,this.runChartClick=r&&!!r.click,this.pinchDown=[],this.lastValidTouch={},xt.Tooltip&&t.tooltip.enabled&&(e.tooltip=new In(e,t.tooltip)),this.setDOMEvents()},normalize:function(t,r){var s,o,a;return t=t||n.event,t=gn(t),t.target||(t.target=t.srcElement),a=t.touches?t.touches.item(0):t,r||(this.chartPosition=r=hn(this.chart.container)),a.pageX===e?(s=u(t.x,t.clientX-r.left),o=t.y):(s=a.pageX-r.left,o=a.pageY-r.top),Tt(t,{chartX:i(s),chartY:i(o)})},getCoordinates:function(e){var t={xAxis:[],yAxis:[]};return ln(this.chart.axes,function(n){t[n.isXAxis?"xAxis":"yAxis"].push({axis:n,value:n.toValue(e[n.horiz?"chartX":"chartY"])})}),t},getIndex:function(e){var t=this.chart;return t.inverted?t.plotHeight+t.plotTop-e.chartY:e.chartX-t.plotLeft},runPointActions:function(e){var n=this,r=n.chart,i=r.series,s=r.tooltip,o,u,l=r.hoverPoint,c=r.hoverSeries,h,p,d=r.chartWidth,v=n.getIndex(e),m;if(s&&n.options.tooltip.shared&&(!c||!c.noSharedTooltip)){u=[],h=i.length;for(p=0;p<h;p++)i[p].visible&&i[p].options.enableMouseTracking!==!1&&!i[p].noSharedTooltip&&i[p].singularTooltips!==!0&&i[p].tooltipPoints.length&&(o=i[p].tooltipPoints[v],o&&o.series&&(o._dist=f(v-o.clientX),d=a(d,o._dist),u.push(o)));h=u.length;while(h--)u[h]._dist>d&&u.splice(h,1);u.length&&u[0].clientX!==n.hoverX&&(s.refresh(u,e),n.hoverX=u[0].clientX)}c&&c.tracker&&(!s||!s.followPointer)?(o=c.tooltipPoints[v],o&&o!==l&&o.onMouseOver(e)):s&&s.followPointer&&!s.isHidden&&(m=s.getAnchor([{}],e),s.updatePosition({plotX:m[0],plotY:m[1]})),s&&!n._onDocumentMouseMove&&(n._onDocumentMouseMove=function(e){Ht(qn)&&B[qn].pointer.onDocumentMouseMove(e)},dn(t,"mousemove",n._onDocumentMouseMove)),ln(r.axes,function(t){t.drawCrosshair(e,Ft(o,l))})},reset:function(n){var r=this,i=r.chart,s=i.hoverSeries,o=i.hoverPoint,u=i.tooltip,a=u&&u.shared?i.hoverPoints:o;n=n&&u&&a,n&&jt(a)[0].plotX===e&&(n=!1),n?(u.refresh(a),o&&o.setState(o.state,!0)):(o&&o.onMouseOut(),s&&s.onMouseOut(),u&&u.hide(),r._onDocumentMouseMove&&(vn(t,"mousemove",r._onDocumentMouseMove),r._onDocumentMouseMove=null),ln(i.axes,function(e){e.hideCrosshair()}),r.hoverX=null)},scaleGroups:function(e,t){var n=this.chart,r;ln(n.series,function(i){r=e||i.getPlotBox(),i.xAxis&&i.xAxis.zoomEnabled&&(i.group.attr(r),i.markerGroup&&(i.markerGroup.attr(r),i.markerGroup.clip(t?n.clipRect:null)),i.dataLabelsGroup&&i.dataLabelsGroup.attr(r))}),n.clipRect.attr(t||n.clipBox)},dragStart:function(e){var t=this.chart;t.mouseIsDown=e.type,t.cancelClick=!1,t.mouseDownX=this.mouseDownX=e.chartX,t.mouseDownY=this.mouseDownY=e.chartY},drag:function(e){var t=this.chart,n=t.options.chart,r=e.chartX,i=e.chartY,s=this.zoomHor,o=this.zoomVert,u=t.plotLeft,a=t.plotTop,l=t.plotWidth,c=t.plotHeight,h,p,d=this.mouseDownX,v=this.mouseDownY;r<u?r=u:r>u+l&&(r=u+l),i<a?i=a:i>a+c&&(i=a+c),this.hasDragged=Math.sqrt(Math.pow(d-r,2)+Math.pow(v-i,2)),this.hasDragged>10&&(h=t.isInsidePlot(d-u,v-a),t.hasCartesianSeries&&(this.zoomX||this.zoomY)&&h&&(this.selectionMarker||(this.selectionMarker=t.renderer.rect(u,a,s?1:l,o?1:c,0).attr({fill:n.selectionMarkerFill||"rgba(69,114,167,0.25)",zIndex:7}).add())),this.selectionMarker&&s&&(p=r-d,this.selectionMarker.attr({width:f(p),x:(p>0?0:p)+d})),this.selectionMarker&&o&&(p=i-v,this.selectionMarker.attr({height:f(p),y:(p>0?0:p)+v})),h&&!this.selectionMarker&&n.panning&&t.pan(e,n.panning))},drop:function(e){var t=this.chart,n=this.hasPinched;if(this.selectionMarker){var r={xAxis:[],yAxis:[],originalEvent:e.originalEvent||e},i=this.selectionMarker,s=i.x,o=i.y,f;if(this.hasDragged||n)ln(t.axes,function(e){if(e.zoomEnabled){var t=e.horiz,n=e.toValue(t?s:o),l=e.toValue(t?s+i.width:o+i.height);!isNaN(n)&&!isNaN(l)&&(r[e.coll].push({axis:e,min:a(n,l),max:u(n,l)}),f=!0)}}),f&&mn(t,"selection",r,function(e){t.zoom(Tt(e,n?{animation:!1}:null))});this.selectionMarker=this.selectionMarker.destroy(),n&&this.scaleGroups()}t&&(It(t.container,{cursor:t._cursor}),t.cancelClick=this.hasDragged>10,t.mouseIsDown=this.hasDragged=this.hasPinched=!1,this.pinchDown=[])},onContainerMouseDown:function(e){e=this.normalize(e),e.preventDefault&&e.preventDefault(),this.dragStart(e)},onDocumentMouseUp:function(e){Ht(qn)&&B[qn].pointer.drop(e)},onDocumentMouseMove:function(e){var t=this.chart,n=this.chartPosition,r=t.hoverSeries;e=this.normalize(e,n),n&&r&&!this.inClass(e.target,"highcharts-tracker")&&!t.isInsidePlot(e.chartX-t.plotLeft,e.chartY-t.plotTop)&&this.reset()},onContainerMouseLeave:function(){var e=B[qn];e&&(e.pointer.reset(),e.pointer.chartPosition=null),qn=null},onContainerMouseMove:function(e){var t=this.chart;qn=t.index,e=this.normalize(e),t.mouseIsDown==="mousedown"&&this.drag(e),(this.inClass(e.target,"highcharts-tracker")||t.isInsidePlot(e.chartX-t.plotLeft,e.chartY-t.plotTop))&&!t.openMenu&&this.runPointActions(e)},inClass:function(e,t){var n;while(e){n=Bt(e,"class");if(n){if(n.indexOf(t)!==-1)return!0;if(n.indexOf(z+"container")!==-1)return!1}e=e.parentNode}},onTrackerMouseOut:function(e){var t=this.chart.hoverSeries,n=e.relatedTarget||e.toElement,r=n&&n.point&&n.point.series;t&&!t.options.stickyTracking&&!this.inClass(n,z+"tooltip")&&r!==t&&t.onMouseOut()},onContainerClick:function(e){var t=this.chart,n=t.hoverPoint,r=t.plotLeft,i=t.plotTop,s=t.inverted,o,u,a;e=this.normalize(e),e.cancelBubble=!0,t.cancelClick||(n&&this.inClass(e.target,z+"tracker")?(o=this.chartPosition,u=n.plotX,a=n.plotY,Tt(n,{pageX:o.left+r+(s?t.plotWidth-a:u),pageY:o.top+i+(s?t.plotHeight-u:a)}),mn(n.series,"click",Tt(e,{point:n})),t.hoverPoint&&n.firePointEvent("click",e)):(Tt(e,this.getCoordinates(e)),t.isInsidePlot(e.chartX-r,e.chartY-i)&&mn(t,"click",e)))},setDOMEvents:function(){var e=this,n=e.chart.container;n.onmousedown=function(t){e.onContainerMouseDown(t)},n.onmousemove=function(t){e.onContainerMouseMove(t)},n.onclick=function(t){e.onContainerClick(t)},dn(n,"mouseleave",e.onContainerMouseLeave),dn(t,"mouseup",e.onDocumentMouseUp),C&&(n.ontouchstart=function(t){e.onContainerTouchStart(t)},n.ontouchmove=function(t){e.onContainerTouchMove(t)},dn(t,"touchend",e.onDocumentTouchEnd))},destroy:function(){var e;vn(this.chart.container,"mouseleave",this.onContainerMouseLeave),vn(t,"mouseup",this.onDocumentMouseUp),vn(t,"touchend",this.onDocumentTouchEnd),clearInterval(this.tooltipTimeout);for(e in this)this[e]=null}},Tt(xt.Pointer.prototype,{pinchTranslate:function(e,t,n,r,i,s,o,u){e&&this.pinchTranslateDirection(!0,n,r,i,s,o,u),t&&this.pinchTranslateDirection(!1,n,r,i,s,o,u)},pinchTranslateDirection:function(e,t,n,r,i,s,o,u){var a=this.chart,l=e?"x":"y",c=e?"X":"Y",h="chart"+c,p=e?"width":"height",d=a["plot"+(e?"Left":"Top")],v,m,g,y=u||1,b=a.inverted,w=a.bounds[e?"h":"v"],E=t.length===1,S=t[0][h],x=n[0][h],T=!E&&t[1][h],N=!E&&n[1][h],C,k,L,A=function(){!E&&f(S-T)>20&&(y=u||f(x-N)/f(S-T)),g=(d-x)/y+S,v=a["plot"+(e?"Width":"Height")]/y};A(),m=g,m<w.min?(m=w.min,C=!0):m+v>w.max&&(m=w.max-v,C=!0),C?(x-=.8*(x-o[l][0]),E||(N-=.8*(N-o[l][1])),A()):o[l]=[x,N],b||(s[l]=g-d,s[p]=v),L=b?e?"scaleY":"scaleX":"scale"+c,k=b?1/y:y,i[p]=v,i[l]=m,r[L]=y,r["translate"+c]=k*d+(x-k*S)},pinch:function(e){var t=this,n=t.chart,r=t.pinchDown,i=n.tooltip&&n.tooltip.options.followTouchMove,s=e.touches,o=s.length,f=t.lastValidTouch,l=t.zoomHor||t.pinchHor,c=t.zoomVert||t.pinchVert,h=l||c,p=t.selectionMarker,d={},v=o===1&&(t.inClass(e.target,z+"tracker")&&n.runTrackerClick||n.runChartClick),m={};(h||i)&&!v&&e.preventDefault(),pn(s,function(e){return t.normalize(e)}),e.type==="touchstart"?(ln(s,function(e,t){r[t]={chartX:e.chartX,chartY:e.chartY}}),f.x=[r[0].chartX,r[1]&&r[1].chartX],f.y=[r[0].chartY,r[1]&&r[1].chartY],ln(n.axes,function(e){if(e.zoomEnabled){var t=n.bounds[e.horiz?"h":"v"],r=e.minPixelPadding,i=e.toPixels(e.dataMin),s=e.toPixels(e.dataMax),o=a(i,s),f=u(i,s);t.min=a(e.pos,o-r),t.max=u(e.pos+e.len,f+r)}})):r.length&&(p||(t.selectionMarker=p=Tt({destroy:H},n.plotBox)),t.pinchTranslate(l,c,r,s,d,p,m,f),t.hasPinched=h,t.scaleGroups(d,m),!h&&i&&o===1&&this.runPointActions(t.normalize(e)))},onContainerTouchStart:function(e){var t=this.chart;qn=t.index,e.touches.length===1?(e=this.normalize(e),t.isInsidePlot(e.chartX-t.plotLeft,e.chartY-t.plotTop)?(this.runPointActions(e),this.pinch(e)):this.reset()):e.touches.length===2&&this.pinch(e)},onContainerTouchMove:function(e){(e.touches.length===1||e.touches.length===2)&&this.pinch(e)},onDocumentTouchEnd:function(e){Ht(qn)&&B[qn].pointer.drop(e)}});if(n.PointerEvent||n.MSPointerEvent){var Un={},zn=!!n.PointerEvent,Wn=function(){var e,t=[];t.item=function(e){return this[e]};for(e in Un)Un.hasOwnProperty(e)&&t.push({pageX:Un[e].pageX,pageY:Un[e].pageY,target:Un[e].target});return t},Xn=function(e,t,n,r){var i;e=e.originalEvent||e,(e.pointerType==="touch"||e.pointerType===e.MSPOINTER_TYPE_TOUCH)&&B[qn]&&(r(e),i=B[qn].pointer,i[t]({type:n,target:e.currentTarget,preventDefault:H,touches:Wn()}))};Tt(Rn.prototype,{onContainerPointerDown:function(e){Xn(e,"onContainerTouchStart","touchstart",function(e){Un[e.pointerId]={pageX:e.pageX,pageY:e.pageY,target:e.currentTarget}})},onContainerPointerMove:function(e){Xn(e,"onContainerTouchMove","touchmove",function(e){Un[e.pointerId]={pageX:e.pageX,pageY:e.pageY},Un[e.pointerId].target||(Un[e.pointerId].target=e.currentTarget)})},onDocumentPointerUp:function(e){Xn(e,"onContainerTouchEnd","touchend",function(e){delete Un[e.pointerId]})},batchMSEvents:function(e){e(this.chart.container,zn?"pointerdown":"MSPointerDown",this.onContainerPointerDown),e(this.chart.container,zn?"pointermove":"MSPointerMove",this.onContainerPointerMove),e(t,zn?"pointerup":"MSPointerUp",this.onDocumentPointerUp)}}),Wt(Rn.prototype,"init",function(e,t,n){It(t.container,{"-ms-touch-action":V,"touch-action":V}),e.call(this,t,n)}),Wt(Rn.prototype,"setDOMEvents",function(e){e.apply(this),this.batchMSEvents(dn)}),Wt(Rn.prototype,"destroy",function(e){this.batchMSEvents(vn),e.call(this)})}var Vn=xt.Legend=function(e,t){this.init(e,t)};Vn.prototype={init:function(e,t){var n=this,r=t.itemStyle,i=Ft(t.padding,8),s=t.itemMarginTop||0;this.options=t;if(!t.enabled)return;n.baseline=kt(r.fontSize)+3+s,n.itemStyle=r,n.itemHiddenStyle=Nt(r,t.itemHiddenStyle),n.itemMarginTop=s,n.padding=i,n.initialItemX=i,n.initialItemY=i-5,n.maxItemWidth=0,n.chart=e,n.itemHeight=0,n.lastLineHeight=0,n.symbolWidth=Ft(t.symbolWidth,16),n.pages=[],n.render(),dn(n.chart,"endResize",function(){n.positionCheckboxes()})},colorizeItem:function(t,n){var r=this,i=r.options,s=t.legendItem,o=t.legendLine,u=t.legendSymbol,a=r.itemHiddenStyle.color,f=n?i.itemStyle.color:a,l=n?t.legendColor||t.color||"#CCC":a,c=t.options&&t.options.marker,h={stroke:l,fill:l},p,d;s&&s.css({fill:f,color:f}),o&&o.attr({stroke:l});if(u){if(c&&u.isMarker){c=t.convertAttribs(c);for(p in c)d=c[p],d!==e&&(h[p]=d)}u.attr(h)}},positionItem:function(e){var t=this,n=t.options,r=n.symbolPadding,i=!n.rtl,s=e._legendItemPos,o=s[0],u=s[1],a=e.checkbox;e.legendGroup&&e.legendGroup.translate(i?o:t.legendWidth-o-2*r-4,u),a&&(a.x=o,a.y=u)},destroyItem:function(e){var t=e.checkbox;ln(["legendItem","legendLine","legendSymbol","legendGroup"],function(t){e[t]&&(e[t]=e[t].destroy())}),t&&en(e.checkbox)},destroy:function(){var e=this,t=e.group,n=e.box;n&&(e.box=n.destroy()),t&&(e.group=t.destroy())},positionCheckboxes:function(e){var t=this.group.alignAttr,n,r=this.clipHeight||this.legendHeight;t&&(n=t.translateY,ln(this.allItems,function(i){var s=i.checkbox,o;s&&(o=n+s.y+(e||0)+3,It(s,{left:t.translateX+i.legendItemWidth+s.x-20+X,top:o+X,display:o>n-6&&o<n+r-6?"":V}))}))},renderTitle:function(){var e=this.options,t=this.padding,n=e.title,r=0,i;n.text&&(this.title||(this.title=this.chart.renderer.label(n.text,t-3,t-4,null,null,null,null,null,"legend-title").attr({zIndex:1}).css(n.style).add(this.group)),i=this.title.getBBox(),r=i.height,this.offsetWidth=i.width,this.contentGroup.attr({translateY:r})),this.titleHeight=r},renderItem:function(e){var t=this,n=t.chart,r=n.renderer,s=t.options,o=s.layout==="horizontal",a=t.symbolWidth,f=s.symbolPadding,l=t.itemStyle,c=t.itemHiddenStyle,h=t.padding,p=o?Ft(s.itemDistance,8):0,d=!s.rtl,v,m=s.width,g=s.itemMarginBottom||0,y=t.itemMarginTop,b=t.initialItemX,w,E,S=e.legendItem,x=e.series&&e.series.drawLegendSymbol?e.series:e,T=x.options,N=t.createCheckboxForItem&&T&&T.showCheckbox,C=s.useHTML;S||(e.legendGroup=r.g("legend-item").attr({zIndex:1}).add(t.scrollGroup),x.drawLegendSymbol(t,e),e.legendItem=S=r.text(s.labelFormat?Vt(s.labelFormat,e):s.labelFormatter.call(e),d?a+f:-f,t.baseline,C).css(Nt(e.visible?l:c)).attr({align:d?"left":"right",zIndex:2}).add(e.legendGroup),t.setItemEvents&&t.setItemEvents(e,S,C,l,c),t.colorizeItem(e,e.visible),N&&t.createCheckboxForItem(e)),w=S.getBBox(),E=e.legendItemWidth=s.itemWidth||e.legendItemWidth||a+f+w.width+p+(N?20:0),t.itemHeight=v=i(e.legendItemHeight||w.height),o&&t.itemX-b+E>(m||n.chartWidth-2*h-b-s.x)&&(t.itemX=b,t.itemY+=y+t.lastLineHeight+g,t.lastLineHeight=0),t.maxItemWidth=u(t.maxItemWidth,E),t.lastItemY=y+t.itemY+g,t.lastLineHeight=u(v,t.lastLineHeight),e._legendItemPos=[t.itemX,t.itemY],o?t.itemX+=E:(t.itemY+=y+v+g,t.lastLineHeight=v),t.offsetWidth=m||u((o?t.itemX-b-p:E)+h,t.offsetWidth)},getAllItems:function(){var t=[];return ln(this.chart.series,function(n){var r=n.options;if(!Ft(r.showInLegend,Ht(r.linkedTo)?!1:e,!0))return;t=t.concat(n.legendItems||(r.legendType==="point"?n.data:n))}),t},render:function(){var e=this,t=e.chart,n=t.renderer,r=e.group,i,s,o,u,a=e.box,f=e.options,l=e.padding,c=f.borderWidth,h=f.backgroundColor;e.itemX=e.initialItemX,e.itemY=e.initialItemY,e.offsetWidth=0,e.lastItemY=0,r||(e.group=r=n.g("legend").attr({zIndex:7}).add(),e.contentGroup=n.g().attr({zIndex:1}).add(r),e.scrollGroup=n.g().add(e.contentGroup)),e.renderTitle(),i=e.getAllItems(),Qt(i,function(e,t){return(e.options&&e.options.legendIndex||0)-(t.options&&t.options.legendIndex||0)}),f.reversed&&i.reverse(),e.allItems=i,e.display=s=!!i.length,ln(i,function(t){e.renderItem(t)}),o=f.width||e.offsetWidth,u=e.lastItemY+e.lastLineHeight+e.titleHeight,u=e.handleOverflow(u);if(c||h)o+=l,u+=l,a?o>0&&u>0&&(a[a.isNew?"attr":"animate"](a.crisp({width:o,height:u})),a.isNew=!1):(e.box=a=n.rect(0,0,o,u,f.borderRadius,c||0).attr({stroke:f.borderColor,"stroke-width":c||0,fill:h||V}).add(r).shadow(f.shadow),a.isNew=!0),a[s?"show":"hide"]();e.legendWidth=o,e.legendHeight=u,ln(i,function(t){e.positionItem(t)}),s&&r.align(Tt({width:o,height:u},f),!0,"spacingBox"),t.isResizing||this.positionCheckboxes()},handleOverflow:function(e){var t=this,n=this.chart,r=n.renderer,s=this.options,o=s.y,u=s.verticalAlign==="top",f=n.spacingBox.height+(u?-o:o)-this.padding,l=s.maxHeight,c,h=this.clipRect,p=s.navigation,d=Ft(p.animation,!0),v=p.arrowSize||12,m=this.nav,g=this.pages,y,b=this.allItems;return s.layout==="horizontal"&&(f/=2),l&&(f=a(f,l)),g.length=0,e>f&&!s.useHTML?(this.clipHeight=c=f-20-this.titleHeight-this.padding,this.currentPage=Ft(this.currentPage,1),this.fullHeight=e,ln(b,function(e,t){var n=e._legendItemPos[1],r=i(e.legendItem.getBBox().height),s=g.length;if(!s||n-g[s-1]>c&&(y||n)!==g[s-1])g.push(y||n),s++;t===b.length-1&&n+r-g[s-1]>c&&g.push(n),n!==y&&(y=n)}),h||(h=t.clipRect=r.clipRect(0,this.padding,9999,0),t.contentGroup.clip(h)),h.attr({height:c}),m||(this.nav=m=r.g().attr({zIndex:1}).add(this.group),this.up=r.symbol("triangle",0,0,v,v).on("click",function(){t.scroll(-1,d)}).add(m),this.pager=r.text("",15,10).css(p.style).add(m),this.down=r.symbol("triangle-down",0,0,v,v).on("click",function(){t.scroll(1,d)}).add(m)),t.scroll(0),e=f):m&&(h.attr({height:n.chartHeight}),m.hide(),this.scrollGroup.attr({translateY:1}),this.clipHeight=0),e},scroll:function(t,n){var r=this.pages,i=r.length,s=this.currentPage+t,o=this.clipHeight,u=this.options.navigation,a=u.activeColor,f=u.inactiveColor,l=this.pager,c=this.padding,h;s>i&&(s=i),s>0&&(n!==e&&rn(n,this.chart),this.nav.attr({translateX:c,translateY:o+this.padding+7+this.titleHeight,visibility:W}),this.up.attr({fill:s===1?f:a}).css({cursor:s===1?"default":"pointer"}),l.attr({text:s+"/"+i}),this.down.attr({x:18+this.pager.getBBox().width,fill:s===i?f:a}).css({cursor:s===i?"default":"pointer"}),h=-r[s-1]+this.initialItemY,this.scrollGroup.animate({translateY:h}),this.currentPage=s,this.positionCheckboxes(h))}};var $n=xt.LegendSymbolMixin={drawRectangle:function(e,t){var n=e.options.symbolHeight||12;t.legendSymbol=this.chart.renderer.rect(0,e.baseline-5-n/2,e.symbolWidth,n,Ft(e.options.symbolRadius,2)).attr({zIndex:3}).add(t.legendGroup)},drawLineMarker:function(e){var t=this.options,n=t.marker,r,s=e.options,o,u=e.symbolWidth,a=this.chart.renderer,f=this.legendGroup,l=e.baseline-i(a.fontMetrics(s.itemStyle.fontSize).b*.3),c;t.lineWidth&&(c={"stroke-width":t.lineWidth},t.dashStyle&&(c.dashstyle=t.dashStyle),this.legendLine=a.path([$,0,l,J,u,l]).attr(c).add(f)),n&&n.enabled&&(r=n.radius,this.legendSymbol=o=a.symbol(this.symbol,u/2-r,l-r,2*r,2*r).add(f),o.isMarker=!0)}};(/Trident\/7\.0/.test(d)||b)&&Wt(Vn.prototype,"positionItem",function(e,t){var n=this,r=function(){t._legendItemPos&&e.call(n,t)};n.chart.renderer.forExport?r():setTimeout(r)}),Jn.prototype={init:function(e,t){var n,r=e.series;e.series=null,n=Nt(O,e),n.series=e.series=r,this.userOptions=e;var i=n.chart;this.margin=this.splashArray("margin",i),this.spacing=this.splashArray("spacing",i);var s=i.events;this.bounds={h:{},v:{}},this.callback=t,this.isResizing=0,this.options=n,this.axes=[],this.series=[],this.hasCartesianSeries=i.showAxes;var o=this,u;o.index=B.length,B.push(o),i.reflow!==!1&&dn(o,"load",function(){o.initReflow()});if(s)for(u in s)dn(o,u,s[u]);o.xAxis=[],o.yAxis=[],o.animation=T?!1:Ft(i.animation,!0),o.pointCount=0,o.counters=new Kt,o.firstRender()},initSeries:function(e){var t=this,n=t.options.chart,r=e.type||n.type||n.defaultSeriesType,i,s=St[r];return s||tn(17,!0),i=new s,i.init(this,e),i},isInsidePlot:function(e,t,n){var r=n?t:e,i=n?e:t;return r>=0&&r<=this.plotWidth&&i>=0&&i<=this.plotHeight},adjustTickAmounts:function(){this.options.chart.alignTicks!==!1&&ln(this.axes,function(e){e.adjustTickAmount()}),this.maxTicks=null},redraw:function(e){var t=this,n=t.axes,r=t.series,i=t.pointer,s=t.legend,o=t.isDirtyLegend,u,a,f=t.isDirtyBox,l=r.length,c=l,h,p=t.renderer,d=p.isHidden(),v=[];rn(e,t),d&&t.cloneRenderTo(),t.layOutTitles();while(c--){h=r[c];if(h.options.stacking){u=!0;if(h.isDirty){a=!0;break}}}if(a){c=l;while(c--)h=r[c],h.options.stacking&&(h.isDirty=!0)}ln(r,function(e){e.isDirty&&e.options.legendType==="point"&&(o=!0)}),o&&s.options.enabled&&(s.render(),t.isDirtyLegend=!1),u&&t.getStacks(),t.hasCartesianSeries&&(t.isResizing||(t.maxTicks=null,ln(n,function(e){e.setScale()})),t.adjustTickAmounts(),t.getMargins(),ln(n,function(e){e.isDirty&&(f=!0)}),ln(n,function(e){e.isDirtyExtremes&&(e.isDirtyExtremes=!1,v.push(function(){mn(e,"afterSetExtremes",Tt(e.eventArgs,e.getExtremes())),delete e.eventArgs})),(f||u)&&e.redraw()})),f&&t.drawChartBox(),ln(r,function(e){e.isDirty&&e.visible&&(!e.isCartesian||e.xAxis)&&e.redraw()}),i&&i.reset(!0),p.draw(),mn(t,"redraw"),d&&t.cloneRenderTo(!0),ln(v,function(e){e.call()})},get:function(e){var t=this,n=t.axes,r=t.series,i,s,o;for(i=0;i<n.length;i++)if(n[i].options.id===e)return n[i];for(i=0;i<r.length;i++)if(r[i].options.id===e)return r[i];for(i=0;i<r.length;i++){o=r[i].points||[];for(s=0;s<o.length;s++)if(o[s].id===e)return o[s]}return null},getAxes:function(){var e=this,t=this.options,n=t.xAxis=jt(t.xAxis||{}),r=t.yAxis=jt(t.yAxis||{}),i,s;ln(n,function(e,t){e.index=t,e.isX=!0}),ln(r,function(e,t){e.index=t}),i=n.concat(r),ln(i,function(t){s=new Fn(e,t)}),e.adjustTickAmounts()},getSelectedPoints:function(){var e=[];return ln(this.series,function(t){e=e.concat(cn(t.points||[],function(e){return e.selected}))}),e},getSelectedSeries:function(){return cn(this.series,function(e){return e.selected})},getStacks:function(){var e=this;ln(e.yAxis,function(e){e.stacks&&e.hasVisibleSeries&&(e.oldStacks=e.stacks)}),ln(e.series,function(t){t.options.stacking&&(t.visible===!0||e.options.chart.ignoreHiddenSeries===!1)&&(t.stackKey=t.type+Ft(t.options.stack,""))})},setTitle:function(e,t,n){var r=this,i=r.options,s,o;s=i.title=Nt(i.title,e),o=i.subtitle=Nt(i.subtitle,t),ln([["title",e,s],["subtitle",t,o]],function(e){var t=e[0],n=r[t],i=e[1],s=e[2];n&&i&&(r[t]=n=n.destroy()),s&&s.text&&!n&&(r[t]=r.renderer.text(s.text,0,0,s.useHTML).attr({align:s.align,"class":z+t,zIndex:s.zIndex||4}).css(s.style).add())}),r.layOutTitles(n)},layOutTitles:function(e){var t=0,n=this.title,r=this.subtitle,i=this.options,s=i.title,u=i.subtitle,a,f=this.spacingBox.width-44;n&&(n.css({width:(s.width||f)+X}).align(Tt({y:15},s),!1,"spacingBox"),!s.floating&&!s.verticalAlign&&(t=n.getBBox().height,t>=18&&t<=25&&(t=15))),r&&(r.css({width:(u.width||f)+X}).align(Tt({y:t+s.margin},u),!1,"spacingBox"),!u.floating&&!u.verticalAlign&&(t=o(t+r.getBBox().height))),a=this.titleOffset!==t,this.titleOffset=t,!this.isDirtyBox&&a&&(this.isDirtyBox=a,this.hasRendered&&Ft(e,!0)&&this.isDirtyBox&&this.redraw())},getChartSize:function(){var e=this,t=e.options.chart,n=t.width,r=t.height,i=e.renderToClone||e.renderTo;Ht(n)||(e.containerWidth=un(i,"width")),Ht(r)||(e.containerHeight=un(i,"height")),e.chartWidth=u(0,n||e.containerWidth||600),e.chartHeight=u(0,Ft(r,e.containerHeight>19?e.containerHeight:400))},cloneRenderTo:function(e){var n=this.renderToClone,r=this.container;e?n&&(this.renderTo.appendChild(r),en(n),delete this.renderToClone):(r&&r.parentNode===this.renderTo&&this.renderTo.removeChild(r),this.renderToClone=n=this.renderTo.cloneNode(0),It(n,{position:q,top:"-9999px",display:"block"}),n.style.setProperty&&n.style.setProperty("display","block","important"),t.body.appendChild(n),r&&n.appendChild(r))},getContainer:function(){var e=this,n,r=e.options.chart,i,s,o,u="data-highcharts-chart",a,f;e.renderTo=o=r.renderTo,f=z+L++,Lt(o)&&(e.renderTo=o=t.getElementById(o)),o||tn(13,!0),a=kt(Bt(o,u)),!isNaN(a)&&B[a]&&B[a].hasRendered&&B[a].destroy(),Bt(o,u,e.index),o.innerHTML="",!r.skipClone&&!o.offsetWidth&&e.cloneRenderTo(),e.getChartSize(),i=e.chartWidth,s=e.chartHeight,e.container=n=qt(I,{className:z+"container"+(r.className?" "+r.className:""),id:f},Tt({position:R,overflow:U,width:i+X,height:s+X,textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)"},r.style),e.renderToClone||o),e._cursor=n.style.cursor,e.renderer=r.forExport?new Mn(n,i,s,r.style,!0):new N(n,i,s,r.style),T&&e.renderer.create(e,n,i,s)},getMargins:function(){var e=this,t=e.spacing,n,r=e.legend,i=e.margin,s=e.options.legend,o=Ft(s.margin,10),a=s.x,f=s.y,l=s.align,c=s.verticalAlign,h=e.titleOffset;e.resetMargins(),n=e.axisOffset,h&&!Ht(i[0])&&(e.plotTop=u(e.plotTop,h+e.options.title.margin+t[0])),r.display&&!s.floating&&(l==="right"?Ht(i[1])||(e.marginRight=u(e.marginRight,r.legendWidth-a+o+t[1])):l==="left"?Ht(i[3])||(e.plotLeft=u(e.plotLeft,r.legendWidth+a+o+t[3])):c==="top"?Ht(i[0])||(e.plotTop=u(e.plotTop,r.legendHeight+f+o+t[0])):c==="bottom"&&(Ht(i[2])||(e.marginBottom=u(e.marginBottom,r.legendHeight-f+o+t[2])))),e.extraBottomMargin&&(e.marginBottom+=e.extraBottomMargin),e.extraTopMargin&&(e.plotTop+=e.extraTopMargin),e.hasCartesianSeries&&ln(e.axes,function(e){e.getOffset()}),Ht(i[3])||(e.plotLeft+=n[3]),Ht(i[0])||(e.plotTop+=n[0]),Ht(i[2])||(e.marginBottom+=n[2]),Ht(i[1])||(e.marginRight+=n[1]),e.setChartSize()},reflow:function(e){var r=this,i=r.options.chart,s=r.renderTo,o=i.width||un(s,"width"),u=i.height||un(s,"height"),a=e?e.target:n,f=function(){r.container&&(r.setSize(o,u,!1),r.hasUserSize=null)};if(!r.hasUserSize&&o&&u&&(a===n||a===t)){if(o!==r.containerWidth||u!==r.containerHeight)clearTimeout(r.reflowTimeout),e?r.reflowTimeout=setTimeout(f,100):f();r.containerWidth=o,r.containerHeight=u}},initReflow:function(){var e=this,t=function(t){e.reflow(t)};dn(n,"resize",t),dn(e,"destroy",function(){vn(n,"resize",t)})},setSize:function(e,t,n){var r=this,s,o,a;r.isResizing+=1,a=function(){r&&mn(r,"endResize",null,function(){r.isResizing-=1})},rn(n,r),r.oldChartHeight=r.chartHeight,r.oldChartWidth=r.chartWidth,Ht(e)&&(r.chartWidth=s=u(0,i(e)),r.hasUserSize=!!s),Ht(t)&&(r.chartHeight=o=u(0,i(t))),(_?yn:It)(r.container,{width:s+X,height:o+X},_),r.setChartSize(!0),r.renderer.setSize(s,o,n),r.maxTicks=null,ln(r.axes,function(e){e.isDirty=!0,e.setScale()}),ln(r.series,function(e){e.isDirty=!0}),r.isDirtyLegend=!0,r.isDirtyBox=!0,r.getMargins(),r.redraw(n),r.oldChartHeight=null,mn(r,"resize"),_===!1?a():setTimeout(a,_&&_.duration||500)},setChartSize:function(e){var t=this,n=t.inverted,r=t.renderer,a=t.chartWidth,f=t.chartHeight,l=t.options.chart,c=t.spacing,h=t.clipOffset,p,d,v,m,g,y,b;t.plotLeft=v=i(t.plotLeft),t.plotTop=m=i(t.plotTop),t.plotWidth=g=u(0,i(a-v-t.marginRight)),t.plotHeight=y=u(0,i(f-m-t.marginBottom)),t.plotSizeX=n?y:g,t.plotSizeY=n?g:y,t.plotBorderWidth=l.plotBorderWidth||0,t.spacingBox=r.spacingBox={x:c[3],y:c[0],width:a-c[3]-c[1],height:f-c[0]-c[2]},t.plotBox=r.plotBox={x:v,y:m,width:g,height:y},b=2*s(t.plotBorderWidth/2),p=o(u(b,h[3])/2),d=o(u(b,h[0])/2),t.clipBox={x:p,y:d,width:s(t.plotSizeX-u(b,h[1])/2-p),height:s(t.plotSizeY-u(b,h[2])/2-d)},e||ln(t.axes,function(e){e.setAxisSize(),e.setAxisTranslation()})},resetMargins:function(){var e=this,t=e.spacing,n=e.margin;e.plotTop=Ft(n[0],t[0]),e.marginRight=Ft(n[1],t[1]),e.marginBottom=Ft(n[2],t[2]),e.plotLeft=Ft(n[3],t[3]),e.axisOffset=[0,0,0,0],e.clipOffset=[0,0,0,0]},drawChartBox:function(){var e=this,t=e.options.chart,n=e.renderer,r=e.chartWidth,i=e.chartHeight,s=e.chartBackground,o=e.plotBackground,u=e.plotBorder,a=e.plotBGImage,f=t.borderWidth||0,l=t.backgroundColor,c=t.plotBackgroundColor,h=t.plotBackgroundImage,p=t.plotBorderWidth||0,d,v,m=e.plotLeft,g=e.plotTop,y=e.plotWidth,b=e.plotHeight,w=e.plotBox,E=e.clipRect,S=e.clipBox;d=f+(t.shadow?8:0);if(f||l)s?s.animate(s.crisp({width:r-d,height:i-d})):(v={fill:l||V},f&&(v.stroke=t.borderColor,v["stroke-width"]=f),e.chartBackground=n.rect(d/2,d/2,r-d,i-d,t.borderRadius,f).attr(v).addClass(z+"background").add().shadow(t.shadow));c&&(o?o.animate(w):e.plotBackground=n.rect(m,g,y,b,0).attr({fill:c}).add().shadow(t.plotShadow)),h&&(a?a.animate(w):e.plotBGImage=n.image(h,m,g,y,b).add()),E?E.animate({width:S.width,height:S.height}):e.clipRect=n.clipRect(S),p&&(u?u.animate(u.crisp({x:m,y:g,width:y,height:b})):e.plotBorder=n.rect(m,g,y,b,0,-p).attr({stroke:t.plotBorderColor,"stroke-width":p,fill:V,zIndex:1}).add()),e.isDirtyBox=!1},propFromSeries:function(){var e=this,t=e.options.chart,n,r=e.options.series,i,s;ln(["inverted","angular","polar"],function(o){n=St[t.type||t.defaultSeriesType],s=e[o]||t[o]||n&&n.prototype[o],i=r&&r.length;while(!s&&i--)n=St[r[i].type],n&&n.prototype[o]&&(s=!0);e[o]=s})},linkSeries:function(){var e=this,t=e.series;ln(t,function(e){e.linkedSeries.length=0}),ln(t,function(t){var n=t.options.linkedTo;Lt(n)&&(n===":previous"?n=e.series[t.index-1]:n=e.get(n),n&&(n.linkedSeries.push(t),t.linkedParent=n))})},renderSeries:function(){ln(this.series,function(e){e.translate(),e.setTooltipPoints&&e.setTooltipPoints(),e.render()})},render:function(){var e=this,t=e.axes,n=e.renderer,r=e.options,i=r.labels,s=r.credits,o;e.setTitle(),e.legend=new Vn(e,r.legend),e.getStacks(),ln(t,function(e){e.setScale()}),e.getMargins(),e.maxTicks=null,ln(t,function(e){e.setTickPositions(!0),e.setMaxTicks()}),e.adjustTickAmounts(),e.getMargins(),e.drawChartBox(),e.hasCartesianSeries&&ln(t,function(e){e.render()}),e.seriesGroup||(e.seriesGroup=n.g("series-group").attr({zIndex:3}).add()),e.renderSeries(),i.items&&ln(i.items,function(t){var r=Tt(i.style,t.style),s=kt(r.left)+e.plotLeft,o=kt(r.top)+e.plotTop+12;delete r.left,delete r.top,n.text(t.html,s,o).attr({zIndex:2}).css(r).add()}),s.enabled&&!e.credits&&(o=s.href,e.credits=n.text(s.text,0,0).on("click",function(){o&&(location.href=o)}).attr({align:s.position.align,zIndex:8}).css(s.style).add().align(s.position)),e.hasRendered=!0},destroy:function(){var t=this,n=t.axes,r=t.series,i=t.container,s,o=i&&i.parentNode;mn(t,"destroy"),B[t.index]=e,t.renderTo.removeAttribute("data-highcharts-chart"),vn(t),s=n.length;while(s--)n[s]=n[s].destroy();s=r.length;while(s--)r[s]=r[s].destroy();ln(["title","subtitle","chartBackground","plotBackground","plotBGImage","plotBorder","seriesGroup","clipRect","credits","pointer","scroller","rangeSelector","legend","resetZoomButton","tooltip","renderer"],function(e){var n=t[e];n&&n.destroy&&(t[e]=n.destroy())}),i&&(i.innerHTML="",vn(i),o&&en(i));for(s in t)delete t[s]},isReadyToRender:function(){var e=this;return!S&&n==n.top&&t.readyState!=="complete"||T&&!n.canvg?(T?Bn.push(function(){e.firstRender()},e.options.global.canvasToolsURL):t.attachEvent("onreadystatechange",function(){t.detachEvent("onreadystatechange",e.firstRender),t.readyState==="complete"&&e.firstRender()}),!1):!0},firstRender:function(){var e=this,t=e.options,n=e.callback;if(!e.isReadyToRender())return;e.getContainer(),mn(e,"init"),e.resetMargins(),e.setChartSize(),e.propFromSeries(),e.getAxes(),ln(t.series||[],function(t){e.initSeries(t)}),e.linkSeries(),mn(e,"beforeRender"),xt.Pointer&&(e.pointer=new Rn(e,t)),e.render(),e.renderer.draw(),n&&n.apply(e,[e]),ln(e.callbacks,function(t){t.apply(e,[e])}),e.cloneRenderTo(!0),mn(e,"load")},splashArray:function(e,t){var n=t[e],r=At(n)?n:[n,n,n,n];return[Ft(t[e+"Top"],r[0]),Ft(t[e+"Right"],r[1]),Ft(t[e+"Bottom"],r[2]),Ft(t[e+"Left"],r[3])]}},Jn.prototype.callbacks=[];var Kn=xt.CenteredSeriesMixin={getCenter:function(){var e=this.options,t=this.chart,n=2*(e.slicedOffset||0),r,i=t.plotWidth-2*n,s=t.plotHeight-2*n,o=e.center,u=[Ft(o[0],"50%"),Ft(o[1],"50%"),e.size||"100%",e.innerSize||0],f=a(i,s),l;return pn(u,function(e,t){return l=/%$/.test(e),r=t<2||t===2&&l,(l?[i,s,f,f][t]*kt(e)/100:e)+(r?n:0)})}},Qn=function(){};Qn.prototype={init:function(e,t,n){var r=this,i;return r.series=e,r.applyOptions(t,n),r.pointAttr={},e.options.colorByPoint&&(i=e.options.colors||e.chart.options.colors,r.color=r.color||i[e.colorCounter++],e.colorCounter===i.length&&(e.colorCounter=0)),e.chart.pointCount++,r},applyOptions:function(t,n){var r=this,i=r.series,s=i.pointValKey;return t=Qn.prototype.optionsToObject.call(this,t),Tt(r,t),r.options=r.options?Tt(r.options,t):t,s&&(r.y=r[s]),r.x===e&&i&&(r.x=n===e?i.autoIncrement():n),r},optionsToObject:function(e){var t={},n=this.series,r=n.pointArrayMap||["y"],i=r.length,s,o=0,u=0;if(typeof e=="number"||e===null)t[r[0]]=e;else if(Ot(e)){e.length>i&&(s=typeof e[0],s==="string"?t.name=e[0]:s==="number"&&(t.x=e[0]),o++);while(u<i)t[r[u++]]=e[o++]}else typeof e=="object"&&(t=e,e.dataLabels&&(n._hasPointLabels=!0),e.marker&&(n._hasPointMarkers=!0));return t},destroy:function(){var e=this,t=e.series,n=t.chart,r=n.hoverPoints,i;n.pointCount--,r&&(e.setState(),Pt(r,e),r.length||(n.hoverPoints=null)),e===n.hoverPoint&&e.onMouseOut();if(e.graphic||e.dataLabel)vn(e),e.destroyElements();e.legendItem&&n.legend.destroyItem(e);for(i in e)e[i]=null},destroyElements:function(){var e=this,t=["graphic","dataLabel","dataLabelUpper","group","connector","shadowGroup"],n,r=6;while(r--)n=t[r],e[n]&&(e[n]=e[n].destroy())},getLabelConfig:function(){var e=this;return{x:e.category,y:e.y,key:e.name||e.category,series:e.series,point:e,percentage:e.percentage,total:e.total||e.stackTotal}},tooltipFormatter:function(e){var t=this.series,n=t.tooltipOptions,r=Ft(n.valueDecimals,""),i=n.valuePrefix||"",s=n.valueSuffix||"";return ln(t.pointArrayMap||["y"],function(t){t="{point."+t;if(i||s)e=e.replace(t+"}",i+t+"}"+s);e=e.replace(t+"}",t+":,."+r+"f}")}),Vt(e,{point:this,series:this.series})}};var Gn=function(){};Gn.prototype={isCartesian:!0,type:"line",pointClass:Qn,sorted:!0,requireSorting:!0,pointAttrToOptions:{stroke:"lineColor","stroke-width":"lineWidth",fill:"fillColor",r:"radius"},axisTypes:["xAxis","yAxis"],colorCounter:0,parallelArrays:["x","y"],init:function(e,t){var n=this,r,i,s=e.series,o=function(e,t){return Ft(e.options.index,e._i)-Ft(t.options.index,t._i)};n.chart=e,n.options=t=n.setOptions(t),n.linkedSeries=[],n.bindAxes(),Tt(n,{name:t.name,state:Q,pointAttr:{},visible:t.visible!==!1,selected:t.selected===!0}),T&&(t.animation=!1),i=t.events;for(r in i)dn(n,r,i[r]);if(i&&i.click||t.point&&t.point.events&&t.point.events.click||t.allowPointSelect)e.runTrackerClick=!0;n.getColor(),n.getSymbol(),ln(n.parallelArrays,function(e){n[e+"Data"]=[]}),n.setData(t.data,!1),n.isCartesian&&(e.hasCartesianSeries=!0),s.push(n),n._i=s.length-1,Qt(s,o),this.yAxis&&Qt(this.yAxis.series,o),ln(s,function(e,t){e.index=t,e.name=e.name||"Series "+(t+1)})},bindAxes:function(){var t=this,n=t.options,r=t.chart,i;ln(t.axisTypes||[],function(s){ln(r[s],function(r){i=r.options;if(n[s]===i.index||n[s]!==e&&n[s]===i.id||n[s]===e&&i.index===0)r.series.push(t),t[s]=r,r.isDirty=!0}),!t[s]&&t.optionalAxis!==s&&tn(18,!0)})},updateParallelArrays:function(e,t){var n=e.series,r=arguments,i=typeof t=="number"?function(r){var i=r==="y"&&n.toYData?n.toYData(e):e[r];n[r+"Data"][t]=i}:function(e){Array.prototype[t].apply(n[e+"Data"],Array.prototype.slice.call(r,2))};ln(n.parallelArrays,i)},autoIncrement:function(){var e=this,t=e.options,n=e.xIncrement;return n=Ft(n,t.pointStart,0),e.pointInterval=Ft(e.pointInterval,t.pointInterval,1),e.xIncrement=n+e.pointInterval,n},getSegments:function(){var e=this,t=-1,n=[],r,i=e.points,s=i.length;if(s)if(e.options.connectNulls){r=s;while(r--)i[r].y===null&&i.splice(r,1);i.length&&(n=[i])}else ln(i,function(e,r){e.y===null?(r>t+1&&n.push(i.slice(t+1,r)),t=r):r===s-1&&n.push(i.slice(t+1,r+1))});e.segments=n},setOptions:function(e){var t=this.chart,n=t.options,r=n.plotOptions,i=t.userOptions||{},s=i.plotOptions||{},o=r[this.type],u;return this.userOptions=e,u=Nt(o,r.series,e),this.tooltipOptions=Nt(O.tooltip,O.plotOptions[this.type].tooltip,i.tooltip,s.series&&s.series.tooltip,s[this.type]&&s[this.type].tooltip,e.tooltip),o.marker===null&&delete u.marker,u},getColor:function(){var e=this.options,t=this.userOptions,n=this.chart.options.colors,r=this.chart.counters,i,s;i=e.color||En[this.type].color,!i&&!e.colorByPoint&&(Ht(t._colorIndex)?s=t._colorIndex:(t._colorIndex=r.color,s=r.color++),i=n[s]),this.color=i,r.wrapColor(n.length)},getSymbol:function(){var e=this,t=e.userOptions,n=e.options.marker,r=e.chart,i=r.options.symbols,s=r.counters,o;e.symbol=n.symbol,e.symbol||(Ht(t._symbolIndex)?o=t._symbolIndex:(t._symbolIndex=s.symbol,o=s.symbol++),e.symbol=i[o]),/^url/.test(e.symbol)&&(n.radius=0),s.wrapSymbol(i.length)},drawLegendSymbol:$n.drawLineMarker,setData:function(t,n,r,i){var s=this,o=s.points,u=o&&o.length||0,a,f=s.options,l=s.chart,c=null,h=s.xAxis,p=h&&!!h.categories,d=s.tooltipPoints,v,m=f.turboThreshold,g,y=this.xData,b=this.yData,w=s.pointArrayMap,E=w&&w.length;t=t||[],a=t.length,n=Ft(n,!0);if(i!==!1&&a&&u===a&&!s.cropped&&!s.hasGroupedData)ln(t,function(e,t){o[t].update(e,!1)});else{s.xIncrement=null,s.pointRange=p?1:f.pointRange,s.colorCounter=0,ln(this.parallelArrays,function(e){s[e+"Data"].length=0});if(m&&a>m){v=0;while(c===null&&v<a)c=t[v],v++;if(Mt(c)){var S=Ft(f.pointStart,0),x=Ft(f.pointInterval,1);for(v=0;v<a;v++)y[v]=S,b[v]=t[v],S+=x;s.xIncrement=S}else if(Ot(c))if(E)for(v=0;v<a;v++)g=t[v],y[v]=g[0],b[v]=g.slice(1,E+1);else for(v=0;v<a;v++)g=t[v],y[v]=g[0],b[v]=g[1];else tn(12)}else for(v=0;v<a;v++)t[v]!==e&&(g={series:s},s.pointClass.prototype.applyOptions.apply(g,[t[v]]),s.updateParallelArrays(g,v),p&&g.name&&(h.names[g.x]=g.name));Lt(b[0])&&tn(14,!0),s.data=[],s.options.data=t,v=u;while(v--)o[v]&&o[v].destroy&&o[v].destroy();d&&(d.length=0),h&&(h.minRange=h.userMinRange),s.isDirty=s.isDirtyData=l.isDirtyBox=!0,r=!1}n&&l.redraw(r)},processData:function(t){var n=this,r=n.xData,i=n.yData,s=r.length,o,u=0,a,f,l,c=n.xAxis,h,p=n.options,d=p.cropThreshold,v=n.isCartesian;if(v&&!n.isDirty&&!c.isDirty&&!n.yAxis.isDirty&&!t)return!1;if(v&&n.sorted&&(!d||s>d||n.forceCrop)){var m=c.min,g=c.max;if(r[s-1]<m||r[0]>g)r=[],i=[];else if(r[0]<m||r[s-1]>g)o=this.cropData(n.xData,n.yData,m,g),r=o.xData,i=o.yData,u=o.start,a=!0}for(h=r.length-1;h>=0;h--)f=r[h]-r[h-1],f>0&&(l===e||f<l)?l=f:f<0&&n.requireSorting&&tn(15);n.cropped=a,n.cropStart=u,n.processedXData=r,n.processedYData=i,p.pointRange===null&&(n.pointRange=l||1),n.closestPointRange=l},cropData:function(e,t,n,r){var i=e.length,s=0,o=i,a=Ft(this.cropShoulder,1),f;for(f=0;f<i;f++)if(e[f]>=n){s=u(0,f-a);break}for(;f<i;f++)if(e[f]>r){o=f+a;break}return{xData:e.slice(s,o),yData:t.slice(s,o),start:s,end:o}},generatePoints:function(){var t=this,n=t.options,r=n.data,i=t.data,s,o=t.processedXData,u=t.processedYData,a=t.pointClass,f=o.length,l=t.cropStart||0,c,h=t.hasGroupedData,p,d=[],v;if(!i&&!h){var m=[];m.length=r.length,i=t.data=m}for(v=0;v<f;v++)c=l+v,h?d[v]=(new a).init(t,[o[v]].concat(jt(u[v]))):(i[c]?p=i[c]:r[c]!==e&&(i[c]=p=(new a).init(t,r[c],o[v])),d[v]=p);if(i&&(f!==(s=i.length)||h))for(v=0;v<s;v++)v===l&&!h&&(v+=f),i[v]&&(i[v].destroyElements(),i[v].plotX=e);t.data=i,t.points=d},getExtremes:function(t){var n=this.xAxis,r=this.yAxis,i=this.processedXData,s,o=[],u=0,a=n.getExtremes(),f=a.min,l=a.max,c,h,p,d,v,m,g,y;t=t||this.stackedYData||this.processedYData,s=t.length;for(g=0;g<s;g++){v=i[g],m=t[g],c=m!==null&&m!==e&&(!r.isLog||m.length||m>0),h=this.getExtremesFromAll||this.cropped||(i[g+1]||v)>=f&&(i[g-1]||v)<=l;if(c&&h){y=m.length;if(y)while(y--)m[y]!==null&&(o[u++]=m[y]);else o[u++]=m}}this.dataMin=Ft(p,Gt(o)),this.dataMax=Ft(d,Yt(o))},translate:function(){this.processedXData||this.processData(),this.generatePoints();var t=this,n=t.options,r=n.stacking,i=t.xAxis,s=i.categories,o=t.yAxis,u=t.points,a=u.length,f=!!t.modifyValue,l,c=n.pointPlacement,h=c==="between"||Mt(c),p=n.threshold;for(l=0;l<a;l++){var d=u[l],v=d.x,m=d.y,g=d.low,y=r&&o.stacks[(t.negStacks&&m<p?"-":"")+t.stackKey],b,w;o.isLog&&m<=0&&(d.y=m=null),d.plotX=i.translate(v,0,0,0,1,c,this.type==="flags"),r&&t.visible&&y&&y[v]&&(b=y[v],w=b.points[t.index],g=w[0],m=w[1],g===0&&(g=Ft(p,o.min)),o.isLog&&g<=0&&(g=null),d.total=d.stackTotal=b.total,d.percentage=b.total&&d.y/b.total*100,d.stackY=m,b.setOffset(t.pointXOffset||0,t.barW||0)),d.yBottom=Ht(g)?o.translate(g,0,1,0,1):null,f&&(m=t.modifyValue(m,d)),d.plotY=typeof m=="number"&&m!==Infinity?o.translate(m,0,1,0,1):e,d.clientX=h?i.translate(v,0,0,0,1):d.plotX,d.negative=d.y<(p||0),d.category=s&&s[d.x]!==e?s[d.x]:d.x}t.getSegments()},animate:function(e){var t=this,n=t.chart,r=n.renderer,i,s,o=t.options.animation,u=n.clipBox,a=n.inverted,f;o&&!At(o)&&(o=En[t.type].animation),f="_sharedClip"+o.duration+o.easing,e?(i=n[f],s=n[f+"m"],i||(n[f]=i=r.clipRect(Tt(u,{width:0})),n[f+"m"]=s=r.clipRect(-99,a?-n.plotLeft:-n.plotTop,99,a?n.chartWidth:n.chartHeight)),t.group.clip(i),t.markerGroup.clip(s),t.sharedClipKey=f):(i=n[f],i&&(i.animate({width:n.plotSizeX},o),n[f+"m"].animate({width:n.plotSizeX+99},o)),t.animate=null,t.animationTimeout=setTimeout(function(){t.afterAnimate()},o.duration))},afterAnimate:function(){var e=this.chart,t=this.sharedClipKey,n=this.group;n&&this.options.clip!==!1&&(n.clip(e.clipRect),this.markerGroup.clip()),setTimeout(function(){t&&e[t]&&(e[t]=e[t].destroy(),e[t+"m"]=e[t+"m"].destroy())},100)},drawPoints:function(){var t=this,n,r=t.points,o=t.chart,u,a,f,l,c,h,p,d,v=t.options,m=v.marker,g=t.pointAttr[""],y,b,w,E=t.markerGroup;if(m.enabled||t._hasPointMarkers){f=r.length;while(f--)l=r[f],u=s(l.plotX),a=l.plotY,d=l.graphic,y=l.marker||{},b=m.enabled&&y.enabled===e||y.enabled,w=o.isInsidePlot(i(u),a,o.inverted),b&&a!==e&&!isNaN(a)&&l.y!==null?(n=l.pointAttr[l.selected?Y:Q]||g,c=n.r,h=Ft(y.symbol,t.symbol),p=h.indexOf("url")===0,d?d.attr({visibility:w?"inherit":U}).animate(Tt({x:u-c,y:a-c},d.symbolName?{width:2*c,height:2*c}:{})):w&&(c>0||p)&&(l.graphic=d=o.renderer.symbol(h,u-c,a-c,2*c,2*c).attr(n).add(E))):d&&(l.graphic=d.destroy())}},convertAttribs:function(e,t,n,r){var i=this.pointAttrToOptions,s,o,u={};e=e||{},t=t||{},n=n||{},r=r||{};for(s in i)o=i[s],u[s]=Ft(e[o],t[s],n[s],r[s]);return u},getAttribs:function(){var e=this,t=e.options,n=En[e.type].marker?t.marker:t,r=n.states,i=r[G],s,o=e.color,u={stroke:o,fill:o},a=e.points||[],f,l,c=[],h,p=e.pointAttrToOptions,d=e.hasPointSpecificOptions,v=t.negativeColor,m=n.lineColor,g=n.fillColor,y=t.turboThreshold,b,w;t.marker?(i.radius=i.radius||n.radius+2,i.lineWidth=i.lineWidth||n.lineWidth+1):i.color=i.color||An(i.color||o).brighten(i.brightness).get(),c[Q]=e.convertAttribs(n,u),ln([G,Y],function(t){c[t]=e.convertAttribs(r[t],c[Q])}),e.pointAttr=c,f=a.length;if(!y||f<y||d)while(f--){l=a[f],n=l.options&&l.options.marker||l.options,n&&n.enabled===!1&&(n.radius=0),l.negative&&v&&(l.color=l.fillColor=v),d=t.colorByPoint||l.color;if(l.options)for(w in p)Ht(n[p[w]])&&(d=!0);d?(n=n||{},h=[],r=n.states||{},s=r[G]=r[G]||{},t.marker||(s.color=s.color||!l.options.color&&i.color||An(l.color).brighten(s.brightness||i.brightness).get()),b={color:l.color},g||(b.fillColor=l.color),m||(b.lineColor=l.color),h[Q]=e.convertAttribs(Tt(b,n),c[Q]),h[G]=e.convertAttribs(r[G],c[G],h[Q]),h[Y]=e.convertAttribs(r[Y],c[Y],h[Q])):h=c,l.pointAttr=h}},destroy:function(){var e=this,t=e.chart,n=/AppleWebKit\/533/.test(d),r,i,s=e.data||[],o,u,a;mn(e,"destroy"),vn(e),ln(e.axisTypes||[],function(t){a=e[t],a&&(Pt(a.series,e),a.isDirty=a.forceRedraw=!0)}),e.legendItem&&e.chart.legend.destroyItem(e),i=s.length;while(i--)o=s[i],o&&o.destroy&&o.destroy();e.points=null,clearTimeout(e.animationTimeout),ln(["area","graph","dataLabelsGroup","group","markerGroup","tracker","graphNeg","areaNeg","posClip","negClip"],function(t){e[t]&&(r=n&&t==="group"?"hide":"destroy",e[t][r]())}),t.hoverSeries===e&&(t.hoverSeries=null),Pt(t.series,e);for(u in e)delete e[u]},getSegmentPath:function(e){var t=this,n=[],r=t.options.step;return ln(e,function(i,s){var o=i.plotX,u=i.plotY,a;t.getPointSpline?n.push.apply(n,t.getPointSpline(e,i,s)):(n.push(s?J:$),r&&s&&(a=e[s-1],r==="right"?n.push(a.plotX,u):r==="center"?n.push((a.plotX+o)/2,a.plotY,(a.plotX+o)/2,u):n.push(o,a.plotY)),n.push(i.plotX,i.plotY))}),n},getGraphPath:function(){var e=this,t=[],n,r=[];return ln(e.segments,function(i){n=e.getSegmentPath(i),i.length>1?t=t.concat(n):r.push(i[0])}),e.singlePoints=r,e.graphPath=t,t},drawGraph:function(){var e=this,t=this.options,n=[["graph",t.lineColor||this.color]],r=t.lineWidth,i=t.dashStyle,s=t.linecap!=="square",o=this.getGraphPath(),u=t.negativeColor;u&&n.push(["graphNeg",u]),ln(n,function(n,u){var a=n[0],f=e[a],l;f?(bn(f),f.animate({d:o})):r&&o.length&&(l={stroke:n[1],"stroke-width":r,fill:V,zIndex:1},i?l.dashstyle=i:s&&(l["stroke-linecap"]=l["stroke-linejoin"]="round"),e[a]=e.chart.renderer.path(o).attr(l).add(e.group).shadow(!u&&t.shadow))})},clipNeg:function(){var e=this.options,t=this.chart,n=t.renderer,r=e.negativeColor||e.negativeFillColor,s,o,a,f=this.graph,l=this.area,c=this.posClip,h=this.negClip,p=t.chartWidth,d=t.chartHeight,v=u(p,d),m=this.yAxis,g,y;r&&(f||l)&&(s=i(m.toPixels(e.threshold||0,!0)),s<0&&(v-=s),g={x:0,y:0,width:v,height:s},y={x:0,y:s,width:v,height:v},t.inverted&&(g.height=y.y=t.plotWidth-s,n.isVML&&(g={x:t.plotWidth-s-t.plotLeft,y:0,width:p,height:d},y={x:s+t.plotLeft-p,y:0,width:t.plotLeft+s,height:p})),m.reversed?(o=y,a=g):(o=g,a=y),c?(c.animate(o),h.animate(a)):(this.posClip=c=n.clipRect(o),this.negClip=h=n.clipRect(a),f&&this.graphNeg&&(f.clip(c),this.graphNeg.clip(h)),l&&(l.clip(c),this.areaNeg.clip(h))))},invertGroups:function(){function n(){var t={width:e.yAxis.len,height:e.xAxis.len};ln(["group","markerGroup"],function(n){e[n]&&e[n].attr(t).invert()})}var e=this,t=e.chart;if(!e.xAxis)return;dn(t,"resize",n),dn(e,"destroy",function(){vn(t,"resize",n)}),n(),e.invertGroups=n},plotGroup:function(e,t,n,r,i){var s=this[e],o=!s;return o&&(this[e]=s=this.chart.renderer.g(t).attr({visibility:n,zIndex:r||.1}).add(i)),s[o?"attr":"animate"](this.getPlotBox()),s},getPlotBox:function(){return{translateX:this.xAxis?this.xAxis.left:this.chart.plotLeft,translateY:this.yAxis?this.yAxis.top:this.chart.plotTop,scaleX:1,scaleY:1}},render:function(){var e=this,t=e.chart,n,r=e.options,i=r.animation,s=i&&!!e.animate&&t.renderer.isSVG,o=e.visible?W:U,u=r.zIndex,a=e.hasRendered,f=t.seriesGroup;n=e.plotGroup("group","series",o,u,f),e.markerGroup=e.plotGroup("markerGroup","markers",o,u,f),s&&e.animate(!0),e.getAttribs(),n.inverted=e.isCartesian?t.inverted:!1,e.drawGraph&&(e.drawGraph(),e.clipNeg()),e.drawDataLabels&&e.drawDataLabels(),e.visible&&e.drawPoints(),e.drawTracker&&e.options.enableMouseTracking!==!1&&e.drawTracker(),t.inverted&&e.invertGroups(),r.clip!==!1&&!e.sharedClipKey&&!a&&n.clip(t.clipRect),s?e.animate():a||e.afterAnimate(),e.isDirty=e.isDirtyData=!1,e.hasRendered=!0},redraw:function(){var e=this,t=e.chart,n=e.isDirtyData,r=e.group,i=e.xAxis,s=e.yAxis;r&&(t.inverted&&r.attr({width:t.plotWidth,height:t.plotHeight}),r.animate({translateX:Ft(i&&i.left,t.plotLeft),translateY:Ft(s&&s.top,t.plotTop)})),e.translate(),e.setTooltipPoints(!0),e.render(),n&&mn(e,"updatedData")}},Yn.prototype={destroy:function(){Zt(this,this.axis)},render:function(e){var t=this.options,n=t.format,r=n?Vt(n,this):t.formatter.call(this);this.label?this.label.attr({text:r,visibility:U}):this.label=this.axis.chart.renderer.text(r,0,0,t.useHTML).css(t.style).attr({align:this.textAlign,rotation:t.rotation,visibility:U}).add(e)},setOffset:function(e,t){var n=this,r=n.axis,i=r.chart,s=i.inverted,o=this.isNegative,u=r.translate(this.percent?100:this.total,0,0,0,1),a=r.translate(0),l=f(u-a),c=i.xAxis[0].translate(this.x)+e,h=i.plotHeight,p={x:s?o?u:u-l:c,y:s?h-c-t:o?h-u-l:h-u,width:s?l:t,height:s?t:l},d=this.label,v;d&&(d.align(this.alignOptions,null,p),v=d.alignAttr,d[this.options.crop===!1||i.isInsidePlot(v.x,v.y)?"show":"hide"](!0))}},Fn.prototype.buildStacks=function(){var e=this.series,t=Ft(this.options.reversedStacks,!0),n=e.length;if(!this.isXAxis){this.usePercentage=!1;while(n--)e[t?n:e.length-n-1].setStackedPoints();if(this.usePercentage)for(n=0;n<e.length;n++)e[n].setPercentStacks()}},Fn.prototype.renderStackTotals=function(){var e=this,t=e.chart,n=t.renderer,r=e.stacks,i,s,o,u=e.stackTotalGroup;u||(e.stackTotalGroup=u=n.g("stack-labels").attr({visibility:W,zIndex:6}).add()),u.translate(t.plotLeft,t.plotTop);for(i in r){s=r[i];for(o in s)s[o].render(u)}},Gn.prototype.setStackedPoints=function(){if(!this.options.stacking||this.visible!==!0&&this.chart.options.chart.ignoreHiddenSeries!==!1)return;var e=this,t=e.processedXData,n=e.processedYData,r=[],i=n.length,s=e.options,o=s.threshold,a=s.stack,l=s.stacking,c=e.stackKey,h="-"+c,p=e.negStacks,d=e.yAxis,v=d.stacks,m=d.oldStacks,g,y,b,w,E,S,x;for(E=0;E<i;E++)S=t[E],x=n[E],g=p&&x<o,w=g?h:c,v[w]||(v[w]={}),v[w][S]||(m[w]&&m[w][S]?(v[w][S]=m[w][S],v[w][S].total=null):v[w][S]=new Yn(d,d.options.stackLabels,g,S,a,l)),y=v[w][S],y.points[e.index]=[y.cum||0],l==="percent"?(b=g?c:h,p&&v[b]&&v[b][S]?(b=v[b][S],y.total=b.total=u(b.total,y.total)+f(x)||0):y.total=nn(y.total+(f(x)||0))):y.total=nn(y.total+(x||0)),y.cum=(y.cum||0)+(x||0),y.points[e.index].push(y.cum),r[E]=y.cum;l==="percent"&&(d.usePercentage=!0),this.stackedYData=r,d.oldStacks={}},Gn.prototype.setPercentStacks=function(){var e=this,t=e.stackKey,n=e.yAxis.stacks,r=e.processedXData;ln([t,"-"+t],function(t){var i=r.length,s,o,u,a;while(i--)s=r[i],o=n[t]&&n[t][s],u=o&&o.points[e.index],u&&(a=o.total?100/o.total:0,u[0]=nn(u[0]*a),u[1]=nn(u[1]*a),e.stackedYData[i]=u[1])})},Tt(Jn.prototype,{addSeries:function(e,t,n){var r,i=this;return e&&(t=Ft(t,!0),mn(i,"addSeries",{options:e},function(){r=i.initSeries(e),i.isDirtyLegend=!0,i.linkSeries(),t&&i.redraw(n)})),r},addAxis:function(e,t,n,r){var i=t?"xAxis":"yAxis",s=this.options,o;o=new Fn(this,Nt(e,{index:this[i].length,isX:t})),s[i]=jt(s[i]||{}),s[i].push(e),Ft(n,!0)&&this.redraw(r)},showLoading:function(e){var t=this,n=t.options,r=t.loadingDiv,i=n.loading;r||(t.loadingDiv=r=qt(I,{className:z+"loading"},Tt(i.style,{zIndex:10,display:V}),t.container),t.loadingSpan=qt("span",null,i.labelStyle,r)),t.loadingSpan.innerHTML=e||n.lang.loading,t.loadingShown||(It(r,{opacity:0,display:"",left:t.plotLeft+X,top:t.plotTop+X,width:t.plotWidth+X,height:t.plotHeight+X}),yn(r,{opacity:i.style.opacity},{duration:i.showDuration||0}),t.loadingShown=!0)},hideLoading:function(){var e=this.options,t=this.loadingDiv;t&&yn(t,{opacity:0},{duration:e.loading.hideDuration||100,complete:function(){It(t,{display:V})}}),this.loadingShown=!1}}),Tt(Qn.prototype,{update:function(e,t,n){var r=this,i=r.series,s=r.graphic,o,u=i.data,a=i.chart,f=i.options;t=Ft(t,!0),r.firePointEvent("update",{options:e},function(){r.applyOptions(e),At(e)&&(i.getAttribs(),s&&(e&&e.marker&&e.marker.symbol?r.graphic=s.destroy():s.attr(r.pointAttr[r.state||""])),e&&e.dataLabels&&r.dataLabel&&(r.dataLabel=r.dataLabel.destroy())),o=fn(r,u),i.updateParallelArrays(r,o),f.data[o]=r.options,i.isDirty=i.isDirtyData=!0,!i.fixedBox&&i.hasCartesianSeries&&(a.isDirtyBox=!0),f.legendType==="point"&&a.legend.destroyItem(r),t&&a.redraw(n)})},remove:function(e,t){var n=this,r=n.series,i=r.points,s=r.chart,o,u=r.data;rn(t,s),e=Ft(e,!0),n.firePointEvent("remove",null,function(){o=fn(n,u),u.length===i.length&&i.splice(o,1),u.splice(o,1),r.options.data.splice(o,1),r.updateParallelArrays(n,"splice",o,1),n.destroy(),r.isDirty=!0,r.isDirtyData=!0,e&&s.redraw()})}}),Tt(Gn.prototype,{addPoint:function(e,t,n,r){var i=this,s=i.options,o=i.data,u=i.graph,a=i.area,f=i.chart,l=i.xAxis&&i.xAxis.names,c=u&&u.shift||0,h=s.data,p,d,v=i.xData,m,g;rn(r,f),n&&ln([u,a,i.graphNeg,i.areaNeg],function(e){e&&(e.shift=c+1)}),a&&(a.isArea=!0),t=Ft(t,!0),p={series:i},i.pointClass.prototype.applyOptions.apply(p,[e]),m=p.x,g=v.length;if(i.requireSorting&&m<v[g-1]){d=!0;while(g&&v[g-1]>m)g--}i.updateParallelArrays(p,"splice",g,0,0),i.updateParallelArrays(p,g),l&&(l[m]=p.name),h.splice(g,0,e),d&&(i.data.splice(g,0,null),i.processData()),s.legendType==="point"&&i.generatePoints(),n&&(o[0]&&o[0].remove?o[0].remove(!1):(o.shift(),i.updateParallelArrays(p,"shift"),h.shift())),i.isDirty=!0,i.isDirtyData=!0,t&&(i.getAttribs(),f.redraw())},remove:function(e,t){var n=this,r=n.chart;e=Ft(e,!0),n.isRemoving||(n.isRemoving=!0,mn(n,"remove",null,function(){n.destroy(),r.isDirtyLegend=r.isDirtyBox=!0,r.linkSeries(),e&&r.redraw(t)})),n.isRemoving=!1},update:function(t,n){var r=this.chart,i=this.userOptions,s=this.type,o=St[s].prototype,u;t=Nt(i,{animation:!1,index:this.index,pointStart:this.xData[0]},{data:this.options.data},t),this.remove(!1);for(u in o)o.hasOwnProperty(u)&&(this[u]=e);Tt(this,St[t.type||s].prototype),this.init(r,t),Ft(n,!0)&&r.redraw(!1)}}),Tt(Fn.prototype,{update:function(t,n){var r=this.chart;t=r.options[this.coll][this.options.index]=Nt(this.userOptions,t),this.destroy(!0),this._addedPlotLB=this.userMin=this.userMax=e,this.init(r,Tt(t,{events:e})),r.isDirtyBox=!0,Ft(n,!0)&&r.redraw()},remove:function(e){var t=this.chart,n=this.coll,r=this.series,i=r.length;while(i--)r[i]&&r[i].remove(!1);Pt(t.axes,this),Pt(t[n],this),t.options[n].splice(this.options.index,1),ln(t[n],function(e,t){e.options.index=t}),this.destroy(),t.isDirtyBox=!0,Ft(e,!0)&&t.redraw()},setTitle:function(e,t){this.update({title:e},t)},setCategories:function(e,t){this.update({categories:e},t)}});var Zn=Rt(Gn);St.line=Zn,En.area=Nt(Sn,{threshold:0});var er=Rt(Gn,{type:"area",getSegments:function(){var e=[],t=[],n=[],r=this.xAxis,i=this.yAxis,s=i.stacks[this.stackKey],o={},u,a,f=this.points,l=this.options.connectNulls,c,h,p;if(this.options.stacking&&!this.cropped){for(h=0;h<f.length;h++)o[f[h].x]=f[h];for(p in s)s[p].total!==null&&n.push(+p);n.sort(function(e,t){return e-t}),ln(n,function(e){if(l&&(!o[e]||o[e].y===null))return;o[e]?t.push(o[e]):(u=r.translate(e),c=s[e].percent?s[e].total?s[e].cum*100/s[e].total:0:s[e].cum,a=i.toPixels(c,!0),t.push({y:null,plotX:u,clientX:u,plotY:a,yBottom:a,onMouseOver:H}))}),t.length&&e.push(t)}else Gn.prototype.getSegments.call(this),e=this.segments;this.segments=e},getSegmentPath:function(e){var t=Gn.prototype.getSegmentPath.call(this,e),n=[].concat(t),r,i=this.options,s=t.length,o=this.yAxis.getThreshold(i.threshold),u;s===3&&n.push(J,t[1],t[2]);if(i.stacking&&!this.closedStacks)for(r=e.length-1;r>=0;r--)u=Ft(e[r].yBottom,o),r<e.length-1&&i.step&&n.push(e[r+1].plotX,u),n.push(e[r].plotX,u);else this.closeSegment(n,e,o);return this.areaPath=this.areaPath.concat(n),t},closeSegment:function(e,t,n){e.push(J,t[t.length-1].plotX,n,J,t[0].plotX,n)},drawGraph:function(){this.areaPath=[],Gn.prototype.drawGraph.apply(this);var e=this,t=this.areaPath,n=this.options,r=n.negativeColor,i=n.negativeFillColor,s=[["area",this.color,n.fillColor]];(r||i)&&s.push(["areaNeg",r,i]),ln(s,function(r){var i=r[0],s=e[i];s?s.animate({d:t}):e[i]=e.chart.renderer.path(t).attr({fill:Ft(r[2],An(r[1]).setOpacity(Ft(n.fillOpacity,.75)).get()),zIndex:0}).add(e.group)})},drawLegendSymbol:$n.drawRectangle});St.area=er,En.spline=Nt(Sn);var tr=Rt(Gn,{type:"spline",getPointSpline:function(e,t,n){var r=1.5,i=r+1,s=t.plotX,o=t.plotY,f=e[n-1],l=e[n+1],c,h,p,d,v;if(f&&l){var m=f.plotX,g=f.plotY,y=l.plotX,b=l.plotY,w;c=(r*s+m)/i,h=(r*o+g)/i,p=(r*s+y)/i,d=(r*o+b)/i,w=(d-h)*(p-s)/(p-c)+o-d,h+=w,d+=w,h>g&&h>o?(h=u(g,o),d=2*o-h):h<g&&h<o&&(h=a(g,o),d=2*o-h),d>b&&d>o?(d=u(b,o),h=2*o-d):d<b&&d<o&&(d=a(b,o),h=2*o-d),t.rightContX=p,t.rightContY=d}return n?(v=["C",f.rightContX||f.plotX,f.rightContY||f.plotY,c||s,h||o,s,o],f.rightContX=f.rightContY=null):v=[$,s,o],v}});St.spline=tr,En.areaspline=Nt(En.area);var nr=er.prototype,rr=Rt(tr,{type:"areaspline",closedStacks:!0,getSegmentPath:nr.getSegmentPath,closeSegment:nr.closeSegment,drawGraph:nr.drawGraph,drawLegendSymbol:$n.drawRectangle});St.areaspline=rr,En.column=Nt(Sn,{borderColor:"#FFFFFF",borderWidth:1,borderRadius:0,groupPadding:.2,marker:null,pointPadding:.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{brightness:.1,shadow:!1},select:{color:"#C0C0C0",borderColor:"#000000",shadow:!1}},dataLabels:{align:null,verticalAlign:null,y:null},stickyTracking:!1,threshold:0});var ir=Rt(Gn,{type:"column",pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color",r:"borderRadius"},cropShoulder:0,trackerGroups:["group","dataLabelsGroup"],negStacks:!0,init:function(){Gn.prototype.init.apply(this,arguments);var e=this,t=e.chart;t.hasRendered&&ln(t.series,function(t){t.type===e.type&&(t.isDirty=!0)})},getColumnMetrics:function(){var t=this,n=t.options,r=t.xAxis,i=t.yAxis,s=r.reversed,o,u={},l,c=0;n.grouping===!1?c=1:ln(t.chart.series,function(n){var r=n.options,s=n.yAxis;n.type===t.type&&n.visible&&i.len===s.len&&i.pos===s.pos&&(r.stacking?(o=n.stackKey,u[o]===e&&(u[o]=c++),l=u[o]):r.grouping!==!1&&(l=c++),n.columnIndex=l)});var h=a(f(r.transA)*(r.ordinalSlope||n.pointRange||r.closestPointRange||r.tickInterval||1),r.len),p=h*n.groupPadding,d=h-2*p,v=d/c,m=n.pointWidth,g=Ht(m)?(v-m)/2:v*n.pointPadding,y=Ft(m,v-2*g),b=(s?c-(t.columnIndex||0):t.columnIndex)||0,w=g+(p+b*v-h/2)*(s?-1:1);return t.columnMetrics={width:y,offset:w}},translate:function(){var e=this,t=e.chart,n=e.options,r=n.borderWidth,s=e.yAxis,l=n.threshold,c=e.translatedThreshold=s.getThreshold(l),h=Ft(n.minPointLength,5),p=e.getColumnMetrics(),d=p.width,v=e.barW=o(u(d,1+2*r)),m=e.pointXOffset=p.offset,g=-(r%2?.5:0),y=r%2?.5:1;t.renderer.isVML&&t.inverted&&(y+=1),Gn.prototype.translate.apply(e),ln(e.points,function(e){var t=Ft(e.yBottom,c),n=a(u(-999-t,e.plotY),s.len+999+t),r=e.plotX+m,o=v,l=a(n,t),p,b,w,E,S=u(n,t)-l;f(S)<h&&h&&(S=h,l=i(f(l-c)>h?t-h:c-(s.translate(e.y,0,1,0,1)<=c?h:0))),e.barX=r,e.pointWidth=d,E=f(r)<.5,p=i(r+o)+g,r=i(r)+g,o=p-r,w=f(l)<.5,b=i(l+S)+y,l=i(l)+y,S=b-l,E&&(r+=1,o-=1),w&&(l-=1,S+=1),e.shapeType="rect",e.shapeArgs={x:r,y:l,width:o,height:S}})},getSymbol:H,drawLegendSymbol:$n.drawRectangle,drawGraph:H,drawPoints:function(){var t=this,n=this.chart,r=t.options,i=n.renderer,s=r.animationLimit||250,o;ln(t.points,function(n){var u=n.plotY,a=n.graphic;u!==e&&!isNaN(u)&&n.y!==null?(o=n.shapeArgs,a?(bn(a),a[t.points.length<s?"animate":"attr"](Nt(o))):n.graphic=a=i[n.shapeType](o).attr(n.pointAttr[n.selected?Y:Q]).add(t.group).shadow(r.shadow,null,r.stacking&&!r.borderRadius)):a&&(n.graphic=a.destroy())})},animate:function(e){var t=this,n=this.yAxis,r=t.options,i=this.chart.inverted,s={},o;S&&(e?(s.scaleY=.001,o=a(n.pos+n.len,u(n.pos,n.toPixels(r.threshold))),i?s.translateX=o-n.len:s.translateY=o,t.group.attr(s)):(s.scaleY=1,s[i?"translateX":"translateY"]=n.pos,t.group.animate(s,t.options.animation),t.animate=null))},remove:function(){var e=this,t=e.chart;t.hasRendered&&ln(t.series,function(t){t.type===e.type&&(t.isDirty=!0)}),Gn.prototype.remove.apply(e,arguments)}});St.column=ir,En.bar=Nt(En.column);var sr=Rt(ir,{type:"bar",inverted:!0});St.bar=sr,En.scatter=Nt(Sn,{lineWidth:0,tooltip:{headerFormat:'<span style="font-size: 10px; color:{series.color}">{series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>",followPointer:!0},stickyTracking:!1});var or=Rt(Gn,{type:"scatter",sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["markerGroup"],takeOrdinalPosition:!1,singularTooltips:!0,drawGraph:function(){this.options.lineWidth&&Gn.prototype.drawGraph.call(this)}});St.scatter=or,En.pie=Nt(Sn,{borderColor:"#FFFFFF",borderWidth:1,center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{distance:30,enabled:!0,formatter:function(){return this.point.name}},ignoreHiddenPoint:!0,legendType:"point",marker:null,size:null,showInLegend:!1,slicedOffset:10,states:{hover:{brightness:.1,shadow:!1}},stickyTracking:!1,tooltip:{followPointer:!0}});var ur=Rt(Qn,{init:function(){Qn.prototype.init.apply(this,arguments);var e=this,t;return e.y<0&&(e.y=null),Tt(e,{visible:e.visible!==!1,name:Ft(e.name,"Slice")}),t=function(t){e.slice(t.type==="select")},dn(e,"select",t),dn(e,"unselect",t),e},setVisible:function(t){var n=this,r=n.series,i=r.chart;n.visible=n.options.visible=t=t===e?!n.visible:t,r.options.data[fn(n,r.data)]=n.options,ln(["graphic","dataLabel","connector","shadowGroup"],function(e){n[e]&&n[e][t?"show":"hide"](!0)}),n.legendItem&&i.legend.colorizeItem(n,t),!r.isDirty&&r.options.ignoreHiddenPoint&&(r.isDirty=!0,i.redraw())},slice:function(e,t,n){var r=this,i=r.series,s=i.chart,o;rn(n,s),t=Ft(t,!0),r.sliced=r.options.sliced=e=Ht(e)?e:!r.sliced,i.options.data[fn(r,i.data)]=r.options,o=e?r.slicedTranslation:{translateX:0,translateY:0},r.graphic.animate(o),r.shadowGroup&&r.shadowGroup.animate(o)}}),ar={type:"pie",isCartesian:!1,pointClass:ur,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","dataLabelsGroup"],axisTypes:[],pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color"},singularTooltips:!0,getColor:H,animate:function(e){var t=this,n=t.points,r=t.startAngleRad;e||(ln(n,function(e){var n=e.graphic,i=e.shapeArgs;n&&(n.attr({r:t.center[3]/2,start:r,end:r}),n.animate({r:i.r,start:i.start,end:i.end},t.options.animation))}),t.animate=null)},setData:function(e,t,n,r){Gn.prototype.setData.call(this,e,!1,n,r),this.processData(),this.generatePoints(),Ft(t,!0)&&this.chart.redraw(n)},generatePoints:function(){var e,t=0,n,r,i,s=this.options.ignoreHiddenPoint;Gn.prototype.generatePoints.call(this),n=this.points,r=n.length;for(e=0;e<r;e++)i=n[e],t+=s&&!i.visible?0:i.y;this.total=t;for(e=0;e<r;e++)i=n[e],i.percentage=t>0?i.y/t*100:0,i.total=t},translate:function(e){this.generatePoints();var t=this,n=0,s=1e3,o=t.options,u=o.slicedOffset,f=u+o.borderWidth,p,d,v,m=o.startAngle||0,g=t.startAngleRad=h/180*(m-90),y=t.endAngleRad=h/180*(Ft(o.endAngle,m+360)-90),b=y-g,w=t.points,E,S,x=o.dataLabels.distance,T=o.ignoreHiddenPoint,N,C=w.length,k;e||(t.center=e=t.getCenter()),t.getX=function(t,n){return v=r.asin(a((t-e[1])/(e[2]/2+x),1)),e[0]+(n?-1:1)*l(v)*(e[2]/2+x)};for(N=0;N<C;N++){k=w[N],p=g+n*b;if(!T||k.visible)n+=k.percentage/100;d=g+n*b,k.shapeType="arc",k.shapeArgs={x:e[0],y:e[1],r:e[2]/2,innerR:e[3]/2,start:i(p*s)/s,end:i(d*s)/s},v=(d+p)/2,v>1.5*h?v-=2*h:v<-h/2&&(v+=2*h),k.slicedTranslation={translateX:i(l(v)*u),translateY:i(c(v)*u)},E=l(v)*e[2]/2,S=c(v)*e[2]/2,k.tooltipPos=[e[0]+E*.7,e[1]+S*.7],k.half=v<-h/2||v>h/2?1:0,k.angle=v,f=a(f,x/2),k.labelPos=[e[0]+E+l(v)*x,e[1]+S+c(v)*x,e[0]+E+l(v)*f,e[1]+S+c(v)*f,e[0]+E,e[1]+S,x<0?"center":k.half?"right":"left",v]}},drawGraph:null,drawPoints:function(){var e=this,t=e.chart,n=t.renderer,r,i,s=e.options.shadow,o,u;s&&!e.shadowGroup&&(e.shadowGroup=n.g("shadow").add(e.group)),ln(e.points,function(t){i=t.graphic,u=t.shapeArgs,o=t.shadowGroup,s&&!o&&(o=t.shadowGroup=n.g("shadow").add(e.shadowGroup)),r=t.sliced?t.slicedTranslation:{translateX:0,translateY:0},o&&o.attr(r),i?i.animate(Tt(u,r)):t.graphic=i=n[t.shapeType](u).setRadialReference(e.center).attr(t.pointAttr[t.selected?Y:Q]).attr({"stroke-linejoin":"round"}).attr(r).add(e.group).shadow(s,o),t.visible!==undefined&&t.setVisible(t.visible)})},sortByAngle:function(e,t){e.sort(function(e,n){return e.angle!==undefined&&(n.angle-e.angle)*t})},drawLegendSymbol:$n.drawRectangle,getCenter:Kn.getCenter,getSymbol:H};ar=Rt(Gn,ar),St.pie=ar,Gn.prototype.drawDataLabels=function(){var t=this,n=t.options,r=n.cursor,i=n.dataLabels,s=t.points,o,u,a,f;if(i.enabled||t._hasPointLabels)t.dlProcessOptions&&t.dlProcessOptions(i),f=t.plotGroup("dataLabelsGroup","data-labels",t.visible?W:U,i.zIndex||6),u=i,ln(s,function(n){var s,l=n.dataLabel,c,h,p,d,v=n.connector,m=!0;o=n.options&&n.options.dataLabels,s=Ft(o&&o.enabled,u.enabled);if(l&&!s)n.dataLabel=l.destroy();else if(s){i=Nt(u,o),d=i.rotation,c=n.getLabelConfig(),a=i.format?Vt(i.format,c):i.formatter.call(c,i),i.style.color=Ft(i.color,i.style.color,t.color,"black");if(l)Ht(a)?(l.attr({text:a}),m=!1):(n.dataLabel=l=l.destroy(),v&&(n.connector=v.destroy()));else if(Ht(a)){h={fill:i.backgroundColor,stroke:i.borderColor,"stroke-width":i.borderWidth,r:i.borderRadius||0,rotation:d,padding:i.padding,zIndex:1};for(p in h)h[p]===e&&delete h[p];l=n.dataLabel=t.chart.renderer[d?"text":"label"](a,0,-999,null,null,null,i.useHTML).attr(h).css(Tt(i.style,r&&{cursor:r})).add(f).shadow(i.shadow)}l&&t.alignDataLabel(n,l,i,null,m)}})},Gn.prototype.alignDataLabel=function(e,t,n,r,s){var o=this.chart,u=o.inverted,a=Ft(e.plotX,-999),f=Ft(e.plotY,-999),l=t.getBBox(),c=this.visible&&(e.series.forceDL||o.isInsidePlot(a,i(f),u)||r&&o.isInsidePlot(a,u?r.x+1:r.y+r.height-1,u)),h;c&&(r=Tt({x:u?o.plotWidth-f:a,y:i(u?o.plotHeight-a:f),width:0,height:0},r),Tt(n,{width:l.width,height:l.height}),n.rotation?(h={align:n.align,x:r.x+n.x+r.width/2,y:r.y+n.y+r.height/2},t[s?"attr":"animate"](h)):(t.align(n,null,r),h=t.alignAttr,Ft(n.overflow,"justify")==="justify"?this.justifyDataLabel(t,n,h,l,r,s):Ft(n.crop,!0)&&(c=o.isInsidePlot(h.x,h.y)&&o.isInsidePlot(h.x+l.width,h.y+l.height)))),c||(t.attr({y:-999}),t.placed=!1)},Gn.prototype.justifyDataLabel=function(e,t,n,r,i,s){var o=this.chart,u=t.align,a=t.verticalAlign,f,l;f=n.x,f<0&&(u==="right"?t.align="left":t.x=-f,l=!0),f=n.x+r.width,f>o.plotWidth&&(u==="left"?t.align="right":t.x=o.plotWidth-f,l=!0),f=n.y,f<0&&(a==="bottom"?t.verticalAlign="top":t.y=-f,l=!0),f=n.y+r.height,f>o.plotHeight&&(a==="top"?t.verticalAlign="bottom":t.y=o.plotHeight-f,l=!0),l&&(e.placed=!s,e.align(t,null,i))},St.pie&&(St.pie.prototype.drawDataLabels=function(){var e=this,t=e.data,n,r=e.chart,s=e.options.dataLabels,o=Ft(s.connectorPadding,10),a=Ft(s.connectorWidth,1),l=r.plotWidth,c=r.plotHeight,h,p,d=Ft(s.softConnector,!0),v=s.distance,m=e.center,g=m[2]/2,y=m[1],b=v>0,w,E,S,x,T=[[],[]],N,C,k,L,A,O,M=[0,0,0,0],_=function(e,t){return t.y-e.y};if(!e.visible||!s.enabled&&!e._hasPointLabels)return;Gn.prototype.drawDataLabels.apply(e),ln(t,function(e){e.dataLabel&&e.visible&&T[e.half].push(e)}),A=0;while(!x&&t[A])x=t[A]&&t[A].dataLabel&&(t[A].dataLabel.getBBox().height||21),A++;A=2;while(A--){var D=[],P,H=[],B=T[A],j,F=B.length,I;e.sortByAngle(B,A-.5);if(v>0){for(j=y-g-v;j<=y+g+v;j+=x)D.push(j);P=D.length;if(F>P){L=[].concat(B),L.sort(_),O=F;while(O--)L[O].rank=O;O=F;while(O--)B[O].rank>=P&&B.splice(O,1);F=B.length}for(O=0;O<F;O++){n=B[O],S=n.labelPos;var q=9999,R,z;for(z=0;z<P;z++)R=f(D[z]-S[1]),R<q&&(q=R,I=z);if(I<O&&D[O]!==null)I=O;else if(P<F-O+I&&D[O]!==null){I=P-F+O;while(D[I]===null)I++}else while(D[I]===null)I++;H.push({i:I,y:D[I]}),D[I]=null}H.sort(_)}for(O=0;O<F;O++){var X,V;n=B[O],S=n.labelPos,w=n.dataLabel,k=n.visible===!1?U:W,V=S[1];if(v>0){X=H.pop(),I=X.i,C=X.y;if(V>C&&D[I+1]!==null||V<C&&D[I-1]!==null)C=V}else C=V;N=s.justify?m[0]+(A?-1:1)*(g+v):e.getX(I===0||I===D.length-1?V:C,A),w._attr={visibility:k,align:S[6]},w._pos={x:N+s.x+({left:o,right:-o}[S[6]]||0),y:C+s.y-10},w.connX=N,w.connY=C,this.options.size===null&&(E=w.width,N-E<o?M[3]=u(i(E-N+o),M[3]):N+E>l-o&&(M[1]=u(i(N+E-l+o),M[1])),C-x/2<0?M[0]=u(i(-C+x/2),M[0]):C+x/2>c&&(M[2]=u(i(C+x/2-c),M[2])))}}if(Yt(M)===0||this.verifyDataLabelOverflow(M))this.placeDataLabels(),b&&a&&ln(this.points,function(t){h=t.connector,S=t.labelPos,w=t.dataLabel,w&&w._pos?(k=w._attr.visibility,N=w.connX,C=w.connY,p=d?[$,N+(S[6]==="left"?5:-5),C,"C",N,C,2*S[2]-S[4],2*S[3]-S[5],S[2],S[3],J,S[4],S[5]]:[$,N+(S[6]==="left"?5:-5),C,J,S[2],S[3],J,S[4],S[5]],h?(h.animate({d:p}),h.attr("visibility",k)):t.connector=h=e.chart.renderer.path(p).attr({"stroke-width":a,stroke:s.connectorColor||t.color||"#606060",visibility:k}).add(e.group)):h&&(t.connector=h.destroy())})},St.pie.prototype.placeDataLabels=function(){ln(this.points,function(e){var t=e.dataLabel,n;t&&(n=t._pos,n?(t.attr(t._attr),t[t.moved?"animate":"attr"](n),t.moved=!0):t&&t.attr({y:-999}))})},St.pie.prototype.alignDataLabel=H,St.pie.prototype.verifyDataLabelOverflow=function(e){var t=this.center,n=this.options,r=n.center,i=n.minSize||80,s=i,o;return r[0]!==null?s=u(t[2]-u(e[1],e[3]),i):(s=u(t[2]-e[1]-e[3],i),t[0]+=(e[3]-e[1])/2),r[1]!==null?s=u(a(s,t[2]-u(e[0],e[2])),i):(s=u(a(s,t[2]-e[0]-e[2]),i),t[1]+=(e[0]-e[2])/2),s<t[2]?(t[2]=s,this.translate(t),ln(this.points,function(e){e.dataLabel&&(e.dataLabel._pos=null)}),this.drawDataLabels&&this.drawDataLabels()):o=!0,o}),St.column&&(St.column.prototype.alignDataLabel=function(e,t,n,r,i){var s=this.chart,o=s.inverted,u=e.dlBox||e.shapeArgs,a=e.below||e.plotY>Ft(this.translatedThreshold,s.plotSizeY),f=Ft(n.inside,!!this.options.stacking);u&&(r=Nt(u),o&&(r={x:s.plotWidth-r.y-r.height,y:s.plotHeight-r.x-r.width,width:r.height,height:r.width}),f||(o?(r.x+=a?0:r.width,r.width=0):(r.y+=a?r.height:0,r.height=0))),n.align=Ft(n.align,!o||f?"center":a?"right":"left"),n.verticalAlign=Ft(n.verticalAlign,o||f?"middle":a?"top":"bottom"),Gn.prototype.alignDataLabel.call(this,e,t,n,r,i)});var fr=xt.TrackerMixin={drawTrackerPoint:function(){var t=this,n=t.chart,r=n.pointer,i=t.options.cursor,s=i&&{cursor:i},o=function(r){var i=r.target,s;n.hoverSeries!==t&&t.onMouseOver();while(i&&!s)s=i.point,i=i.parentNode;s!==e&&s!==n.hoverPoint&&s.onMouseOver(r)};ln(t.points,function(e){e.graphic&&(e.graphic.element.point=e),e.dataLabel&&(e.dataLabel.element.point=e)}),t._hasTracking||(ln(t.trackerGroups,function(e){t[e]&&(t[e].addClass(z+"tracker").on("mouseover",o).on("mouseout",function(e){r.onTrackerMouseOut(e)}).css(s),C&&t[e].on("touchstart",o))}),t._hasTracking=!0)},drawTrackerGraph:function(){var e=this,t=e.options,n=t.trackByArea,r=[].concat(n?e.areaPath:e.graphPath),i=r.length,s=e.chart,o=s.pointer,u=s.renderer,a=s.options.tooltip.snap,f=e.tracker,l=t.cursor,c=l&&{cursor:l},h=e.singlePoints,p,d,v=function(){s.hoverSeries!==e&&e.onMouseOver()},m="rgba(192,192,192,"+(S?1e-4:.002)+")";if(i&&!n){d=i+1;while(d--)r[d]===$&&r.splice(d+1,0,r[d+1]-a,r[d+2],J),(d&&r[d]===$||d===i)&&r.splice(d,0,J,r[d-2]+a,r[d-1])}for(d=0;d<h.length;d++)p=h[d],r.push($,p.plotX-a,p.plotY,J,p.plotX+a,p.plotY);f?f.attr({d:r}):(e.tracker=u.path(r).attr({"stroke-linejoin":"round",visibility:e.visible?W:U,stroke:m,fill:n?m:V,"stroke-width":t.lineWidth+(n?0:2*a),zIndex:2}).add(e.group),ln([e.tracker,e.markerGroup],function(e){e.addClass(z+"tracker").on("mouseover",v).on("mouseout",function(e){o.onTrackerMouseOut(e)}).css(c),C&&e.on("touchstart",v)}))}};St.column&&(ir.prototype.drawTracker=fr.drawTrackerPoint),St.pie&&(St.pie.prototype.drawTracker=fr.drawTrackerPoint),St.scatter&&(or.prototype.drawTracker=fr.drawTrackerPoint),Tt(Vn.prototype,{setItemEvents:function(e,t,n,r,i){var s=this;(n?t:e.legendGroup).on("mouseover",function(){e.setState(G),t.css(s.options.itemHoverStyle)}).on("mouseout",function(){t.css(e.visible?r:i),e.setState()}).on("click",function(t){var n="legendItemClick",r=function(){e.setVisible()};t={browserEvent:t},e.firePointEvent?e.firePointEvent(n,t,r):mn(e,n,t,r)})},createCheckboxForItem:function(e){var t=this;e.checkbox=qt("input",{type:"checkbox",checked:e.selected,defaultChecked:e.selected},t.options.itemCheckboxStyle,t.chart.container),dn(e.checkbox,"click",function(t){var n=t.target;mn(e,"checkboxClick",{checked:n.checked},function(){e.select()})})}}),O.legend.itemStyle.cursor="pointer",Tt(Jn.prototype,{showResetZoom:function(){var e=this,t=O.lang,n=e.options.chart.resetZoomButton,r=n.theme,i=r.states,s=n.relativeTo==="chart"?null:"plotBox";this.resetZoomButton=e.renderer.button(t.resetZoom,null,null,function(){e.zoomOut()},r,i&&i.hover).attr({align:n.position.align,title:t.resetZoomTitle}).add().align(n.position,!1,s)},zoomOut:function(){var e=this;mn(e,"selection",{resetSelection:!0},function(){e.zoom()})},zoom:function(e){var t=this,n,r=t.pointer,i=!1,s;!e||e.resetSelection?ln(t.axes,function(e){n=e.zoom()}):ln(e.xAxis.concat(e.yAxis),function(e){var t=e.axis,s=t.isXAxis;if(r[s?"zoomX":"zoomY"]||r[s?"pinchX":"pinchY"])n=t.zoom(e.min,e.max),t.displayBtn&&(i=!0)}),s=t.resetZoomButton,i&&!s?t.showResetZoom():!i&&At(s)&&(t.resetZoomButton=s.destroy()),n&&t.redraw(Ft(t.options.chart.animation,e&&e.animation,t.pointCount<100))},pan:function(e,t){var n=this,r=n.hoverPoints,i;r&&ln(r,function(e){e.setState()}),ln(t==="xy"?[1,0]:[1],function(t){var r=e[t?"chartX":"chartY"],s=n[t?"xAxis":"yAxis"][0],o=n[t?"mouseDownX":"mouseDownY"],f=(s.pointRange||0)/2,l=s.getExtremes(),c=s.toValue(o-r,!0)+f,h=s.toValue(o+n[t?"plotWidth":"plotHeight"]-r,!0)-f;s.series.length&&c>a(l.dataMin,l.min)&&h<u(l.dataMax,l.max)&&(s.setExtremes(c,h,!1,!1,{trigger:"pan"}),i=!0),n[t?"mouseDownX":"mouseDownY"]=r}),i&&n.redraw(!1),It(n.container,{cursor:"move"})}}),Tt(Qn.prototype,{select:function(e,t){var n=this,r=n.series,i=r.chart;e=Ft(e,!n.selected),n.firePointEvent(e?"select":"unselect",{accumulate:t},function(){n.selected=n.options.selected=e,r.options.data[fn(n,r.data)]=n.options,n.setState(e&&Y),t||ln(i.getSelectedPoints(),function(e){e.selected&&e!==n&&(e.selected=e.options.selected=!1,r.options.data[fn(e,r.data)]=e.options,e.setState(Q),e.firePointEvent("unselect"))})})},onMouseOver:function(e){var t=this,n=t.series,r=n.chart,i=r.tooltip,s=r.hoverPoint;s&&s!==t&&s.onMouseOut(),t.firePointEvent("mouseOver"),i&&(!i.shared||n.noSharedTooltip)&&i.refresh(t,e),t.setState(G),r.hoverPoint=t},onMouseOut:function(){var e=this.series.chart,t=e.hoverPoints;if(!t||fn(this,t)===-1)this.firePointEvent("mouseOut"),this.setState(),e.hoverPoint=null},firePointEvent:function(e,t,n){var r=this,i=this.series,s=i.options;(s.point.events[e]||r.options&&r.options.events&&r.options.events[e])&&this.importEvents(),e==="click"&&s.allowPointSelect&&(n=function(e){r.select(null,e.ctrlKey||e.metaKey||e.shiftKey)}),mn(this,e,t,n)},importEvents:function(){if(!this.hasImportedEvents){var e=this,t=Nt(e.series.options.point,e.options),n=t.events,r;e.events=n;for(r in n)dn(e,r,n[r]);this.hasImportedEvents=!0}},setState:function(e,t){var n=this,r=n.plotX,i=n.plotY,s=n.series,o=s.options.states,u=En[s.type].marker&&s.options.marker,a=u&&!u.enabled,f=u&&u.states[e],l=f&&f.enabled===!1,c=s.stateMarkerGraphic,h=n.marker||{},p=s.chart,d,v,m=n.pointAttr;e=e||Q,t=t&&c;if(e===n.state&&!t||n.selected&&e!==Y||o[e]&&o[e].enabled===!1||e&&(l||a&&!f.enabled)||e&&h.states&&h.states[e]&&h.states[e].enabled===!1)return;n.graphic?(d=u&&n.graphic.symbolName&&m[e].r,n.graphic.attr(Nt(m[e],d?{x:r-d,y:i-d,width:2*d,height:2*d}:{}))):(e&&f&&(d=f.radius,v=h.symbol||s.symbol,c&&c.currentSymbol!==v&&(c=c.destroy()),c?c[t?"animate":"attr"]({x:r-d,y:i-d}):(s.stateMarkerGraphic=c=p.renderer.symbol(v,r-d,i-d,2*d,2*d).attr(m[e]).add(s.markerGroup),c.currentSymbol=v)),c&&c[e&&p.isInsidePlot(r,i,p.inverted)?"show":"hide"]()),n.state=e}}),Tt(Gn.prototype,{onMouseOver:function(){var e=this,t=e.chart,n=t.hoverSeries;n&&n!==e&&n.onMouseOut(),e.options.events.mouseOver&&mn(e,"mouseOver"),e.setState(G),t.hoverSeries=e},onMouseOut:function(){var e=this,t=e.options,n=e.chart,r=n.tooltip,i=n.hoverPoint;i&&i.onMouseOut(),e&&t.events.mouseOut&&mn(e,"mouseOut"),r&&!t.stickyTracking&&(!r.shared||e.noSharedTooltip)&&r.hide(),e.setState(),n.hoverSeries=null},setState:function(e){var t=this,n=t.options,r=t.graph,i=t.graphNeg,s=n.states,o=n.lineWidth,u;e=e||Q;if(t.state!==e){t.state=e;if(s[e]&&s[e].enabled===!1)return;e&&(o=s[e].lineWidth||o+1),r&&!r.dashstyle&&(u={"stroke-width":o},r.attr(u),i&&i.attr(u))}},setVisible:function(t,n){var r=this,i=r.chart,s=r.legendItem,o,u=i.options.chart.ignoreHiddenSeries,a=r.visible;r.visible=t=r.userOptions.visible=t===e?!a:t,o=t?"show":"hide",ln(["group","dataLabelsGroup","markerGroup","tracker"],function(e){r[e]&&r[e][o]()}),i.hoverSeries===r&&r.onMouseOut(),s&&i.legend.colorizeItem(r,t),r.isDirty=!0,r.options.stacking&&ln(i.series,function(e){e.options.stacking&&e.visible&&(e.isDirty=!0)}),ln(r.linkedSeries,function(e){e.setVisible(t,!1)}),u&&(i.isDirtyBox=!0),n!==!1&&i.redraw(),mn(r,o)},setTooltipPoints:function(t){var n=this,r=[],i,o,f,l=n.xAxis,c=l&&l.getExtremes(),h=l?l.tooltipLen||l.len:n.chart.plotSizeX,p,d,v,m,g=[];if(n.options.enableMouseTracking===!1||n.singularTooltips)return;t&&(n.tooltipPoints=null),ln(n.segments||n.points,function(e){r=r.concat(e)}),l&&l.reversed&&(r=r.reverse()),n.orderTooltipPoints&&n.orderTooltipPoints(r),i=r.length;for(m=0;m<i;m++){p=r[m],d=p.x;if(d>=c.min&&d<=c.max){v=r[m+1],o=f===e?0:f+1,f=r[m+1]?a(u(0,s((p.clientX+(v?v.wrappedClientX||v.clientX:h))/2)),h):h;while(o>=0&&o<=f)g[o++]=p}}n.tooltipPoints=g},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},select:function(t){var n=this;n.selected=t=t===e?!n.selected:t,n.checkbox&&(n.checkbox.checked=t),mn(n,t?"select":"unselect")},drawTracker:fr.drawTrackerGraph}),Tt(xt,{Axis:Fn,Chart:Jn,Color:An,Point:Qn,Tick:jn,Renderer:N,Series:Gn,SVGElement:On,SVGRenderer:Mn,arrayMin:Gt,arrayMax:Yt,charts:B,dateFormat:M,format:Vt,pathAnim:D,getOptions:Nn,hasBidiBug:x,isTouchDevice:w,numberFormat:Ut,seriesTypes:St,setOptions:Tn,addEvent:dn,removeEvent:vn,createElement:qt,discardElement:en,css:It,each:ln,extend:Tt,map:pn,merge:Nt,pick:Ft,splat:jt,extendClass:Rt,pInt:kt,wrap:Wt,svg:S,canvas:T,vml:!S&&!T,product:j,version:F})}(),define("highcharts",function(e){return function(){var t,n;return t||e.Highcharts}}(this)),"use strict",define("views/misc/chart-one",["underscore","backbone","highcharts","collections/products"],function(e,t,n,r){var i=t.View.extend({el:"#miscChartOneView",options:{chart:{type:"spline",zoomType:"xy",backgroundColor:null,style:{fontFamily:"Open Sans, sans-serif"}},title:null,legend:!1,rangeSelector:{selected:1},colors:["#aaa","#e43700"],xAxis:{title:null,tickColor:"#666",lineColor:"#666",gridLineColor:"#666",labels:{style:{color:"#ececec",fontSize:"16px"},y:30},tickInterval:1},yAxis:{title:null,gridLineColor:"#666",lineColor:"#111"},plotOptions:{spline:{lineWidth:3,marker:{radius:6,lineWidth:3,lineColor:"#aaa",fillColor:"#333",symbol:"circle"}}},tooltip:{formatter:function(){return"<strong>Year "+this.point.name+"</strong><br>$"+Number(this.point.y.toFixed(0)).toCommas()}},series:[],credits:{enabled:!1}},initialize:function(){this.products=new r,t.Events.on("change:product",this.setChart,this)},setChart:function(t){var n=this;this.products.getCostsByProduct(t,function(r,i){n.options.series[0]={data:e.map(i.rows,function(e){return{name:e.age,x:Number(Number(e.age).toFixed(0)),y:Number(Number(e.data[0]).toFixed(0))}})},t&&(n.options.series[1]={marker:{radius:6,lineWidth:3,lineColor:"#e43700",fillColor:"#333",symbol:"circle"},data:e.map(i.rows,function(e){return{name:e.age,x:Number(Number(e.age).toFixed(0)),y:Number(Number(e.data[1]).toFixed(0))}})}),n.$el.highcharts(n.options)})}});return i}),"use strict",define("views/misc",["backbone","views/misc/toolbar","views/misc/chart-one"],function(e,t,n){var r=e.View.extend({el:"#miscView",initialize:function(){this.toolbar=new t,this.chartOne=new n},show:function(){this.$el.removeClass("is-hidden"),this.chartOne.setChart()},hide:function(){this.$el.addClass("is-hidden")}});return r}),"use strict",define("views/rank/toolbar",["backbone","handlebars"],function(e){var t=e.View.extend({el:"#rankToolbarView",events:{"click #averageCost":"filter","click #enablerSpent":"filter","click #staffCount":"filter","click #time":"filter"},filter:function(t){var n=$(t.currentTarget);n.addClass("active").siblings().removeClass("active"),e.Events.trigger("change:filter",n.data("name"))}});return t}),"use strict",define("views/rank/chart",["underscore","backbone","highcharts","collections/products"],function(e,t,n,r){var i=t.View.extend({el:"#rankChartView",options:{chart:{type:"column",zoomType:"xy",backgroundColor:null,inverted:!0,spacingTop:0,height:900,style:{fontFamily:"Open Sans, sans-serif"}},title:!1,legend:!1,rangeSelector:{selected:1},xAxis:{type:"category",labels:{style:{color:"#ECECEC",fontSize:"12px",overflow:"hidden",width:"400px","min-width":"400px",lineHeight:"1",textAlign:"right"},useHTML:!0},title:null,tickColor:null,reversed:!1,lineColor:"#666"},yAxis:{offset:12,opposite:!0,title:{align:"low",margin:12,style:{color:"#666",fontSize:12}},labels:{},tickWidth:1,tickPosition:"inside",tickColor:"#666",tickLength:12,gridLineWidth:null,lineColor:"#666",lineWidth:1},plotOptions:{column:{borderWidth:0,borderColor:null,pointWidth:15,pointPadding:0,states:{hover:{color:"rgba(230, 61, 0, 1)"}}}},tooltip:{borderWidth:0,followPointer:!0},series:[],credits:{enabled:!1}},initialize:function(){this.products=new r,t.Events.on("change:filter",this.updateChart,this)},setChart:function(){var e=this;this.products.getRankedCosts(function(t,n){e.products.set(n.rows),e.updateChart()})},updateChart:function(t){var n=this;t=t||"average_cost",this.products.comparator=t,this.products.sort();switch(t){case"average_cost":this.options.yAxis.title.text="US Dollars",this.options.tooltip.formatter=function(){return"<strong>"+this.point.name+"</strong><br>$"+Number(this.point.y.toFixed(0)).toCommas()};break;case"enabler_spent":this.options.yAxis.title.text="US Dollars",this.options.tooltip.formatter=function(){return"<strong>"+this.point.name+"</strong><br>$"+Number(this.point.y.toFixed(0)).toCommas()};break;case"staff_count":this.options.yAxis.title.text="Persons",this.options.tooltip.formatter=function(){return"<strong>"+this.point.name+"</strong><br>"+Number(this.point.y.toFixed(0)).toCommas()+" persons"};break;case"time_months":this.options.yAxis.title.text="Months",this.options.tooltip.formatter=function(){return"<strong>"+this.point.name+"</strong><br>"+Number(this.point.y.toFixed(0)).toCommas()+" months"};break;default:this.options.yAxis.title.text="",this.options.tooltip.formatter=function(){return"<strong>"+this.point.name+"</strong><br>"+Number(this.point.y.toFixed(0)).toCommas()}}n.options.yAxis.labels={formatter:function(){return this.value.toSmallFormat()}},n.options.series[0]={color:"rgba(230, 61, 0, 0.5)",data:e.map(this.products.toJSON(),function(e){var n={name:e.name,y:e[t]};return e.name==="Average"&&(n.color="#aaa"),n})},n.$el.highcharts(n.options)}});return i}),"use strict",define("views/rank",["backbone","views/rank/toolbar","views/rank/chart"],function(e,t,n){var r=e.View.extend({el:"#rankView",initialize:function(){this.toolbar=new t,this.chart=new n},show:function(){this.$el.removeClass("is-hidden"),this.chart.setChart(),$("#averageCost").addClass("active").siblings().removeClass("active")},hide:function(){this.$el.addClass("is-hidden")}});return r}),"use strict",define("instances/status-constraints",["backbone","models/status-map"],function(e,t){var n=new t({constraint:"Historic constraints",cohort:"Consumer",product:"All products"});return n}),define("text!views/../../templates/contrains-toolbar.handlebars",[],function(){return'<li><a href="#all" data-name="All products">All products</a></li>\n{{#each products}}\n  <li><a href="#{{product}}" data-name="{{product}}">{{product}}</a></li>\n{{/each}}\n'}),"use strict",define("views/constraints/toolbar",["backbone","handlebars","instances/status-constraints","collections/products","text!../../../templates/contrains-toolbar.handlebars"],function(e,t,n,r,i){var s=e.View.extend({el:"#constraintsToolbarView",events:{"click #productSelector a":"setProduct","click #cohortSelector a":"setCohort","click #constraintSelector a":"setConstraint"},template:t.compile(i),initialize:function(){this.products=new r,this.$productOptions=this.$el.find("#productOptions"),this.$productSelector=this.$el.find("#productSelector"),this.$currentProduct=this.$el.find("#currentProduct"),this.$averageLegend=this.$el.find("#averageLegend"),this.$consumerVsEnablerLegend=this.$el.find(".consumer-vs-enabler-legend"),this.render()},render:function(e){var t=this;e=e||"Consumer",this.products.getDataByCohort(e,function(e,n){t.products.set(n.rows),t.$productOptions.html(t.template({products:t.products.toJSON()}))})},setCohort:function(e){var t=$(e.currentTarget),r=t.data("name");this.$el.find("#currentCohort").text(r),n.set("cohort",r),r==="Consumer vs Enabler"?(this.disableProducts(),this.$consumerVsEnablerLegend.removeClass("is-hidden"),this.$averageLegend.addClass("is-hidden")):(this.enableProducts(),this.$averageLegend.removeClass("is-hidden"),this.$consumerVsEnablerLegend.addClass("is-hidden")),this.resetProducts(),this.render(r),e.preventDefault()},setProduct:function(e){var t=$(e.currentTarget).data("name");this.$currentProduct.text(t),n.set("product",t),this.$productSelector.find(".item-color").removeClass("is-hidden"),t==="All products"&&this.resetProducts(),e.preventDefault()},setConstraint:function(e){var t=$(e.currentTarget),r=t.data("name");this.$el.find("#currentConstraint").text(r),n.set("constraint",r),r==="Future constraints"?(this.resetProducts(),this.disableProducts()):this.enableProducts(),e.preventDefault()},resetProducts:function(){this.$currentProduct.text("All products"),n.set("product","All products"),this.$productSelector.find(".item-color").addClass("is-hidden")},enableProducts:function(){n.get("constraint")==="Historic constraints"&&n.get("cohort")!=="Consumer vs Enabler"&&this.$productSelector.removeClass("is-disabled")},disableProducts:function(){this.$productSelector.addClass("is-disabled")}});return s}),"use strict",define("views/constraints/chart",["underscore","backbone","highcharts","collections/products","instances/status-constraints"],function(e,t,n,r,i){var s=t.View.extend({el:"#constraintsChartView",options:{title:null,chart:{type:"column",borderRadius:0,backgroundColor:null,spacingBottom:35,style:{fontFamily:"Open Sans, sans-serif"}},legend:!1,xAxis:{type:"category",labels:{style:{fontSize:"16px",color:"#ECECEC",textAlign:"center"},y:38,useHTML:!0},title:null,lineColor:"#666",tickWidth:0,minPadding:.5},yAxis:{title:null,labels:{step:5},gridLineColor:"#666",lineColor:"#666",lineWidth:1,tickWidth:0,max:5},plotOptions:{column:{borderWidth:0,pointWidth:14,groupPadding:.32}},tooltip:{formatter:function(){return"<b>"+this.point.name+"</b><br>"+Number(this.point.y.toFixed(2))}},series:[],credits:{enabled:!1}},initialize:function(){this.products=new r,i.on("change",this.setChart,this)},updateChart:function(t){var n=[],r=[];e.each(t.rows,function(e){n.push({name:e.constraint,y:Number(Number(e.average).toFixed(2)),color:"#aaa"}),e.value&&r.push({name:e.constraint,y:Number(Number(e.value).toFixed(2)),color:"#e43700"})}),this.options.series[0]={data:n},r.length>0?this.options.series[1]={data:r}:this.options.series[1]&&this.options.series.splice(this.options.series.indexOf(this.options.series[1]),1),this.$el.highcharts(this.options)},setChart:function(){var e=i.get("constraint"),t=i.get("cohort"),n=i.get("product");t==="Consumer vs Enabler"?this.byConsumerVsEnabler(e):e==="Future constraints"?this.byFutureConstraints(t):n==="All products"?this.byAllProductsAndCohort(t):n&&this.byProductAndCohort(n,t)},byConsumerVsEnabler:function(t){var n=this;this.products.getConsumerVsEnabler(function(r,i){var s=[],o=[];e.each(i.rows,function(e){var n={},r=0;t==="Future constraints"?r=Number(Number(e.future_average).toFixed(2)):r=Number(Number(e.historic_average).toFixed(2)),n={name:e.constraint,y:r},e.cohort==="Consumer"?s.push(n):e.cohort==="Enabler"&&o.push(n)}),n.options.series[0]={color:"#aaa",data:s},n.options.series[1]={color:"#525252",data:o},n.$el.highcharts(n.options)})},byAllProductsAndCohort:function(e){var t=this;this.products.getConstraintsByAllProductsAndCohort(e,function(e,n){t.updateChart(n)})},byProductAndCohort:function(e,t){var n=this;this.products.getConstraintsByProductAndCohort(e,t,function(e,t){n.updateChart(t)})},byFutureConstraints:function(e){var t=this;this.products.getConstraintsFuture(e,function(e,n){t.updateChart(n)})}});return s}),"use strict",define("views/constraints",["backbone","views/constraints/toolbar","views/constraints/chart"],function(e,t,n){var r=e.View.extend({el:"#constraintsView",initialize:function(){this.toolbar=new t,this.chart=new n},show:function(){this.$el.removeClass("is-hidden"),this.chart.setChart()},hide:function(){this.$el.addClass("is-hidden")}});return r}),"use strict",define("views/about",["backbone"],function(e){var t=e.View.extend({el:"#aboutView",show:function(){this.$el.removeClass("is-hidden")},hide:function(){this.$el.addClass("is-hidden")}});return t}),"use strict",define("router",["backbone","views/spin","views/map","views/misc","views/rank","views/constraints","views/about"],function(e,t,n,r,i,s,o){var u={},a,f,l,c,h,p,d;return u.spin=new t,u.map=new n,u.misc=new r,u.rank=new i,u.constraints=new s,u.about=new o,f=$("#mainNav"),l=$("#mapItemNav"),c=$("#miscItemNav"),h=$("#rankItemNav"),p=$("#constraintsItemNav"),d=$("#aboutItemNav"),a=e.Router.extend({routes:{"":"default",map:"map",misc:"misc",rank:"rank",constraints:"constraints",about:"about"},initialize:function(){e.history.start({pushState:!1})},"default":function(){this.navigate("map",{trigger:!0})},map:function(){this.hideAll(),this.disableAll(),l.addClass("active"),u.map.show()},misc:function(){this.hideAll(),this.disableAll(),c.addClass("active"),u.misc.show()},rank:function(){this.hideAll(),this.disableAll(),h.addClass("active"),u.rank.show()},constraints:function(){this.hideAll(),this.disableAll(),p.addClass("active"),u.constraints.show()},about:function(){this.hideAll(),this.disableAll(),d.addClass("active"),u.about.show()},hideAll:function(){u.map.hide(),u.misc.hide(),u.rank.hide(),u.about.hide(),u.constraints.hide()},disableAll:function(){f.find("li").removeClass("active")}}),a}),"use strict",sessionStorage.setItem("CARTODBUSER","globalintegrity"),require.config({paths:{jquery:"../vendor/jquery/jquery",underscore:"../vendor/underscore/underscore",backbone:"../vendor/backbone/backbone",handlebars:"../vendor/handlebars/handlebars",text:"../vendor/requirejs-text/text",sprintf:"../vendor/sprintf/src/sprintf",moment:"../vendor/momentjs/moment",spin:"../vendor/spinjs/spin",cartodb:"../vendor/cartodb/dist/cartodb.nojquery",highcharts:"../lib/highcharts/js/highcharts.src"},shim:{jquery:{exports:"$"},underscore:{exports:"_"},backbone:{deps:["jquery","underscore"],exports:"Backbone"},handlebars:{exports:"Handlebars"},sprintf:{exports:"sprintf"},cartodb:{deps:["jquery"]},highcharts:{exports:"Highcharts"}}}),require(["underscore","backbone","handlebars","router"],function(e,t,n,r){Number.prototype.toCommas=function(){return this.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},Number.prototype.toSmallFormat=function(){var e=this;return e>999999?e=(this/1e6).toFixed(0)+"M":e>999&&(e=(this/1e3).toFixed(0)+"K"),e},cdb.core.Template.compilers=e.extend(cdb.core.Template.compilers,{handlebars:typeof n=="undefined"?null:n.compile}),n.registerHelper("xif",function(e,t){var n=e!==undefined&&e!==null;return n?t.fn(this):t.inverse(this)}),new r}),define("main",function(){});